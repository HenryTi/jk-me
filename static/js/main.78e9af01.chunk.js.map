{"version":3,"sources":["tonva-core/net/wsChannel.ts","tonva-core/net/messageHub.ts","tonva-core/net/apiBase.ts","tonva-core/net/host.ts","tonva-core/net/appBridge.ts","tonva-core/net/httpChannel.ts","tonva-core/net/httpChannelUI.ts","tonva-core/net/uqApi.ts","tonva-core/net/guestApi.ts","tonva-core/net/caller.ts","tonva-core/net/centerApi.ts","tonva-core/net/netToken.ts","tonva-core/web/httpChannel.ts","tonva-core/web/httpChannelUI.ts","tonva-core/web/apiBase.ts","tonva-core/web/host.ts","tonva-core/web/uqApi.ts","tonva-core/web/wsChannel.ts","tonva-core/web/appBridge.ts","tonva-core/web/centerApi.ts","tonva-core/web/guestApi.ts","tonva-core/web/messageHub.ts","tonva-core/web/Web.ts","tonva-core/uqCore/entity.ts","tonva-core/uqCore/caller.ts","tonva-core/uqCore/tuid/idCache.ts","tonva-core/uqCore/tuid/reactBoxId.tsx","tonva-core/uqCore/uqMan.ts","tonva-core/uqCore/tuid/tuid.tsx","tonva-core/uqCore/tuid/tuidsCache.ts","tonva-core/uqCore/action.ts","tonva-core/uqCore/sheet.ts","tonva-core/uqCore/query.ts","tonva-core/uqCore/book.ts","tonva-core/uqCore/history.ts","tonva-core/uqCore/map.ts","tonva-core/uqCore/pending.ts","tonva-core/uqCore/enum.ts","tonva-core/uqCore/ID.ts","tonva-core/uqCore/IDCache/IDCache.ts","tonva-core/uqCore/uqsMan.ts","tonva-core/uqCore/uqsLoader.ts","tonva-core/navigo.ts","tonva-core/tool/pageItems.ts","tonva-core/tool/local.ts","tonva-core/tool/getObjPropIgnoreCase.ts","tonva-core/tool/date.ts","tonva-core/tool/caseString.ts","tonva-core/tool/rules.ts","tonva-react/nav/Nav.tsx","tonva-react/components/reloadPage.tsx","tonva-react/nav/FetchErrorView.tsx","tonva-react/nav/NavView.tsx","tonva-react/nav/index.ts","tonva-react/components/inputRules.ts","tonva-react/components/form/widgets/widget.tsx","tonva-react/components/form/widgets/textWidget.tsx","tonva-react/components/form/widgets/textareaWidget.tsx","tonva-react/components/form/widgets/passwordWidget.tsx","tonva-react/components/form/widgets/numberWidget.tsx","tonva-react/components/form/widgets/updownWidget.tsx","tonva-react/components/form/widgets/dateWidget.tsx","tonva-react/components/form/widgets/checkBoxWidget.tsx","tonva-react/components/form/widgets/selectWidget.tsx","tonva-react/components/form/widgets/radioWidget.tsx","tonva-react/components/form/widgets/rangeWidget.tsx","tonva-react/components/form/widgets/idWidget.tsx","tonva-react/components/form/widgets/unknown.tsx","tonva-react/components/form/widgets/buttonWidget.tsx","tonva-react/components/form/context.tsx","tonva-react/components/form/widgets/arrComponent.tsx","tonva-react/components/image.tsx","tonva-react/components/loading.tsx","tonva-react/components/simple/Badge.tsx","tonva-react/components/simple/LMR.tsx","tonva-react/components/simple/FA.tsx","tonva-react/components/simple/IconText.tsx","tonva-react/components/resUploader.tsx","tonva-react/components/edit/itemEdit.tsx","tonva-react/components/edit/imageItemEdit.tsx","tonva-react/components/form/widgets/imageWidget.tsx","tonva-react/components/form/widgets/tagWidget.tsx","tonva-react/components/form/widgets/factory.tsx","tonva-react/components/form/form.tsx","tonva-react/components/form/field.tsx","tonva-react/components/edit/stringItemEdit.tsx","tonva-react/components/edit/radioItemEdit.tsx","tonva-react/components/edit/selectItemEdit.tsx","tonva-react/components/edit/idItemEdit.tsx","tonva-react/components/edit/tagItemEdit.tsx","tonva-react/components/edit/textAreaItemEdit.tsx","tonva-react/components/edit/checkBoxItemEdit.tsx","tonva-react/components/edit/rangeItemEdit.tsx","tonva-react/components/edit/numberItemEdit.tsx","tonva-react/components/edit/edit.tsx","tonva-react/components/list/base.tsx","tonva-react/components/list/clickable.tsx","tonva-react/components/list/static.tsx","tonva-react/components/list/selectable.tsx","tonva-react/components/list/index.tsx","tonva-react/components/easyDate/index.tsx","tonva-react/components/dropDownActions/index.tsx","tonva-react/components/propGrid/row.tsx","tonva-react/components/propGrid/propView.tsx","tonva-react/components/propGrid/PropGrid.tsx","tonva-react/components/userIcon.tsx","tonva-react/components/media.tsx","tonva-react/components/searchBox.tsx","tonva-react/components/ax/index.tsx","tonva-react/components/input/input.tsx","tonva-react/components/input/inputs/inputNumber.tsx","tonva-react/components/input/inputs/checkBox.tsx","tonva-core/uqBuild/tools.ts","tonva-react/vm/view.tsx","tonva-react/vm/vpage.tsx","tonva-react/vm/components/CStringEdit.tsx","tonva-react/components/page/page.tsx","tonva-react/res/listRes.ts","tonva-core/tool/user.ts","tonva-react/res/res.ts","tonva-react/components/page/scrollView.tsx","tonva-core/tool/localDb.ts","tonva-react/vm/controller.tsx","tonva-core/tool/env.ts","tonva-react/components/login.tsx","tonva-core/tool/uid.ts","tonva-core/tool/62.ts","tonva-react/components/page/pageHeader.tsx","tonva-react/components/page/tabs.tsx","tonva-react/res/inputRes.ts","tonva-core/uqBuild/fieldItem.ts","tonva-react/auth/VLogout.tsx","tonva-react/auth/VLogin.tsx","tonva-react/auth/VChangePassword.tsx","tonva-react/auth/VUserQuit.tsx","tonva-react/auth/CLogin.tsx","tonva-react/img/logo.svg","tonva-react/auth/tools.tsx","tonva-core/uqBuild/buildTsUqFolder.ts","tonva-core/uqBuild/buildUQ.ts","tonva-react/auth/meInfo.tsx","tonva-react/app/vMain.tsx","tonva-react/app/CAppBase.ts","tonva-react/app/start.ts","tonva-react/app/CBase.ts","tonva-react/WebReact.ts","tonva-react/CStringEdit.tsx","tonva-react/uqStringify.ts","uq-app/CBase.ts","home/VHome.tsx","account/VAccount.tsx","account/VObjectAccountHistory.tsx","account/CAccount.ts","home/CHome.ts","uq-app/appConfig.ts","me/VAbout.tsx","me/VMe.tsx","me/VEditMe.tsx","me/VAdminSetting.tsx","me/CMe.ts","uq-app/bug/tester/test-times-change.ts","uq-app/bug/tester/test1.ts","uq-app/bug/tester/test2.ts","uq-app/bug/tester/test3.ts","uq-app/bug/tester/test4.ts","uq-app/bug/tester/index.ts","uq-app/bug/VBug.tsx","uq-app/bug/VConsole.tsx","uq-app/bug/CBug.ts","uq-app/res/index.ts","uq-app/res/zh.ts","uq-app/res/en.ts","uq-app/VMain.tsx","uq-app/uqs/JkMe/JkMe.ts","uq-app/test-uqui/VTest.tsx","uq-app/test-uqui/CTest.tsx","uq-app/uqs/JkMe/Object.ui.tsx","uq-app/uqs/JkMe/ItemHistory.ui.tsx","uq-app/uqs/JkMe/OrderDetail.ui.tsx","uq-app/uqs/JkMe/OrderMain.ui.tsx","uq-app/uqs/JkMe/ItemTitle.ui.tsx","uq-app/uqs/JkMe/PostTitle.ui.tsx","uq-app/uqs/JkMe/ObjectUser.ui.tsx","uq-app/uqs/JkMe/ObjectStaff.ui.tsx","uq-app/uqs/JkMe/ObjectPost.ui.tsx","uq-app/uqs/JkMe/ObjectCustomer.ui.tsx","uq-app/uqs/JkMe/ObjectPostItem.ui.tsx","uq-app/uqs/JkMe/Group.ui.tsx","uq-app/uqs/JkMe/ObjectDistributor.ui.tsx","uq-app/uqs/JkMe/ObjectAgent.ui.tsx","uq-app/uqs/JkMe/QueueBizOp.ui.tsx","uq-app/uqs/JkMe/QueueBizMain.ui.tsx","uq-app/uqs/JkMe/DeliverDetail.ui.tsx","uq-app/uqs/JkMe/DeliverMain.ui.tsx","uq-app/uqs/JkMe/Role.ui.tsx","uq-app/uqs/JkMe/OPIHistory.ui.tsx","uq-app/uqs/JkMe/ObjectAccount.ui.tsx","uq-app/uqs/JkMe/BizMainBound.ui.tsx","uq-app/uqs/JkMe/OPIBooking.ui.tsx","uq-app/uqs/JkMe/AccountTitle.ui.tsx","uq-app/uqs/JkMe/DxOrderDetail.ui.tsx","uq-app/uqs/JkMe/DxOrderMain.ui.tsx","uq-app/uqs/JkMe/DxBizMain.ui.tsx","uq-app/uqs/JkMe/DxBizOp.ui.tsx","uq-app/uqs/JkMe/DxBiz.ui.tsx","uq-app/uqs/JkMe/UserObject.ui.tsx","uq-app/uqs/JkMe/GroupObject.ui.tsx","uq-app/uqs/JkMe/UserSuperviseItem.ui.tsx","uq-app/uqs/JkMe/MonthSumProduct.ui.tsx","uq-app/uqs/JkMe/MonthSumCustomer.ui.tsx","uq-app/uqs/JkMe/IxBizOpBound.ui.tsx","uq-app/uqs/JkMe/UserRole.ui.tsx","uq-app/uqs/JkMe/RoleOps.ui.tsx","uq-app/uqs/JkMe/ObjectAccountHistory.ui.tsx","uq-app/uqs/JkMe/DaySumItem.ui.tsx","uq-app/uqs/JkMe/AccountBooking.ui.tsx","uq-app/uqs/JkProduct/JkProduct.ts","uq-app/uqs/JkProduct/Chemical.ui.tsx","uq-app/uqs/JkProduct/SalesRegion.ui.tsx","uq-app/uqs/JkProduct/Currency.ui.tsx","uq-app/uqs/JkProduct/PackType.ui.tsx","uq-app/uqs/JkProduct/Language.ui.tsx","uq-app/uqs/JkProduct/Brand.ui.tsx","uq-app/uqs/JkProduct/Stuff.ui.tsx","uq-app/uqs/JkProduct/ProductX.ui.tsx","uq-app/uqs/JkProduct/ProductCategory.ui.tsx","uq-app/uqs/JkProduct/Lot.ui.tsx","uq-app/uqs/JkProduct/PackSalesLevel.ui.tsx","uq-app/uqs/JkPointShop/JkPointShop.ts","uq-app/uqs/JkPointShop/ProductX.ui.tsx","uq-app/uqs/JkPointShop/Customer.ui.tsx","uq-app/uqs/JkPointShop/WebUser.ui.tsx","uq-app/uqs/JkPointShop/Contact.ui.tsx","uq-app/uqs/JkPointShop/Currency.ui.tsx","uq-app/uqs/JkPointShop/BuyerAccount.ui.tsx","uq-app/uqs/JkPointShop/Genre.ui.tsx","uq-app/uqs/JkPointShop/PointProductLib.ui.tsx","uq-app/uqs/JkPointShop/Brand.ui.tsx","uq-app/uqs/JkPointShop/OrderMain.ui.tsx","uq-app/uqs/JkPointShop/OrderDetail.ui.tsx","uq-app/uqs/JkPointShop/ExchangeDetail.ui.tsx","uq-app/uqs/JkPointShop/ExchangeMain.ui.tsx","uq-app/uqs/JkPointShop/ReceiveMain.ui.tsx","uq-app/uqs/JkPointShop/ReceiveDetail.ui.tsx","uq-app/uqs/JkPointShop/DxOrderDetail.ui.tsx","uq-app/uqs/JkPointShop/DxReOrderDetail.ui.tsx","uq-app/uqs/JkPointShop/DxExchangeDetail.ui.tsx","uq-app/uqs/JkPointShop/DxExchangeMainState.ui.tsx","uq-app/uqs/JkPointShop/IxExchangeMainUsedPoint.ui.tsx","uq-app/uqs/JkPointShop/ExchangeDetailDeliver.ui.tsx","uq-app/uqs/JkPointShop/IxOrderDetailReceive.ui.tsx","uq-app/uqs/JkHr/JkHr.ts","uq-app/uqs/JkHr/Employee.ui.tsx","uq-app/uqs/JkHr/Role.ui.tsx","uq-app/uqs/JkHr/Company.ui.tsx","uq-app/uqs/index.ts","uq-app/uqs/JkMe/index.ts","uq-app/uqs/JkProduct/index.ts","uq-app/uqs/JkPointShop/index.ts","uq-app/uqs/JkHr/index.ts","supervise/VSupervise.tsx","supervise/VItemDayHistory.tsx","supervise/VItemSumHistory.tsx","supervise/VItemHistory.tsx","supervise/VSumByMonth.tsx","supervise/objects/CObjects.ts","supervise/objects/VObjects.tsx","supervise/objects/VAgents.tsx","supervise/objects/CAgents.ts","supervise/objects/VDistributors.tsx","supervise/objects/CDistributors.ts","supervise/objects/VGroups.tsx","supervise/objects/CGroups.ts","tools/parts.tsx","supervise/objects/VPosts.tsx","supervise/objects/CPosts.ts","supervise/objects/VStaffs.tsx","supervise/objects/CStaffs.ts","supervise/objects/initCObjects.ts","supervise/VAccounts.tsx","supervise/CSupervise.ts","portal/period.ts","portal/bizOpDetail.tsx","portal/VBizOpDetail.tsx","portal/VPostItemHistory.tsx","portal/VPeriodPostItemHistory.tsx","portal/VPortal.tsx","portal/CPortal.ts","portal/object/VObjectPortal.tsx","portal/object/CObjectPortal.ts","portal/unit/VUnitPortal.tsx","portal/unit/CUnitPortal.ts","uq-app/CApp.ts","uq-app/startApp.tsx","reportWebVitals.ts","index.tsx"],"names":["subAppWindow","MessageHub","handlerSeed","anyHandlers","msgHandlers","handler","seed","this","args0","type","handlerId","msg","a","$type","i","messageHub","postWsToSubApp","undefined","postMessage","WsBase","dispatch","wsBaseSeed","WsBridge","wsBaseId","WSChannel","wsHost","token","ws","that","Promise","resolve","reject","WebSocket","centerToken","console","log","onopen","ev","onerror","onmessage","wsMessage","onclose","close","event","data","JSON","parse","receive","netThis","connect","then","send","refetchApi","channel","url","options","fetch","ApiBase","path","showWaiting","caller","getHttpChannel","xcall","method","body","callFetch","params","get","post","put","delete","centerHost","process","uqDebugHost","hosts","centerhost","value","local","reshost","uqhost","unitxhost","httpArr","urlFromHost","host","str","startsWith","isAbsoluteUrl","endsWith","centerUrlFromHost","centerWsFromHost","https","substr","length","resUrlFromHost","fetchOptions","mode","headers","Host","testing","resHost","env","isDevelopment","tryLocal","getCenterHost","getResHost","promises","hostArr","findIndex","v","push","fetchUrl","debugHostUrl","localCheck","all","results","len","j","hostValue","document","location","hash","includes","debugHost","db","urlTest","testProd","error","getUrlOrDebug","urlDebug","fetchLocalCheck","text","catch","e","Error","setTimeout","uqTokens","isBridged","window","self","parent","Nav","user","nav","subFrameStarted","evt","message","subWin","source","el","getElementById","hidden","hideFrameBack","_","clone","initSubWin","setCenterToken","id","showAppView","onReceiveAppApiMessage","apiName","unit","parts","split","param","uqOwner","uqName","appOwner","appName","uqTokenApi","uq","ret","name","onAppApiReturn","action","uqTokenActions","realUrl","getUrlOrTest","addEventListener","onReceive","navBack","callCenterApiFromMessage","bridgeCenterApiReturn","stringify","buildAppUq","uqToken","at","opener","getUqToken","brideCenterApis","bridgeCenterApi","callId","uid","from","callCenterapi","directCall","result","bca","methodsWithBody","HttpChannel","hostUrl","apiToken","ui","timeout","startWait","waiting","endWait","showError","urlPrefix","buildOptions","h","encodeURI","p","buildParams","indexOf","innerFetch","res","keys","Object","c","k","innerFetchResult","buildError","err","ex","retErr","key","now","Date","timeOutHandler","ok","clearTimeout","statusText","ct","json","retJson","Array","isArray","retError","toLowerCase","buildHeaders","lang","language","CenterHttpChannel","u","UqHttpChannel","HttpChannelNavUI","version","channelUIs","channelNoUIs","logoutApis","channels","UqTokenApi","clearLocal","logoutUqTokens","UqApi","basePath","channelUI","arr","init","s","trim","theUser","roles","start","page","entities","UnitxApi","unitId","buildChannel","centerAppApi","CenterAppApi","unitxUq","setCenterUrl","centerChannel","centerChannelUI","loginedUserId","userId","t","CenterApiBase","uqTokensName","localMap","localDb","map","un","localCache","child","remove","nowTick","Math","floor","tick","uqParams","set","removeItem","CallCenterApi","call","uqs","UserApi","decodeUserToken","nick","icon","account","oem","verify","password","prop","userApi","GuestApi","decodeGuestToken","guest","unitName","guestApi","Caller","$$user","_params","CenterApi","app","userName","centerApi","netToken","clear","web","logout","culture","appBridge","onError","getCenterChannelUI","getCenterChannel","assign","AppBridge","onWsReceive","Web","unitxApi","wsBridge","isBuildingUQ","_uqs","ln","chars","codeBackSlash","charCodeAt","codeN","codeT","codeB","codeF","codeV","codeR","codes","codeBN","codeBT","codeBB","codeBF","codeBV","codeBR","Entity","typeId","jName","schema","ver","sys","schemaLocal","uqApi","fields","arrFields","returns","face","fieldMaps","item","find","f","loadEntitySchema","buildSchema","loadValues","setSchema","buildFieldsTuid","setJName","arrs","buildFieldTuid","buildArrFieldsTuid","fieldName","arrName","fn","getTuid","an","fieldArr","tuid","buildFieldsParams","arrResult","pa","rowResult","field","d","val","buildDateTimeParam","getFullYear","getMonth","getDate","_tuid","getIdFromObj","dt","getTime","toISOString","packRow","arrData","getObjPropIgnoreCase","packArr","join","row","r","ch","substring","escape","values","boxId","unpackRow","unpackArr","ch0","fLen","to","reverseNT","n","Number","isNaN","p0","vals","EntityCaller","entity","tries","_entity","loadSchema","innerRequest","innerCall","jsonResult","$uq","$modify","pullModify","xresult","retry","uqVersion","en","rebuildSchema","buildEntities","ActionCaller","QueryQueryCaller","unpackReturns","QueryPageCaller","pageStart","pageSize","IdCache","tuidLocal","queue","cache","Map","localArr","waitingIds","tuidInner","makeObservable","observable","shallow","cacheSet","initLocalArr","defer","has","cacheTuids","moveToHead","shift","index","splice","_id","getValue","useId","loadIds","tuidValues","cacheIdValues","tuids","unpackTuidIds","tuidValue","cacheValue","cacheTuidFieldValues","ids","loadTuidIdsOrLocal","localedValues","filter","getItem","loadingIds","netIds","loadValuesFromIds","netRet","setItem","IdDivCache","div","divName","TuidContent","tuidName","x","uqStringify","ReactBoxId","isUndefined","valueFromId","boxName","obj","className","content","assureBox","observer","nullUI","ttv","divObj","bi","logContent","render","boxIdContent","EnumResultType","UqTuid","noCache","typeName","idName","unique","isImport","TuidBox","id1","ix","Tuid","idValue","TuidInner","divs","cacheFields","idCache","newVersion","removeAll","tuidDiv","TuidDiv","TuidView","sName","createBoxId","resetCache","assureObj","cacheIds","modifyIds","IdsCaller","request","GetCaller","cacheFieldsInValue","arrValues","mainFields","$create","$update","stampOnMain","unpackTuidIdsOfFields","props","SaveCaller","SavePropCaller","AllCaller","searchArr","owner","SearchCaller","LoadArrCaller","SaveArrCaller","order","ArrPosCaller","TuidNoCaller","TuidCaller","$id","transParams","arrParams","arrValue","buildDateParam","bid","$order","year","month","date","TuidImport","getObj","tv","hasDiv","loadMain","load","save","saveProp","search","loadArr","saveArr","posArr","no","ownerField","alert","TuidBoxDiv","TuidsCache","modifyMax","cacheTimer","clearCacheTimer","localModifyMax","max","seconds","tuidCached","innerPullModify","tuidLists","queueModify","group","modify","UqAction","ActionSubmitCaller","SubmitReturnsCaller","SubmitConvertCaller","Action","pack","UqSheet","states","ops","op","actions","discription","SaveDirectCaller","flow","state","ActionDirectCaller","brief","unpackSheet","flows","GetSheetCaller","getArchive","unpack","SheetArchiveCaller","SheetArchivesCaller","StateSheetsCaller","StateSheetCountCaller","UserSheetsCaller","MySheetsCaller","Sheet","SheetCaller","suffix","resVerify","count","UqQuery","PageItems","more","startField","list","isPaged","size","$page","array","deep","pop","pageCaller","queryCaller","query","table","Query","UqBook","queryApiName","BookQueryCaller","Book","UqHistory","History","UqMap","queries","schemaFrom","actionSchema","newAction","querySchema","newQuery","AddCaller","DelCaller","PageCaller","qc","QueryCaller","MapCaller","getCaller","MapAddCaller","add","MapDelCaller","MapAllCaller","MapPageCaller","MapQueryCaller","UqPending","Pending","UqEnum","UqID","create","update","ID","QueryID","IDX","UqIDX","UqIX","IX","IDCache","timeoutHandler","timeOut","TvIdValues","IDTv","UqMan","uqData","tvs","enums","idxs","ixs","sheets","books","maps","histories","pendings","tuidsCache","localEntities","proxy","config","createBoxIdFromTVs","allRoles","tuidArr","actionArr","queryArr","idArr","idxArr","ixArr","enumArr","sheetArr","bookArr","mapArr","historyArr","pendingArr","Acts","apiActs","retArr","retActs","getAdmins","$Acts","sql","ActIX","apiActIX","$ActIX","ActIXSort","apiActIxSort","$ActIXSort","ActDetail","apiActDetail","items","main","detail","detail2","detail3","$ActDetail","apiQueryID","$QueryID","apiIDTv","retValues","$tv","nameNoVice","$IDTv","IDNO","apiIDNO","$IDNO","IDDetailGet","apiIDDetailGet","$IDDetailGet","apiID","$ID","KeyID","apiKeyID","$KeyID","apiIX","$IX","IXr","apiIXr","$IXr","KeyIX","apiKeyIX","$KeyIX","IDLog","apiIDLog","$IDLog","IDSum","apiIDSum","$IDSum","IDinIX","apiIDinIX","$IDinIX","IDxID","apiIDxID","$IDxID","IDTree","apiIDTree","$IDTree","IDRender","React","createElement","children","renderIDUnknownType","IDType","IDV","IDLocalV","IDLocalRender","getRoles","sheet","loadEntities","access","role","names","buildTuids","buildAccess","newTuid","entityName","allSchemas","forEach","fromType","fromObj","enm","setEntity","book","history","pending","lName","idEntity","idx","newID","newIDX","newIX","newBook","newMap","newHistory","newSheet","newPending","newEnum","buildSheet","build","buildTuidBox","buildTuidDivBox","uqKey","dev","alias","capitalCase","Proxy","target","receiver","lk","func","String","showReload","reloadTick","showReloadPage","reload","api","resultType","apiParam","nv","prototype","toString","apiPost","IXs","after","postParam","toScalars","IDXToString","IX1","ID2","UQsMan","uqMans","collection","buildTVs","uqDataArr","uqConfigs","localCacheVersion","cacheVersion","retErrors","setTuidImportsLocal","uqConfig","ownerAlias","uqLower","buildUQs","uqMan","uqTVs","l","lj","uqsData","promiseInits","uqAlias","uqFullName","uqFull","lower","setUq","createProxy","getUqKey","getUqKeyWithConfig","setInner","tuidImport","fromName","iName","setFrom","buildingUq","UQsLoader","appConfig","uqsMan","loadApp","loadUqs","uqsManApp","UQsManApp","localData","uqAppData","loadUqAppData","loadUqData","buildUqs","appUqs","tonvaAppName","Navigo","useHash","root","_routes","_useHash","_hash","_paused","_destroyed","_lastRouteResolved","_notFoundHandler","_defaultHandler","_usePushState","_genericHooks","_historyUpdateMethod","timout","_onLocationChange","isPushStateAvailable","replace","_cLoc","_listen","updatePageLinks","absolute","_getRoot","_historyUpdate","RegExp","href","arg0","arg1","hooks","orderedRoutes","sort","compareUrlDepth","route","on","uses","_add","reduce","current","GETParameters","extractGETParameters","onlyURL","getOnlyURL","already","matched","match","manageHooks","_callLeave","isHashedRoot","m","slice","removeEventListener","_findLinks","link","hasListenerAttached","ctrlKey","metaKey","currentTarget","tagName","getLinkPath","preventDefault","navigate","status","pause","destroy","getAttribute","as","title","pushState","replaceState","cLocRoot","isHashChangeAPIAvailable","cached","check","cleanUrl","querySelectorAll","lastRouteResolved","leave","decodeURIComponent","paramNames","regexp","PARAMETER_REGEXP","full","dots","REPLACE_VARIABLE_REGEXP","WILDCARD_REGEXP","REPLACE_WILDCARD","FOLLOWED_BY_SLASH_REGEXP","MATCH_REGEXP_FLAGS","urlA","urlB","getUrlDepth","routes","replaceDynamicURLParts","clean","regExpResultToParams","findMatchedRoutes","colonExp","routeExp","fallbackURL","matched0","cleanGETParam","exHooks","before","shouldRoute","itemObservable","loading","beforeLoad","loaded","_items","allLoaded","topDiv","bottomDiv","isFirst","pageItemAction","itemConverter","scrollToTop","scrollIntoView","scrollToBottom","firstSize","appendPosition","sortOrder","changing","computed","divId","getPageId","loadResults","pageList","runInAction","unshift","reset","isAsc","endItem","scrollToEnd","pushItem","endIndex","startId","pid","sum","setLoaded","onLoad","setPageStart","onLoaded","reverse","LocalData","_user","_guest","_unit","minute2020_01_01","dateFromMinuteId","timeZone","envTimezone","pow","dateFromHourId","firstCharUppercase","camelCase","ACode","ZCode","fromCharCode","firstCharLowercase","aCode","zCode","mobileRegex","emailRegex","logMark","ReloadPage","timerHandler","clearInterval","setInterval","setState","header","onClick","ConfirmReloadPage","back","confirm","FetchErrorView","reApi","clearError","errContent","style","wordWrap","SystemNotifyPage","stackKey","notSupportedBrowsers","NavView","stack","waitCount","waitTimeHandler","isHistoryBack","top","confirmClose","fetchError","browser","notSupportedBrowser","wait","view","disposer","removeCeased","ceased","refresh","dispose","level","backLevel","popAndDispose","elWait","elError","test","left","zIndex","visibility","position","logs","navView","navigo","navSettings","resUrl","hashParam","windowOnError","lineno","colno","windowOnUnhandledRejection","reason","windowOnClick","windowOnMouseMove","navigator","userAgent","y","windowOnScroll","forceDevelopment","reloadUser","curUser","logined","navLogin","showLogin","navLogout","showLogout","navRegister","showRegister","navForget","showForget","navPageRoutes","doneSysRoutes","sysRoutes","isWebNav","backIcon","closeIcon","pageWebNav","onChangeLogin","showPrivacyPage","privacy","getPrivacyContent","privacyPage","htmlString","__html","dangerouslySetInnerHTML","createLogin","login","upgradeUq","race","serviceWorker","ready","registration","unregister","plus","webview","webView","resetAll","localStorage","resOptions","district","onLogined","notLogined","userPassword","ref","g","unitJsonPath","unitRes","innerText","loadUnitJson","innerHTML","getPredefinedUnitName","unitFromName","settings","htmlTitle","html0","getElementsByTagName","origin","pathname","setGuest","onunhandledrejection","onfocus","isMobile","onselectstart","oncontextmenu","pwd","logindUser","historyAPIUpdateMethod","navPage","queryStr","routeFromNavPage","internalOnNavRoutes","merge","navOns","showPage","isUserLogin","me","callback","saveLocalUser","internalLogined","defaultTop","loginTop","withBack","getLogin","logoutClear","showChangePassword","showUserQuit","unauthorized","show","topKey","popTo","ceaseTop","regConfirmClose","confirmBox","toTimeString","step","parser","DOMParser","htmlDoc","parseFromString","elHtml","Rule","defaultInputRes","resLang","inputRes","RuleCustom","defy","RulePredefined","RuleRequired","required","RuleNum","min","minMsg","maxMsg","template","number","checkMore","RuleInt","isInteger","integer","Widget","context","itemSchema","fieldProps","_itemSchema","_ui","defaultValue","rules","readOnly","disabled","errors","contextErrors","visible","isChanging","onInputChange","changeValue","container","form","inNode","label","requiredFlag","FieldContainer","renderBody","hasError","isOk","getUiItem","buildRules","rule","removeErrorWidget","addErrorWidget","initData","newValue","fromElement","onChanging","onChanged","prev","allowChange","setDataValue","setElementValue","fieldClass","classNames","FieldClass","elDiscription","discriptionClassName","uiLabel","Templet","errorList","tag","TextWidget","inputType","input","hasFocus","onKeyDown","internalOnKeyDown","keyCode","onEnter","blur","setError","onBlur","checkRules","checkContextRules","onFocus","clearErrors","focus","select","placeholder","renderTemplet","cn","onChange","maxLength","renderErrors","TextAreaWidget","setValue","rows","PasswordWidget","UrlWidget","EmailWidget","NumberWidget","UpdownWidget","returnValue","isValidKey","DateWidget","DateTimeWidget","TimeWidget","MonthWidget","CheckBoxWidget","trueValue","falseValue","checked","defaultChecked","SelectWidget","option","radioStyle","height","RadioWidget","inputs","rowKey","isRow","RangeWidget","none","IdWidget","pickId","clearContextError","Unknown","dataType","uiType","dataTypes","ButtonWidget","submit","onButtonClick","observerRender","caption","widgetType","widget","button","ButtonClass","Context","uiSchema","subContexts","widgets","errorWidgets","arrRowContexts","itemName","getDisabled","setDisabled","getReadOnly","setReadOnly","getVisible","setVisible","buttonName","ew","checkFieldRules","rowContext","setContextError","clearWidgetsErrors","pos","checkHasError","clearContextErrors","rowKeySeed","RowContext","parentContext","arrSchema","uiArr","itemSchemas","FormContext","ContextContainer","ArrComponent","selectable","deletable","restorable","getArrRowContexts","onDeleted","onRestored","arrLabel","ArrContainer","RowContainer","RowSeperator","formSelectable","formDeletable","formRestorable","arrSelectable","arrDeletable","arrRestorable","ac","rc","rs","first","rowContent","sep","typeofTemplet","factory","selectCheck","deleteIcon","$isSelected","$source","isDeleted","$isDeleted","editContainer","Provider","Image","src","altImage","alt","Loading","b","badge","color","badgeAlign","badgeVertical","LMR","cursor","right","FA","spin","fixWidth","border","pull","pulse","rotate","flip","inverse","IconText","iconClass","textClass","ResUploader","fileInput","fileName","upload","formData","buildFormData","Headers","append","onFilesChange","files","maxSize","FormData","file","multiple","display","formatSize","pointLength","units","toFixed","xlargeSize","mediumSize","ImageUploader","imgBaseSize","imageTypes","resUploader","desImgWidth","desImgHeight","desImgSize","srcImgWidth","srcImgHeight","isChanged","resId","enableUploadButton","srcImage","desImage","fileError","uploaded","onFileChange","lastIndexOf","reader","FileReader","readAsDataURL","onload","setSize","compress","img","width","w","scale","round","canvas","ctx","getContext","anw","createAttribute","nodeValue","anh","setAttributeNode","drawImage","base64","toDataURL","blob","convertBase64UrlToBlob","onSaved","showOrgImage","maxWidth","urlData","mime","bstr","atob","u8arr","Uint8Array","Blob","levelDiv","padding","ItemEdit","fileSize","uploading","AudioUploader","audioTypes","edit","uiItem","_uiItem","internalStart","internalEnd","divValue","labelHide","templet","verifyRule","ImageItemEdit","ImageWidget","imageSrc","end","TagWidget","TagSingleWidget","valuesView","wrapClassName","inputName","renderRadios","TagMultiWidget","defaultArr","def","renderChecks","stringWidget","widgetFactories","string","textarea","datetime","time","email","updown","checkbox","image","checkboxes","radio","tagSingle","tagMulti","range","typeWidget","getItemSchema","getTypeWidget","hiden","widgetFactory","WidgetClass","Form","formContext","Container","watch","calcSelectOrDelete","DefaultContainer","onSubmit","DefaultFieldContainer","fieldLabelSize","fieldLabelAlign","labelView","cnAlign","fieldCol","DefaultFieldClass","DefaultButtonClass","DefaultRes","autorun","dv","initDataItem","arrItem","arrItems","arrDict","arrItemOperated","formArrVal","beforeShow","renderContent","FormField","contextType","StringItemEdit","preValue","verifyValue","onSave","inputOptions","element","RadioItemEdit","SelectItemEdit","IdItemEdit","TagItemEdit","renderInputs","TagSingleItemEdit","TagMultiItemEdit","TextAreaItemEdit","CheckBoxItemEdit","onItemChanged","RangeItemEdit","NumberItemEdit","Edit","defaultSepClassName","defaultRowContainerClassName","topBorder","bottomBorder","rowContainerClassName","rowClick","itemEdit","editInRow","onItemClick","stopEdit","topBorderClassName","bottomBorderClassName","sepClassName","ie","createItemEdit","divLabel","requireFlag","ListBase","pageItems","Clickable","Static","Selectable","inputItems","buildItems","itemsArray","isItemSelected","selectedItems","compare","retItems","selected","labelId","comp","selectItem","si","obItem","onSelect","flex","marginBottom","htmlFor","listenArraySplice","isObservableArray","observe","change","removedCount","added","_added","checkAll","anySelected","some","List","listBase","_$scroll","direct","buildBase","prevProps","prevState","isEqual","forceUpdate","selectAll","unselectAll","footer","waitingMore","tabIndex","isLoading","staticRow","listRes","timeRes","md","ymd","yesterday","today","tomorrow","$zh","$en","tt","renderDate","vDate","withTime","always","nDate","_date","nowYear","hour","getHours","minute","getMinutes","appendTime","dPart","hm","setRes","EasyTime","VDate","vTime","hideTime","hideSameYear","PropRow","PropBorder","borderTop","PropGap","valueAlignStart","valueAlignCenter","valueAlignEnd","LabeledPropRow","gridProps","_prop","col","labelFixLeft","bk","renderLabel","renderProp","align","vAlign","alignValue","renderPropBody","renderPropContent","StringPropRow","NumberPropRow","ListPropRow","borderBottom","ComponentPropRow","component","PropView","buildRows","isGap","setValues","PropGrid","propView","userCache","loader","UserView","noneImage","idProp","useUser","use","Ax","axProps","aClassName","naClassName","openSysPage","Input","requiredFlagElement","ruleMessage","defaultRequiredFlagElement","onValueChange","inp","containerClassName","ruleClassName","defaultRuleClassName","valueFromInput","Component","InputNumber","defaultClassName","parseFloat","parseValue","InputCheckBox","red","lastBuildTime","saveSrcTsFileIfNotExists","saveTsFileIfNotExists","uqTsSrcPath","saveTsFile","srcFile","tsFile","fs","existsSync","renameSync","writeFileSync","overrideTsFile","tsFilePath","buildTsHeader","getNameFromUq","devPart","uqPart","devName","View","controller","isMe","vm","vp","afterBack","open","go","vCall","returnCall","imageClassName","textClassName","renderUser","onClosePage","openPage","replacePage","backPage","closePage","ceasePage","popToTopPage","VPage","retOnClosePage","_onClosePage","openPageElement","renderPage","replacePageElement","onScroll","onPageScroll","onScrollTop","scroller","onPageScrollTop","onScrollBottom","onPageScrollBottom","headerClassName","tabsProps","webNav","Controller","Page","tabsView","TabsView","inWebNav","pageHeaderProps","center","rph","renderPageHeader","elFooter","errorInfo","renderHeader","renderFooter","zh","jwtDecode","$lang","$district","languages","toUpperCase","setResOptions","resGlobal","setGlobalRes","Scroller","scrollTo","scrollTop","offsetHeight","scrollTimeGap","ScrollViewBase","bottomTime","topTime","refDiv","onResize","sh","scrollHeight","Children","eachChild","ScrollView","WebNavScrollView","vHeader","vFooter","navHeader","navRawHeader","navFooter","navRawFooter","__ls","LocalCache","removeLocal","Local","caches","locals","keyForGet","keyForSet","sk","LocalArr","LocalMap","keyForRemove","ks","saveIndex","ls","internalT","isDev","receiveHandlerId","unregisterReceiveHandler","onDispose","onMessageReceive","onMessage","_resolve_$","topPageKey","beforeInit","getPageWebNav","afterInit","replaceOpen","onEvent","registerReceiveHandler","beforeStart","afterStart","yes","buttons","pl","decode","exec","sUnit","tc","from62","parseInt","getTimezoneOffset","initEnv","detectBrowser","ms","args","global","handle","documentMode","importCLogin","CLogin","importCRegister","CRegister","CForget","ALPHABET","rtn","charAt","random","digits","c0","c9","A","Z","z","NaN","onBack","vBack","debugLogout","rightView","Tab","contentBuilder","notify","onShown","_content","TabCaptionComponent","tabBg","selectedTab","tabArr","tabClick","tab","shown","tabs","bsCur","bsTab","tabPosition","borderColor","borderStyle","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius","notifyCircle","num","displayNone","pageHeader","pageFooter","tabBack","isSelected","buildFieldItem","isKey","$FieldItemType","fieldItemType","VLogout","onLogout","VLogin","onLogin","username","sender","getSender","tonvaTop","privacyEntry","VChangePassword","orgPassword","newPassword","newPassword1","waitingTime","VUserQuitBase","button1Caption","onClickButton1","button2Caption","onClickButton2","note","renderButton1","renderButton2","VUserQuit","openVPage","VQuitConfirm","userQuit","VQuitDone","userLogined","vPage","getVChangePassword","changePassword","logo","senders","regex","buildTsUqFolder","uqsFolder","uqFolder","mkdirSync","tsUq","buildUQ","saveTuidAndIDTsIndexAndRender","imports","sets","coll","cName","tsUI","toLocaleLowerCase","buildFields","tsFieldArr","buildFieldArr","replaceTsFileFields","tsImportFieldItemsBegin","tsImportFieldItemsEnd","replaceTsFileString","begin","tsIndex","readdirSync","fileEntityName","unFile","unlinkSync","buildIDFields","buildIDXFields","buildIXFields","ts","buildIDFieldArr","buildIDXFieldArr","buildIXFieldArr","readFileSync","startStr","lBrace","rBrace","fieldsText","buildFieldsFromOldText","fieldItemReplaceProps","oldText","setFieldOldProp","buildFieldText","fieldStart","fieldText","eval","sec","tsImport","appendArr","tsBuild","tsLen","uqEntityInterface","buildEnumInterface","buildTuidInterface","buildActionInterface","buildSheetInterface","buildQueryInterface","buildBookInterface","buildMapInterface","buildHistoryInterface","buildPendingInterface","buildIDInterface","buildIDXInterface","buildIDXActParamInterface","buildIXInterface","buildActsInterface","uqBlock","buildTuid","buildAction","buildBook","buildQuery","buildMap","buildHistory","buildPending","buildID","buildIDX","buildIX","buildInterface","entityCode","isInID","indent","buildField","fieldTypeMap","sysFields","q","repeat","buildArrs","af","buildReturns","retName","schemaKeys","others","exFields","hasTrack","hasMemo","exField","track","memo","VErrorsPage","VStartError","CAppBase","timezone","unitTimezone","uqsUser","WebReact","uqsLoader","afterBuiltUQs","onNavRoutes","initUQs","resolveRoute","userFromId","userRoles","getUqUserRoles","setUqRoles","isRole","CApp","html","cApp","CBase","getUqRoles","internalInit","wn","getWebNav","CSub","_owner","ownerWNs","own","CUqBase","CUqSub","CUqApp","VHome","cAccount","renderAccounts","renderVPortal","VAccount","VAccounts","accounts","onAccountClick","accountTitles","postTitles","objectAccount","balance","vice","fixed","postTitle","VObjectAccountHistory","renderHistory","accountTitle","itemTitles","dateString","accountHistory","CAccount","enumAccount","JkMe","GetObjectAccountHistory","renderView","object","GetUserObjectAccount","CHome","newC","cPortal","jk","noUnit","VAbout","VMe","renderAdmin","isAdmin","admins","adminSetting","renderUserText","meInfo","showEditMe","userSpan","about","aboutRows","VEditMe","userSetProp","onExit","gridRows","VAdminSetting","CMe","unitOwner","rootUnits","mapAdd","backend","testPointShop","testTimesChange","testItem1","testItem2","testItem3","testItem4","debugItems","VBug","renderItem","openDebugPage","VConsole","divBottom","autoScrollEnd","autoScroll","lastScrollTop","timeHandler","createRange","selectNode","objToHtml","createContextualFragment","appendChild","startAutoScrollToBottom","currentItem","pauseAutoScrollToBottom","arrToHtml","objToString","indentVal","objToLine","CBug","span","home","relation","discover","supervise","debug","aboutTheApp","pleaseLogin","Item","Post","OrderReady","EnumRole","EnumRoleOp","EnumObjectType","EnumAccount","EnumBizOpType","VMain","cHome","cMe","cSupervise","VTester","click","uiItems","CTester","$","hasEntity","bizOp","product","quantity","amount","price","webUser","customerAccount","seller","currency","sumAmount","stamp","staff","customer","distributor","agent","bizMain","orderDetail","contact","warehouse","cutOffMain","trayNumber","opi","itemHistory","booking","bizOpType","postItem","ratio","deliverDone","receiveDone","return","costPrice","orderReady","biz","done","xi","ixx","bound","description","descriptionC","imageUrl","EnumPointType","EnumPointChangingSource","EnumExchangeState","orderMainNo","orderDetailNo","endUser","createDate","point","subAmount","shippingContact","sheetId","totalPoint","deliver","deliverTime","receiveAmount","setUI","ItemHistory","OrderDetail","OrderMain","ItemTitle","PostTitle","ObjectUser","ObjectStaff","ObjectPost","ObjectCustomer","ObjectPostItem","Group","ObjectDistributor","ObjectAgent","QueueBizOp","QueueBizMain","DeliverDetail","DeliverMain","Role","OPIHistory","ObjectAccount","BizMainBound","OPIBooking","AccountTitle","DxOrderDetail","DxOrderMain","DxBizMain","DxBizOp","DxBiz","UserObject","GroupObject","UserSuperviseItem","MonthSumProduct","MonthSumCustomer","IxBizOpBound","UserRole","RoleOps","ObjectAccountHistory","DaySumItem","AccountBooking","Chemical","SalesRegion","Currency","PackType","Language","Brand","Stuff","ProductX","ProductCategory","Lot","PackSalesLevel","JkProduct","Customer","WebUser","Contact","BuyerAccount","Genre","PointProductLib","ExchangeDetail","ExchangeMain","ReceiveMain","ReceiveDetail","DxReOrderDetail","DxExchangeDetail","DxExchangeMainState","IxExchangeMainUsedPoint","ExchangeDetailDeliver","IxOrderDetailReceive","JkPointShop","Employee","Company","JkHr","VIndex","iconColor","fa","VSupervise","renderOpTest","queryList","orderAmount","showProductSumByMonth","orderProfit","showCustomerSumByMonth","superviseItems","renderVUnitSum","cObjectsArr","loadAndShowList","showAccounts","renderSuperviseItem","onClickSuperviseItem","opRenders","showItemSumHistory","ViewItemDayHistory","renderDayItem","toLocaleDateString","onClickDayItem","setDate","showItemHistory","itemSumDays","VItemDayHistory","VItemSumHistory","renderMonthItem","onClickMonthItem","setMonth","showItemDayHistory","itemSumMonths","VItemHistory","onClickItem","pageItemHistory","VSumByMonth","$serial","renderId","monthSum","vCaption","hasNext","next","VProductSumByMonth","VCustomerSumByMonth","CObjects","baseList","internalLoadList","loadList","showList","VObjects","renderRow","onClickRow","renderListHeader","renderListFooter","VAgents","CAgents","GetAgents","VDistributors","CDistributors","GetDistributors","VGroups","CGroups","GetGroups","cnAmount","VPosts","amountThisMonth","amountLastMonth","itemTitle","vAmount","CPosts","GetPosts","VStaffs","monthValuesArr","dThis","mThis","mLast","vValue","renderEmployee","pageTop","showObjectPortal","employee","CStaffs","GetStaffs","valueToday","valueThisMonth","valueLastMonth","staffRow","sumItem","newCObjectPortal","initCObjects","renderAccount","objectType","objectTo","renderObject","showAccountHistory","EnumPeriod","CSupervise","objects","groups","distributors","agents","staffs","posts","GetUserSuperviseItem","GetAccounts","GetItemSumDays","days","GetItemSumMonths","months","PageItemHistory","GetItemHistory","MonthSum","setHours","GetProductSumByMonth","GetCustomerSumByMonth","BizOpDetail","Period","newDate","initObservable","DayPeriod","day","dw","getDay","WeekPeriod","week","diff","yf","mf","df","mt","MonthPeriod","YearPeriod","setFullYear","VBizOpDetail","bizOpDetail","minuteId","itemPeriodSum","VPostItemHistory","showBizOpDetail","VPeriodPostItemHistory","clickItem","periodHistory","VDayPostItemHistory","showPostItemHistory","VMonthPostItemHistory","showDayPostItemHistory","VPeriodSum","postPeriodSum","itemList","renderItemPeriodSum","onClickItemPeriodSum","ips","period","showMonthPostItemHistory","periodList","ep","VRefreshTime","refreshTime","setPeriod","CPortal","objectPostItem","internalSetPeriod","periodType","createPeriod","GetUserObjectItemPeriodSum","GetPeriodSum","postPeriodSumColl","postPeriodSumList","itemColl","fromDate","toDate","GetObjectItemHistory","sumPeriod","GetObjectItemPeriodHistory","loadPostItemHistory","loadPeriodPostItemHistory","VObjectPortal","CObjectPortal","GetObjectItemPeriodSum","nf","Intl","NumberFormat","minimumFractionDigits","maximumFractionDigits","VUnitPortal","format","CUnitPortal","GetItemPeriodSum","abs","gaps","cBug","cUI","cUnitPortal","timer","gapIndex","callTick","$poked","poke","loadBaseData","appStart","onNotLogined","loginedOnly","renderNavView","GetItemTitles","GetPostTitles","GetAccountTitles","GetRoleOps","$getMyTimezone","retItemTitles","retPostTitles","retAccountTitles","roleOps","myTimezone","it","pt","tz","unitTimeZone","setSettings","ReactDOM","StrictMode","reportWebVitals","onPerfEntry","Function","getCLS","getFID","getFCP","getLCP","getTTFB","startApp"],"mappings":"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","file":"static/js/main.78e9af01.chunk.js","sourcesContent":["import { messageHub } from \"./messageHub\";\r\n\r\nlet subAppWindow:Window;\r\nfunction postWsToSubApp(msg:any) {\r\n    if (subAppWindow === undefined) return;\r\n    subAppWindow.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport function setSubAppWindow(win:Window) {\r\n    subAppWindow = win;\r\n}\r\n\r\nexport function postWsToTop(msg:any) {\r\n    window.top.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport abstract class WsBase {\r\n\tprivate messageHub = messageHub;\r\n\t/*\r\n    wsBaseId:string;\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n\tprivate msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\t*/\r\n\t/*\r\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.anyHandlers[seed] = handler;\r\n        return seed;\r\n    }\r\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.msgHandlers[seed] = {type:type, handler: handler};\r\n        return seed;\r\n    }\r\n    endWsReceive(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n\t}\r\n\t*/\r\n    async receive(msg:any) {\r\n\t\tthis.messageHub.dispatch(msg);\r\n\t\t/*\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n\t\t}\r\n\t\t*/\r\n    }\r\n}\r\n\r\nlet wsBaseSeed = 1;\r\nexport class WsBridge extends WsBase {\r\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\r\n}\r\n\r\nexport const wsBridge = new WsBridge();\r\n\r\nexport class WSChannel extends WsBase {\r\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\r\n    static centerToken:string;\r\n    private wsHost: string;\r\n    private token: string;\r\n    private ws: WebSocket;\r\n\r\n    constructor(wsHost: string, token: string) {\r\n        super();\r\n        this.wsHost = wsHost;\r\n        this.token = token;\r\n    }\r\n\r\n    static setCenterToken(token?: string) {\r\n        WSChannel.centerToken = token;\r\n    }\r\n    \r\n    connect():Promise<void> {\r\n        //this.wsHost = wsHost;\r\n        //this.token = token || WSChannel.centerToken;\r\n        if (this.ws !== undefined) return;\r\n        let that = this;\r\n        return new Promise((resolve, reject) => {\r\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\r\n            console.log('connect webSocket %s', this.wsHost);\r\n            ws.onopen = (ev) => {\r\n                console.log('webSocket connected %s', this.wsHost);\r\n                that.ws = ws;\r\n                resolve();\r\n            };\r\n            ws.onerror = (ev) => {\r\n                reject('webSocket can\\'t open!');\r\n            };\r\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\r\n            ws.onclose = (ev) => {\r\n                that.ws = undefined;\r\n                console.log('webSocket closed!');\r\n            }\r\n        });\r\n    }\r\n    close() {\r\n        if (this.ws !== undefined) {\r\n            this.ws.close();\r\n            this.ws = undefined;\r\n        }\r\n    }\r\n    private async wsMessage(event:any):Promise<void> {\r\n        try {\r\n            console.log('websocket message: %s', event.data);\r\n            let msg = JSON.parse(event.data);\r\n            postWsToSubApp(msg);\r\n            await this.receive(msg);\r\n        }\r\n        catch (err) {\r\n            console.log('ws msg error: ', err);\r\n        }\r\n    }\r\n    sendWs(msg:any) {\r\n        let netThis = this;\r\n        this.connect().then(() => {\r\n            netThis.ws.send(msg);\r\n        });\r\n    }\r\n}\r\n","class MessageHub {\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\tregisterReceiveHandler(handler:(msg:any)=>Promise<void>):number;\r\n\tregisterReceiveHandler(type:string, handler:(msg:any)=>Promise<void>):number;\t\r\n    registerReceiveHandler(...args:any[]):number {\r\n\t\tlet seed = this.handlerSeed++;\r\n\t\tlet args0 = args[0];\r\n\t\tlet handler:(msg:any)=>Promise<void>;\r\n\t\tswitch (typeof args0) {\r\n\t\t\tcase 'string':\r\n\t\t\t\thandler = args[1];\r\n\t\t\t\tthis.msgHandlers[seed] = {type:args0, handler};\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'function':\r\n\t\t\t\tthis.anyHandlers[seed] = args0;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn seed;\r\n    }\r\n    unregisterReceiveHandler(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n    }\r\n    async dispatch(msg:any) {\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n        }\r\n    }\r\n}\r\n\r\nexport const messageHub = new MessageHub();\r\n","import {HttpChannel} from './httpChannel';\r\nimport { Caller } from './caller';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \r\n    resolve:(values:any)=>any, reject:(reason:any)=>void)\r\n{\r\n    await channel.fetch(url, options, false, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(path: string, showWaiting: boolean) {\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    async xcall(caller:Caller<any>):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.xcall(this.path, caller);\r\n    }\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import { env } from '../tool';\r\n\r\nconst centerHost = process.env['REACT_APP_CENTER_HOST'];\r\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\r\nconst resHost = process.env['REACT_APP_RES_HOST'] || centerHost;\r\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugBuilderHost = 'localhost:3009';\r\ninterface HostValue {\r\n    value: string;\r\n\tlocal: boolean;\r\n}\r\nconst hosts:{[name:string]:HostValue} = {\r\n    centerhost: {\r\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    reshost: {\r\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\r\n\t\tlocal: false,\r\n    },\r\n    uqhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    unitxhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    \"uq-build\": {\r\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \r\n\t\tlocal: false,\r\n    }\r\n}\r\n\r\nconst httpArr = ['https://', 'http://'];\r\nfunction isAbsoluteUrl(url:string):boolean {\r\n    for (let str of httpArr) {\r\n        if (url.startsWith(str) === true) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction urlFromHost(host:string):string {\r\n    if (isAbsoluteUrl(host) === true) {\r\n        if (host.endsWith('/')) return host;\r\n        return host + '/';\r\n    }\r\n    return `http://${host}/`;\r\n}\r\n\r\nfunction centerUrlFromHost(host:string):string {\r\n    return urlFromHost(host);\r\n}\r\nfunction centerWsFromHost(host:string) {\r\n    let https = 'https://';\r\n    if (host.startsWith(https) === true) {\r\n        host = host.substr(https.length);\r\n        if (host.endsWith('/') === true) host = host.substr(0, host.length-1);\r\n        return 'wss://' + host + '/tv/';\r\n    }\r\n    return `ws://${host}/tv/`\r\n}\r\nexport function resUrlFromHost(host:string) {\r\n\tif (!host) return;\r\n    let url = urlFromHost(host);\r\n    return url + 'res/';\r\n}\r\n\r\nconst fetchOptions = {\r\n    method: \"GET\",\r\n    mode: \"no-cors\", // no-cors, cors, *same-origin\r\n    headers: {\r\n        \"Content-Type\": \"text/plain\"\r\n    },\r\n};\r\n\r\nclass Host {\r\n    testing: boolean;\r\n    url: string;\r\n    ws: string;\r\n    resHost: string;\r\n\r\n    async start(testing:boolean) {\r\n\t\tif (!centerHost) debugger;\r\n        this.testing = testing;\r\n        if (env.isDevelopment === true) {\r\n            await this.tryLocal();\r\n        }\r\n        let host = this.getCenterHost();\r\n        this.url = centerUrlFromHost(host);\r\n        this.ws = centerWsFromHost(host);\r\n\t\tthis.resHost = this.getResHost();\r\n    }\r\n\r\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\r\n    private async tryLocal() {\r\n        let promises:PromiseLike<any>[] = [];\r\n        let hostArr:string[] = [];\r\n        for (let i in hosts) {\r\n            let hostValue = hosts[i];\r\n            let {value} = hostValue;\r\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\r\n        }\r\n\r\n        for (let host of hostArr) {\r\n            let fetchUrl = this.debugHostUrl(host);\r\n            promises.push(localCheck(fetchUrl));\r\n        }\r\n        let results = await Promise.all(promises);\r\n        let len = hostArr.length;\r\n        for (let i=0; i<len; i++) {\r\n            let local = results[i];\r\n            let host = hostArr[i];\r\n            for (let j in hosts) {\r\n                let hostValue = hosts[j];\r\n                if (hostValue.value === host) {\r\n                    hostValue.local = local;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getCenterHost():string {\r\n        let {value, local} = hosts.centerhost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return centerHost;\r\n    }\r\n\r\n    private getResHost():string {\r\n        let {value, local} = hosts.reshost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return resHost;\r\n    }\r\n\r\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\r\n        if (env.isDevelopment === false) return url;\r\n        let host = hosts[debugHost];\r\n        if (host === undefined) return url;\r\n        let {value, local} = host;\r\n        if (local === false) return url;\r\n        return `http://${value}/`;\r\n    }\r\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\r\n\t\tif (!urlTest) {\r\n\t\t\turlTest = url;\r\n\t\t\tif (!urlTest) {\r\n\t\t\t\tconsole.error('no server set for ' + db);\r\n\t\t\t\tdebugger;\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!url) {\r\n\t\t\turl = urlTest;\r\n\t\t}\r\n\t\tlet testProd:string;\r\n        if (this.testing === true) {\r\n\t\t\tif (urlTest !== '-') url = urlTest;\r\n\t\t\ttestProd = 'test';\r\n        }\r\n        else {\r\n\t\t\ttestProd = 'prod';\r\n        }\r\n\t\turl = this.getUrlOrDebug(url);\r\n\t\tif (url.endsWith('/') === false) {\r\n\t\t\turl += '/';\r\n\t\t}\r\n        return `${url}uq/${testProd}/${db}/`;\r\n    }\r\n\r\n    async localCheck(urlDebug: string):Promise<boolean> {\r\n        return await localCheck(urlDebug);\r\n    }\r\n}\r\n\r\nexport const host:Host = new Host();\r\n\r\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\r\n// 网上找了上面的fetch timeout代码。\r\n// 尽管timeout了，fetch仍然继续，没有cancel\r\n\r\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\r\n//const timeout = 2000;\r\nconst timeout = 2000;\r\n\r\nfunction fetchLocalCheck(url:string):Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      fetch(url, fetchOptions as any)\r\n      .then(v => {\r\n          v.text().then(resolve).catch(reject);\r\n      })\r\n      .catch(reject);\r\n      const e = new Error(\"Connection timed out\");\r\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\r\n    });\r\n}\r\n\r\nasync function localCheck(url:string):Promise<boolean> {\r\n    try {\r\n\t\tawait fetchLocalCheck(url);\r\n        return true;\r\n    }\r\n    catch (err) {\r\n        return false;\r\n    }\r\n}\r\n\r\n/*\r\nexport interface IUqForChannel {\r\n    uq: string;\r\n    uqVersion: number;\r\n}\r\n*/","import _ from 'lodash';\r\n//import {nav} from '../components';\r\nimport {uid} from '../tool/uid';\r\nimport {uqTokenApi, callCenterapi, centerToken, setCenterToken, UqTokenApi} from './uqApi';\r\nimport {setSubAppWindow} from './wsChannel';\r\nimport { host } from './host';\r\nimport { env } from '../tool';\r\nimport { Web } from 'tonva-core';\r\n\r\nexport interface UqToken {\r\n    name: string;\r\n    db: string;\r\n    url: string;\r\n    token: string;\r\n}\r\nconst uqTokens:{[uqName:string]: UqToken}  = {};\r\nexport function logoutUqTokens() {\r\n    for (let i in uqTokens) {\r\n        uqTokens[i] = undefined;\r\n    }\r\n\tUqTokenApi.clearLocal();\r\n}\r\n\r\nexport function isBridged():boolean {\r\n    return window.self !== window.parent;\r\n}\r\n\r\nclass Nav {\r\n    async showAppView() {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    user: any;\r\n    navBack() {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    onReceive(msg: any) {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n\r\n}\r\n\r\nconst nav = new Nav();\r\n\r\nwindow.addEventListener('message', async function(evt) {\r\n    var message = evt.data;\r\n\tif (!message) return;\r\n    switch (message.type) {\r\n        case 'sub-frame-started':\r\n            subFrameStarted(evt);\r\n            break;\r\n        case 'ws':\r\n            //wsBridge.receive(message.msg);\r\n            await nav.onReceive(message.msg);\r\n            break;\r\n        case 'init-sub-win':\r\n            await initSubWin(message);\r\n            break;\r\n        case 'pop-app':\r\n            window.console.log('///\\\\\\\\\\\\ pop-app');\r\n            nav.navBack();\r\n            break;\r\n        case 'center-api':\r\n            await callCenterApiFromMessage(evt.source as Window, message);\r\n            break;\r\n        case 'center-api-return':\r\n            bridgeCenterApiReturn(message);\r\n            break;\r\n        case 'app-api':\r\n            let ret = await onReceiveAppApiMessage(message.hash, message.apiName);\r\n            (evt.source as Window).postMessage({\r\n                type: 'app-api-return', \r\n                apiName: message.apiName,\r\n                db: ret.db,\r\n                url: ret.url,\r\n                token: ret.token} as any, \"*\");\r\n            break;\r\n        case 'app-api-return':\r\n            console.log(\"app-api-return: %s\", JSON.stringify(message));\r\n            console.log('await onAppApiReturn(message);');\r\n            await onAppApiReturn(message);\r\n            break;\r\n        default:\r\n\t\t\tif ((message.source as string)?.startsWith('react-devtools') === true) break;\r\n            window.console.log('message: %s', JSON.stringify(message));\r\n            break;\r\n    }\r\n});\r\n\r\nfunction subFrameStarted(evt:any) {\r\n    var message = evt.data;\r\n    let subWin = evt.source as Window;\r\n    setSubAppWindow(subWin);\r\n    hideFrameBack(message.hash);\r\n    let msg:any = _.clone(nav.user);\r\n    msg.type = 'init-sub-win';\r\n    subWin.postMessage(msg, '*');\r\n}\r\nfunction hideFrameBack(hash:string) {\r\n    let el = document.getElementById(hash);\r\n    if (el !== undefined) el.hidden = true;\r\n}\r\nasync function initSubWin(message:any) {\r\n    console.log('initSubWin: set nav.user', message);\r\n    let user = nav.user = message; // message.user;\r\n    setCenterToken(user.id, user.token);\r\n    await nav.showAppView();\r\n}\r\nasync function onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\r\n\tlet {unit} = env;\r\n    if (!unit) {\r\n        console.error('no unit defined in unit.json or in index.html, or not logined in', unit);\r\n    }\r\n    let parts = apiName.split('/');\r\n    let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\r\n    console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\r\n    let ret = await uqTokenApi.uq(param);\r\n    let {db, url, token} = ret;\r\n    return {name: apiName, db:db, url: url, token: token};\r\n}\r\n\r\nasync function onAppApiReturn(message:any) {\r\n    let {apiName, db, url, urlTest, token} = message;\r\n    let action = uqTokenActions[apiName];\r\n    if (action === undefined) {\r\n        throw new Error('error app api return');\r\n        //return;\r\n    }\r\n    let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n    console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\r\n    //action.url = realUrl;\r\n    //action.token = token;\r\n    action.resolve({\r\n        name: apiName,\r\n        db: db,\r\n        url: realUrl,\r\n        token: token,\r\n    } as UqToken);\r\n}\r\n\r\ninterface UqTokenAction {\r\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\r\n    reject: (reason?: any) => void;\r\n}\r\nconst uqTokenActions:{[uq:string]: UqTokenAction} = {};\r\nexport async function buildAppUq(uq:string, uqOwner:string, uqName:string):Promise<void> {\r\n    if (!isBridged()) {\r\n\t\t//let unit = getUnit();\r\n\t\tlet {unit} = env;\r\n        let uqToken = await uqTokenApi.uq({unit,  uqOwner, uqName});\r\n        if (uqToken.token === undefined) uqToken.token = centerToken;\r\n        let {db, url, urlTest} = uqToken;\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        console.log('realUrl: %s', realUrl);\r\n        uqToken.url = realUrl;\r\n        uqTokens[uq] = uqToken;\r\n        return uqToken;\r\n    }\r\n    //console.log(\"**** before buildAppUq ****\", appInFrame);\r\n    let bp = uqTokenActions[uq];\r\n    if (bp !== undefined) return;\r\n    return new Promise<void>((resolve, reject) => {\r\n        uqTokenActions[uq] = {\r\n            resolve: async (at:any) => {\r\n                let {db, url, token} = await at;\r\n                uqTokens[uq] = {\r\n                    name: uq,\r\n                    db: db,\r\n                    url: url,\r\n                    token: token,\r\n                };\r\n                uqTokenActions[uq] = undefined;\r\n                //console.log(\"**** after buildAppUq ****\", appInFrame);\r\n                resolve();\r\n            },\r\n            reject: reject,\r\n        };\r\n        (window.opener || window.parent).postMessage({\r\n            type: 'app-api',\r\n            apiName: uq,\r\n            //hash: appInFrame.hash,\r\n        }, \"*\");\r\n    });\r\n}\r\n\r\nexport function getUqToken(uq:string):UqToken {\r\n    let uts = uqTokens;\r\n    return uts[uq];\r\n}\r\n\r\ninterface BridgeCenterApi {\r\n    id: string;\r\n    resolve: (value?:any)=>any;\r\n    reject: (reason?:any)=>void;\r\n}\r\nconst brideCenterApis:{[id:string]: BridgeCenterApi} = {};\r\nexport async function bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\r\n    console.log('bridgeCenterApi: url=%s, method=%s', url, method);\r\n    return new Promise<any>(async (resolve, reject) => {\r\n        let callId:string;\r\n        for (;;) {\r\n            callId = uid();\r\n            let bca = brideCenterApis[callId];\r\n            if (bca === undefined) {\r\n                brideCenterApis[callId] = {\r\n                    id: callId,\r\n                    resolve: resolve,\r\n                    reject: reject,\r\n                }\r\n                break;\r\n            }\r\n        }\r\n        (window.opener || window.parent).postMessage({\r\n            type: 'center-api',\r\n            callId: callId,\r\n            url: url,\r\n            method: method,\r\n            body: body\r\n        }, '*');\r\n    });\r\n}\r\n\r\nasync function callCenterApiFromMessage(from:Window, message:any):Promise<void> {\r\n    let {callId, url, method, body} = message;\r\n    let result = await callCenterapi.directCall(url, method, body);\r\n    from.postMessage({\r\n        type: 'center-api-return',\r\n        callId: callId,\r\n        result: result,\r\n    }, '*');\r\n}\r\n\r\nfunction bridgeCenterApiReturn(message:any) {\r\n    let {callId, result} = message;\r\n    let bca = brideCenterApis[callId];\r\n    if (bca === undefined) return;\r\n    brideCenterApis[callId] = undefined;\r\n    bca.resolve(result);\r\n}\r\n","import {bridgeCenterApi, isBridged} from './appBridge';\r\nimport {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\n//import {nav} from '../components/nav';\r\nimport { Caller } from './caller';\r\nimport { env } from '../tool';\r\n\r\n/*\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n*/\r\n\r\nconst methodsWithBody = ['POST', 'PUT'];\r\n\r\nexport abstract class HttpChannel {\r\n    private timeout: number;\r\n    protected ui?: HttpChannelUI;\r\n    protected hostUrl: string;\r\n    protected apiToken: string;\r\n\r\n    constructor(hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = env.isDevelopment === true? 500000:50000;\r\n    }\r\n\r\n    private startWait = (waiting: boolean) => {\r\n        if (waiting === true) {\r\n            if (this.ui !== undefined) this.ui.startWait();\r\n        }\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async xcall(urlPrefix:string, caller:Caller<any>): Promise<void> {\r\n        let options = this.buildOptions();\r\n        let {headers, path, method} = caller;\r\n        if (headers !== undefined) {\r\n            let h = options.headers;\r\n            for (let i in headers) {\r\n\t\t\t\t//h.append(i, encodeURI(headers[i]));\r\n\t\t\t\th[i] = encodeURI(headers[i]);\r\n            }\r\n        }\r\n        options.method = method;\r\n        let p = caller.buildParams();\r\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\r\n            options.body = JSON.stringify(p)\r\n        }\r\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\r\n    }\r\n\r\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let ret = await this.innerFetch(url, options, waiting);\r\n        return ret.res;\r\n    }\r\n\r\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n    async fetch(url: string, options: any, waiting: boolean, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait(waiting);\r\n        let path = url;\r\n        function buildError(err: any, ex?: string) {\r\n            switch (typeof err) {\r\n                case 'string':\r\n                    if (ex !== undefined) err += ' ' + ex;\r\n                    break;\r\n                case 'object':\r\n                    let keys = Object.keys(err);\r\n                    let retErr:any = {\r\n                        ex: ex,\r\n                    };\r\n                    for (let key of keys) {\r\n                        retErr[key] = err[key];\r\n                    }\r\n                    err = retErr;\r\n                    break;\r\n            }\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s-%s %s', options.method, path, options.body || '');\r\n            let now = Date.now();\r\n            let timeOutHandler = env.setTimeout(\r\n                undefined, //'httpChannel.fetch',\r\n                () => {\r\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\r\n                },\r\n                this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('ok false endWait');       \r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    env.clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        if (typeof retJson !== 'object') {\r\n                            debugger;\r\n                        }\r\n                        else if (Array.isArray(retJson) === true) {\r\n                            debugger;\r\n                        }\r\n                        return resolve(retJson);\r\n                    }\r\n                    let retError = retJson.error;\r\n                    if (retError === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retError, 'retJson.error'));\r\n                        reject(retError);\r\n                    }\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error, 'catch res.json()'));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('text endWait');\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            this.endWait(url, reject);\r\n            if (typeof error === 'string') {\r\n                let err = error.toLowerCase();\r\n                if (err.startsWith('unauthorized') === true || err.startsWith('$roles') === true) {\r\n                    //nav.logout();\r\n                    return;\r\n                }\r\n            }\r\n            console.error('fecth error (no nav.showError): ' + url);\r\n        };\r\n    }\r\n\r\n    protected abstract innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, true, resolve, reject);\r\n        });\r\n    }\r\n\r\n    //private buildOptions(): {method:string; headers:Headers; body:any} {\r\n\t\tprivate buildOptions(): {method:string; headers:{[name:string]: string}; body:any} {\r\n        let headers = this.buildHeaders();\r\n        let options = {\r\n            headers: headers,\r\n            method: undefined as any,\r\n            body: undefined as any,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n\r\n\t/*\r\n    protected buildHeaders():Headers {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        return headers;\r\n\t}\r\n\t*/\r\n\tprotected buildHeaders():{[name:string]: string} { \r\n        //let {language, culture} = nav;\r\n        let language:string, culture:string;\r\n        let headers:{[name:string]: string} = {}; //new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n\t\t//headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n\t\theaders['Content-Type'] = 'application/json;charset=UTF-8';\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n\t\t//headers.append('Accept-Language', lang);\r\n\t\theaders['Accept-Language'] = lang;\r\n        if (this.apiToken) { \r\n\t\t\t//headers.append('Authorization', this.apiToken); \r\n\t\t\theaders['Authorization'] = this.apiToken;\r\n        }\r\n        return headers;\r\n\t}\r\n}\r\n\r\nexport class CenterHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        if (this.apiToken === undefined && isBridged())\r\n            return await bridgeCenterApi(u, options.method, options.body);\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n\r\nexport class UqHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n","//import {nav} from '../components/nav';\r\nimport {FetchError} from './fetchError';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:FetchError):Promise<void>;\r\n    showUpgradeUq(uq:string, version:number):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    startWait() {\r\n        //nav.startWait();\r\n    }\r\n    endWait() {\r\n        //nav.endWait();\r\n    }\r\n    async showError(error:FetchError):Promise<void> {\r\n        //nav.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        //await nav.onError(error);\r\n    }\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        //await nav.showUpgradeUq(uq, version);\r\n    }\r\n}\r\n\r\n","import _ from 'lodash';\r\nimport {HttpChannel, CenterHttpChannel, UqHttpChannel} from './httpChannel';\r\nimport {HttpChannelNavUI} from './httpChannelUI';\r\nimport {getUqToken, logoutUqTokens, buildAppUq} from './appBridge';\r\nimport {ApiBase} from './apiBase';\r\nimport { host } from './host';\r\nimport { LocalMap, env } from '../tool';\r\nimport {decodeUserToken} from '../tool/user';\r\n\r\ninterface PromiseValue<T> {\r\n\tresolve: (value?: T | PromiseLike<T>) => void;\r\n\treject: (reason?: any) => void;\r\n}\r\nlet channelUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\nlet channelNoUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\n\r\nexport function logoutApis() {\r\n    channelUIs = {};\r\n    channelNoUIs = {};\r\n    logoutUnitxApis();\r\n    logoutUqTokens();\r\n}\r\n\r\ninterface UqLocal {\r\n    user: number;\r\n    unit: number;\r\n    value: any;\r\n    tick?: number;\r\n    isNet?: boolean;\r\n}\r\n\r\nexport class UqApi extends ApiBase {\r\n    uqOwner: string;\r\n    uqName: string;\r\n    uq: string;\r\n\r\n    constructor(basePath:string, uqOwner:string, uqName:string, showWaiting?: boolean) {\r\n        super(basePath, showWaiting);\r\n        if (uqName) {\r\n            this.uqOwner = uqOwner;\r\n            this.uqName = uqName;\r\n            this.uq = uqOwner + '/' + uqName;\r\n        }\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    async init() {\r\n        await buildAppUq(this.uq, this.uqOwner, this.uqName);\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channels: {[name:string]: HttpChannel|(PromiseValue<any>[])};\r\n        let channelUI: HttpChannelNavUI;\r\n        if (this.showWaiting === true || this.showWaiting === undefined) {\r\n            channels = channelUIs;\r\n            channelUI = new HttpChannelNavUI();\r\n        }\r\n        else {\r\n            channels = channelNoUIs;\r\n        }\r\n        let channel = channels[this.uq];\r\n\t\tif (channel !== undefined) {\r\n\t\t\tif (Array.isArray(channel) === false) return channel as HttpChannel;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tchannel = channels[this.uq] = [];\r\n\t\t}\r\n\t\tlet arr = channel as PromiseValue<any>[];\r\n\t\treturn new Promise(async (resolve, reject) => {\r\n\t\t\tarr.push({resolve, reject});\r\n\t\t\tif (arr.length !== 1) return;\r\n\t\t\tlet uqToken = getUqToken(this.uq); //, this.uqOwner, this.uqName);\r\n\t\t\tif (!uqToken) {\r\n\t\t\t\t//debugger;\r\n\t\t\t\tawait this.init();\r\n\t\t\t\tuqToken = getUqToken(this.uq);\r\n\t\t\t}\r\n\t\t\tlet {url, token} = uqToken;\r\n\t\t\tthis.token = token;\r\n\t\t\tchannel = new UqHttpChannel(url, token, channelUI);\r\n\t\t\tchannels[this.uq] = channel;\r\n\t\t\tfor (let pv of arr) {\r\n\t\t\t\tpv.resolve(channel);\r\n\t\t\t}\r\n\r\n\t\t});\r\n    }\r\n\r\n    /*async update():Promise<string> {\r\n        return await this.get('update');\r\n    }*/\r\n\r\n    /*\r\n    async __loadAccess():Promise<any> {\r\n        let acc = this.access === undefined?\r\n            '' :\r\n            this.access.join('|');\r\n        let ret = await this.get('access', {acc:acc});\r\n        return ret;\r\n    }\r\n    */\r\n    async loadEntities():Promise<any> {\r\n        //return await localUqs.loadAccess(this);\r\n        //let acc = this.access === undefined?\r\n        //    '' :\r\n        //    this.access.join('|');\r\n\t\t//let ret = await this.get('access', {acc:acc});\r\n\t\tlet ret = await this.get('entities');\r\n        return ret;\r\n\t}\r\n    async getAdmins():Promise<{id:number;role:number}[]> {\r\n\t\tlet ret = await this.get('get-admins',);\r\n\t\treturn ret;\r\n    }\r\n \tasync getRoles():Promise<string[]> {\r\n\t\tlet ret = await this.get('get-roles',);\r\n\t\tif (!ret) return null;\r\n\t\tlet parts:string[] = (ret as string).split('|');\r\n\t\tlet s:string[] = [];\r\n\t\tfor (let p of parts) {\r\n\t\t\tp = p.trim();\r\n\t\t\tif (!p) continue;\r\n\t\t\ts.push(p);\r\n\t\t}\r\n\t\tif (s.length === 0) return null;\r\n\t\treturn s;\r\n\t}\r\n\tasync getAllRoleUsers():Promise<{user:number, admin:number, roles:string}[]> {\r\n\t\tlet ret = await this.get('get-all-role-users');\r\n\t\treturn ret;\r\n\t}\r\n\tasync setUserRoles(theUser:number, roles:string):Promise<void> {\r\n\t\tawait this.post('set-user-roles', {theUser, roles});\r\n\t}\r\n\tasync deleteUserRoles(theUser:number):Promise<void> {\r\n\t\tawait this.get('delete-user-roles', {theUser});\r\n\t}\r\n\r\n\tasync allSchemas(): Promise<any> {\r\n\t\treturn await this.get('all-schemas');\r\n\t}\r\n\r\n    async schema(name:string):Promise<any> {\r\n        return await this.get('schema/' + name);\r\n    }\r\n\r\n    async queueModify(start:number, page:number, entities:string) {\r\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\r\n    }\r\n}\r\n\r\nlet channels:{[unitId:number]: HttpChannel} = {};\r\n\r\nexport function logoutUnitxApis() {\r\n    channels = {};\r\n}\r\n\r\nexport class UnitxApi extends UqApi {\r\n    private unitId:number;\r\n    constructor(unitId:number) {\r\n        super('tv/', undefined, undefined, true);\r\n        this.unitId = unitId;\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channel = channels[this.unitId];\r\n        if (channel !== undefined) return channel;\r\n        return channels[this.unitId] = await this.buildChannel();\r\n    }\r\n\r\n    private async buildChannel():Promise<HttpChannel> {\r\n        let channelUI = new HttpChannelNavUI();\r\n        let centerAppApi = new CenterAppApi('tv/', undefined);\r\n        let ret = await centerAppApi.unitxUq(this.unitId);\r\n        let {token, db, url, urlTest} = ret;\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        this.token = token;\r\n        return new UqHttpChannel(realUrl, token, channelUI);\r\n    }\r\n}\r\n\r\nlet centerHost:string;\r\n\r\nexport function setCenterUrl(url:string) {\r\n    console.log('setCenterUrl %s', url);\r\n    centerHost = url;\r\n    centerChannel = undefined;\r\n    centerChannelUI = undefined;\r\n}\r\n\r\nexport let centerToken:string|undefined = undefined;\r\n\r\nlet loginedUserId:number = 0;\r\nexport function setCenterToken(userId:number, t?:string) {\r\n    loginedUserId = userId;\r\n    centerToken = t;\r\n    centerChannel = undefined;\r\n    centerChannelUI = undefined;\r\n}\r\n\r\nlet centerChannelUI:HttpChannel;\r\nlet centerChannel:HttpChannel;\r\nfunction getCenterChannelUI():HttpChannel {\r\n    if (centerChannelUI !== undefined) return centerChannelUI;\r\n    return centerChannelUI = new CenterHttpChannel(centerHost, centerToken, new HttpChannelNavUI());\r\n}\r\nfunction getCenterChannel():HttpChannel {\r\n    if (centerChannel !== undefined) return centerChannel;\r\n    return centerChannel = new CenterHttpChannel(centerHost, centerToken);\r\n}\r\n\r\nexport abstract class CenterApiBase extends ApiBase {\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        return (this.showWaiting === true || this.showWaiting === undefined)?\r\n            getCenterChannelUI():\r\n            getCenterChannel();\r\n    }\r\n}\r\n\r\nconst uqTokensName = 'uqTokens';\r\nexport class UqTokenApi extends CenterApiBase {\r\n\tstatic clearLocal() {\r\n\t\tenv.localDb.removeItem(uqTokensName);\r\n\t}\r\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\r\n\r\n    async uq(params: {unit:number, uqOwner:string, uqName:string}):Promise<any> {\r\n        let {uqOwner, uqName} = params;\r\n        let un = uqOwner+'/'+uqName;\r\n        let localCache = this.localMap.child(un);\r\n        try {\r\n            let uqToken:UqLocal = localCache.get();\r\n            if (uqToken !== undefined) {\r\n                let {unit, user} = uqToken;\r\n                if (unit !== params.unit || user !== loginedUserId) {\r\n                    localCache.remove();\r\n                    uqToken = undefined;\r\n                }\r\n            }\r\n            let nowTick = Math.floor(Date.now() / 1000);\r\n            if (uqToken !== undefined) {\r\n                let {tick, value} = uqToken;\r\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\r\n                    return _.clone(value);\r\n                }\r\n            }\r\n            let uqParams:any = _.clone(params);\r\n            uqParams.testing = host.testing;\r\n            let ret = await this.get('uq-token', uqParams);\r\n            if (ret === undefined) {\r\n                let {unit, uqOwner, uqName} = params;\r\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\r\n                throw err;\r\n            }\r\n\r\n            uqToken = {\r\n                unit: params.unit,\r\n                user: loginedUserId,\r\n                tick: nowTick,\r\n                value: ret,\r\n            }\r\n            localCache.set(uqToken);\r\n            return _.clone(ret);\r\n        }\r\n        catch (err) {\r\n            localCache.remove();\r\n            throw err;\r\n        }\r\n    }\r\n}\r\n\r\nexport const uqTokenApi = new UqTokenApi('tv/tie/', undefined);\r\n\r\nexport class CallCenterApi extends CenterApiBase {\r\n    directCall(url:string, method:string, body:any):Promise<any> {\r\n        return this.call(url, method, body);\r\n    }\r\n}\r\nexport const callCenterapi = new CallCenterApi('', undefined);\r\n\r\nexport interface UqAppData {\r\n    appName: string;\r\n    appOwner: string;\r\n    id: number;\r\n    version: string;        // AppUI version\r\n    uqs: UqData[];\r\n}\r\n\r\nexport interface UqData {\r\n    id: number;\r\n    uqOwner: string;\r\n\townerAlias: string;\r\n    uqName: string;\r\n\tuqAlias: string;\r\n    access: string;\r\n    newVersion: boolean;\r\n}\r\n\r\nexport interface UqServiceData {\r\n    id: number;\r\n    db: string;\r\n    url: string;\r\n    urlTest: string;\r\n    token: string;\r\n}\r\n\r\n//const appUqsName = 'appUqs';\r\n\r\nexport class CenterAppApi extends CenterApiBase {\r\n    async appUqs(appOwner:string, appName:string):Promise<UqAppData> {\r\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner, appName});\r\n        return ret;\r\n    }\r\n    async uqs(uqs: {owner:string; name:string; version:string}[]):Promise<UqData[]> {\r\n        return await this.post('tie/pure-uqs', uqs);\r\n    }\r\n    async unitxUq(unit:number):Promise<UqServiceData> {\r\n        return await this.get('tie/unitx-uq', {unit:unit});\r\n    }\r\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\r\n        return await this.post('tie/change-password', param);\r\n    }\r\n\r\n    async userQuit(): Promise<void> {\r\n        await this.get('tie/user-ask-quit', {});\r\n    }\r\n}\r\n\r\nexport interface RegisterParameter {\r\n    nick:string, \r\n    user:string, \r\n    pwd:string,\r\n    country:number, \r\n    mobile:number, \r\n    mobileCountry:number,\r\n    email:string,\r\n    verify:string,\r\n};\r\n\r\nexport class UserApi extends CenterApiBase {\r\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\r\n        //(params as any).device = nav.local.device.get();\r\n        let ret = await this.post('user/login', params);\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeUserToken(ret);\r\n            case 'object':\r\n                let token = ret.token;\r\n                let user = decodeUserToken(token);\r\n                let {nick, icon} = ret;\r\n                if (nick) user.nick = nick;\r\n                if (icon) user.icon = icon;\r\n                return user;\r\n        }\r\n        // !== undefined) return decodeToken(token);\r\n    }\r\n    async register(params: RegisterParameter): Promise<any>\r\n    {\r\n        return await this.post('user/register', params);\r\n    }\r\n\r\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\r\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\r\n    }\r\n\r\n    async checkVerify(account:string, verify:string) {\r\n        return await this.post('user/check-verify', {account:account, verify:verify});\r\n    }\r\n\r\n    async isExists(account:string) {\r\n        return await this.get('user/is-exists', {account:account});\r\n    }\r\n\r\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\r\n        return await this.post('user/reset-password', {account:account, password, verify, type});\r\n    }\r\n    \r\n    async userSetProp(prop:string, value:any) {\r\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\r\n    }\r\n\r\n    async me():Promise<any> {\r\n        return await this.get('tie/me');\r\n    }\r\n\r\n    async user(id:number): Promise<any> {\r\n        return await this.get('tie/user', {id:id});\r\n\t}\r\n\t\r\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\r\n\t\treturn await this.get('tie/user-from-key', {key});\r\n\t}\r\n}\r\n\r\nexport const userApi = new UserApi('tv/', undefined);\r\n","import { decodeGuestToken } from '../tool/user';\r\nimport { CenterApiBase } from './uqApi';\r\n\r\nexport class GuestApi extends CenterApiBase {\r\n    async guest(): Promise<any> {\r\n        //let guest = nav.local.guest.get();\r\n        let ret = await this.get('', {});\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeGuestToken(ret);\r\n            case 'object':\r\n                let guest = decodeGuestToken(ret.token);\r\n                return guest;\r\n        }\r\n    }\r\n\r\n    async unitFromName(unitName:string): Promise<number> {\r\n        let ret = await this.get(unitName);\r\n        return ret && ret.unit;\r\n    }\r\n}\r\n\r\nexport const guestApi = new GuestApi('tv/guest/', undefined);\r\n","export abstract class Caller<T> {\r\n    protected readonly _params: T;\r\n    constructor(params: T, $$user:number = undefined, waiting: boolean) {\r\n        this._params = params;\r\n        this.$$user = $$user;\r\n        this.waiting = waiting;\r\n    }\r\n    readonly $$user: number;\r\n    protected get params():any {return this._params;}\r\n    buildParams():any {return this.params;}\r\n    method: string  = 'POST';\r\n    abstract get path(): string;\r\n    get headers(): {[header:string]: string} {return undefined}\r\n    waiting: boolean;\r\n}\r\n","import {CenterApiBase} from './uqApi';\r\n\r\nclass CenterApi extends CenterApiBase {\r\n    async userAppUnits(app:number):Promise<any[]> {\r\n        return await this.get('tie/user-app-units', {app:app});\r\n    }\r\n    async userFromId(userId:number):Promise<any> {\r\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\r\n\t}\r\n\tasync userFromKey(userName:string):Promise<any> {\r\n\t\treturn await this.get('tie/user-from-key', {key:userName});\r\n\t}\r\n}\r\n\r\nexport const centerApi = new CenterApi('tv/', undefined);\r\n","\r\nimport {setCenterToken} from './uqApi';\r\nimport {WSChannel} from './wsChannel';\r\n\r\nexport const netToken = {\r\n    set(userId:number, token:string) {\r\n        setCenterToken(userId, token);\r\n        WSChannel.setCenterToken(token);\r\n    },\r\n    clear() {\r\n        setCenterToken(0, undefined);\r\n        WSChannel.setCenterToken(undefined);\r\n    }\r\n};\r\n","//import {bridgeCenterApi, isBridged} from './appBridge';\r\nimport {FetchError} from './fetchError';\r\nimport {HttpChannelUI} from './httpChannelUI';\r\n// import {nav} from '../../tonva-react/components/nav';\r\nimport { Caller } from './caller';\r\nimport { env } from '../tool';\r\nimport { Web } from './Web';\r\n\r\n/*\r\nexport async function httpGet(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.get('', params);\r\n    return ret;\r\n}\r\n\r\nexport async function httpPost(url:string, params?:any):Promise<any> {\r\n    let channel = new HttpChannel(false, url, undefined, undefined);\r\n    let ret = await channel.post('', params);\r\n    return ret;\r\n}\r\n*/\r\n\r\nconst methodsWithBody = ['POST', 'PUT'];\r\n\r\nexport abstract class HttpChannel {\r\n    private timeout: number;\r\n    protected web: Web;\r\n    protected ui?: HttpChannelUI;\r\n    protected hostUrl: string;\r\n    protected apiToken: string;\r\n\r\n    constructor(web:Web, hostUrl: string, apiToken:string, ui?: HttpChannelUI) {\r\n        this.web = web;\r\n        this.hostUrl = hostUrl;\r\n        this.apiToken = apiToken;\r\n        this.ui = ui;\r\n        this.timeout = env.isDevelopment === true? 500000:50000;\r\n    }\r\n\r\n    private startWait = (waiting: boolean) => {\r\n        if (waiting === true) {\r\n            if (this.ui !== undefined) this.ui.startWait();\r\n        }\r\n    }\r\n\r\n    private endWait = (url?:string, reject?:(reason?:any)=>void) => {\r\n        if (this.ui !== undefined) this.ui.endWait();\r\n        if (reject !== undefined) reject('访问webapi超时 ' + url);\r\n    }\r\n\r\n    private showError = async (error:FetchError) => {\r\n        if (this.ui !== undefined) await this.ui.showError(error);\r\n    }\r\n\r\n    used() {\r\n        this.post('', {});\r\n    }\r\n\r\n    async xcall(urlPrefix:string, caller:Caller<any>): Promise<void> {\r\n        let options = this.buildOptions();\r\n        let {headers, path, method} = caller;\r\n        if (headers !== undefined) {\r\n            let h = options.headers;\r\n            for (let i in headers) {\r\n\t\t\t\t//h.append(i, encodeURI(headers[i]));\r\n\t\t\t\th[i] = encodeURI(headers[i]);\r\n            }\r\n        }\r\n        options.method = method;\r\n        let p = caller.buildParams();\r\n        if (methodsWithBody.indexOf(method) >= 0 && p !== undefined) {\r\n            options.body = JSON.stringify(p)\r\n        }\r\n        return await this.innerFetch(urlPrefix + path, options, caller.waiting);\r\n    }\r\n\r\n    private async innerFetchResult(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let ret = await this.innerFetch(url, options, waiting);\r\n        return ret.res;\r\n    }\r\n\r\n    async get(url: string, params: any = undefined, waiting?: boolean): Promise<any> {\r\n        if (params) {\r\n            let keys = Object.keys(params);\r\n            if (keys.length > 0) {\r\n                let c = '?';\r\n                for (let k of keys) {\r\n                    let v = params[k];\r\n                    if (v === undefined) continue;\r\n                    url += c + k + '=' + params[k];\r\n                    c = '&';\r\n                }\r\n            }\r\n        }\r\n        let options = this.buildOptions();\r\n        options.method = 'GET';\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async post(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'POST';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async put(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'PUT';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n\r\n    async delete(url: string, params: any, waiting?: boolean): Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = 'DELETE';\r\n        options.body = JSON.stringify(params);\r\n        return await this.innerFetchResult(url, options, waiting);\r\n    }\r\n    async fetch(url: string, options: any, waiting: boolean, resolve:(value?:any)=>any, reject:(reason?:any)=>void):Promise<void> {\r\n        let that = this;\r\n        this.startWait(waiting);\r\n        let path = url;\r\n        function buildError(err: any, ex?: string) {\r\n            switch (typeof err) {\r\n                case 'string':\r\n                    if (ex !== undefined) err += ' ' + ex;\r\n                    break;\r\n                case 'object':\r\n                    let keys = Object.keys(err);\r\n                    let retErr:any = {\r\n                        ex: ex,\r\n                    };\r\n                    for (let key of keys) {\r\n                        retErr[key] = err[key];\r\n                    }\r\n                    err = retErr;\r\n                    break;\r\n            }\r\n            return {\r\n                channel: that,\r\n                url: path,\r\n                options: options,\r\n                resolve: resolve,\r\n                reject: reject,\r\n                error: err,\r\n            }\r\n        }\r\n        try {\r\n            console.log('%s-%s %s', options.method, path, options.body || '');\r\n            let now = Date.now();\r\n            let timeOutHandler = env.setTimeout(\r\n                undefined, //'httpChannel.fetch',\r\n                () => {\r\n                    that.endWait(url + ' timeout endWait: ' + (Date.now() - now) + 'ms', reject);\r\n                },\r\n                this.timeout);\r\n            let res = await fetch(encodeURI(path), options);\r\n            if (res.ok === false) {\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('ok false endWait');       \r\n                that.endWait();\r\n                console.log('call error %s', res.statusText);\r\n                throw res.statusText;\r\n            }\r\n            let ct = res.headers.get('content-type');\r\n            if (ct && ct.indexOf('json')>=0) {\r\n                return res.json().then(async retJson => {\r\n                    env.clearTimeout(timeOutHandler);\r\n                    that.endWait();\r\n                    if (retJson.ok === true) {\r\n                        if (typeof retJson !== 'object') {\r\n                            debugger;\r\n                        }\r\n                        else if (Array.isArray(retJson) === true) {\r\n                            debugger;\r\n                        }\r\n                        return resolve(retJson);\r\n                    }\r\n                    let retError = retJson.error;\r\n                    if (retError === undefined) {\r\n                        await that.showError(buildError('not valid tonva json'));\r\n                    }\r\n                    else {\r\n                        await that.showError(buildError(retError, 'retJson.error'));\r\n                        reject(retError);\r\n                    }\r\n                }).catch(async error => {\r\n                    await that.showError(buildError(error, 'catch res.json()'));\r\n                });\r\n            }\r\n            else {\r\n                let text = await res.text();\r\n                env.clearTimeout(timeOutHandler);\r\n                console.log('text endWait');\r\n                that.endWait();\r\n                resolve(text);\r\n            }\r\n        }\r\n        catch(error) {\r\n            this.endWait(url, reject);\r\n            if (typeof error === 'string') {\r\n                let err = error.toLowerCase();\r\n                if (err.startsWith('unauthorized') === true || err.startsWith('$roles') === true) {\r\n                    this.web.logout();\r\n                    return;\r\n                }\r\n            }\r\n            console.error('fecth error (no nav.showError): ' + url);\r\n        };\r\n    }\r\n\r\n    protected abstract innerFetch(url: string, options: any, waiting: boolean): Promise<any>;\r\n\r\n    async callFetch(url:string, method:string, body:any):Promise<any> {\r\n        let options = this.buildOptions();\r\n        options.method = method;\r\n        options.body = body;\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(url, options, true, resolve, reject);\r\n        });\r\n    }\r\n\r\n    //private buildOptions(): {method:string; headers:Headers; body:any} {\r\n\t\tprivate buildOptions(): {method:string; headers:{[name:string]: string}; body:any} {\r\n        let headers = this.buildHeaders();\r\n        let options = {\r\n            headers: headers,\r\n            method: undefined as any,\r\n            body: undefined as any,\r\n            // cache: 'no-cache',\r\n        };\r\n        return options;\r\n    }\r\n\r\n\t/*\r\n    protected buildHeaders():Headers {\r\n        let {language, culture} = nav;\r\n        let headers = new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n        headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n        headers.append('Accept-Language', lang);\r\n        if (this.apiToken) { \r\n            headers.append('Authorization', this.apiToken); \r\n        }\r\n        return headers;\r\n\t}\r\n\t*/\r\n\tprotected buildHeaders():{[name:string]: string} { \r\n        let {language, culture} = this.web;\r\n        let headers:{[name:string]: string} = {}; //new Headers();\r\n        //headers.append('Access-Control-Allow-Origin', '*');\r\n\t\t//headers.append('Content-Type', 'application/json;charset=UTF-8');\r\n\t\theaders['Content-Type'] = 'application/json;charset=UTF-8';\r\n        let lang = language;\r\n        if (culture) lang += '-' + culture;\r\n\t\t//headers.append('Accept-Language', lang);\r\n\t\theaders['Accept-Language'] = lang;\r\n        if (this.apiToken) { \r\n\t\t\t//headers.append('Authorization', this.apiToken); \r\n\t\t\theaders['Authorization'] = this.apiToken;\r\n        }\r\n        return headers;\r\n\t}\r\n}\r\n\r\nexport class CenterHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        let {appBridge} = this.web;\r\n        if (this.apiToken === undefined && appBridge.isBridged())\r\n            return await appBridge.bridgeCenterApi(u, options.method, options.body);\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n\r\nexport class UqHttpChannel extends HttpChannel {\r\n    protected async innerFetch(url: string, options: any, waiting: boolean): Promise<any> {\r\n        let u = this.hostUrl + url;\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            await this.fetch(u, options, waiting, resolve, reject);\r\n        });\r\n    }\r\n}\r\n","import { Web } from './Web';\r\nimport { FetchError } from './fetchError';\r\n\r\nexport interface HttpChannelUI {\r\n    startWait():void;\r\n    endWait():void;\r\n    showError(error:FetchError):Promise<void>;\r\n    // showUpgradeUq(uq:string, version:number):Promise<void>;\r\n}\r\n\r\nexport class HttpChannelNavUI implements HttpChannelUI {\r\n    protected readonly web:Web;\r\n\r\n    constructor(web:Web) {\r\n        this.web = web;\r\n    }\r\n\r\n    startWait() {\r\n        this.web.startWait();\r\n    }\r\n    endWait() {\r\n        this.web.endWait();\r\n    }\r\n    async showError(error:FetchError):Promise<void> {\r\n        this.web.endWait();\r\n        /*\r\n        if (error.name === 'SyntaxError') {\r\n            error = {\r\n                name: error.name,\r\n                message: error.message,\r\n            }\r\n        }*/\r\n        await this.web.onError(error);\r\n    }\r\n    /*\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        await this.web.tonva.nav.showUpgradeUq(uq, version);\r\n    }\r\n    */\r\n}\r\n","import {HttpChannel} from './httpChannel';\r\nimport { Caller } from './caller';\r\nimport { Web } from './Web';\r\n\r\nexport async function refetchApi(channel:HttpChannel, url:string, options:any, \r\n    resolve:(values:any)=>any, reject:(reason:any)=>void)\r\n{\r\n    await channel.fetch(url, options, false, resolve, reject);\r\n}\r\n\r\nexport abstract class ApiBase {\r\n    protected readonly web: Web;\r\n    protected token: string;\r\n    protected path: string;\r\n    protected showWaiting: boolean;\r\n\r\n    constructor(web: Web, path: string, showWaiting: boolean) {\r\n        this.web = web;\r\n        this.path = path || '';\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    protected abstract getHttpChannel(): Promise<HttpChannel>;\r\n\r\n    async xcall(caller:Caller<any>):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.xcall(this.path, caller);\r\n    }\r\n\r\n    public async call(url:string, method:string, body:any):Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.callFetch(url, method, body);\r\n    }\r\n\r\n    public async get(path:string, params:any=undefined): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.get(this.path + path, params);\r\n    }\r\n\r\n    public async post(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.post(this.path + path, params);\r\n    }\r\n\r\n    public async put(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.put(this.path + path, params);\r\n    }\r\n\r\n    public async delete(path:string, params:any): Promise<any> {\r\n        let channel = await this.getHttpChannel();\r\n        return await channel.delete(this.path + path, params);\r\n    }\r\n}\r\n","import { env } from '../tool';\r\n\r\nconst centerHost = process.env['REACT_APP_CENTER_HOST'];\r\nconst centerDebugHost = 'localhost:3000'; //'192.168.86.64';\r\nconst resHost = process.env['REACT_APP_RES_HOST'] || centerHost;\r\nconst resDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugHost = 'localhost:3015'; //'192.168.86.63';\r\nconst uqDebugBuilderHost = 'localhost:3009';\r\ninterface HostValue {\r\n    value: string;\r\n\tlocal: boolean;\r\n}\r\nconst hosts:{[name:string]:HostValue} = {\r\n    centerhost: {\r\n        value: process.env['REACT_APP_CENTER_DEBUG_HOST'] || centerDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    reshost: {\r\n        value: process.env['REACT_APP_RES_DEBUG_HOST'] || resDebugHost,\r\n\t\tlocal: false,\r\n    },\r\n    uqhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    unitxhost: {\r\n        value: process.env['REACT_APP_UQ_DEBUG_HOST'] || uqDebugHost, \r\n\t\tlocal: false,\r\n    },\r\n    \"uq-build\": {\r\n        value: process.env['REACT_APP_UQ_DEBUG_BUILDER_HOST'] || uqDebugBuilderHost, \r\n\t\tlocal: false,\r\n    }\r\n}\r\n\r\nconst httpArr = ['https://', 'http://'];\r\nfunction isAbsoluteUrl(url:string):boolean {\r\n    for (let str of httpArr) {\r\n        if (url.startsWith(str) === true) return true;\r\n    }\r\n    return false;\r\n}\r\n\r\nfunction urlFromHost(host:string):string {\r\n    if (isAbsoluteUrl(host) === true) {\r\n        if (host.endsWith('/')) return host;\r\n        return host + '/';\r\n    }\r\n    return `http://${host}/`;\r\n}\r\n\r\nfunction centerUrlFromHost(host:string):string {\r\n    return urlFromHost(host);\r\n}\r\nfunction centerWsFromHost(host:string) {\r\n    let https = 'https://';\r\n    if (host.startsWith(https) === true) {\r\n        host = host.substr(https.length);\r\n        if (host.endsWith('/') === true) host = host.substr(0, host.length-1);\r\n        return 'wss://' + host + '/tv/';\r\n    }\r\n    return `ws://${host}/tv/`\r\n}\r\nexport function resUrlFromHost(host:string) {\r\n\tif (!host) return;\r\n    let url = urlFromHost(host);\r\n    return url + 'res/';\r\n}\r\n\r\nconst fetchOptions = {\r\n    method: \"GET\",\r\n    mode: \"no-cors\", // no-cors, cors, *same-origin\r\n    headers: {\r\n        \"Content-Type\": \"text/plain\"\r\n    },\r\n};\r\n\r\nclass Host {\r\n    testing: boolean;\r\n    url: string;\r\n    ws: string;\r\n    resHost: string;\r\n\r\n    async start(testing:boolean) {\r\n\t\tif (!centerHost) debugger;\r\n        this.testing = testing;\r\n        if (env.isDevelopment === true) {\r\n            await this.tryLocal();\r\n        }\r\n        let host = this.getCenterHost();\r\n        this.url = centerUrlFromHost(host);\r\n        this.ws = centerWsFromHost(host);\r\n\t\tthis.resHost = this.getResHost();\r\n    }\r\n\r\n    private debugHostUrl(host:string) {return `http://${host}/hello`}\r\n    private async tryLocal() {\r\n        let promises:PromiseLike<any>[] = [];\r\n        let hostArr:string[] = [];\r\n        for (let i in hosts) {\r\n            let hostValue = hosts[i];\r\n            let {value} = hostValue;\r\n            if (hostArr.findIndex(v => v === value) < 0) hostArr.push(value);\r\n        }\r\n\r\n        for (let host of hostArr) {\r\n            let fetchUrl = this.debugHostUrl(host);\r\n            promises.push(localCheck(fetchUrl));\r\n        }\r\n        let results = await Promise.all(promises);\r\n        let len = hostArr.length;\r\n        for (let i=0; i<len; i++) {\r\n            let local = results[i];\r\n            let host = hostArr[i];\r\n            for (let j in hosts) {\r\n                let hostValue = hosts[j];\r\n                if (hostValue.value === host) {\r\n                    hostValue.local = local;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    private getCenterHost():string {\r\n        let {value, local} = hosts.centerhost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return centerHost;\r\n    }\r\n\r\n    private getResHost():string {\r\n        let {value, local} = hosts.reshost;\r\n        let hash = document.location.hash;\r\n        if (hash.includes('sheet_debug') === true) {\r\n            return value;\r\n        }\r\n        if (env.isDevelopment === true) {\r\n            if (local === true) return value;\r\n        }\r\n        return resHost;\r\n    }\r\n\r\n    getUrlOrDebug(url:string, debugHost:string = 'uqhost'):string {\r\n        if (env.isDevelopment === false) return url;\r\n        let host = hosts[debugHost];\r\n        if (host === undefined) return url;\r\n        let {value, local} = host;\r\n        if (local === false) return url;\r\n        return `http://${value}/`;\r\n    }\r\n    getUrlOrTest(db:string, url:string, urlTest:string):string {\r\n\t\tif (!urlTest) {\r\n\t\t\turlTest = url;\r\n\t\t\tif (!urlTest) {\r\n\t\t\t\tconsole.error('no server set for ' + db);\r\n\t\t\t\tdebugger;\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n\t\telse if (!url) {\r\n\t\t\turl = urlTest;\r\n\t\t}\r\n\t\tlet testProd:string;\r\n        if (this.testing === true) {\r\n\t\t\tif (urlTest !== '-') url = urlTest;\r\n\t\t\ttestProd = 'test';\r\n        }\r\n        else {\r\n\t\t\ttestProd = 'prod';\r\n        }\r\n\t\turl = this.getUrlOrDebug(url);\r\n\t\tif (url.endsWith('/') === false) {\r\n\t\t\turl += '/';\r\n\t\t}\r\n        return `${url}uq/${testProd}/${db}/`;\r\n    }\r\n\r\n    async localCheck(urlDebug: string):Promise<boolean> {\r\n        return await localCheck(urlDebug);\r\n    }\r\n}\r\n\r\nexport const host:Host = new Host();\r\n\r\n// 因为测试的都是局域网服务器，甚至本机服务器，所以一秒足够了\r\n// 网上找了上面的fetch timeout代码。\r\n// 尽管timeout了，fetch仍然继续，没有cancel\r\n\r\n// 实际上，一秒钟不够。web服务器会自动停。重启的时候，可能会比较长时间。也许两秒甚至更多。\r\n//const timeout = 2000;\r\nconst timeout = 2000;\r\n\r\nfunction fetchLocalCheck(url:string):Promise<any> {\r\n    return new Promise((resolve, reject) => {\r\n      fetch(url, fetchOptions as any)\r\n      .then(v => {\r\n          v.text().then(resolve).catch(reject);\r\n      })\r\n      .catch(reject);\r\n      const e = new Error(\"Connection timed out\");\r\n      env.setTimeout('fetchLocalCheck', reject, timeout, e);\r\n    });\r\n}\r\n\r\nasync function localCheck(url:string):Promise<boolean> {\r\n    try {\r\n\t\tawait fetchLocalCheck(url);\r\n        return true;\r\n    }\r\n    catch (err) {\r\n        return false;\r\n    }\r\n}\r\n\r\n/*\r\nexport interface IUqForChannel {\r\n    uq: string;\r\n    uqVersion: number;\r\n}\r\n*/","import {HttpChannel, UqHttpChannel} from './httpChannel';\r\nimport {HttpChannelNavUI} from './httpChannelUI';\r\n//import {getUqToken, logoutUqTokens, buildAppUq} from './appBridge';\r\nimport {ApiBase} from './apiBase';\r\nimport { host } from './host';\r\nimport { LocalMap, env, decodeUserToken } from '../tool';\r\nimport { Web, PromiseValue } from './Web';\r\n\r\ninterface UqLocal {\r\n    user: number;\r\n    unit: number;\r\n    value: any;\r\n    tick?: number;\r\n    isNet?: boolean;\r\n}\r\n\r\nexport class UqApi extends ApiBase {\r\n    uqOwner: string;\r\n    uqName: string;\r\n    uq: string;\r\n\r\n    constructor(web:Web, basePath:string, uqOwner:string, uqName:string, showWaiting?: boolean) {\r\n        super(web, basePath, showWaiting);\r\n        if (uqName) {\r\n            this.uqOwner = uqOwner;\r\n            this.uqName = uqName;\r\n            this.uq = uqOwner + '/' + uqName;\r\n        }\r\n        this.showWaiting = showWaiting;\r\n    }\r\n\r\n    async init() {\r\n        await this.web.appBridge.buildAppUq(this.uq, this.uqOwner, this.uqName);\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channels: {[name:string]: HttpChannel|(PromiseValue<any>[])};\r\n        let channelUI: HttpChannelNavUI;\r\n        if (this.showWaiting === true || this.showWaiting === undefined) {\r\n            channels = this.web.channelUIs;\r\n            channelUI = new HttpChannelNavUI(this.web);\r\n        }\r\n        else {\r\n            channels = this.web.channelNoUIs;\r\n        }\r\n        let channel = channels[this.uq];\r\n\t\tif (channel !== undefined) {\r\n\t\t\tif (Array.isArray(channel) === false) return channel as HttpChannel;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tchannel = channels[this.uq] = [];\r\n\t\t}\r\n\t\tlet arr = channel as PromiseValue<any>[];\r\n\t\treturn new Promise(async (resolve, reject) => {\r\n\t\t\tarr.push({resolve, reject});\r\n\t\t\tif (arr.length !== 1) return;\r\n\t\t\tlet uqToken = this.web.appBridge.getUqToken(this.uq); //, this.uqOwner, this.uqName);\r\n\t\t\tif (!uqToken) {\r\n\t\t\t\t//debugger;\r\n\t\t\t\tawait this.init();\r\n\t\t\t\tuqToken = this.web.appBridge.getUqToken(this.uq);\r\n\t\t\t}\r\n\t\t\tlet {url, token} = uqToken;\r\n\t\t\tthis.token = token;\r\n\t\t\tchannel = new UqHttpChannel(this.web, url, token, channelUI);\r\n\t\t\tchannels[this.uq] = channel;\r\n\t\t\tfor (let pv of arr) {\r\n\t\t\t\tpv.resolve(channel);\r\n\t\t\t}\r\n\r\n\t\t});\r\n    }\r\n\r\n    /*async update():Promise<string> {\r\n        return await this.get('update');\r\n    }*/\r\n\r\n    /*\r\n    async __loadAccess():Promise<any> {\r\n        let acc = this.access === undefined?\r\n            '' :\r\n            this.access.join('|');\r\n        let ret = await this.get('access', {acc:acc});\r\n        return ret;\r\n    }\r\n    */\r\n    async loadEntities():Promise<any> {\r\n        //return await localUqs.loadAccess(this);\r\n        //let acc = this.access === undefined?\r\n        //    '' :\r\n        //    this.access.join('|');\r\n\t\t//let ret = await this.get('access', {acc:acc});\r\n\t\tlet ret = await this.get('entities');\r\n        return ret;\r\n\t}\r\n    async getAdmins():Promise<{id:number;role:number}[]> {\r\n\t\tlet ret = await this.get('get-admins',);\r\n\t\treturn ret;\r\n    }\r\n \tasync getRoles():Promise<string[]> {\r\n\t\tlet ret = await this.get('get-roles',);\r\n\t\tif (!ret) return null;\r\n\t\tlet parts:string[] = (ret as string).split('|');\r\n\t\tlet s:string[] = [];\r\n\t\tfor (let p of parts) {\r\n\t\t\tp = p.trim();\r\n\t\t\tif (!p) continue;\r\n\t\t\ts.push(p);\r\n\t\t}\r\n\t\tif (s.length === 0) return null;\r\n\t\treturn s;\r\n\t}\r\n\tasync getAllRoleUsers():Promise<{user:number, admin:number, roles:string}[]> {\r\n\t\tlet ret = await this.get('get-all-role-users');\r\n\t\treturn ret;\r\n\t}\r\n\tasync setUserRoles(theUser:number, roles:string):Promise<void> {\r\n\t\tawait this.post('set-user-roles', {theUser, roles});\r\n\t}\r\n\tasync deleteUserRoles(theUser:number):Promise<void> {\r\n\t\tawait this.get('delete-user-roles', {theUser});\r\n\t}\r\n\r\n\tasync allSchemas(): Promise<any> {\r\n\t\treturn await this.get('all-schemas');\r\n\t}\r\n\r\n    async schema(name:string):Promise<any> {\r\n        return await this.get('schema/' + name);\r\n    }\r\n\r\n    async queueModify(start:number, page:number, entities:string) {\r\n        return await this.post('queue-modify', {start:start, page:page, entities:entities});\r\n    }\r\n}\r\n\r\n/*\r\nlet channels:{[unitId:number]: HttpChannel} = {};\r\n\r\nexport function logoutUnitxApis() {\r\n    channels = {};\r\n}\r\n*/\r\n\r\nexport class UnitxApi extends UqApi {\r\n    private unitId:number;\r\n    constructor(web:Web, unitId:number) {\r\n        super(web, 'tv/', undefined, undefined, true);\r\n        this.unitId = unitId;\r\n    }\r\n\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        let channel = this.web.channels[this.unitId];\r\n        if (channel !== undefined) return channel;\r\n        return this.web.channels[this.unitId] = await this.buildChannel();\r\n    }\r\n\r\n    private async buildChannel():Promise<HttpChannel> {        \r\n        let channelUI = new HttpChannelNavUI(this.web);\r\n        let centerAppApi = new CenterAppApi(this.web, 'tv/', undefined);\r\n        let ret = await centerAppApi.unitxUq(this.unitId);\r\n        let {token, db, url, urlTest} = ret;\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        this.token = token;\r\n        return new UqHttpChannel(this.web, realUrl, token, channelUI);\r\n    }\r\n}\r\nexport abstract class CenterApiBase extends ApiBase {\r\n    protected async getHttpChannel(): Promise<HttpChannel> {\r\n        return (this.showWaiting === true || this.showWaiting === undefined)?\r\n            this.web.getCenterChannelUI():\r\n            this.web.getCenterChannel();\r\n    }\r\n}\r\n\r\nconst uqTokensName = 'uqTokens';\r\nexport class UqTokenApi extends CenterApiBase {\r\n\tstatic clearLocal() {\r\n\t\tenv.localDb.removeItem(uqTokensName);\r\n\t}\r\n    private localMap: LocalMap = env.localDb.map(uqTokensName);\r\n\r\n    async uq(params: {unit:number, uqOwner:string, uqName:string}):Promise<any> {\r\n        let {uqOwner, uqName} = params;\r\n        let un = uqOwner+'/'+uqName;\r\n        let localCache = this.localMap.child(un);\r\n        try {\r\n            let uqToken:UqLocal = localCache.get();\r\n            if (uqToken !== undefined) {\r\n                let {unit, user} = uqToken;\r\n                if (unit !== params.unit || user !== this.web.loginedUserId) {\r\n                    localCache.remove();\r\n                    uqToken = undefined;\r\n                }\r\n            }\r\n            let nowTick = Math.floor(Date.now() / 1000);\r\n            if (uqToken !== undefined) {\r\n                let {tick, value} = uqToken;\r\n                if (value !== undefined && (nowTick - tick) < 24*3600) {\r\n                    return Object.assign({}, value);\r\n                }\r\n            }\r\n            let uqParams:any = Object.assign({}, params);\r\n            uqParams.testing = host.testing;\r\n            let ret = await this.get('uq-token', uqParams);\r\n            if (ret === undefined) {\r\n                let {unit, uqOwner, uqName} = params;\r\n                let err = `center get app-uq(unit=${unit}, '${uqOwner}/${uqName}') - not exists or no unit-service`;\r\n                throw err;\r\n            }\r\n\r\n            uqToken = {\r\n                unit: params.unit,\r\n                user: this.web.loginedUserId,\r\n                tick: nowTick,\r\n                value: ret,\r\n            }\r\n            localCache.set(uqToken);\r\n            return Object.assign({}, ret);\r\n        }\r\n        catch (err) {\r\n            localCache.remove();\r\n            throw err;\r\n        }\r\n    }\r\n}\r\n\r\nexport class CallCenterApi extends CenterApiBase {\r\n    directCall(url:string, method:string, body:any):Promise<any> {\r\n        return this.call(url, method, body);\r\n    }\r\n}\r\n\r\nexport interface UqAppData {\r\n    appName: string;\r\n    appOwner: string;\r\n    id: number;\r\n    version: string;        // AppUI version\r\n    uqs: UqData[];\r\n}\r\n\r\nexport interface UqData {\r\n    id: number;\r\n    uqOwner: string;\r\n\townerAlias: string;\r\n    uqName: string;\r\n\tuqAlias: string;\r\n    access: string;\r\n    newVersion: boolean;\r\n}\r\n\r\nexport interface UqServiceData {\r\n    id: number;\r\n    db: string;\r\n    url: string;\r\n    urlTest: string;\r\n    token: string;\r\n}\r\n\r\n//const appUqsName = 'appUqs';\r\n\r\nexport class CenterAppApi extends CenterApiBase {\r\n    async appUqs(appOwner:string, appName:string):Promise<UqAppData> {\r\n        let ret:UqAppData = await this.get('tie/app-uqs', {appOwner, appName});\r\n        return ret;\r\n    }\r\n    async uqs(uqs: {owner:string; name:string; version:string}[]):Promise<UqData[]> {\r\n        return await this.post('tie/pure-uqs', uqs);\r\n    }\r\n    async unitxUq(unit:number):Promise<UqServiceData> {\r\n        return await this.get('tie/unitx-uq', {unit:unit});\r\n    }\r\n    async changePassword(param: {orgPassword:string, newPassword:string}) {\r\n        return await this.post('tie/change-password', param);\r\n    }\r\n\r\n    async userQuit(): Promise<void> {\r\n        await this.get('tie/user-ask-quit', {});\r\n    }\r\n}\r\n\r\nexport interface RegisterParameter {\r\n    nick:string, \r\n    user:string, \r\n    pwd:string,\r\n    country:number, \r\n    mobile:number, \r\n    mobileCountry:number,\r\n    email:string,\r\n    verify:string,\r\n};\r\n\r\nexport class UserApi extends CenterApiBase {\r\n    async login(params: {user: string, pwd: string, guest: number}): Promise<any> {\r\n        //(params as any).device = nav.local.device.get();\r\n        let ret = await this.post('user/login', params);\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeUserToken(ret);\r\n            case 'object':\r\n                let token = ret.token;\r\n                let user = decodeUserToken(token);\r\n                let {nick, icon} = ret;\r\n                if (nick) user.nick = nick;\r\n                if (icon) user.icon = icon;\r\n                return user;\r\n        }\r\n        // !== undefined) return decodeToken(token);\r\n    }\r\n    async register(params: RegisterParameter): Promise<any>\r\n    {\r\n        return await this.post('user/register', params);\r\n    }\r\n\r\n    async sendVerify(account:string, type:'mobile'|'email', oem:string) {\r\n        return await this.post('user/set-verify', {account:account, type:type, oem:oem});\r\n    }\r\n\r\n    async checkVerify(account:string, verify:string) {\r\n        return await this.post('user/check-verify', {account:account, verify:verify});\r\n    }\r\n\r\n    async isExists(account:string) {\r\n        return await this.get('user/is-exists', {account:account});\r\n    }\r\n\r\n    async resetPassword(account:string, password:string, verify:string, type:'mobile'|'email'):Promise<any[]> {\r\n        return await this.post('user/reset-password', {account:account, password, verify, type});\r\n    }\r\n    \r\n    async userSetProp(prop:string, value:any) {\r\n        await this.post('tie/user-set-prop', {prop:prop, value:value});\r\n    }\r\n\r\n    async me():Promise<any> {\r\n        return await this.get('tie/me');\r\n    }\r\n\r\n    async user(id:number): Promise<any> {\r\n        return await this.get('tie/user', {id:id});\r\n\t}\r\n\t\r\n\tasync fromKey(key:string): Promise<{id:number, name:string, nick:string, icon:string}> {\r\n\t\treturn await this.get('tie/user-from-key', {key});\r\n\t}\r\n}\r\n","import { Web } from \"./Web\";\r\n\r\nlet subAppWindow:Window;\r\nfunction postWsToSubApp(msg:any) {\r\n    if (subAppWindow === undefined) return;\r\n    subAppWindow.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport function setSubAppWindow(win:Window) {\r\n    subAppWindow = win;\r\n}\r\n\r\nexport function postWsToTop(msg:any) {\r\n    window.top.postMessage({\r\n        type: 'ws',\r\n        msg: msg\r\n    }, '*');\r\n}\r\n\r\nexport abstract class WsBase {\r\n    protected web: Web;\r\n\t//private messageHub = messageHub;\r\n    constructor(web: Web) {\r\n        this.web = web;\r\n    }\r\n\r\n\t/*\r\n    wsBaseId:string;\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n\tprivate msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\t*/\r\n\t/*\r\n    onWsReceiveAny(handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.anyHandlers[seed] = handler;\r\n        return seed;\r\n    }\r\n    onWsReceive(type:string, handler:(msg:any)=>Promise<void>):number {\r\n        let seed = this.handlerSeed++;\r\n        this.msgHandlers[seed] = {type:type, handler: handler};\r\n        return seed;\r\n    }\r\n    endWsReceive(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n\t}\r\n\t*/\r\n    async receive(msg:any) {\r\n\t\tthis.web.messageHub.dispatch(msg);\r\n\t\t/*\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n\t\t}\r\n\t\t*/\r\n    }\r\n}\r\n\r\nlet wsBaseSeed = 1;\r\nexport class WsBridge extends WsBase {\r\n    wsBaseId:string = 'WsBridge seed ' + wsBaseSeed++;\r\n}\r\n\r\nexport class WSChannel extends WsBase {\r\n    wsBaseId:string = 'WSChannel seed ' + wsBaseSeed++;\r\n    static centerToken:string;\r\n    private wsHost: string;\r\n    private token: string;\r\n    private ws: WebSocket;\r\n\r\n    constructor(web: Web, wsHost: string, token: string) {\r\n        super(web);\r\n        this.wsHost = wsHost;\r\n        this.token = token;\r\n    }\r\n\r\n    static setCenterToken(token?: string) {\r\n        WSChannel.centerToken = token;\r\n    }\r\n    \r\n    connect():Promise<void> {\r\n        //this.wsHost = wsHost;\r\n        //this.token = token || WSChannel.centerToken;\r\n        if (this.ws !== undefined) return;\r\n        let that = this;\r\n        return new Promise((resolve, reject) => {\r\n            let ws = new WebSocket(this.wsHost, this.token || WSChannel.centerToken);\r\n            console.log('connect webSocket %s', this.wsHost);\r\n            ws.onopen = (ev) => {\r\n                console.log('webSocket connected %s', this.wsHost);\r\n                that.ws = ws;\r\n                resolve();\r\n            };\r\n            ws.onerror = (ev) => {\r\n                reject('webSocket can\\'t open!');\r\n            };\r\n            ws.onmessage = async (msg) => await that.wsMessage(msg);\r\n            ws.onclose = (ev) => {\r\n                that.ws = undefined;\r\n                console.log('webSocket closed!');\r\n            }\r\n        });\r\n    }\r\n    close() {\r\n        if (this.ws !== undefined) {\r\n            this.ws.close();\r\n            this.ws = undefined;\r\n        }\r\n    }\r\n    private async wsMessage(event:any):Promise<void> {\r\n        try {\r\n            console.log('websocket message: %s', event.data);\r\n            let msg = JSON.parse(event.data);\r\n            postWsToSubApp(msg);\r\n            await this.receive(msg);\r\n        }\r\n        catch (err) {\r\n            console.log('ws msg error: ', err);\r\n        }\r\n    }\r\n    sendWs(msg:any) {\r\n        let netThis = this;\r\n        this.connect().then(() => {\r\n            netThis.ws.send(msg);\r\n        });\r\n    }\r\n}\r\n","//import {nav} from '../components';\r\nimport { UqTokenApi } from './uqApi';\r\nimport { setSubAppWindow } from './wsChannel';\r\nimport { host } from './host';\r\nimport { env, uid } from '../tool';\r\nimport { Web } from './Web';\r\n\r\nexport interface UqToken {\r\n    name: string;\r\n    db: string;\r\n    url: string;\r\n    token: string;\r\n}\r\n\r\ninterface UqTokenAction {\r\n    resolve: (value?: UqToken | PromiseLike<UqToken>) => void;\r\n    reject: (reason?: any) => void;\r\n}\r\n\r\ninterface BridgeCenterApi {\r\n    id: string;\r\n    resolve: (value?:any)=>any;\r\n    reject: (reason?:any)=>void;\r\n}\r\n\r\nexport class AppBridge {\r\n    private readonly web: Web;\r\n    private readonly uqTokens:{[uqName:string]: UqToken}  = {};\r\n\r\n    constructor(web: Web) {\r\n        this.web = web;\r\n    }\r\n\r\n    addMessageListener() {\r\n        window.addEventListener('message', async (evt) => {\r\n            var message = evt.data;\r\n            if (!message) return;\r\n            //let {nav} = this.web.tonva;\r\n            switch (message.type) {\r\n                case 'sub-frame-started':\r\n                    this.subFrameStarted(evt);\r\n                    break;\r\n                case 'ws':\r\n                    //wsBridge.receive(message.msg);\r\n                    await this.web.onWsReceive(message.msg);\r\n                    break;\r\n                case 'init-sub-win':\r\n                    await this.initSubWin(message);\r\n                    break;\r\n                case 'pop-app':\r\n                    window.console.log('///\\\\\\\\\\\\ pop-app');\r\n                    this.web.navBack();\r\n                    break;\r\n                case 'center-api':\r\n                    await this.callCenterApiFromMessage(evt.source as Window, message);\r\n                    break;\r\n                case 'center-api-return':\r\n                    this.bridgeCenterApiReturn(message);\r\n                    break;\r\n                case 'app-api':\r\n                    let ret = await this.onReceiveAppApiMessage(message.hash, message.apiName);\r\n                    (evt.source as Window).postMessage({\r\n                        type: 'app-api-return', \r\n                        apiName: message.apiName,\r\n                        db: ret.db,\r\n                        url: ret.url,\r\n                        token: ret.token} as any, \"*\");\r\n                    break;\r\n                case 'app-api-return':\r\n                    console.log(\"app-api-return: %s\", JSON.stringify(message));\r\n                    console.log('await onAppApiReturn(message);');\r\n                    await this.onAppApiReturn(message);\r\n                    break;\r\n                default:\r\n                    if ((message.source as string)?.startsWith('react-devtools') === true) break;\r\n                    window.console.log('message: %s', JSON.stringify(message));\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n\r\n    logoutUqTokens() {\r\n        for (let i in this.uqTokens) {\r\n            this.uqTokens[i] = undefined;\r\n        }\r\n        UqTokenApi.clearLocal();\r\n    }\r\n\r\n    isBridged():boolean {\r\n        return window.self !== window.parent;\r\n    }\r\n\r\n    private subFrameStarted(evt:any) {\r\n        var message = evt.data;\r\n        let subWin = evt.source as Window;\r\n        setSubAppWindow(subWin);\r\n        this.hideFrameBack(message.hash);\r\n        let msg:any =  Object.assign({}, this.web.user);\r\n        msg.type = 'init-sub-win';\r\n        subWin.postMessage(msg, '*');\r\n    }\r\n\r\n    hideFrameBack(hash:string) {\r\n        let el = document.getElementById(hash);\r\n        if (el !== undefined) el.hidden = true;\r\n    }\r\n\r\n    async initSubWin(message:any) {\r\n        console.log('initSubWin: set nav.user', message);\r\n        let user = this.web.user = message; // message.user;\r\n        this.web.setCenterToken(user.id, user.token);\r\n        await this.web.showAppView();\r\n    }\r\n\r\n    private async onReceiveAppApiMessage(hash: string, apiName: string): Promise<UqToken> {\r\n        let {unit} = env;\r\n        if (!unit) {\r\n            console.error('no unit defined in unit.json or in index.html, or not logined in', unit);\r\n        }\r\n        let parts = apiName.split('/');\r\n        let param = {unit: unit, uqOwner: parts[0], uqName: parts[1], appOwner: parts[2], appName:parts[3]};\r\n        console.log('uqTokenApi.uq onReceiveAppApiMessage', param);\r\n        let ret = await this.web.uqTokenApi.uq(param);\r\n        let {db, url, token} = ret;\r\n        return {name: apiName, db:db, url: url, token: token};\r\n    }\r\n\r\n    private async onAppApiReturn(message:any) {\r\n        let {apiName, db, url, urlTest, token} = message;\r\n        let action = this.uqTokenActions[apiName];\r\n        if (action === undefined) {\r\n            throw new Error('error app api return');\r\n            //return;\r\n        }\r\n        let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n        console.log('onAppApiReturn(message:any): url=' + url + ', real=' + realUrl);\r\n        //action.url = realUrl;\r\n        //action.token = token;\r\n        action.resolve({\r\n            name: apiName,\r\n            db: db,\r\n            url: realUrl,\r\n            token: token,\r\n        } as UqToken);\r\n    }\r\n\r\n    private readonly uqTokenActions:{[uq:string]: UqTokenAction} = {};\r\n\r\n    async buildAppUq(uq:string, uqOwner:string, uqName:string):Promise<void> {\r\n        if (!this.isBridged()) {\r\n            //let unit = getUnit();\r\n            let {unit} = env;\r\n            let uqToken = await this.web.uqTokenApi.uq({unit,  uqOwner, uqName});\r\n            if (uqToken.token === undefined) uqToken.token = this.web.centerToken;\r\n            let {db, url, urlTest} = uqToken;\r\n            let realUrl = host.getUrlOrTest(db, url, urlTest);\r\n            console.log('realUrl: %s', realUrl);\r\n            uqToken.url = realUrl;\r\n            this.uqTokens[uq] = uqToken;\r\n            return uqToken;\r\n        }\r\n        //console.log(\"**** before buildAppUq ****\", appInFrame);\r\n        let bp = this.uqTokenActions[uq];\r\n        if (bp !== undefined) return;\r\n        return new Promise<void>((resolve, reject) => {\r\n            this.uqTokenActions[uq] = {\r\n                resolve: async (at:any) => {\r\n                    let {db, url, token} = await at;\r\n                    this.uqTokens[uq] = {\r\n                        name: uq,\r\n                        db: db,\r\n                        url: url,\r\n                        token: token,\r\n                    };\r\n                    this.uqTokenActions[uq] = undefined;\r\n                    //console.log(\"**** after buildAppUq ****\", appInFrame);\r\n                    resolve();\r\n                },\r\n                reject: reject,\r\n            };\r\n            (window.opener || window.parent).postMessage({\r\n                type: 'app-api',\r\n                apiName: uq,\r\n                //hash: appInFrame.hash,\r\n            }, \"*\");\r\n        });\r\n    }\r\n\r\n    getUqToken(uq:string):UqToken {\r\n        let uts = this.uqTokens;\r\n        return uts[uq];\r\n    }\r\n\r\n    private readonly brideCenterApis:{[id:string]: BridgeCenterApi} = {};\r\n    async bridgeCenterApi(url:string, method:string, body:any):Promise<any> {\r\n        console.log('bridgeCenterApi: url=%s, method=%s', url, method);\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            let callId:string;\r\n            for (;;) {\r\n                callId = uid();\r\n                let bca = this.brideCenterApis[callId];\r\n                if (bca === undefined) {\r\n                    this.brideCenterApis[callId] = {\r\n                        id: callId,\r\n                        resolve: resolve,\r\n                        reject: reject,\r\n                    }\r\n                    break;\r\n                }\r\n            }\r\n            (window.opener || window.parent).postMessage({\r\n                type: 'center-api',\r\n                callId: callId,\r\n                url: url,\r\n                method: method,\r\n                body: body\r\n            }, '*');\r\n        });\r\n    }\r\n\r\n    async callCenterApiFromMessage(from:Window, message:any):Promise<void> {\r\n        let {callId, url, method, body} = message;\r\n        let result = await this.web.callCenterapi.directCall(url, method, body);\r\n        from.postMessage({\r\n            type: 'center-api-return',\r\n            callId: callId,\r\n            result: result,\r\n        }, '*');\r\n    }\r\n\r\n    bridgeCenterApiReturn(message:any) {\r\n        let {callId, result} = message;\r\n        let bca = this.brideCenterApis[callId];\r\n        if (bca === undefined) return;\r\n        this.brideCenterApis[callId] = undefined;\r\n        bca.resolve(result);\r\n    }\r\n}\r\n","import {CenterApiBase} from './uqApi';\r\n\r\nexport class CenterApi extends CenterApiBase {\r\n    async userAppUnits(app:number):Promise<any[]> {\r\n        return await this.get('tie/user-app-units', {app:app});\r\n    }\r\n    async userFromId(userId:number):Promise<any> {\r\n        return await this.get('user/user-name-nick-icon-from-id', {userId:userId});\r\n\t}\r\n\tasync userFromKey(userName:string):Promise<any> {\r\n\t\treturn await this.get('tie/user-from-key', {key:userName});\r\n\t}\r\n}\r\n","import { decodeGuestToken } from '../tool';\r\nimport { CenterApiBase } from './uqApi';\r\n\r\nexport class GuestApi extends CenterApiBase {\r\n    async guest(): Promise<any> {\r\n        //let guest = nav.local.guest.get();\r\n        let ret = await this.get('', {});\r\n        switch (typeof ret) {\r\n            default: return;\r\n            case 'string': return decodeGuestToken(ret);\r\n            case 'object':\r\n                let guest = decodeGuestToken(ret.token);\r\n                return guest;\r\n        }\r\n    }\r\n\r\n    async unitFromName(unitName:string): Promise<number> {\r\n        let ret = await this.get(unitName);\r\n        return ret && ret.unit;\r\n    }\r\n}\r\n","import { Web } from \"./Web\";\r\n\r\nexport class MessageHub {\r\n    web: Web;\r\n    constructor(web: Web) {\r\n        this.web = web;\r\n    }\r\n    private handlerSeed = 1;\r\n    private anyHandlers:{[id:number]:(msg:any)=>Promise<void>} = {};\r\n    private msgHandlers:{[id:number]:{type:string, handler:(msg:any)=>Promise<void>}} = {};\r\n\tregisterReceiveHandler(handler:(msg:any)=>Promise<void>):number;\r\n\tregisterReceiveHandler(type:string, handler:(msg:any)=>Promise<void>):number;\t\r\n    registerReceiveHandler(...args:any[]):number {\r\n\t\tlet seed = this.handlerSeed++;\r\n\t\tlet args0 = args[0];\r\n\t\tlet handler:(msg:any)=>Promise<void>;\r\n\t\tswitch (typeof args0) {\r\n\t\t\tcase 'string':\r\n\t\t\t\thandler = args[1];\r\n\t\t\t\tthis.msgHandlers[seed] = {type:args0, handler};\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'function':\r\n\t\t\t\tthis.anyHandlers[seed] = args0;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn seed;\r\n    }\r\n    unregisterReceiveHandler(handlerId:number) {\r\n        delete this.anyHandlers[handlerId];\r\n        delete this.msgHandlers[handlerId];\r\n    }\r\n    async dispatch(msg:any) {\r\n        let {$type} = msg;\r\n        for (let i in this.anyHandlers) {\r\n            await this.anyHandlers[i](msg);\r\n        }\r\n        for (let i in this.msgHandlers) {\r\n            let {type, handler} = this.msgHandlers[i];\r\n            if (type !== $type) continue;\r\n            await handler(msg);\r\n        }\r\n    }\r\n}\r\n","//import { Tonva } from \"../Tonva\";\r\nimport { AppBridge } from \"./appBridge\";\r\nimport { CenterApi } from \"./centerApi\";\r\nimport { UqData, CallCenterApi, CenterAppApi, UnitxApi, UqAppData, UqTokenApi, UserApi } from \"./uqApi\";\r\nimport { HttpChannel, CenterHttpChannel, UqHttpChannel } from './httpChannel';\r\nimport { GuestApi } from \"./guestApi\";\r\nimport { MessageHub } from \"./messageHub\";\r\nimport { HttpChannelNavUI } from \"./httpChannelUI\";\r\nimport { WsBridge, WSChannel } from \"./wsChannel\";\r\nimport { FetchError } from \"./fetchError\";\r\n//import { UQsMan, UQsManApp, TVs } from \"../uq\";\r\n//import { AppConfig, UqConfig } from \"../app\";\r\n\r\nexport interface PromiseValue<T> {\r\n\tresolve: (value?: T | PromiseLike<T>) => void;\r\n\treject: (reason?: any) => void;\r\n}\r\n\r\nexport abstract class Web {\r\n    // ----- 从nav搬移过来的内容\r\n\r\n\r\n\r\n    // ===== nav搬移内容结束\r\n\r\n\tabstract navInit(): Promise<void>\r\n\treload() {\r\n\t\tthrow new Error('Method not implemented.');\r\n\t}\r\n\tshowReloadPage(msg: string) {\r\n\t\tthrow new Error('Method not implemented.');\r\n\t}\r\n    // 这个应该会去掉\r\n    navBack() {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    // 这个是收到websocket消息的处理\r\n    async onWsReceive(msg: any) {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    async showAppView() {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    logout() {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    async onError(error: FetchError) {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    endWait() {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    startWait() {\r\n        throw new Error('Method not implemented.');\r\n    }\r\n    centerHost:string;\r\n    centerToken:string|undefined = undefined;\r\n    loginedUserId:number = 0;    \r\n    centerChannelUI:HttpChannel;\r\n    centerChannel:HttpChannel;\r\n\r\n    channelUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\n    channelNoUIs:{[name:string]: HttpChannel|(PromiseValue<any>[])} = {};\r\n    channels:{[unitId:number]: HttpChannel} = {};\r\n\r\n//    readonly tonva: Tonva;\r\n    readonly centerApi: CenterApi;\r\n    readonly appBridge: AppBridge;\r\n    readonly userApi: UserApi;\r\n    readonly uqTokenApi: UqTokenApi;\r\n    readonly callCenterapi: CallCenterApi;\r\n    readonly unitxApi: UnitxApi;\r\n    readonly guestApi: GuestApi;\r\n    readonly messageHub: MessageHub;\r\n    readonly wsBridge: WsBridge;\r\n\r\n    language: string;\r\n    culture: string;\r\n\r\n    // 下面的变量应该以后会去掉\r\n    isBuildingUQ: boolean;\r\n    _uqs: any;\r\n    user: any;\r\n    // -- end -------------------\r\n\r\n\r\n    constructor() {\r\n        this.centerApi = new CenterApi(this, '/tv', undefined);\r\n        this.appBridge = new AppBridge(this);\r\n        this.userApi = new UserApi(this, 'tv/', undefined);\r\n        this.uqTokenApi = new UqTokenApi(this, 'tv/tie/', undefined);\r\n        this.callCenterapi = new CallCenterApi(this, '', undefined);\r\n        let unitId: number = 0;\r\n        this.unitxApi = new UnitxApi(this, unitId);\r\n        this.guestApi = new GuestApi(this, 'tv/guest/', undefined);\r\n        this.messageHub = new MessageHub(this);\r\n        this.wsBridge = new WsBridge(this);\r\n    }\r\n    \r\n    logoutApis() {\r\n        this.channelUIs = {};\r\n        this.channelNoUIs = {};\r\n        this.channels = {};\r\n        this.appBridge.logoutUqTokens();\r\n    }\r\n\r\n    setCenterUrl(url:string) {\r\n        console.log('setCenterUrl %s', url);\r\n        this.centerHost = url;\r\n        this.centerChannel = undefined;\r\n        this.centerChannelUI = undefined;\r\n    }\r\n    \r\n    setCenterToken(userId:number, t?:string) {\r\n        this.loginedUserId = userId;\r\n        this.centerToken = t;\r\n        this.centerChannel = undefined;\r\n        this.centerChannelUI = undefined;\r\n    }\r\n\r\n    getCenterChannelUI():HttpChannel {\r\n        if (this.centerChannelUI !== undefined) return this.centerChannelUI;\r\n        this.centerChannelUI = new CenterHttpChannel(this, this.centerHost, this.centerToken, new HttpChannelNavUI(this));\r\n    }\r\n    \r\n    getCenterChannel():HttpChannel {\r\n        if (this.centerChannel !== undefined) return this.centerChannel;\r\n        return this.centerChannel = new CenterHttpChannel(this, this.centerHost, this.centerToken);\r\n    }\r\n\r\n    setNetToken(userId:number, token:string) {\r\n        this.setCenterToken(userId, token);\r\n        WSChannel.setCenterToken(token);\r\n    }\r\n\r\n    clearNetToken() {\r\n        this.setCenterToken(0, undefined);\r\n        WSChannel.setCenterToken(undefined);\r\n    }\r\n}\r\n","import { UqApi } from '../net';\r\nimport { LocalCache } from '../tool';\r\nimport { UqMan, Field, ArrFields, FieldMap } from './uqMan';\r\nimport { Tuid } from './tuid';\r\nimport { getObjPropIgnoreCase } from '../tool';\r\n\r\nconst tab = '\\t';\r\nconst ln = '\\n';\r\nconst chars = '\\\\ntbfvr';\r\nconst codeBackSlash = chars.charCodeAt(0);\r\nconst codeN = chars.charCodeAt(1);\r\nconst codeT = chars.charCodeAt(2);\r\nconst codeB = chars.charCodeAt(3);\r\nconst codeF = chars.charCodeAt(4);\r\nconst codeV = chars.charCodeAt(5);\r\nconst codeR = chars.charCodeAt(6);\r\n\r\nconst codes = '\\n\\t\\b\\f\\v\\r';\r\nconst codeBN = codes.charCodeAt(0);\r\nconst codeBT = codes.charCodeAt(1);\r\nconst codeBB = codes.charCodeAt(2);\r\nconst codeBF = codes.charCodeAt(3);\r\nconst codeBV = codes.charCodeAt(4);\r\nconst codeBR = codes.charCodeAt(5);\r\n\r\nexport abstract class Entity {\r\n    private jName: string;\r\n    schema: any;\r\n    ver: number = 0;\r\n    sys?: boolean;\r\n    readonly uq: UqMan;\r\n    readonly name: string;\r\n    readonly typeId: number;\r\n    readonly schemaLocal: LocalCache;\r\n    readonly uqApi: UqApi;\r\n    abstract get typeName(): string;\r\n    get sName():string {return this.jName || this.name}\r\n\tfields: Field[];\r\n    arrFields: ArrFields[];\r\n    returns: ArrFields[];\r\n\r\n    constructor(uq:UqMan, name:string, typeId:number) {\r\n        this.uq = uq;\r\n        this.name = name;\r\n        this.typeId = typeId;\r\n        this.sys = this.name.indexOf('$') >= 0;\r\n        this.schemaLocal = this.uq.localMap.item(this.name); // new EntityCache(this);\r\n        this.uqApi = this.uq.uqApi;\r\n    }\r\n\r\n    public face: any;           // 对应字段的label, placeHolder等等的中文，或者语言的翻译\r\n\r\n    //getApiFrom() {return this.entities.uqApi;}\r\n\r\n    private fieldMaps: {[arr:string]: FieldMap} = {};\r\n    fieldMap(arr?:string): FieldMap {\r\n        if (arr === undefined) arr = '$';\r\n        let ret = this.fieldMaps[arr];\r\n        if (ret === undefined) {\r\n            let fields:Field[];\r\n            if (arr === '$') fields = this.fields;\r\n            else if (this.arrFields !== undefined) {\r\n                let arrFields = this.arrFields.find(v => v.name === arr);\r\n                if (arrFields !== undefined) fields = arrFields.fields;\r\n            }\r\n            else if (this.returns !== undefined) {\r\n                let arrFields = this.returns.find(v => v.name === arr);\r\n                if (arrFields !== undefined) fields = arrFields.fields;\r\n            }\r\n            if (fields === undefined) return {};\r\n            ret = {};\r\n            for (let f of fields) ret[f.name] = f;\r\n            this.fieldMaps[arr] = ret;\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    public async loadSchema():Promise<void> {\r\n        if (this.schema !== undefined) return;\r\n        let schema = this.schemaLocal.get();\r\n        if (!schema) {\r\n            schema = await this.uq.loadEntitySchema(this.name);\r\n        }\r\n        //this.setSchema(schema);\r\n\t\t//this.buildFieldsTuid();\r\n\t\tthis.buildSchema(schema);\r\n\t\tawait this.loadValues();\r\n\t}\r\n\r\n\tbuildSchema(schema: any) {\r\n        this.setSchema(schema);\r\n\t\tthis.buildFieldsTuid();\r\n\t\t//await this.loadValues();\r\n\t}\r\n\t\r\n\tprotected async loadValues():Promise<any> {}\r\n\r\n    // 如果要在setSchema里面保存cache，必须先调用clearSchema\r\n    public clearSchema() {\r\n        this.schema = undefined;\r\n    }\r\n\r\n    public setSchema(schema:any) {\r\n        if (schema === undefined) return;\r\n        let {name, version} = schema;\r\n        this.ver = version || 0;\t\t\r\n\t\tthis.setJName(name);\r\n        this.schemaLocal.set(schema);\r\n\t\tthis.schema = schema;\r\n\t\tthis.buildFieldsTuid();\r\n\t}\r\n\t\r\n\tprotected setJName(name:string) {\r\n        if (name !== this.name) this.jName = name;\r\n\t}\r\n\r\n    public buildFieldsTuid() {\r\n        let {fields, arrs, returns} = this.schema;\r\n\t\tthis.fields = fields;\r\n        this.uq.buildFieldTuid(fields);\r\n\t\tthis.arrFields = arrs;\r\n        this.uq.buildArrFieldsTuid(arrs, fields);\r\n\t\tthis.returns = returns;\r\n        this.uq.buildArrFieldsTuid(returns, fields);\r\n    }\r\n\r\n    schemaStringify():string {\r\n        return JSON.stringify(this.schema, (key:string, value:any) => {\r\n            if (key === '_tuid') return undefined;\r\n            return value;\r\n        }, 4);\r\n    }\r\n\r\n    tuidFromName(fieldName:string, arrName?:string):Tuid {\r\n        if (this.schema === undefined) return;\r\n        let {fields, arrs} = this.schema;\r\n        let entities = this.uq;\r\n        function getTuid(fn:string, fieldArr:Field[]) {\r\n            if (fieldArr === undefined) return;\r\n            let f = fieldArr.find(v => v.name === fn);\r\n            if (f === undefined) return;\r\n            return entities.getTuid(f.tuid);\r\n        }\r\n        let fn = fieldName.toLowerCase();\r\n        if (arrName === undefined) return getTuid(fn, fields);\r\n        if (arrs === undefined) return;\r\n        let an = arrName.toLowerCase();\r\n        let arr = (arrs as ArrFields[]).find(v => v.name === an);\r\n        if (arr === undefined) return;\r\n        return getTuid(fn, arr.fields);\r\n    }\r\n\r\n    buildParams(params:any):any {\r\n        let result:any = {};\r\n        let fields = this.fields;\r\n        if (fields !== undefined) this.buildFieldsParams(result, fields, params);\r\n        let arrs = this.arrFields;\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                let {name, fields} = arr;\r\n                let paramsArr:any[] = params[name];\r\n                if (paramsArr === undefined) continue;\r\n                let arrResult:any[] = [];\r\n                result[name] = arrResult;\r\n                for (let pa of params) {\r\n                    let rowResult = {};\r\n                    this.buildFieldsParams(rowResult, fields, pa);\r\n                    arrResult.push(rowResult);\r\n                }\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n\r\n    private buildFieldsParams(result:any, fields:Field[], params:any) {\r\n        for (let field of fields) {\r\n            let {name, type} = field;            \r\n            let d = params[name];\r\n            let val:any;\r\n            switch (type) {\r\n\t\t\t\tcase 'datetime':\r\n                \tval = this.buildDateTimeParam(d);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'date':\r\n\t\t\t\t\tif (d instanceof Date) {\r\n\t\t\t\t\t\tval = `${d.getFullYear()}-${d.getMonth()+1}-${d.getDate()}`;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tval = d;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\tswitch (typeof d) {\r\n\t\t\t\t\t\tdefault: val = d; break;\r\n\t\t\t\t\t\tcase 'object':\r\n\t\t\t\t\t\t\tif (d instanceof Date) {\r\n\t\t\t\t\t\t\t\tval = d;\r\n\t\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tlet tuid = field._tuid;\r\n\t\t\t\t\t\t\tif (tuid === undefined) val = d.id;\r\n\t\t\t\t\t\t\telse val = tuid.getIdFromObj(d);\r\n\t\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tbreak;\r\n            }\r\n            result[name] = val;\r\n        }\r\n    }\r\n\r\n    buildDateTimeParam(val:any) {\r\n        let dt: Date;\r\n        switch (typeof val) {\r\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\r\n            case 'undefined': return undefined;\r\n            case 'object': dt = (val as Date); break;\r\n            case 'string':\r\n            case 'number': dt = new Date(val); break;\r\n        }\r\n        return Math.floor(dt.getTime()/1000);\r\n    }\r\n\r\n    buildDateParam(val:any) {\r\n        let dt: Date;\r\n        switch (typeof val) {\r\n            default: debugger; throw new Error('escape datetime field in pack data error: value=' + val);\r\n            case 'undefined': return '';\r\n            case 'string': return val;\r\n            case 'object': dt = (val as Date); break;\r\n            case 'number': dt = new Date(val); break;\r\n        }\r\n        let ret = dt.toISOString();\r\n        let p = ret.indexOf('T');\r\n        return p>0? ret.substr(0, p) : ret;\r\n    }\r\n\r\n    pack(data:any):string {\r\n        let ret:string[] = [];\r\n        let fields = this.fields;\r\n        if (fields !== undefined) this.packRow(ret, fields, data);\r\n        let arrs = this.arrFields; \r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n\t\t\t\tlet {name, fields} = arr;\r\n\t\t\t\tlet arrData = getObjPropIgnoreCase(data, name);\r\n\t\t\t\t//if (!arrData) arrData = data[name.toLowerCase()];\r\n                this.packArr(ret, fields, arrData);\r\n            }\r\n        }\r\n        return ret.join('');\r\n    }\r\n\r\n    private escape(row:any, field:Field):any {\r\n        let d = row[field.name];\r\n        if (d === null) return '';\r\n        switch (field.type) {\r\n            case 'datetime':\r\n                return this.buildDateTimeParam(d);\r\n            default:\r\n                switch (typeof d) {\r\n                    default: return d;\r\n                    case 'object':\r\n                        let tuid = field._tuid;\r\n                        if (tuid === undefined) return d.id;\r\n                        return tuid.getIdFromObj(d);\r\n                    case 'string':\r\n                        let len = d.length;\r\n                        let r = '', p = 0;\r\n                        for (let i=0;i<len;i++) {\r\n                            let c:number = d.charCodeAt(i), ch:string;\r\n                            switch(c) {\r\n\t\t\t\t\t\t\t\tdefault: continue;\r\n\t\t\t\t\t\t\t\tcase codeBackSlash: ch = '\\\\\\\\'; break;\r\n                                case codeBT: ch = '\\\\t'; break;\r\n\t\t\t\t\t\t\t\tcase codeBN: ch = '\\\\n'; break;\r\n\t\t\t\t\t\t\t\tcase codeBF: ch = '\\\\f'; break;\r\n\t\t\t\t\t\t\t\tcase codeBV: ch = '\\\\v'; break;\r\n\t\t\t\t\t\t\t\tcase codeBB: ch = '\\\\b'; break;\r\n\t\t\t\t\t\t\t\tcase codeBR: ch = '\\\\r'; break;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tr += d.substring(p, i) + ch;\r\n\t\t\t\t\t\t\tp = i+1;\r\n                        }\r\n                        return r + d.substring(p);\r\n                    case 'undefined': return '';\r\n                }\r\n        }\r\n    }\r\n\r\n    private packRow(result:string[], fields:Field[], data:any) {\r\n        let len = fields.length;\r\n        if (len === 0) {\r\n            result.push(ln);\r\n            return;\r\n        }\r\n        let ret = '';\r\n        ret += this.escape(data, fields[0]);\r\n        for (let i=1;i<len;i++) {\r\n            let f = fields[i];\r\n            ret += tab + this.escape(data, f);\r\n        }\r\n        result.push(ret + ln);\r\n    }\r\n\r\n    private packArr(result:string[], fields:Field[], data:any[]) {\r\n        if (data !== undefined) {\r\n\t\t\tif (data.length === 0) {\r\n\t\t\t\tresult.push(ln);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfor (let row of data) {\r\n\t\t\t\t\tthis.packRow(result, fields, row);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tresult.push(ln);\r\n\t\t}\r\n        result.push(ln);\r\n    }\r\n    protected cacheFieldsInValue(values:any, fields:Field[]) {\r\n        for (let f of fields as Field[]) {\r\n            let {name, _tuid} = f;\r\n            if (_tuid === undefined) continue;\r\n            let id = values[name];\r\n            //_tuid.useId(id);\r\n            values[name] = _tuid.boxId(id);\r\n        }\r\n    }\r\n\r\n    protected unpackTuidIdsOfFields(values:string[], fields: Field[]):any[] {\r\n        if (fields === undefined) {\r\n            return values as any[];\r\n        }\r\n        let ret:any[] = []\r\n        for (let ln of values) {\r\n            if (!ln) continue;\r\n            let len = ln.length;\r\n            let p = 0;\r\n            while (p<len) {\r\n                let ch = ln.charCodeAt(p);\r\n                if (ch === 10) {\r\n                    ++p;\r\n                    break;\r\n                }\r\n                let row = {};\r\n                p = this.unpackRow(row, fields, ln, p);\r\n                ret.push(row);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    unpackSheet(data:string):any {\r\n        let ret = {} as any; //new this.newMain();\r\n        //if (schema === undefined || data === undefined) return;\r\n        let fields = this.fields;\r\n        let p = 0;\r\n        if (fields !== undefined) p = this.unpackRow(ret, fields, data, p);\r\n        let arrs = this.arrFields; //schema['arrs'];\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                p = this.unpackArr(ret, arr, data, p);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n\tunpackReturns(data:string, returns?:ArrFields[]):{[name:string]:any[]} {\r\n\t\tif (data === undefined) debugger;\r\n\t\tlet ret = {} as any;\r\n\t\tlet p = 0;\r\n\t\tlet arrs = returns || this.returns;\r\n\t\tif (arrs !== undefined) {\r\n\t\t\tfor (let arr of arrs) {\r\n\t\t\t\tp = this.unpackArr(ret, arr, data, p);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn ret;\r\n\t}\r\n\r\n    protected unpackRow(ret:any, fields:Field[], data:string, p:number):number {\r\n        let ch0 = 0, ch = 0, c = p, i = 0, len = data.length, fLen = fields.length;\r\n        for (;p<len;p++) {\r\n            ch0 = ch;\r\n            ch = data.charCodeAt(p);\r\n            if (ch === 9) {\r\n                let f = fields[i];\r\n                let {name} = f;\r\n                if (ch0 !== 8) {\r\n                    if (p>c) {\r\n                        let v = data.substring(c, p);\r\n                        ret[name] = this.to(ret, v, f);\r\n                    }\r\n                }\r\n                else {\r\n                    ret[name] = null;\r\n                }\r\n                c = p+1;\r\n                ++i;\r\n                if (i>=fLen) {\r\n                    p = data.indexOf('\\n', c);\r\n                    if (p >= 0) ++p;\r\n                    else p = len;\r\n                    return p;\r\n                }\r\n            }\r\n            else if (ch === 10) {\r\n                let f = fields[i];\r\n                let {name} = f;\r\n                if (ch0 !== 8) {\r\n                    if (p>c) {\r\n                        let v = data.substring(c, p);\r\n                        ret[name] = this.to(ret, v, f);\r\n                    }\r\n                }\r\n                else {\r\n                    ret[name] = null;\r\n                }\r\n                ++p;\r\n                ++i;\r\n                return p;\r\n            }\r\n        }\r\n        let f = fields[i];\r\n        let {name} = f;\r\n        if (ch0 !== 8) {\r\n            let v = data.substring(c);\r\n            ret[name] = this.to(ret, v, f);\r\n        }\r\n        return len;\r\n    }\r\n\r\n    private to(ret:any, v:string, f:Field):any {\r\n        switch (f.type) {\r\n\t\t\tdefault: return v;\r\n\t\t\tcase 'text':\r\n\t\t\tcase 'char':\r\n\t\t\t\treturn this.reverseNT(v);\r\n            case 'datetime':\r\n            case 'time':\r\n\t\t\tcase 'timestamp':\r\n                let n = Number(v);\r\n                let date = isNaN(n) === true? new Date(v) : new Date(n*1000);\r\n                return date;\r\n            case 'date':\r\n                let parts = v.split('-');\r\n                return new Date(Number(parts[0]), Number(parts[1])-1, Number(parts[2]));\r\n            case 'tinyint':\r\n            case 'smallint':\r\n            case 'int':\r\n            case 'bigint':\r\n            case 'dec':\r\n\t\t\tcase 'float':\r\n\t\t\tcase 'double':\r\n                return Number(v);\r\n            case 'id':\r\n                let id = Number(v);\r\n                let {_tuid} = f;\r\n                if (_tuid === undefined) return id;\r\n                return _tuid.boxId(id);\r\n        }\r\n\t}\r\n\t\r\n\tprivate reverseNT(text:string):string {\r\n\t\tif (text === undefined) return;\r\n\t\tif (text === null) return;\r\n\t\tlet len = text.length;\r\n\t\tlet r = '';\r\n\t\tlet p = 0;\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet c = text.charCodeAt(i);\r\n\t\t\tif (c === codeBackSlash) {\r\n\t\t\t\tif (i===len-1) break;\r\n\t\t\t\tlet c1 = text.charCodeAt(i+1);\r\n\t\t\t\tlet ch:string;\r\n\t\t\t\tswitch (c1) {\r\n\t\t\t\t\tdefault: continue;\r\n\t\t\t\t\tcase codeBackSlash: ch = '\\\\'; break;\r\n\t\t\t\t\tcase codeN: ch = '\\n'; break;\r\n\t\t\t\t\tcase codeT: ch = '\\t'; break;\r\n\t\t\t\t\tcase codeB: ch = '\\b'; break;\r\n\t\t\t\t\tcase codeF: ch = '\\f'; break;\r\n\t\t\t\t\tcase codeV: ch = '\\v'; break;\r\n\t\t\t\t\tcase codeR: ch = '\\r'; break;\r\n\t\t\t\t}\r\n\t\t\t\tr += text.substring(p, i) + ch;\r\n\t\t\t\tp = i+2;\r\n\t\t\t\t++i;\r\n\t\t\t}\r\n\t\t}\r\n\t\tr += text.substring(p, len);\r\n\t\treturn r;\r\n\t}\r\n\r\n    private unpackArr(ret:any, arr:ArrFields, data:string, p:number):number {\r\n\t\tlet p0 = p;\r\n        let vals:any[] = [], len = data.length;\r\n        let {name, fields} = arr;\r\n        while (p<len) {\r\n            let ch = data.charCodeAt(p);\r\n            if (ch === 10) {\r\n\t\t\t\tif (p === p0) {\r\n\t\t\t\t\tch = data.charCodeAt(p);\r\n\t\t\t\t\tif (ch !== 10) {\r\n\t\t\t\t\t\tthrow new Error('upackArr: arr第一个字符是10，则必须紧跟一个10，表示整个arr的结束')\r\n\t\t\t\t\t}\r\n\t\t\t\t\t++p;\r\n\t\t\t\t}\r\n                ++p;\r\n                break;\r\n            }\r\n            let val = {} as any; //new creater();\r\n            vals.push(val);\r\n            p = this.unpackRow(val, fields, data, p);\r\n        }\r\n        ret[name] = vals;\r\n        return p;\r\n    }\r\n}\r\n","//import _ from 'lodash';\r\nimport { Caller } from '../net';\r\nimport { Entity } from './entity';\r\nimport { Action } from './action';\r\nimport { Query } from './query';\r\n\r\ninterface UqResponseSchema {\r\n    uq: any;\r\n    entity: any;\r\n}\r\n\r\nexport abstract class EntityCaller<T> extends Caller<T> {\r\n    private tries: number;\r\n    protected _entity: Entity;\r\n\r\n    constructor(entity: Entity, params:T, $$user:number = undefined, waiting: boolean = true) {\r\n        super(params, $$user, waiting);\r\n        this.tries = 0;\r\n        this._entity = entity;\r\n    }\r\n\r\n    protected get entity(): Entity {return this._entity;}\r\n\r\n    //大多的entityCaller都不需要这个\r\n    //buildParams() {return this.entity.buildParams(this.params);}\r\n    \r\n    async request(): Promise<any> {\r\n        await this.entity.loadSchema();\r\n        let ret = await this.innerRequest();\r\n        return ret;\r\n    }\r\n\r\n    protected async innerCall(): Promise<any> {\r\n        return await this.entity.uqApi.xcall(this);\r\n    }\r\n\r\n    async innerRequest(): Promise<any> {\r\n        let jsonResult = await this.innerCall();\r\n        let {$uq, $modify, res} = jsonResult;\r\n        this.entity.uq.pullModify($modify);\r\n        if ($uq === undefined) {\r\n            let ret = this.xresult(res);\r\n            return ret;\r\n        }\r\n        return await this.retry($uq);\r\n    }\r\n\r\n    xresult(res:any):any {return res}\r\n\r\n    get headers(): {[header:string]: string} {\r\n        let {ver, uq} = this.entity;\r\n        let {uqVersion} = uq;\r\n        return {\r\n            uq: `${uqVersion}`,\r\n            en: `${ver}`,\r\n        }\r\n    }\r\n\r\n    private async retry(schema: UqResponseSchema) {\r\n        ++this.tries;\r\n        if (this.tries > 5) throw new Error('can not get right uq response schema, 5 tries');\r\n        this.rebuildSchema(schema);\r\n        return await this.innerRequest();\r\n    }\r\n\r\n    private rebuildSchema(schema: UqResponseSchema) {\r\n        let {uq, entity} = schema;\r\n        if (uq !== undefined) {\r\n\t\t\tthis.entity.uq.buildEntities(uq);\r\n\t\t}\r\n        if (entity !== undefined) {\r\n\t\t\tthis.entity.setSchema(entity);\r\n\t\t}\r\n    }\r\n}\r\n\r\nexport abstract class ActionCaller extends EntityCaller<any> {\r\n    protected get entity(): Action {return this._entity as Action;}\r\n}\r\n\r\nexport class QueryQueryCaller extends EntityCaller<any> {\r\n    protected get entity(): Query {return this._entity as Query};\r\n    get path():string {return `query/${this.entity.name}`;}\r\n    xresult(res:any) {\r\n        let data = this.entity.unpackReturns(res);\r\n        return data;\r\n    }\r\n    buildParams() {return this.entity.buildParams(this.params);}\r\n}\r\n\r\nexport class QueryPageCaller extends EntityCaller<any> {\r\n    protected get params(): {pageStart:any; pageSize:number, params:any} {return this._params};\r\n\tprotected get entity(): Query {return this._entity as Query};\r\n\t//results: {[name:string]:any[]};\r\n\tget path():string {return `query-page/${this.entity.name}`;}\t\r\n    buildParams() {\r\n        let {pageStart, pageSize, params} = this.params;\r\n        let p:any;\r\n        if (params === undefined) {\r\n            p = {key: ''};\r\n        }\r\n        else {\r\n            p = this.entity.buildParams(params);\r\n        }\r\n        /*\r\n        switch (typeof params) {\r\n            case 'undefined': p = {key: ''}; break;\r\n            default: p = _.clone(params); break;\r\n        }\r\n        */\r\n        p['$pageStart'] = pageStart;\r\n        p['$pageSize'] = pageSize;\r\n        return p;\r\n    };\r\n    xresult(res:any): {[name:string]:any[]} {\r\n        let ret = this.entity.unpackReturns(res);\r\n\t\t//return this.results.$page;// as any[];\r\n\t\treturn ret;\r\n    }\r\n}\r\n","import { action, isObservableMap, makeObservable, observable, ObservableMap } from 'mobx';\r\nimport _ from 'lodash';\r\nimport { LocalArr } from '../../tool';\r\nimport { BoxId } from './boxId';\r\nimport { TuidInner, TuidDiv } from './tuid';\r\n\r\nconst maxCacheSize = 10000;\r\n\r\nexport class IdCache {\r\n    private queue: number[] = [];                   // 每次使用，都排到队头\r\n\tcache = new Map();    // 已经缓冲的\r\n\r\n    protected localArr:LocalArr;\r\n    protected waitingIds: number[] = [];          // 等待loading的\r\n    protected tuidInner: TuidInner;\r\n\r\n    constructor(tuidLocal: TuidInner) {\r\n        makeObservable(this, {\r\n            cache: observable.shallow,\r\n            cacheSet: action,\r\n        });\r\n        this.tuidInner = tuidLocal;\r\n        this.initLocalArr();\r\n    }\r\n\r\n    protected initLocalArr() {\r\n        this.localArr = this.tuidInner.schemaLocal.arr(this.tuidInner.name + '.ids');\r\n    }\r\n\r\n    cacheSet(id:number, val:any) {\r\n        this.cache.set(id, val);\r\n    }\r\n\r\n    useId(id:number, defer?:boolean) {\r\n        if (!id) return;\r\n        if (typeof id !== 'number') {\r\n\t\t\tconsole.error('id cache ' + id + ' is not number');\r\n\t\t\treturn;\r\n\t\t}\r\n        if (this.cache.has(id) === true) {\r\n            this.moveToHead(id);\r\n            return;\r\n        }\r\n        this.tuidInner.cacheTuids(defer===true?70:20);\r\n        if (this.waitingIds.findIndex(v => v === id) >= 0) {\r\n            this.moveToHead(id);\r\n            return;\r\n        }\r\n\r\n        if (this.queue.length >= maxCacheSize) {\r\n            // 缓冲已满，先去掉最不常用的\r\n            let r = this.queue.shift();\r\n            if (r === id) {\r\n                // 如果移除的，正好是现在用的，则插入\r\n                this.queue.push(r);\r\n                return;\r\n            }\r\n\r\n            if (this.cache.has(r) === true) {\r\n                // 如果移除r已经缓存\r\n                this.cache.delete(r);\r\n            }\r\n            else {\r\n                // 如果移除r还没有缓存\r\n                let index = this.waitingIds.findIndex(v => v === r);\r\n                this.waitingIds.splice(index, 1);\r\n            }\r\n        }\r\n        this.waitingIds.push(id);\r\n        this.queue.push(id);\r\n\t\treturn;\r\n    }\r\n\r\n    private moveToHead(id:number) {\r\n        let index = this.queue.findIndex(v => v === id);\r\n        this.queue.splice(index, 1);\r\n        this.queue.push(id);\r\n    }\r\n\r\n    getValue(id:number) {\r\n\t\treturn this.cache.get(id);\r\n    }\r\n\r\n    remove(id:number) {\r\n        this.cache.delete(id);\r\n        let index = this.queue.findIndex(v => v === id);\r\n\t\tthis.queue.splice(index, 1);\r\n\t\tthis.localArr.removeItem(id);\r\n    }\r\n\r\n    valueFromId(id:number|BoxId):any {\r\n        let _id:number;\r\n        switch (typeof id) {\r\n            case 'object': _id = (id as BoxId).id; break;\r\n            case 'number': _id = id as number; break;\r\n            default: return;\r\n        }\r\n        return this.getValue(_id);\r\n    }\r\n\r\n    resetCache(id:number) {\r\n        this.remove(id);\r\n        this.useId(id);\r\n    }\r\n\r\n    cacheValue(val:any):boolean {\r\n        if (val === undefined) return false;\r\n        let id = this.getIdFromObj(val);\r\n        if (id === undefined) return false;\r\n        this.cacheSet(id, val);\r\n        return true;\r\n    }\r\n    protected getIdFromObj(val:any) {return this.tuidInner.getIdFromObj(val)}\r\n\r\n    async cacheIds():Promise<void> {\r\n\t\tlet tuidValues = await this.loadIds();\r\n        this.cacheIdValues(tuidValues);\r\n    }\r\n\r\n    protected cacheIdValues(tuidValues: any[]) {\r\n        if (tuidValues === undefined) return;\r\n        let tuids = this.unpackTuidIds(tuidValues);\r\n        for (let tuidValue of tuids) {\r\n            if (this.cacheValue(tuidValue) === true) {\r\n                this.cacheTuidFieldValues(tuidValue);\r\n            }\r\n        }\r\n    }\r\n    async modifyIds(ids:any[]):Promise<void> {\r\n        let tuidValues:string[] = await this.loadTuidIdsOrLocal(ids);\r\n        let localedValues = tuidValues.filter(v => {\r\n            let p = v.indexOf('\\t');\r\n            if (p<0) p = v.length;\r\n            let id = Number(v.substr(0, p));\r\n            let val = this.localArr.getItem(id);\r\n            return (val !== undefined);\r\n        });\r\n        if (localedValues.length === 0) return;\r\n        this.cacheIdValues(localedValues);\r\n    }\r\n    protected async loadIds(): Promise<any[]> {\r\n\t\tif (this.waitingIds.length === 0) return;\r\n\t\tlet loadingIds = [...this.waitingIds];\r\n\t\tthis.waitingIds = [];\r\n\t\treturn await this.loadTuidIdsOrLocal(loadingIds);\r\n    }\r\n    protected unpackTuidIds(values:string[]):any[] {\r\n        return this.tuidInner.unpackTuidIds(values);\r\n    }\r\n    protected cacheTuidFieldValues(tuidValue: any) {\r\n        this.tuidInner.cacheTuidFieldValues(tuidValue);\r\n    }\r\n\r\n    async assureObj(id:number):Promise<void> {\r\n        let val = this.cache.get(id);\r\n        if (val !== undefined) return val;\r\n        /*\r\n        switch (typeof val) {\r\n            case 'object': return val;\r\n            // case 'number': this.cache.set(id, undefined); break;\r\n        }\r\n        */\r\n        let ret = await this.loadTuidIdsOrLocal([id]);\r\n        this.cacheIdValues(ret);\r\n    }\r\n\r\n\tprotected async loadValuesFromIds(netIds: number[]):Promise<any[]> {\r\n\t\tlet netRet = await this.tuidInner.loadValuesFromIds(undefined, netIds);\r\n\t\treturn netRet;\r\n\t}\r\n\r\n    private async loadTuidIdsOrLocal(ids:number[]):Promise<string[]> {\r\n        let ret:string[] = [];        \r\n        let netIds:number[] = [];\r\n        for (let id of ids) {\r\n            let value = this.localArr.getItem(id);\r\n            //if (value === undefined)\r\n            // 值不存在或者是空字符串，重新获取\r\n            if (!value)\r\n                netIds.push(id);\r\n            else\r\n                ret.push(value);\r\n        }\r\n        let len = netIds.length;\r\n        if (len === 0) return ret;\r\n\r\n\t\tlet netRet = await this.loadValuesFromIds(netIds);\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t//有些id可能没有内容，不会返回\r\n\t\t\t//let id = netIds[i]; \r\n\t\t\tlet row:string = netRet[i];\r\n\t\t\tif (!row) continue;\r\n\t\t\tlet p = row.indexOf('\\t');\r\n\t\t\tif (p < 0) p = row.length;\r\n\t\t\tlet id = Number(row.substr(0, p));\r\n\t\t\t_.remove(netIds, v => v === id);\r\n\t\t\tret.push(row);\r\n\t\t\tthis.localArr.setItem(id, row);\r\n\t\t}\r\n\t\tlen = netIds.length;\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tthis.localArr.setItem(netIds[i], '');\r\n\t\t}\r\n        return ret;\r\n    }\r\n}\r\n\r\nexport class IdDivCache extends IdCache {\r\n    private div: TuidDiv;\r\n    protected divName:string;\r\n\r\n    constructor(tuidLocal:TuidInner, div: TuidDiv) {\r\n        super(tuidLocal);\r\n        this.div = div;\r\n        this.divName = div.name;\r\n        this.localArr = tuidLocal.schemaLocal.arr(tuidLocal.name + '.ids.' + this.divName);\r\n    }\r\n\r\n    protected initLocalArr() {\r\n        // 这个不需要，必须去掉\r\n        // this.localArr = this.tuidInner.cache.arr(this.tuidInner.name + '.ids');\r\n    }\r\n\r\n    protected getIdFromObj(val:any) {return this.div.getIdFromObj(val)}\r\n    protected unpackTuidIds(values:string[]):any[] {\r\n        return this.div.unpackTuidIds(values);\r\n    }\r\n    protected cacheTuidFieldValues(tuidValue: any) {\r\n        this.div.cacheTuidFieldValues(tuidValue);\r\n    }\r\n\tprotected async loadValuesFromIds(netIds: number[]):Promise<any[]> {\r\n\t\tlet netRet = await this.tuidInner.loadValuesFromIds(this.divName, netIds);\r\n\t\treturn netRet;\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { BoxId } from './boxId';\r\nimport { Tuid } from './tuid';\r\nimport { observer } from 'mobx-react';\r\n\r\nconst TuidContent = (tuidName:string, values:any, x?:any) => {\r\n    return <>{tuidName}: {uqStringify(values)}</>;\r\n};\r\n\r\nexport function uqStringify(values: any): string {\r\n    let s = '{';\r\n    if (values === undefined) return 'undefined';\r\n    for (let i in values) {\r\n        let v = values[i];\r\n        s += i + ': ';\r\n        if (v === undefined) {\r\n            s += 'undefined';\r\n        }\r\n        else if (v === null) {\r\n            s += 'null';\r\n        }\r\n        else {\r\n            switch (typeof v) {\r\n                default:\r\n                    s += v;\r\n                    break;\r\n                case 'function':\r\n                    s += 'function';\r\n                    break;\r\n                case 'object':\r\n                    s += '{obj}';\r\n                    break;\r\n            }\r\n        }\r\n        s += ', ';\r\n    }\r\n    return s + '}';\r\n}\r\n\r\nexport class ReactBoxId implements BoxId {\r\n    readonly id: number;\r\n    protected tuid: Tuid;\r\n    protected ui: (values:any) => JSX.Element;\r\n    readonly isUndefined:boolean;\r\n    constructor(id: number, tuid: Tuid, ui: (values:any) => JSX.Element) {\r\n        this.id = Number(id);\r\n        this.tuid = tuid;\r\n        this.ui = ui;\r\n        this.isUndefined = (this.tuid === undefined);\r\n    }\r\n\r\n    get obj():any {\r\n        return this.tuid.valueFromId(this.id);\r\n    }\r\n\r\n    equ(id:BoxId|number): boolean {\r\n        if (id === undefined || id === null) return false;\r\n        if (typeof id === 'object') return this.id === id.id;\r\n        return this.id === id;\r\n    }\r\n\r\n    render(ui:TvTemplet, x:any):JSX.Element {\r\n        if (this.id === undefined || this.id === null || isNaN(this.id) === true) return;\r\n        let boxName = this.boxName; // this.tuid.name;\r\n        let val = this.obj; // this.tuid.valueFromId(this.id);\r\n        if (this.isUndefined === true) {\r\n            if (ui !== undefined) return ui(val, x);\r\n            return TuidContent(boxName, val, x);\r\n        }\r\n        switch (typeof val) {\r\n            case 'undefined':\r\n                return <span className=\"text-black-50\">{boxName} undefined</span>;\r\n            case 'number':\r\n                return <span className=\"text-light\">{boxName} {this.id}</span>;\r\n        }\r\n        if (ui === undefined) {\r\n            ui = this.ui;\r\n        }\r\n        if (ui !== undefined) {\r\n            if (typeof ui !== 'function') {\r\n                ui = (ui as any).content;\r\n            }\r\n            if (ui !== undefined) {\r\n                let ret = ui(val/*, this.tuidUR.res*/);\r\n                if (ret !== undefined) return ret;\r\n                return <span className=\"text-danger\">{boxName} {this.id}</span>;\r\n            }\r\n        }\r\n\r\n        return TuidContent(boxName, val);\r\n    }\r\n\r\n    get boxName():string {return this.tuid.name}\r\n    // ui(): TvTemplet {return this.tuid.ui}\r\n    // res(): any {return this.tuid.res}\r\n\r\n    async assure(): Promise<BoxId> {\r\n        await this.tuid.assureBox(this.id);\r\n        return this;\r\n    }\r\n}\r\n\r\nfunction boxIdContent(bi: number|BoxId, ui:TvTemplet, x:any) {\r\n    let logContent:any;\r\n    let boxId:ReactBoxId = bi as ReactBoxId;\r\n    switch(typeof bi) {\r\n        case 'undefined': logContent = <>boxId undefined</>; break;\r\n        case 'number': logContent = <>id:{bi}</>; break;\r\n        default:\r\n            if (typeof boxId.render !== 'function') {\r\n                if (ui === undefined) {\r\n                    logContent = TuidContent(boxId.boxName, bi, x);\r\n                }\r\n                else {\r\n                    return ui(bi, x);\r\n                }\r\n            }\r\n            break;\r\n    }\r\n    if (logContent !== undefined) {\r\n        return <del className=\"text-danger\">{logContent}</del>;\r\n    }\r\n    return boxId.render(ui, x);\r\n}\r\n\r\nexport type TvTemplet = (values?:any, x?:any) => JSX.Element;\r\n\r\ninterface Props {\r\n    tuidValue: number|BoxId, \r\n    ui?: TvTemplet,\r\n    x?: any,\r\n    nullUI?: ()=>JSX.Element\r\n}\r\n\r\nconst Tv = observer(({tuidValue, ui, x, nullUI}:Props) => {\r\n    if (tuidValue === undefined) {\r\n        if (nullUI === undefined) return <small className=\"text-muted\">[无]</small>;\r\n        return nullUI();\r\n    }\r\n    if (tuidValue === null) {\r\n        if (nullUI === undefined) return <>[null]</>;\r\n        return nullUI();\r\n    }\r\n    let ttv = typeof tuidValue;\r\n    switch (ttv) {\r\n        default:\r\n            if (ui === undefined)\r\n                return <>{ttv}-{tuidValue}</>;\r\n            else {\r\n                let ret = ui(tuidValue, x);\r\n                if (ret !== undefined) return ret;\r\n                return <>{tuidValue}</>;\r\n            }\r\n        case 'object':\r\n            let divObj = boxIdContent(tuidValue, ui, x);\r\n            if (divObj !== undefined) return divObj;\r\n            return nullUI === undefined? <>id null</>: nullUI();\r\n        case 'number':\r\n            return <>id...{tuidValue}</>;\r\n    }\r\n});\r\n\r\nexport const tv = (tuidValue:number|BoxId, ui?:TvTemplet, x?:any, nullUI?:()=>JSX.Element):JSX.Element => {\r\n    return <Tv tuidValue={tuidValue} ui={ui} x={x} nullUI={nullUI} />;\r\n};\r\n","import { UqApi, UqData, UnitxApi } from '../net';\r\nimport { Tuid, TuidDiv, TuidImport, TuidInner, TuidBox, TuidsCache } from './tuid';\r\nimport { Action } from './action';\r\nimport { Sheet } from './sheet';\r\nimport { Query } from './query';\r\nimport { Book } from './book';\r\nimport { History } from './history';\r\nimport { Map } from './map';\r\nimport { Pending } from './pending';\r\nimport { CreateBoxId, BoxId } from './tuid';\r\nimport { LocalMap, LocalCache, env, capitalCase } from '../tool';\r\nimport { UQsMan } from './uqsMan';\r\nimport { ReactBoxId } from './tuid/reactBoxId';\r\nimport { UqEnum } from './enum';\r\nimport { Entity } from './entity';\r\nimport { UqConfig } from '../appConfig';\r\nimport { ID, IX, IDX } from './ID';\r\n//import { nav } from '../components';\r\nimport { IDCache } from './IDCache';\r\nimport React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { Web } from '../web';\r\n\r\nexport type FieldType = 'id' | 'tinyint' | 'smallint' | 'int' | 'bigint' | 'dec' | 'float' | 'double' | 'char' | 'text'\r\n    | 'datetime' | 'date' | 'time' | 'timestamp';\r\n\r\nexport function fieldDefaultValue(type:FieldType) {\r\n    switch (type) {\r\n        case 'tinyint':\r\n        case 'smallint':\r\n        case 'int':\r\n        case 'bigint':\r\n        case 'dec':\r\n\t\tcase 'float':\r\n\t\tcase 'double':\r\n            return 0;\r\n        case 'char':\r\n        case 'text':\r\n            return '';\r\n        case 'datetime':\r\n        case 'date':\r\n            return '2000-1-1';\r\n        case 'time':\r\n            return '0:00';\r\n    }\r\n}\r\n\r\nexport interface Field {\r\n    name: string;\r\n    type: FieldType;\r\n    tuid?: string;\r\n    arr?: string;\r\n    null?: boolean;\r\n    size?: number;\r\n    owner?: string;\r\n    _tuid?: TuidBox;\r\n}\r\nexport interface ArrFields {\r\n    name: string;\r\n    fields: Field[];\r\n    id?: string;\r\n    order?: string;\r\n}\r\nexport interface FieldMap {\r\n    [name:string]: Field;\r\n}\r\nexport interface SchemaFrom {\r\n    owner:string;\r\n    uq:string;\r\n}\r\nexport interface TuidModify {\r\n    max: number;\r\n    seconds: number;\r\n}\r\n\r\ninterface ParamPage {\r\n\tstart:number;\r\n\tend?: number;\r\n\tsize:number;\r\n}\r\n\r\nexport interface ParamActIX<T> {\r\n\tIX: IX;\r\n\tID?: ID;\r\n\tIXs?:{IX:IX, ix:number}[];\t\t\t\t// 一次写入多个IX\r\n\tvalues: {ix:number, xi:number|T}[];\r\n}\r\n\r\nexport interface ParamActIXSort {\r\n\tIX: IX;\r\n\tix: number;\r\n\tid: number;\t\t\t\t\t// id to be moved\r\n\tafter: number;\t\t\t\t// insert after id. if before first, then 0\r\n}\r\n\r\nexport interface ParamActDetail<M,D> {\r\n\tmain: {\r\n\t\tID: ID;\r\n\t\tvalue: M;\r\n\t};\r\n\tdetail: {\r\n\t\tID: ID;\r\n\t\tvalues: D[];\r\n\t};\r\n}\r\n\r\nexport interface RetActDetail {\r\n\tmain: number;\r\n\tdetail: number[];\r\n}\r\n\r\nexport interface ParamActDetail2<M,D,D2> extends ParamActDetail<M, D> {\r\n\tdetail2: {\r\n\t\tID: ID;\r\n\t\tvalues: D2[];\r\n\t};\r\n}\r\n\r\nexport interface RetActDetail2 extends RetActDetail {\r\n\tdetail2: number[];\r\n}\r\n\r\nexport interface ParamActDetail3<M,D,D2,D3> extends ParamActDetail2<M, D, D2> {\r\n\tdetail3: {\r\n\t\tID: ID;\r\n\t\tvalues: D3[];\r\n\t};\r\n}\r\n\r\nexport interface RetActDetail3 extends RetActDetail2 {\r\n\tdetail3: number[];\r\n}\r\n\r\nexport interface ParamQueryID {\r\n\tID?: ID;\r\n\tIX?: (IX|string)[];\r\n\tIDX?: (ID|IDX)[];\r\n\tid?: number | number[];\r\n\tkey?: {[key:string]:string|number};\r\n\tix?: number;\r\n\tidx?: number | number[];\r\n\tkeyx?: {[key:string]:string|number};\r\n\tpage?: ParamPage;\r\n\torder?: 'desc'|'asc';\r\n}\r\n\r\nexport interface ParamIDNO {\r\n\tID: ID;\r\n}\r\n\r\nexport interface ParamIDDetailGet {\r\n\tid: number;\r\n\tmain: ID;\r\n\tdetail: ID;\r\n\tdetail2?: ID;\r\n\tdetail3?: ID;\r\n}\r\n\r\nexport interface ParamID {\r\n\tIDX: (ID|IDX) | (ID|IDX)[];\r\n\tid: number | number[];\r\n\torder?: 'asc' | 'desc',\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamKeyID {\r\n\tID: ID;\r\n\tIDX?: (ID|IDX)[];\r\n\tIX?: IX[];\r\n\tkey: {[key:string]:string|number};\r\n\tix?: number;\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamIX {\r\n\tIX: IX;\r\n\tIX1?: IX;\r\n\tix: number | number[];\r\n\tIDX?: (ID|IDX)[];\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamKeyIX {\r\n\tID: ID;\r\n\tkey: {[key:string]:string|number};\r\n\tIX: IX;\r\n\tIDX?: (ID|IDX)[];\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamIDLog {\r\n\tIDX: (ID|IDX);\r\n\tfield: string;\r\n\tid: number;\r\n\tlog: 'each' | 'day' | 'week' | 'month' | 'year';\r\n\ttimeZone?: number;\r\n\tfar?: number;\r\n\tnear?: number;\r\n\tpage: ParamPage;\r\n}\r\n\r\nexport interface ParamIDSum {\r\n\tIDX: IDX;\r\n\tfield: string[];\r\n\tid: number|number[];\r\n\tfar?: number;\t\t\t\t// 以前\r\n\tnear?: number;\t\t\t\t// 最近\r\n}\r\n\r\nexport interface ParamIDxID {\r\n\tID: ID;\r\n\tIX: IX;\r\n\tID2: ID;\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface IDXValue {\r\n\tvalue: number;\r\n\ttime?: number|Date;\r\n\tsetAdd: '='|'+';\r\n}\r\n\r\nexport interface ParamIDinIX {\r\n\tID: ID;\r\n\tid: number;\r\n\tIX: IX;\r\n\tpage?: ParamPage;\r\n}\r\n\r\nexport interface ParamIDTree {\r\n\tID: ID;\r\n\tparent: number;\r\n\tkey: string|number;\r\n\tlevel?: number;\t\t\t\t// 无值，默认1一级\r\n\tpage?: ParamPage;\r\n}\r\n\r\nfunction IDPath(path:string):string {return path;}\r\nenum EnumResultType {data, sql};\r\n\r\nexport interface Uq {\r\n\tgetAdmins(): Promise<{id:number; role:number}[]>;\r\n\t$: UqMan;\t\r\n\tActs(param:any): Promise<any>;\r\n\t$Acts(param:any): Promise<string>;\r\n\tActIX<T>(param: ParamActIX<T>): Promise<number[]>;\r\n\t$ActIX<T>(param: ParamActIX<T>): Promise<string>;\r\n\tActIXSort(param: ParamActIXSort): Promise<void>;\r\n\t$ActIXSort(param: ParamActIXSort): Promise<string>;\r\n\tActDetail<M,D>(param: ParamActDetail<M,D>): Promise<RetActDetail>;\r\n\t$ActDetail<M,D>(param: ParamActDetail<M,D>): Promise<string>;\r\n\tActDetail<M,D,D2>(param: ParamActDetail2<M,D,D2>): Promise<RetActDetail2>;\r\n\t$ActDetail<M,D,D2>(param: ParamActDetail2<M,D,D2>): Promise<string>;\r\n\tActDetail<M,D,D2,D3>(param: ParamActDetail3<M,D,D2,D3>): Promise<RetActDetail3>;\r\n\t$ActDetail<M,D,D2,D3>(param: ParamActDetail3<M,D,D2,D3>): Promise<string>;\r\n\tQueryID<T>(param: ParamQueryID): Promise<T[]>;\r\n\t$QueryID<T>(param: ParamQueryID): Promise<string>;\r\n\tIDNO(param: ParamIDNO): Promise<string>;\r\n\t$IDNO(param: ParamIDNO): Promise<string>;\r\n\tIDDetailGet<M,D>(param: ParamIDDetailGet): Promise<[M[], D[]]>;\r\n\t$IDDetailGet<M,D>(param: ParamIDDetailGet): Promise<string>;\r\n\tIDDetailGet<M,D,D2>(param: ParamIDDetailGet): Promise<[M[], D[], D2[]]>;\r\n\t$IDDetailGet<M,D,D2>(param: ParamIDDetailGet): Promise<string>;\r\n\tIDDetailGet<M,D,D2,D3>(param: ParamIDDetailGet): Promise<[M[], D[], D2[], D3[]]>;\r\n\t$IDDetailGet<M,D,D2,D3>(param: ParamIDDetailGet): Promise<string>;\r\n\tID<T>(param: ParamID): Promise<T[]>;\r\n\t$ID<T>(param: ParamID): Promise<string>;\r\n\tKeyID<T>(param: ParamKeyID): Promise<T[]>;\r\n\t$KeyID<T>(param: ParamKeyID): Promise<string>;\r\n\tIX<T>(param: ParamIX): Promise<T[]>;\r\n\t$IX<T>(param: ParamIX): Promise<string>;\r\n\tIXr<T> (param: ParamIX): Promise<T[]>; // IX id 反查IX list\r\n\t$IXr<T> (param: ParamIX): Promise<string>; // IX id 反查IX list\r\n\tKeyIX<T>(param: ParamKeyIX): Promise<T[]>;\r\n\t$KeyIX<T>(param: ParamKeyIX): Promise<string>;\r\n\tIDLog<T> (param: ParamIDLog): Promise<T[]>;\r\n\t$IDLog<T> (param: ParamIDLog): Promise<string>;\r\n\tIDSum<T> (param: ParamIDSum): Promise<T[]>;\r\n\t$IDSum<T> (param: ParamIDSum): Promise<string>;\r\n\tIDxID<T,T2> (param: ParamIDxID): Promise<[T[],T2[]]>; // ID list with IX 对应的子集\r\n\t$IDxID<T,T2> (param: ParamIDxID): Promise<string>; // ID list with IX 对应的子集\r\n\tIDinIX<T>(param:ParamIDinIX): Promise<T&{$in:boolean}[]>;\r\n\t$IDinIX<T>(param:ParamIDinIX): Promise<string>;\r\n\tIDTree<T>(param:ParamIDTree): Promise<T[]>;\r\n\t$IDTree<T>(param:ParamIDTree): Promise<string>;\r\n\r\n\tIDTv(ids: number[]): Promise<any[]>;\r\n\tIDRender(id: number, render?:(value:any) => JSX.Element): JSX.Element;\r\n\tIDV<T>(id: number): T;\r\n\r\n\tIDLocalTv(ids: number[]): Promise<any[]>;\r\n\tIDLocalRender(id: number, render?:(value:any) => JSX.Element): JSX.Element;\r\n\tIDLocalV<T>(id: number): T;\r\n}\r\n\r\nexport class UqMan {\r\n\tprivate readonly entities: {[name:string]: Entity} = {};\r\n\tprivate readonly enums: {[name:string]: UqEnum} = {};\r\n\tprivate readonly actions: {[name:string]: Action} = {};\r\n    private readonly queries: {[name:string]: Query} = {};\r\n\tprivate readonly ids: {[name:string]: ID} = {};\r\n\tprivate readonly idxs: {[name:string]: IDX} = {};\r\n\tprivate readonly ixs: {[name:string]: IX} = {};\r\n\r\n    private readonly sheets: {[name:string]: Sheet} = {};\r\n    private readonly books: {[name:string]: Book} = {};\r\n    private readonly maps: {[name:string]: Map} = {};\r\n    private readonly histories: {[name:string]: History} = {};\r\n\tprivate readonly pendings: {[name:string]: Pending} = {};\r\n    private readonly tuidsCache: TuidsCache;\r\n    private readonly localEntities: LocalCache;\r\n    private readonly tvs:{[entity:string]:(values:any)=>JSX.Element};\r\n\tprivate idCache: IDCache;\r\n\tproxy: any;\r\n    readonly localMap: LocalMap;\r\n    readonly localModifyMax: LocalCache;\r\n    readonly tuids: {[name:string]: Tuid} = {};\r\n    readonly createBoxId: CreateBoxId;\r\n    readonly newVersion: boolean;\r\n    readonly uqOwner: string;\r\n    readonly uqName: string;\r\n    readonly name: string;\r\n    readonly uqApi: UqApi;\r\n\treadonly id: number;\r\n\treadonly web: Web;\r\n\r\n    uqVersion: number;\r\n\tconfig: UqConfig;\r\n\r\n    constructor(web: Web, uqData: UqData, createBoxId:CreateBoxId, tvs:{[entity:string]:(values:any)=>JSX.Element}) {\r\n\t\tthis.web = web;\r\n        this.createBoxId = createBoxId;\r\n        if (createBoxId === undefined) {\r\n            this.createBoxId = this.createBoxIdFromTVs;\r\n            this.tvs = tvs || {};\r\n        }\r\n        let {id, uqOwner, uqName, /*access, */newVersion} = uqData;\r\n        this.newVersion = newVersion;\r\n        this.uqOwner = uqOwner;\r\n        this.uqName = uqName;\r\n        this.id = id;\r\n        this.name = uqOwner + '/' + uqName;\r\n        this.uqVersion = 0;\r\n\t\tthis.localMap = env.localDb.map(this.name);\r\n        this.localModifyMax = this.localMap.child('$modifyMax');\r\n        this.localEntities = this.localMap.child('$access');\r\n        let baseUrl = 'tv/';\r\n\r\n        if (this.name === '$$$/$unitx') {\r\n            // 这里假定，点击home link之后，已经设置unit了\r\n            // 调用 UnitxApi会自动搜索绑定 unitx service\r\n            this.uqApi = new UnitxApi(env.unit);\r\n        }\r\n        else {\r\n            this.uqApi = new UqApi(baseUrl, uqOwner, uqName, true);\r\n        }\r\n        this.tuidsCache = new TuidsCache(this);\r\n    }\r\n\r\n\tgetID(name:string):ID {return this.ids[name.toLowerCase()];};\r\n\tgetIDX(name:string):IDX {return this.idxs[name.toLowerCase()];};\r\n\tgetIX(name:string):IX {return this.ixs[name.toLowerCase()];};\r\n\r\n    private createBoxIdFromTVs:CreateBoxId = (tuid:Tuid, id:number):BoxId =>{\r\n        let {name} = tuid;\r\n        /*\r\n        let tuidUR = this.tuidURs[name];\r\n        if (tuidUR === undefined) {\r\n            let {ui, res} = this.getUI(tuid);\r\n            this.tuidURs[name] = tuidUR = new TuidWithUIRes(tuid, ui, res);\r\n        }\r\n        */\r\n        return new ReactBoxId(id, tuid, this.tvs[name]);\r\n\t}\r\n\t\r\n\tprivate roles:string[];\r\n\tasync getRoles():Promise<string[]> {\r\n\t\tif (this.roles !== undefined) return this.roles;\r\n\t\tthis.roles = await this.uqApi.getRoles();\r\n\t\treturn this.roles;\r\n\t}\r\n\r\n    tuid(name:string):Tuid {return this.tuids[name.toLowerCase()]}\r\n    tuidDiv(name:string, div:string):TuidDiv {\r\n        let tuid = this.tuids[name.toLowerCase()]\r\n        return tuid && tuid.div(div.toLowerCase());\r\n    }\r\n    action(name:string):Action {return this.actions[name.toLowerCase()]}\r\n    sheet(name:string):Sheet {return this.sheets[name.toLowerCase()]}\r\n    query(name:string):Query {return this.queries[name.toLowerCase()]}\r\n    book(name:string):Book {return this.books[name.toLowerCase()]}\r\n    map(name:string):Map {return this.maps[name.toLowerCase()]}\r\n    history(name:string):History {return this.histories[name.toLowerCase()]}\r\n    pending(name:string):Pending {return this.pendings[name.toLowerCase()]}\r\n\r\n    sheetFromTypeId(typeId:number):Sheet {\r\n        for (let i in this.sheets) {\r\n            let sheet = this.sheets[i];\r\n            if (sheet.typeId === typeId) return sheet;\r\n        }\r\n    }\r\n\r\n\tallRoles: string[];\r\n    readonly tuidArr: Tuid[] = [];\r\n    readonly actionArr: Action[] = [];\r\n    readonly queryArr: Query[] = [];\r\n    readonly idArr: ID[] = [];\r\n    readonly idxArr: IDX[] = [];\r\n    readonly ixArr: IX[] = [];\r\n    readonly enumArr: UqEnum[] = [];\r\n    readonly sheetArr: Sheet[] = [];\r\n    readonly bookArr: Book[] = [];\r\n    readonly mapArr: Map[] = [];\r\n    readonly historyArr: History[] = [];\r\n    readonly pendingArr: Pending[] = [];\r\n\r\n    async init() {\r\n        await this.uqApi.init();\r\n    }\r\n\r\n    async loadEntities(): Promise<string> {\r\n        try {\r\n            let entities = this.localEntities.get();\r\n            if (!entities) {\r\n                entities = await this.uqApi.loadEntities();\r\n\t\t\t}\r\n            if (!entities) return;\r\n            this.buildEntities(entities);\r\n        }\r\n        catch (err) {\r\n            return err as any;\r\n        }\r\n    }\r\n\r\n\tbuildEntities(entities:any) {\r\n        if (entities === undefined) {\r\n            debugger;\r\n        }\r\n        this.localEntities.set(entities);\r\n        let {access, tuids, role, version} = entities;\r\n\t\tthis.uqVersion = version;\r\n\t\tthis.allRoles = role?.names;\r\n        this.buildTuids(tuids);\r\n\t\tthis.buildAccess(access);\r\n\t}\r\n\t\r\n    private buildTuids(tuids:any) {\r\n        for (let i in tuids) {\r\n            let schema = tuids[i];\r\n            let {typeId, from} = schema;\r\n            let tuid = this.newTuid(i, typeId, from);\r\n            tuid.sys = true;\r\n        }\r\n        for (let i in tuids) {\r\n            let schema = tuids[i];\r\n            let tuid = this.getTuid(i);\r\n            tuid.setSchema(schema);\r\n        }\r\n        for (let i in this.tuids) {\r\n            let tuid = this.tuids[i];\r\n            tuid.buildFieldsTuid();\r\n        }\r\n\t}\r\n\r\n    async loadEntitySchema(entityName: string): Promise<any> {\r\n        return await this.uqApi.schema(entityName);\r\n    }\r\n\r\n\tasync loadAllSchemas():Promise<void> {\r\n\t\tlet ret = await this.uqApi.allSchemas();\r\n\t\tlet entities: Entity[][] = [\r\n\t\t\tthis.actionArr, \r\n\t\t\tthis.enumArr,\r\n\t\t\tthis.sheetArr,\r\n\t\t\tthis.queryArr,\r\n\t\t\tthis.bookArr,\r\n\t\t\tthis.mapArr,\r\n\t\t\tthis.historyArr,\r\n\t\t\tthis.pendingArr,\r\n\t\t\tthis.idArr,\r\n\t\t\tthis.idxArr,\r\n\t\t\tthis.ixArr,\r\n\t\t];\r\n\t\tentities.forEach(arr => {\r\n\t\t\tarr.forEach(v => {\r\n\t\t\t\tlet entity = ret[v.name.toLowerCase()];\r\n\t\t\t\tif (!entity) return;\r\n\t\t\t\tlet schema = entity.call;\r\n\t\t\t\tif (!schema) return;\r\n\t\t\t\tv.buildSchema(schema);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n    getTuid(name:string): Tuid {\r\n        return this.tuids[name];\r\n    }\r\n\r\n    private buildAccess(access:any) {\r\n        for (let a in access) {\r\n            let v = access[a];\r\n            switch (typeof v) {\r\n                case 'string': this.fromType(a, v); break;\r\n                case 'object': this.fromObj(a, v); break;\r\n            }\r\n        }\r\n    }\r\n\r\n    cacheTuids(defer:number) {\r\n        this.tuidsCache.cacheTuids(defer);\r\n    }\r\n\r\n\tprivate setEntity(name:string, entity:Entity) {\r\n\t\tthis.entities[name] = entity;\r\n\t\tthis.entities[name.toLowerCase()] = entity;\r\n\t}\r\n\r\n    newEnum(name:string, id:number):UqEnum {\r\n        let enm = this.enums[name];\r\n        if (enm !== undefined) return enm;\r\n\t\tenm = this.enums[name] = new UqEnum(this, name, id);\r\n\t\tthis.setEntity(name, enm);\r\n        this.enumArr.push(enm);\r\n        return enm;\r\n    }\r\n\tnewAction(name:string, id:number):Action {\r\n        let action = this.actions[name];\r\n        if (action !== undefined) return action;\r\n        action = this.actions[name] = new Action(this, name, id);\r\n\t\tthis.setEntity(name, action);\r\n        this.actionArr.push(action);\r\n        return action;\r\n    }\r\n    private newTuid(name:string, id:number, from:SchemaFrom):Tuid {\r\n        let tuid = this.tuids[name];\r\n        if (tuid !== undefined) return tuid;\r\n        if (from !== undefined)\r\n            tuid = new TuidImport(this, name, id, from);\r\n        else\r\n            tuid = new TuidInner(this, name, id);\r\n        this.tuids[name] = tuid;\r\n\t\tthis.setEntity(name, tuid);\r\n        this.tuidArr.push(tuid);\r\n        return tuid;\r\n    }\r\n    newQuery(name:string, id:number):Query {\r\n        let query = this.queries[name];\r\n        if (query !== undefined) return query;\r\n        query = this.queries[name] = new Query(this, name, id)\r\n\t\tthis.setEntity(name, query);\r\n        this.queryArr.push(query);\r\n        return query;\r\n    }\r\n    private newBook(name:string, id:number):Book {\r\n        let book = this.books[name];\r\n        if (book !== undefined) return book;\r\n        book = this.books[name] = new Book(this, name, id);\r\n\t\tthis.setEntity(name, book);\r\n        this.bookArr.push(book);\r\n        return book;\r\n    }\r\n    private newMap(name:string, id:number):Map {\r\n        let map = this.maps[name];\r\n        if (map !== undefined) return map;\r\n        map = this.maps[name] = new Map(this, name, id)\r\n\t\tthis.setEntity(name, map);\r\n        this.mapArr.push(map);\r\n        return map;\r\n    }\r\n    private newHistory(name:string, id:number):History {\r\n        let history = this.histories[name];\r\n        if (history !== undefined) return;\r\n        history = this.histories[name] = new History(this, name, id)\r\n\t\tthis.setEntity(name, history);\r\n        this.historyArr.push(history);\r\n        return history;\r\n    }\r\n    private newPending(name:string, id:number):Pending {\r\n        let pending = this.pendings[name];\r\n        if (pending !== undefined) return;\r\n        pending = this.pendings[name] = new Pending(this, name, id)\r\n\t\tthis.setEntity(name, pending);\r\n        this.pendingArr.push(pending);\r\n        return pending;\r\n    }\r\n    private newSheet(name:string, id:number):Sheet {\r\n        let sheet = this.sheets[name];\r\n        if (sheet !== undefined) return sheet;\r\n        sheet = this.sheets[name] = new Sheet(this, name, id);\r\n\t\tthis.setEntity(name, sheet);\r\n        this.sheetArr.push(sheet);\r\n        return sheet;\r\n    }\r\n    private newID(name:string, id:number):ID {\r\n\t\tlet lName = name.toLowerCase();\r\n        let idEntity = this.ids[lName];\r\n        if (idEntity !== undefined) return idEntity;\r\n        idEntity = this.ids[lName] = new ID(this, name, id);\r\n\t\tthis.setEntity(name, idEntity);\r\n        this.idArr.push(idEntity);\r\n        return idEntity;\r\n    }\r\n    private newIDX(name:string, id:number):IDX {\r\n\t\tlet lName = name.toLowerCase();\r\n        let idx = this.idxs[lName];\r\n        if (idx !== undefined) return idx;\r\n        idx = this.idxs[lName] = new IDX(this, name, id);\r\n\t\tthis.setEntity(name, idx);\r\n        this.idxArr.push(idx);\r\n        return idx;\r\n    }\r\n    private newIX(name:string, id:number):IX {\r\n\t\tlet lName = name.toLowerCase();\r\n        let ix = this.ixs[lName];\r\n        if (ix !== undefined) return ix;\r\n        ix = this.ixs[lName] = new IX(this, name, id);\r\n\t\tthis.setEntity(name, ix);\r\n        this.ixArr.push(ix);\r\n        return ix;\r\n    }\r\n    private fromType(name:string, type:string) {\r\n        let parts = type.split('|');\r\n        type = parts[0];\r\n        let id = Number(parts[1]);\r\n        switch (type) {\r\n            //case 'uq': this.id = id; break;\r\n            case 'tuid':\r\n                // Tuid should not be created here!;\r\n                //let tuid = this.newTuid(name, id);\r\n                //tuid.sys = false;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'id': this.newID(name, id); break;\r\n\t\t\tcase 'idx': this.newIDX(name, id); break;\r\n\t\t\tcase 'ix': this.newIX(name, id); break;\r\n            case 'action': this.newAction(name, id); break;\r\n            case 'query': this.newQuery(name, id); break;\r\n            case 'book': this.newBook(name, id); break;\r\n            case 'map': this.newMap(name, id); break;\r\n            case 'history': this.newHistory(name, id); break;\r\n            case 'sheet':this.newSheet(name, id); break;\r\n\t\t\tcase 'pending': this.newPending(name, id); break;\r\n\t\t\tcase 'enum': this.newEnum(name, id); break;\r\n        }\r\n    }\r\n    private fromObj(name:string, obj:any) {\r\n        switch (obj['$']) {\r\n            case 'sheet': this.buildSheet(name, obj); break;\r\n        }\r\n    }\r\n    private buildSheet(name:string, obj:any) {\r\n        let sheet = this.sheets[name];\r\n        if (sheet === undefined) sheet = this.newSheet(name, obj.id);\r\n        sheet.build(obj);\r\n    }\r\n    buildFieldTuid(fields:Field[], mainFields?:Field[]) {\r\n        if (fields === undefined) return;\r\n        for (let f of fields) {\r\n            let {tuid} = f;\r\n            if (tuid === undefined) continue;\r\n            let t = this.getTuid(tuid);\r\n            if (t === undefined) continue;\r\n            f._tuid = t.buildTuidBox();\r\n        }\r\n        for (let f of fields) {\r\n            let {owner} = f;\r\n            if (owner === undefined) continue;\r\n            let ownerField = fields.find(v => v.name === owner);\r\n            if (ownerField === undefined) {\r\n                if (mainFields !== undefined) {\r\n                    ownerField = mainFields.find(v => v.name === owner);\r\n                }\r\n                if (ownerField === undefined) {\r\n                    debugger;\r\n                    throw new Error(`owner field ${owner} is undefined`);\r\n                }\r\n            }\r\n            let {arr, tuid} = f;\r\n            let t = this.getTuid(ownerField._tuid.tuid.name);\r\n            if (t === undefined) continue;\r\n            let div = t.div(arr || tuid);\r\n            f._tuid = div && div.buildTuidDivBox(ownerField);\r\n\t\t\t/*\r\n            if (f._tuid === undefined) {\r\n                debugger;\r\n                throw new Error(`owner field ${owner} is not tuid`);\r\n            }\r\n\t\t\t*/\r\n        }\r\n    }\r\n    buildArrFieldsTuid(arrFields:ArrFields[], mainFields:Field[]) {\r\n        if (arrFields === undefined) return;\r\n        for (let af of arrFields) {\r\n            let {fields} = af;\r\n            if (fields === undefined) continue;\r\n            this.buildFieldTuid(fields, mainFields);\r\n        }\r\n    }\r\n\r\n    pullModify(modifyMax:number) {\r\n        this.tuidsCache.pullModify(modifyMax);\r\n\t}\r\n\r\n\tgetUqKey() {\r\n\t\tlet uqKey:string = this.uqName.split(/[-._]/).join('').toLowerCase();\r\n\t\treturn uqKey;\r\n\t}\r\n\r\n\tgetUqKeyWithConfig() {\r\n\t\tif (!this.config) return;\r\n\t\tlet uqKey:string = this.uqName.split(/[-._]/).join('').toLowerCase();\r\n\t\tlet {dev, alias} = this.config;\r\n\t\tuqKey = capitalCase(dev.alias || dev.name) + capitalCase(alias??uqKey);\r\n\t\treturn uqKey;\r\n\t}\r\n\r\n\thasEntity(name: string):boolean {\r\n\t\treturn this.entities[name] !== undefined\r\n\t\t\t|| this.entities[name.toLowerCase()] !== undefined;\r\n\t}\r\n\r\n\tcreateProxy():any {\r\n\t\tlet ret = new Proxy(this.entities, {\r\n\t\t\tget: (target, key, receiver) => {\r\n\t\t\t\tlet lk = (key as string).toLowerCase();\r\n\t\t\t\tif (lk === '$') {\r\n\t\t\t\t\treturn this;\r\n\t\t\t\t}\r\n\t\t\t\tlet ret = target[lk];\r\n\t\t\t\tif (ret !== undefined) return ret;\r\n\t\t\t\tlet func = (this as any)[key];\r\n\t\t\t\tif (func !== undefined) return func;\r\n\t\t\t\tlet err = `entity ${this.name}.${String(key)} not defined`;\r\n\t\t\t\tconsole.error('UQ错误：' + err);\r\n\t\t\t\tthis.showReload('服务器正在更新');\r\n\t\t\t\treturn undefined;\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.proxy = ret;\r\n\t\tthis.idCache = new IDCache(this.proxy);\r\n\t\treturn ret;\r\n\t}\r\n\r\n    private showReload(msg: string) {\r\n\t\tlet cache = this.localMap.child('$reload-tick');\r\n\t\tlet reloadTick = cache.get();\r\n\t\tif (!reloadTick) reloadTick = 0;\r\n\t\tconsole.error(msg);\r\n\t\tthis.localMap.removeAll();\r\n\t\tlet tick = Date.now();\r\n\t\tcache.set(tick);\r\n\t\tif (tick - reloadTick  < 10*1000)  {\r\n\t\t\tthis.web.showReloadPage(msg);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.web.reload();\r\n\t\t}\r\n    }\r\n\r\n\tprivate async apiPost(api:string, resultType: EnumResultType, apiParam: any): Promise<any> {\r\n\t\tif (resultType === EnumResultType.sql) api = 'sql-' + api;\r\n\t\tlet ret = await this.uqApi.post(IDPath(api), apiParam);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate async apiActs(param: any, resultType: EnumResultType): Promise<any> {\r\n\t\t// 这边的obj属性序列，也许会不一样\r\n\t\tlet arr:string[] = [];\r\n\t\tlet apiParam:any = {};\r\n\t\tfor (let i in param) {\r\n\t\t\tarr.push(i);\r\n\t\t\tapiParam[i] = (param[i] as any[]).map(v => {\r\n\t\t\t\tlet obj:any = {};\r\n\t\t\t\tfor (let j in v) {\r\n\t\t\t\t\tlet val = v[j];\r\n\t\t\t\t\tif (typeof val === 'object') {\r\n\t\t\t\t\t\tlet nv:any = {};\r\n\t\t\t\t\t\tfor (let n in val) {\r\n\t\t\t\t\t\t\tlet tv = val[n];\r\n\t\t\t\t\t\t\tif (tv && typeof tv === 'object') {\r\n\t\t\t\t\t\t\t\tif (n === 'time') {\r\n\t\t\t\t\t\t\t\t\tif (Object.prototype.toString.call(tv) === '[object Date]') {\r\n\t\t\t\t\t\t\t\t\t\ttv = (tv as Date).getTime();\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\telse {\r\n\t\t\t\t\t\t\t\t\tlet id = tv['id'];\r\n\t\t\t\t\t\t\t\t\ttv = id;\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tnv[n] = tv;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tobj[j] = nv;\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tobj[j] = val;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\treturn obj;\r\n\t\t\t});\r\n\t\t}\r\n\t\tapiParam['$'] = arr;\r\n\t\tlet ret = await this.apiPost('acts', resultType,  apiParam);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected Acts = async (param:any): Promise<any> => {\r\n\t\t//let apiParam = this.ActsApiParam(param);\r\n\t\tlet ret = await this.apiActs(param, EnumResultType.data); // await this.apiPost('acts', apiParam);\r\n\t\tlet retArr = (ret[0].ret as string).split('\\n');\r\n\t\tlet arr:string[] = [];\r\n\t\tfor (let i in param) arr.push(i);\r\n\t\tlet retActs:{[key:string]:number[]} = {};\r\n\t\tfor (let i=0; i<arr.length; i++) {\r\n\t\t\tretActs[arr[i]] = ids(retArr[i].split('\\t'));\r\n\t\t}\r\n\t\treturn retActs;\r\n\t}\r\n\r\n\tprotected getAdmins = async(): Promise<{id:number; role:number}[]> => {\r\n\t\treturn await this.uqApi.getAdmins();\r\n\t}\r\n\r\n\tprotected $Acts = async (param:any): Promise<any> => {\r\n\t\treturn await this.apiActs(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiActIX(param: any, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {IX, ID, values, IXs} = param;\r\n\t\tlet apiParam:any = {\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIXs: IXs?.map((v: any) => ({IX:entityName(v.IX), ix:v.ix})),\r\n\t\t\tvalues,\r\n\t\t};\r\n\t\tlet ret = await this.apiPost('act-ix', resultType, apiParam);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected ActIX = async (param: ParamActIX<any>): Promise<number[]> => {\r\n\t\t/*\r\n\t\tlet {IX, ID, values, IXs} = param;\r\n\t\tlet apiParam:any = {\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIXs: IXs?.map(v => ({IX:entityName(v.IX), ix:v.ix})),\r\n\t\t\tvalues,\r\n\t\t};\r\n\t\tlet ret = await this.apiPost('act-ix'), apiParam);\r\n\t\t*/\r\n\t\tlet ret = await this.apiActIX(param, EnumResultType.data);\r\n\t\treturn (ret[0].ret as string).split('\\t').map(v => Number(v));\r\n\t}\r\n\r\n\tprotected $ActIX = async (param: ParamActIX<any>): Promise<string> => {\r\n\t\tlet ret = await this.apiActIX(param, EnumResultType.sql);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate async apiActIxSort(param: ParamActIXSort, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {IX, ix, id, after} = param;\r\n\t\tlet apiParam:any = {\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tix,\r\n\t\t\tid,\r\n\t\t\tafter,\r\n\t\t};\r\n\t\treturn await this.apiPost('act-ix-sort', resultType, apiParam);\r\n\t}\r\n\r\n\tprotected ActIXSort = async (param: ParamActIXSort): Promise<void> => {\r\n\t\t/*\r\n\t\tlet {IX, ix, id, after} = param;\r\n\t\tlet apiParam:any = {\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tix,\r\n\t\t\tid,\r\n\t\t\tafter,\r\n\t\t};\r\n\t\tawait this.apiPost('act-ix-sort'), apiParam);\r\n\t\t*/\r\n\t\treturn await this.apiActIxSort(param, EnumResultType.data);\r\n\t}\r\n\r\n\tprotected $ActIXSort = async (param: ParamActIXSort): Promise<string> => {\r\n\t\treturn await this.apiActIxSort(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiActDetail(param: ParamActDetail<any, any>, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {main, detail, detail2, detail3} = param as unknown as ParamActDetail3<any, any, any, any>;\r\n\t\tlet postParam:any = {\r\n\t\t\tmain: {\r\n\t\t\t\tname: entityName(main.ID),\r\n\t\t\t\tvalue: toScalars(main.value),\r\n\t\t\t},\r\n\t\t\tdetail: {\r\n\t\t\t\tname: entityName(detail.ID),\r\n\t\t\t\tvalues: detail.values?.map(v => toScalars(v)),\r\n\t\t\t},\r\n\t\t}\r\n\t\tif (detail2) {\r\n\t\t\tpostParam.detail2 = {\r\n\t\t\t\tname: entityName(detail2.ID),\r\n\t\t\t\tvalues: detail2.values?.map(v => toScalars(v)),\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (detail3) {\r\n\t\t\tpostParam.detail3 = {\r\n\t\t\t\tname: entityName(detail3.ID),\r\n\t\t\t\tvalues: detail3.values?.map(v => toScalars(v)),\r\n\t\t\t}\r\n\t\t}\r\n\t\tlet ret = await this.apiPost('act-detail', resultType, postParam);\r\n\t}\r\n\r\n\tprotected ActDetail = async (param: ParamActDetail<any, any>) => {\r\n\t\tlet ret = await this.apiActDetail(param, EnumResultType.data);\r\n\t\tlet val:string = ret[0].ret;\r\n\t\tlet parts = val.split('\\n');\r\n\t\tlet items = parts.map(v => v.split('\\t'));\r\n\t\tret = {\r\n\t\t\tmain: ids(items[0])[0],\r\n\t\t\tdetail: ids(items[1]),\r\n\t\t\tdetail2: ids(items[2]),\r\n\t\t\tdetail3: ids(items[3]),\r\n\t\t};\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected $ActDetail = async (param: ParamActDetail<any, any>) => {\r\n\t\treturn await this.apiActDetail(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiQueryID(param: ParamQueryID, resultType: EnumResultType): Promise<any[]> {\r\n\t\tlet {ID, IX, IDX} = param;\r\n\t\tlet ret = await this.apiPost('query-id', resultType, {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIX: IX?.map(v => entityName(v)),\r\n\t\t\tIDX: this.IDXToString(IDX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected QueryID = async (param: ParamQueryID) => {\r\n\t\treturn await this.apiQueryID(param, EnumResultType.data);\r\n\t}\r\n\r\n\tprotected $QueryID = async (param: ParamQueryID) => {\r\n\t\treturn await this.apiQueryID(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIDTv(ids: number[], resultType: EnumResultType): Promise<any[]> {\t\t\r\n\t\tlet ret = await this.apiPost('id-tv', resultType, ids);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected IDTv = async (ids: number[]): Promise<any[]> => {\r\n\t\tlet ret = await this.apiIDTv(ids, EnumResultType.data);\r\n\t\tlet retValues: any[] = [];\r\n\t\tfor (let row of ret) {\r\n\t\t\tlet {$type, $tv} = row;\r\n\t\t\tif (!$tv) continue;\r\n\t\t\tlet ID = this.ids[$type];\r\n\t\t\tif (!ID) continue;\r\n\t\t\tlet {schema} = ID;\r\n\t\t\tif (!schema) {\r\n\t\t\t\tawait ID.loadSchema();\r\n\t\t\t\tschema = ID.schema;\r\n\t\t\t}\r\n\t\t\tlet {nameNoVice} = schema;\r\n\t\t\tif (!nameNoVice) continue;\r\n\t\t\tlet values = ($tv as string).split('\\n');\r\n\t\t\tlet len = nameNoVice.length;\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tlet p = nameNoVice[i];\r\n\t\t\t\trow[p] = values[i];\r\n\t\t\t}\r\n\t\t\tdelete row.$tv;\r\n\t\t\tretValues.push(row);\r\n\t\t}\r\n\t\treturn retValues;\r\n\t}\r\n\r\n\tprotected $IDTv = async (ids: number[]): Promise<any> => {\r\n\t\treturn await this.apiIDTv(ids, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIDNO(param: ParamIDNO, resultType: EnumResultType): Promise<string> {\r\n\t\tlet {ID} = param;\r\n\t\tlet ret = await this.apiPost('id-no', resultType, {ID: entityName(ID)});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected IDNO = async (param: ParamIDNO): Promise<string> => {\r\n\t\treturn await this.apiIDNO(param, EnumResultType.data);\r\n\t}\r\n\r\n\tprotected $IDNO = async (param: ParamIDNO): Promise<string> => {\r\n\t\treturn await this.apiIDNO(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIDDetailGet(param: ParamIDDetailGet, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {id, main, detail, detail2, detail3} = param;\r\n\t\tlet ret = await this.apiPost('id-detail-get', resultType, {\r\n\t\t\tid,\r\n\t\t\tmain: entityName(main),\r\n\t\t\tdetail: entityName(detail),\r\n\t\t\tdetail2: entityName(detail2),\r\n\t\t\tdetail3: entityName(detail3),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected IDDetailGet = async (param: ParamIDDetailGet): Promise<any> => {\r\n\t\treturn await this.apiIDDetailGet(param, EnumResultType.data);\r\n\t}\r\n\r\n\tprotected $IDDetailGet = async (param: ParamIDDetailGet): Promise<any> => {\r\n\t\treturn await this.apiIDDetailGet(param, EnumResultType.sql);\r\n\t}\r\n\r\n\t//private checkParam(ID:ID, IDX:(ID|IDX)|(ID|IDX)[], IX:IX, id:number|number[], key:{[key:string]:string|number}, page: ParamPage) {\r\n\t//}\r\n\tprivate IDXToString(p:ID|IDX|((ID|IDX)[])):string|string[] {\r\n\t\tif (Array.isArray(p) === true) return (p as (ID|IDX)[]).map(v => entityName(v));\r\n\t\treturn entityName(p as ID|IDX);\r\n\t}\r\n\tprivate async apiID(param: ParamID, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.apiPost('id', resultType, {\r\n\t\t\t...param,\r\n\t\t\tIDX: this.IDXToString(IDX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected  ID = async (param: ParamID): Promise<any[]> => {\r\n\t\treturn await this.apiID(param, EnumResultType.data);\r\n\t}\r\n\tprotected  $ID = async (param: ParamID): Promise<string> => {\r\n\t\treturn await this.apiID(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiKeyID(param: ParamKeyID, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {ID, IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, null, key, page);\r\n\t\tlet ret = await this.apiPost('key-id', resultType, {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected KeyID = async (param: ParamKeyID): Promise<any[]> => {\r\n\t\treturn await this.apiKeyID(param, EnumResultType.data);\r\n\t}\r\n\tprotected $KeyID = async (param: ParamKeyID): Promise<string> => {\r\n\t\treturn await this.apiKeyID(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIX(param: ParamIX, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {IX, IX1, IDX} = param;\r\n\t\t//this.checkParam(null, IDX, IX, id, null, page);\r\n\t\tlet ret = await this.apiPost('ix', resultType, {\r\n\t\t\t...param,\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tIX1: entityName(IX1),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected IX = async (param: ParamIX): Promise<any[]> => {\r\n\t\treturn await this.apiIX(param, EnumResultType.data);\r\n\t}\r\n\tprotected $IX = async (param: ParamIX): Promise<string> => {\r\n\t\treturn await this.apiIX(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIXr(param: ParamIX, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {IX, IX1, IDX} = param;\r\n\t\t//this.checkParam(null, IDX, IX, id, null, page);\r\n\t\tlet ret = await this.apiPost('ixr', resultType, {\r\n\t\t\t...param,\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tIX1: entityName(IX1),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected IXr = async (param: ParamIX): Promise<any[]> => {\r\n\t\treturn await this.apiIXr(param, EnumResultType.data);\r\n\t}\r\n\tprotected $IXr = async (param: ParamIX): Promise<any[]> => {\r\n\t\treturn await this.apiIXr(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiKeyIX(param: ParamKeyIX, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {ID, IX, IDX} = param;\r\n\t\t//this.checkParam(ID, IDX, IX, null, key, page);\r\n\t\tlet ret = await this.apiPost('key-ix', resultType, {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tIDX: IDX?.map(v => entityName(v)),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected KeyIX = async (param: ParamKeyIX): Promise<any[]> => {\r\n\t\treturn await this.apiKeyIX(param, EnumResultType.data);\r\n\t}\r\n\tprotected $KeyIX = async (param: ParamKeyIX): Promise<any[]> => {\r\n\t\treturn await this.apiKeyIX(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIDLog(param: ParamIDLog, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.apiPost('id-log', resultType, {\r\n\t\t\t...param,\r\n\t\t\tIDX: entityName(IDX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected IDLog = async (param: ParamIDLog): Promise<any[]> => {\r\n\t\treturn await this.apiIDLog(param, EnumResultType.data);\r\n\t}\r\n\tprotected $IDLog = async (param: ParamIDLog): Promise<string> => {\r\n\t\treturn await this.apiIDLog(param, EnumResultType.sql);\r\n\t}\r\n\t\r\n\tprivate async apiIDSum(param: ParamIDSum, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {IDX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.apiPost('id-sum', resultType, {\r\n\t\t\t...param,\r\n\t\t\tIDX: entityName(IDX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected IDSum = async (param: ParamIDSum): Promise<any[]> => {\r\n\t\treturn await this.apiIDSum(param, EnumResultType.data);\r\n\t}\r\n\tprotected $IDSum = async (param: ParamIDSum): Promise<string> => {\r\n\t\treturn await this.apiIDSum(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIDinIX(param:ParamIDinIX, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {ID, IX} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.apiPost('id-in-ix', resultType, {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIX: entityName(IX),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected IDinIX = async (param:ParamIDinIX): Promise<any|{$in:boolean}[]> => {\r\n\t\treturn await this.apiIDinIX(param, EnumResultType.data);\r\n\t}\r\n\tprotected $IDinIX = async (param:ParamIDinIX): Promise<string> => {\r\n\t\treturn await this.apiIDinIX(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIDxID(param:ParamIDxID,resultType: EnumResultType): Promise<any> {\r\n\t\tlet {ID, IX, ID2} = param;\r\n\t\t//this.checkParam(null, IDX, null, id, null, page);\r\n\t\tlet ret = await this.apiPost('id-x-id', resultType, {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t\tIX: entityName(IX),\r\n\t\t\tID2: entityName(ID2),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected IDxID = async (param:ParamIDxID): Promise<any[]> => {\r\n\t\treturn await this.apiIDxID(param, EnumResultType.data);\r\n\t}\r\n\tprotected $IDxID = async (param:ParamIDxID): Promise<string> => {\r\n\t\treturn await this.apiIDxID(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprivate async apiIDTree(param:ParamIDTree, resultType: EnumResultType): Promise<any> {\r\n\t\tlet {ID} = param;\r\n\t\tlet ret = await this.apiPost('id-tree', resultType, {\r\n\t\t\t...param,\r\n\t\t\tID: entityName(ID),\r\n\t\t});\r\n\t\treturn ret;\r\n\t}\r\n\tprotected IDTree = async (param:ParamIDTree): Promise<any[]> => {\r\n\t\treturn await this.apiIDTree(param, EnumResultType.data);\r\n\t}\r\n\tprotected $IDTree = async (param:ParamIDTree): Promise<string> => {\r\n\t\treturn await this.apiIDTree(param, EnumResultType.sql);\r\n\t}\r\n\r\n\tprotected IDRender = (id: number, render?:(value:any) => JSX.Element): JSX.Element => {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet ret = this.idCache.getValue(id);\r\n\t\t\tif (ret === undefined) {\r\n\t\t\t\treturn React.createElement('span', {props:{className: 'text-muted'},  children: ['id='+id]});\r\n\t\t\t}\r\n\t\t\tlet {$type} = ret as any;\r\n\t\t\tif (!$type) return this.renderIDUnknownType(id);\r\n\t\t\tlet IDType = this.ids[$type];\r\n\t\t\tif (!IDType) return this.renderIDUnknownType(id);\r\n\t\t\treturn (render ?? IDType.render)(ret);\r\n\t\t}));\r\n\t}\r\n\r\n\tprotected IDV = <T extends object>(id: number): T => {\r\n\t\tlet ret = this.idCache.getValue(id);\r\n\t\treturn ret as T;\r\n\t}\r\n\r\n\tprivate renderIDUnknownType(id: number) {\r\n\t\treturn React.createElement('span', {props:{className: 'text-muted'},  children: [`id=${id} type undefined`]});\r\n\t}\r\n\r\n\tIDLocalTv(ids: number[]): Promise<any[]> {\r\n\t\treturn this.IDTv(ids.map(v => -v));\r\n\t}\r\n\r\n\tprotected IDLocalV = <T extends object>(id: number): T => {\r\n\t\treturn this.IDV(-id);\r\n\t}\r\n\r\n\tprotected IDLocalRender = (id: number, render?:(value:any) => JSX.Element): JSX.Element => {\r\n\t\treturn this.IDRender(-id, render);\r\n\t}\r\n}\r\n\r\nfunction ids(item:string[]):number[] {\r\n\tif (!item) return;\r\n\tlet len = item.length;\r\n\tif (len <= 1) return;\r\n\tlet ret:number[] = [];\r\n\tfor (let i=0; i<len-1; i++) ret.push(Number(item[i]));\r\n\treturn ret;\r\n}\r\n\r\nfunction entityName(entity:Entity | string): string {\r\n\tif (!entity) return;\r\n\tif (typeof entity === 'string') return entity;\r\n\treturn entity.name;\r\n}\r\n\r\nfunction toScalars(value:any):any {\r\n\tif (!value) return value;\r\n\tlet ret:any = {};\r\n\tfor (let i in value) {\r\n\t\tlet v = value[i];\r\n\t\tif (typeof v === 'object') v = v['id'];\r\n\t\tret[i] = v;\r\n\t}\r\n\treturn ret;\r\n}","import { observer } from 'mobx-react';\r\nimport _ from 'lodash';\r\nimport { LocalArr } from '../../tool';\r\nimport { Entity } from '../entity';\r\nimport { UqMan, ArrFields, Field, SchemaFrom } from '../uqMan';\r\nimport { EntityCaller } from '../caller';\r\nimport { BoxId } from './boxId';\r\nimport { IdCache, IdDivCache } from './idCache';\r\nimport { Render } from '../../ui';\r\nimport { uqStringify } from './reactBoxId';\r\n\r\nexport interface TuidSaveResult {\r\n    id: number;\r\n    inId: number;\r\n}\r\n\r\nexport interface TuidNOResult {\r\n\tdate: string;\r\n\tno: number;\r\n}\r\n\r\nexport abstract class UqTuid<M> extends Entity {\r\n    protected noCache: boolean;\r\n    readonly typeName:string = 'tuid';\r\n    protected idName: string;\r\n    //cached: boolean;\r\n    unique: string[];\r\n\trender: Render<M>;\r\n\r\n    public setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {id} = schema;\r\n        this.idName = id;\r\n    }\r\n\r\n    buildTuidBox(): TuidBox {\r\n        return new TuidBox(this);\r\n    }\r\n\r\n    getIdFromObj(obj:any):number {return obj[this.idName]}\r\n    stopCache():void {this.noCache = true}\r\n    abstract tv(id:number, render?:Render<M>):JSX.Element;\r\n    abstract getObj(id:number):M;\r\n    abstract useId(id:number):void;\r\n    abstract boxId(id:number):BoxId;\r\n    abstract valueFromId(id:number):any;\r\n\tabstract resetCache(id:number|BoxId):void;\r\n\tabstract assureBox<T> (id:number|BoxId): Promise<T>;\r\n\tstatic idValue(id: {id:number}|number):number {\r\n\t\tlet t = typeof id;\r\n\t\tswitch (t) {\r\n\t\t\tdefault: debugger; throw new Error('unknown id type: ' + t);\r\n\t\t\tcase 'undefined': return undefined;\r\n\t\t\tcase 'object': return (id as any).id;\r\n\t\t\tcase 'number': return id as number;\r\n\t\t}\r\n\t}\r\n    static equ(id1:{id:number}|number, ix:{id:number}|number): boolean {\r\n        if (id1 === undefined || id1 === null) return false;\r\n\t\tif (ix === undefined || ix === null) return false;\r\n\t\treturn Tuid.idValue(id1) === Tuid.idValue(ix);\r\n\t\t/*\r\n        if (typeof id1 === 'object') {\r\n\t\t\tlet id1Id = id1.id;\r\n            return typeof ix === 'object'? id1Id === ix.id : id1Id === ix;\r\n        }\r\n        if (typeof ix === 'object') {\r\n\t\t\tlet id2Id = ix.id;\r\n            return typeof id1 === 'object'? id2Id === id1.id : id2Id === id1;\r\n        }\r\n\t\treturn id1 === ix;\r\n\t\t*/\r\n    }\r\n    cacheIds() {}\r\n    async modifyIds(ids:any[]) {}\r\n    isImport = false;\r\n    abstract get hasDiv():boolean;// {return this.divs!==undefined}\r\n    abstract div(name:string):TuidDiv;\r\n    abstract loadMain(id:number|BoxId):Promise<M>;\r\n\tabstract load(id:number|BoxId):Promise<M>;\r\n    abstract all():Promise<M[]>;\r\n\tabstract save(id:number, props:M):Promise<TuidSaveResult>;\r\n\tabstract saveProp(id:number, prop:string, value:any):Promise<void>;\r\n    abstract search(key:string, pageStart:string|number, pageSize:number):Promise<M[]>;\r\n    abstract searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any>;\r\n    abstract loadArr(arr:string, owner:number, id:number):Promise<any>;\r\n    abstract saveArr(arr:string, owner:number, id:number, props:any):Promise<void>;\r\n\tabstract posArr(arr:string, owner:number, id:number, order:number):Promise<void>;\r\n\tabstract no():Promise<TuidNOResult>;\r\n}\r\n\r\nexport abstract class Tuid extends UqTuid<any> {\r\n}\r\n\r\nexport class TuidInner extends Tuid {\r\n    private divs: {[div:string]: TuidDiv};\r\n    protected cacheFields: Field[];\r\n    protected idCache: IdCache;\r\n    protected localArr:LocalArr;\r\n    constructor(uq:UqMan, name:string, typeId:number) {\r\n        super(uq, name, typeId);\r\n        this.idCache = new IdCache(this);\r\n        this.localArr = this.schemaLocal.arr(this.name + '.whole');\r\n        if (uq.newVersion === true) this.localArr.removeAll();\r\n    }\r\n\r\n    public setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {arrs} = schema;\r\n        if (arrs !== undefined) {\r\n            this.divs = {};\r\n            for (let arr of arrs) {\r\n                let {name} = arr;\r\n                let tuidDiv = new TuidDiv(this.uq, this, name);\r\n                this.divs[name] = tuidDiv;\r\n                tuidDiv.setSchema(arr);\r\n                tuidDiv.buildFieldsTuid();\r\n            }\r\n        }\r\n    }\r\n    \r\n    getObj(id:number):any {\r\n        let obj = this.valueFromId(id);\r\n        if (obj) return obj;\r\n        this.useId(id);\r\n        return {id};\r\n    }\r\n\r\n\ttv(id:number, render?:Render<any>):JSX.Element {\r\n        const TuidView = observer(() => {\r\n\t\t\tlet obj = this.valueFromId(id);\r\n\t\t\tif (obj === undefined) {\r\n\t\t\t\tthis.useId(id);\r\n\t\t\t\treturn <>{this.sName}:{id}</>;\r\n\t\t\t}\r\n            let r: Render<any>;\r\n            if (render) {\r\n                r = render;\r\n            }\r\n            else if (this.render) {\r\n                r = this.render;\r\n            }\r\n            else {\r\n                console.log('render', render, 'this.render', this.render);\r\n                r = (item:any) => {\r\n                    return <>{this.sName}:{uqStringify(item)}</>;\r\n                };\r\n            }\r\n\t\t\treturn r(obj);\r\n\t\t});\r\n\t\treturn <><TuidView /></>;\r\n\t}\r\n\r\n    useId(id:number, defer?:boolean) {\r\n        if (this.noCache === true) return;\r\n        if (!id) return;\r\n        this.idCache.useId(id, defer);\r\n    }\r\n    boxId(id:number):BoxId {\r\n        if (!id) return;\r\n        if (typeof id === 'object') return id;\r\n        this.useId(id);\r\n        let {createBoxId} = this.uq;\r\n        if (!createBoxId) return {id: id} as BoxId;\r\n        return createBoxId(this, id);\r\n    }\r\n    valueFromId(id:number) {return this.idCache.getValue(id)}\r\n\tresetCache(id:number|BoxId):void {\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tthis.idCache.resetCache(id);\r\n\t}\r\n    async assureBox<T> (id:number|BoxId):Promise<T> {\r\n\t\tif (!id) return;\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tawait this.idCache.assureObj(id);\r\n\t\treturn this.idCache.getValue(id);\r\n    }\r\n\r\n    cacheIds() {\r\n        this.idCache.cacheIds();\r\n        if (this.divs === undefined) return;\r\n        for (let i in this.divs) this.divs[i].cacheIds();\r\n    }\r\n    async modifyIds(ids:any[]) {\r\n        await this.idCache.modifyIds(ids);\r\n    }\r\n    cacheTuids(defer:number) {this.uq.cacheTuids(defer)}\r\n    get hasDiv():boolean {return this.divs!==undefined}\r\n    div(name:string):TuidDiv {\r\n        return this.divs && this.divs[name];\r\n    }\r\n    async loadValuesFromIds(divName:string, ids:number[]):Promise<any[]> {\r\n        let ret:any[] = await new IdsCaller(this, {divName:divName, ids:ids}, undefined, false).request();\r\n        return ret;\r\n    }\r\n    async loadMain(id:number|BoxId):Promise<any> {\r\n        if (typeof id === 'object') id = id.id;\r\n        await this.idCache.assureObj(id);\r\n        return this.idCache.valueFromId(id);\r\n    }\r\n    async load(id:number|BoxId):Promise<any> {\r\n        if (id === undefined || id === 0) return;\r\n        //let cacheValue = this.idCache.valueFromId(id); \r\n        //if (typeof cacheValue === 'object') return cacheValue;\r\n        if (typeof id === 'object') id = id.id;\r\n        let valuesText = undefined; //this.localArr.getItem(id);\r\n        let values: any;\r\n        if (valuesText) {\r\n            values = JSON.parse(valuesText);\r\n        }\r\n        else {\r\n            values = await new GetCaller(this, id).request();\r\n            if (values !== undefined) {\r\n                // this.localArr.setItem(id, JSON.stringify(values));\r\n            }\r\n        }\r\n        if (values === undefined) return;\r\n        for (let f of this.schema.fields) {\r\n            let {tuid} = f;\r\n            if (tuid === undefined) continue;\r\n            let t = this.uq.getTuid(tuid);\r\n            if (t === undefined) continue;\r\n            let n = f.name;\r\n            values[n] = t.boxId(values[n]);\r\n        }\r\n        this.idCache.cacheValue(values);\r\n        this.cacheTuidFieldValues(values);\r\n        return values;\r\n    }\r\n\r\n    cacheTuidFieldValues(values:any) {\r\n        let {fields, arrs} = this.schema;\r\n        this.cacheFieldsInValue(values, fields);\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs as ArrFields[]) {\r\n                let {name, fields} = arr;\r\n                let arrValues = values[name];\r\n                if (arrValues === undefined) continue;\r\n                let tuidDiv = this.div(name);\r\n                for (let row of arrValues) {\r\n                    //row._$tuid = tuidDiv;\r\n                    //row.$owner = this.boxId(row.owner);\r\n                    tuidDiv.cacheValue(row);\r\n                    this.cacheFieldsInValue(row, fields);\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    public buildFieldsTuid() {\r\n        super.buildFieldsTuid();\r\n        let {mainFields, $create, $update, stampOnMain} = this.schema;\r\n\t\tif (mainFields === undefined) debugger;\r\n\t\tthis.cacheFields = mainFields || this.fields;\r\n\t\tif (stampOnMain === true) {\r\n\t\t\tif ($create === true) this.cacheFields.push({name: '$create', type: 'timestamp', _tuid: undefined});\r\n\t\t\tif ($update === true) this.cacheFields.push({name: '$update', type: 'timestamp', _tuid: undefined});\r\n\t\t}\r\n        this.uq.buildFieldTuid(this.cacheFields);\r\n    }\r\n\r\n    unpackTuidIds(values:string[]):any[] {\r\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\r\n    }\r\n\r\n    async save(id:number, props:any):Promise<TuidSaveResult> {\r\n        let ret = await new SaveCaller(this, {id:id, props:props}).request();\r\n        if (id !== undefined) {\r\n            this.idCache.remove(id);\r\n            this.localArr.removeItem(id);\r\n        }\r\n        return ret;\r\n\t}\r\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\r\n\t\tawait new SavePropCaller(this, {id, prop, value}).request();\r\n\t\tthis.idCache.remove(id);\r\n\t\tawait this.idCache.assureObj(id);\r\n\t}\r\n    async all():Promise<any[]> {\r\n        let ret: any[] = await new AllCaller(this, {}).request();\r\n        return ret;\r\n    }\r\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any[]> {\r\n        let ret:any[] = await this.searchArr(undefined, key, pageStart, pageSize);\r\n        return ret;\r\n    }\r\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        //let api = this.uqApi;\r\n        //let ret = await api.tuidSearch(this.name, undefined, owner, key, pageStart, pageSize);\r\n        let params:any = {arr:undefined, owner:owner, key:key, pageStart:pageStart, pageSize:pageSize};\r\n        let ret = await new SearchCaller(this, params).request();\r\n        let {fields} = this.schema;\r\n        for (let row of ret) {\r\n            this.cacheFieldsInValue(row, fields);\r\n        }\r\n        return ret;\r\n    }\r\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\r\n        if (id === undefined || id === 0) return;\r\n        //let api = this.uqApi;\r\n        //return await api.tuidArrGet(this.name, arr, owner, id);\r\n        return await new LoadArrCaller(this, {arr:arr, owner:owner, id:id}).request();\r\n    }\r\n    async saveArr(arr:string, owner:number, id:number, props:any) {\r\n        //let params = _.clone(props);\r\n        //params[\"$id\"] = id;\r\n        //return await this.uqApi.tuidArrSave(this.name, arr, owner, params);\r\n        return await new SaveArrCaller(this, {arr:arr, owner:owner, id:id, props:props}).request();\r\n    }\r\n\r\n    async posArr(arr:string, owner:number, id:number, order:number) {\r\n        //return await this.uqApi.tuidArrPos(this.name, arr, owner, id, order);\r\n        return await new ArrPosCaller(this, {arr:arr, owner:owner, id:id, order:order}).request();\r\n\t}\r\n\tasync no():Promise<TuidNOResult> {\r\n\t\treturn await new TuidNoCaller(this, undefined).request();\r\n\t}\r\n}\r\n\r\nabstract class TuidCaller<T> extends EntityCaller<T> {\r\n    protected get entity(): Tuid {return this._entity as Tuid};\r\n}\r\n\r\n// 包含main字段的load id\r\n// 当前为了兼容，先调用的包含所有字段的内容\r\nclass GetCaller extends TuidCaller<number> {\r\n    method = 'GET';\r\n    get path():string {return `tuid/${this.entity.name}/${this.params}`}\r\n}\r\n\r\nclass IdsCaller extends TuidCaller<{divName:string, ids:number[]}> {\r\n    get path():string {\r\n        let {divName} = this.params;\r\n        return `tuidids/${this.entity.name}/${divName !== undefined?divName:'$'}`;\r\n    }\r\n    buildParams():any {return this.params.ids}\r\n    xresult(res:any):any {\r\n        return (res as string).split('\\n');\r\n    }\r\n}\r\n\r\n\r\nclass SaveCaller extends TuidCaller<{id:number, props:any}> {\r\n    get path():string {return `tuid/${this.entity.name}`}\r\n    buildParams():any {\r\n        let {fields, arrs} = this.entity.schema;\r\n        let {id, props} = this.params;\r\n        let params:any = {$id: id};\r\n        this.transParams(params, props, fields);\r\n        if (arrs !== undefined) {\r\n            for (let arr of arrs) {\r\n                let arrName = arr.name;\r\n                let arrParams = [];\r\n                let arrFields = arr.fields;\r\n                let arrValues = props[arrName];\r\n                if (arrValues !== undefined) {\r\n                    for (let arrValue of arrValues) {\r\n                        let row = {};\r\n                        this.transParams(row, arrValue, arrFields);\r\n                        arrParams.push(row);\r\n                    }\r\n                }\r\n                params[arrName] = arrParams;\r\n            }\r\n        }\r\n        return params;\r\n    }\r\n    private transParams(values:any, params:any, fields:Field[]) {\r\n        if (params === undefined) return;\r\n        for (let field of fields) {\r\n            let {name, tuid, type} = field;\r\n            let val = params[name];\r\n            if (tuid !== undefined) {\r\n                if (typeof val === 'object') {\r\n                    if (val !== null) val = val.id;\r\n                }\r\n            }\r\n            else {\r\n                switch (type) {\r\n                    case 'date':\r\n                        val = this.entity.buildDateParam(val); \r\n                        break;\r\n                    case 'datetime':\r\n                        val = this.entity.buildDateTimeParam(val);\r\n                        break;\r\n                }\r\n            }\r\n            values[name] = val;\r\n        }\r\n    }\r\n}\r\n\r\nclass SearchCaller extends TuidCaller<{arr:string, owner:number, key:string, pageStart:string|number, pageSize:number}> {\r\n    get path():string {return `tuids/${this.entity.name}`}\r\n}\r\n\r\nclass AllCaller extends TuidCaller<{}> {\r\n    method = 'GET';\r\n    get path():string {return `tuid-all/${this.entity.name}`}\r\n}\r\n\r\nclass LoadArrCaller extends TuidCaller<{arr:string, owner:number, id:number}> {\r\n    method = 'GET';\r\n    get path():string {\r\n        let {arr, owner, id} = this.params;\r\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/${id}`;\r\n    }\r\n}\r\nclass SavePropCaller extends TuidCaller<{id:number, prop:string, value:any}> {\r\n    get path():string {return `tuid-prop/${this.entity.name}/`;}\r\n}\r\nclass SaveArrCaller extends TuidCaller<{arr:string, owner:number, id:number, props:any}> {\r\n    get path():string {\r\n        let {arr, owner} = this.params;\r\n        return `tuid-arr/${this.entity.name}/${owner}/${arr}/`;\r\n    }\r\n    buildParams():any {\r\n        let {id, props} = this.params;\r\n        let params = _.clone(props);\r\n        params['$id'] = id;\r\n        return params;\r\n    }\r\n}\r\nclass ArrPosCaller extends TuidCaller<{arr:string, owner:number, id:number, order:number}> {\r\n    get path():string {\r\n        let {arr, owner} = this.params;\r\n        return `tuid-arr-pos/${this.entity.name}/${owner}/${arr}/`;\r\n    }\r\n    buildParams():any {\r\n        let {id, order} = this.params;\r\n        return { bid: id, $order: order}\r\n    }\r\n}\r\nclass TuidNoCaller extends TuidCaller<{}> {\r\n    get path():string {\r\n        return `tuid-no/${this.entity.name}/`;\r\n    }\r\n    buildParams():any {\r\n\t\tlet d = new Date();\r\n\t\tlet year = d.getFullYear();\r\n\t\tlet month = d.getMonth() + 1;\r\n\t\tlet date = d.getDate();\r\n        return {year, month, date};\r\n    }\r\n}\r\n\r\nexport class TuidImport extends Tuid {\r\n    private tuidLocal: TuidInner;\r\n\r\n    constructor(uq:UqMan, name:string, typeId:number, from: SchemaFrom) {\r\n        super(uq, name, typeId);\r\n        this.from = from;\r\n    }\r\n\r\n    setFrom(tuidLocal: TuidInner) {this.tuidLocal = tuidLocal}\r\n    \r\n    readonly from: SchemaFrom;\r\n    isImport = true;\r\n\r\n    getObj(id:number): any {return this.tuidLocal?.getObj(id)}\r\n\ttv(id:number, render?:Render<any>):JSX.Element {\r\n\t\treturn this.tuidLocal?.tv(id, render);\r\n\t}\r\n\r\n    useId(id:number) {this.tuidLocal?.useId(id);}\r\n    boxId(id:number):BoxId {\r\n\t\tif (!this.tuidLocal) debugger;\r\n\t\treturn this.tuidLocal?.boxId(id);\r\n\t}\r\n    valueFromId(id:number) {return this.tuidLocal?.valueFromId(id)}\r\n\tresetCache(id:number|BoxId):void {\r\n\t\tthis.tuidLocal?.resetCache(id);\r\n\t}\r\n    async assureBox<T>(id:number):Promise<T> {\r\n        await this.tuidLocal.assureBox(id);\r\n\t\treturn this.tuidLocal.valueFromId(id);\r\n    }\r\n    get hasDiv():boolean {return this.tuidLocal?.hasDiv}\r\n    div(name:string):TuidDiv {return this.tuidLocal?.div(name)}\r\n    async loadMain(id:number|BoxId):Promise<any> {\r\n        let ret = await this.tuidLocal.loadMain(id);\r\n        return ret;\r\n    }\r\n    async load(id:number|BoxId):Promise<any> {\r\n        return await this.tuidLocal.load(id);\r\n    }\r\n    async save(id:number, props:any):Promise<TuidSaveResult> {\r\n        return await this.tuidLocal.save(id, props);\r\n\t}\r\n\tasync saveProp(id:number, prop:string, value:any):Promise<void> {\r\n\t\tawait this.tuidLocal.saveProp(id, prop, value);\r\n\t}\r\n    async all():Promise<any[]> {\r\n        return await this.tuidLocal.all();\r\n    }\r\n    async search(key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        return await this.tuidLocal.search(key, pageStart, pageSize);\r\n    }\r\n    async searchArr(owner:number, key:string, pageStart:string|number, pageSize:number):Promise<any> {\r\n        return await this.tuidLocal.searchArr(owner, key, pageStart, pageSize);\r\n    }\r\n    async loadArr(arr:string, owner:number, id:number):Promise<any> {\r\n        return await this.tuidLocal.loadArr(arr, owner, id);\r\n    }\r\n    async saveArr(arr:string, owner:number, id:number, props:any):Promise<void> {\r\n        await this.tuidLocal.saveArr(arr, owner, id, props);\r\n    }\r\n    async posArr(arr:string, owner:number, id:number, order:number):Promise<void> {\r\n        await this.tuidLocal.posArr(arr, owner, id, order);\r\n    }\r\n\tasync no():Promise<TuidNOResult> {\r\n\t\treturn await this.tuidLocal.no();\r\n\t}\r\n}\r\n\r\n// field._tuid 用这个接口\r\n// Tuid, TuidDiv 实现这个接口\r\nexport class TuidBox {\r\n    tuid: Tuid;\r\n    ownerField:Field = undefined;\r\n    constructor(tuid: Tuid) {\r\n        this.tuid = tuid;\r\n    }\r\n\r\n    boxId(id:number):BoxId {\r\n        return this.tuid.boxId(id);\r\n    }\r\n    getIdFromObj(obj:any):number {\r\n        return this.tuid.getIdFromObj(obj);\r\n    }\r\n    useId(id:number):void {\r\n        return this.tuid.useId(id);\r\n    }\r\n    async showInfo() {\r\n        alert('showInfo not implemented');\r\n    }\r\n}\r\n\r\n\r\nexport class TuidDiv extends TuidInner {\r\n    readonly typeName:string = 'div';\r\n    protected cacheFields: Field[];\r\n    protected tuid: TuidInner;\r\n    protected idName: string;\r\n    protected idCache: IdDivCache;\r\n\r\n    constructor(uq: UqMan, tuid: TuidInner, name: string) {\r\n        super(uq, name, 0);\r\n        this.tuid = tuid;\r\n        this.idName = 'id';\r\n        this.idCache = new IdDivCache(tuid, this);\r\n    }\r\n\r\n    get owner() {return this.tuid}\r\n\r\n    buildFieldsTuid() {\r\n        super.buildFieldsTuid();\r\n        let {mainFields} = this.schema;\r\n        if (mainFields === undefined) debugger;\r\n        this.uq.buildFieldTuid(this.cacheFields = mainFields);\r\n    }\r\n\r\n    buildTuidDivBox(ownerField: Field): TuidBoxDiv {\r\n        return new TuidBoxDiv(this.tuid, this, ownerField);\r\n    }\r\n\r\n    getIdFromObj(obj:any):number {return obj[this.idName]}\r\n    cacheValue(value:any):void {\r\n        this.idCache.cacheValue(value);\r\n    }\r\n\r\n    useId(id:number, defer?:boolean):void {\r\n        if (this.noCache === true) return;\r\n        this.idCache.useId(id, defer);\r\n    }\r\n\r\n    valueFromId(id:number):any {\r\n        return this.idCache.getValue(id)\r\n    }\r\n\r\n    async assureBox<T>(id:number):Promise<T> {\r\n\t\tawait this.idCache.assureObj(id);\r\n\t\treturn this.idCache.getValue(id);\r\n    }\r\n\r\n    async cacheIds() {\r\n        await this.idCache.cacheIds();\r\n    }\r\n\r\n    cacheTuidFieldValues(values:any) {\r\n        let fields = this.schema.fields;\r\n        this.cacheFieldsInValue(values, fields);\r\n    }\r\n\r\n    unpackTuidIds(values:string[]):any[] {\r\n        return this.unpackTuidIdsOfFields(values, this.cacheFields);\r\n    }\r\n}\r\n\r\nexport class TuidBoxDiv extends TuidBox {\r\n    ownerField: Field;\r\n    private div: TuidDiv;\r\n    constructor(tuid: Tuid, div: TuidDiv, ownerField: Field) {\r\n        super(tuid);\r\n        this.div = div;\r\n        this.ownerField = ownerField;\r\n    }\r\n\r\n    boxId(id:number):BoxId {\r\n        return this.div.boxId(id);\r\n    }\r\n    getIdFromObj(obj:any):number {\r\n        return this.div.getIdFromObj(obj);\r\n    }\r\n    useId(id:number):void {\r\n        return this.div.useId(id);\r\n    }\r\n}\r\n","import { UqMan, TuidModify } from '../uqMan';\r\nimport { Tuid } from \"./tuid\";\r\nimport { env } from '../../tool';\r\n\r\ninterface Modify {\r\n    id: number;\r\n    entity: string;\r\n    key: string;\r\n}\r\n\r\nexport class TuidsCache {\r\n    private readonly uq: UqMan;\r\n    private modifyMax: TuidModify;\r\n    private cacheTimer: any;\r\n    constructor(uq: UqMan) {\r\n        this.uq = uq;\r\n    }\r\n\r\n    cacheTuids(defer:number) {\r\n        this.clearCacheTimer();\r\n        this.cacheTimer = env.setTimeout('TuidsCache.cacheTuids', this.loadIds, defer);\r\n    }\r\n    private clearCacheTimer() {\r\n        if (this.cacheTimer === undefined) return;\r\n        env.clearTimeout(this.cacheTimer);\r\n        this.cacheTimer = undefined;\r\n    }\r\n    private loadIds = () => {\r\n        this.clearCacheTimer();\r\n        let {tuids} = this.uq;\r\n        for (let i in tuids) {\r\n            let tuid = tuids[i];\r\n            tuid.cacheIds();\r\n        }\r\n    }\r\n    \r\n    pullModify(modifyMax:number) {\r\n        if (modifyMax === undefined) return;\r\n        let now = Math.floor(Date.now() / 1000);\r\n        if (this.modifyMax === undefined) {\r\n            this.modifyMax = this.uq.localModifyMax.get();\r\n            if (this.modifyMax === undefined) {\r\n                this.modifyMax = {\r\n                    max: modifyMax,\r\n                    seconds: now,\r\n                };\r\n                this.uq.localModifyMax.set(this.modifyMax);\r\n            }\r\n        }\r\n        let {max, seconds} = this.modifyMax;\r\n        let lockGap = 3600;\r\n        if (now - seconds < lockGap) return;\r\n        if (modifyMax <= max) return;\r\n        let tuidCached:string[] = [];\r\n        let {tuids} = this.uq;\r\n        for (let i in tuids) {\r\n            //if (tuids[i].cached === true) \r\n            tuidCached.push(i);\r\n        }\r\n        if (tuidCached.length === 0) return;\r\n        this.modifyMax.seconds = now;\r\n        this.innerPullModify(tuidCached.join('\\t'));\r\n    }\r\n\r\n    private async innerPullModify(tuidLists:string):Promise<void> {\r\n        let {uqApi, tuids} = this.uq;\r\n        let {max} = this.modifyMax;\r\n        let ret:{queue:Modify[], queueMax:number} = await uqApi.queueModify(max, 30, tuidLists);\r\n        let group:{[entity:string]: {tuid:Tuid; ids: string[]}} = {};\r\n        let modifyMax:number = 0;\r\n        for (let modify of ret.queue) {\r\n\t\t\tlet {id, entity, key} = modify;\r\n\t\t\tif (!key) continue;\r\n            let tuid = tuids[entity];\r\n            if (tuid === undefined) continue;\r\n            let item = group[entity];\r\n            if (item === undefined) {\r\n                item = group[entity] = {tuid: tuid, ids:[]};\r\n            }\r\n            item.ids.push(key);\r\n            if (id > modifyMax) modifyMax = id;\r\n        }\r\n        for (let i in group) {\r\n            let {tuid, ids} = group[i];\r\n            await tuid.modifyIds(ids);\r\n        }\r\n        let now = Math.floor(Date.now() / 1000);\r\n        this.modifyMax = {\r\n            max: modifyMax,\r\n            seconds: now,\r\n        }\r\n        this.uq.localModifyMax.set(this.modifyMax);\r\n    }\r\n}\r\n","import { Entity } from './entity';\r\nimport { ActionCaller } from './caller';\r\n\r\nexport class UqAction<P, R> extends Entity {\r\n    get typeName(): string { return 'action';}\r\n    async submit(data:P, $$user:number = undefined, waiting: boolean = true) {\r\n\t\tlet caller = new ActionSubmitCaller(this, data, $$user, waiting)\r\n\t\tlet ret = await caller.request();\r\n\t\treturn ret;\r\n    }\r\n    async submitReturns(data:P, $$user:number = undefined):Promise<R> {\r\n       return await new SubmitReturnsCaller(this, data, $$user).request();\r\n    }\r\n    async submitConvert(data:P, $$user:number = undefined) {\r\n        return await new SubmitConvertCaller(this, data, $$user).request();\r\n    }\r\n}\r\n\r\nexport class Action extends UqAction<any, any> {\r\n}\r\n\r\nexport class ActionSubmitCaller extends ActionCaller {\r\n    get path():string {return 'action/' + this.entity.name;}\r\n    buildParams():any {\r\n\t\treturn {\r\n            $$user: this.$$user,\r\n            data: this.entity.pack(this.params)\r\n        };\r\n\t}\r\n}\r\n\r\nclass SubmitReturnsCaller extends ActionSubmitCaller {\r\n    get path():string {return 'action/' + this.entity.name + '/returns';}\r\n    xresult(res:any):any {\r\n        let {returns} = this.entity;\r\n        let len = returns.length;\r\n        let ret:{[r:string]:any[]} = {};\r\n        for (let i=0; i<len; i++) {\r\n            let retSchema = returns[i];\r\n            ret[retSchema.name] = res[i];\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nclass SubmitConvertCaller extends ActionSubmitCaller {\r\n    get path():string {return 'action-convert/' + this.entity.name;}\r\n    buildParams():any {\r\n        return {\r\n            $$user: this.$$user,\r\n            data: this.params\r\n        };\r\n    }\r\n}\r\n","import { Entity } from './entity';\r\nimport { PageItems } from '../tool/pageItems';\r\nimport { EntityCaller } from './caller';\r\nimport { ArrFields } from './uqMan';\r\n\r\nexport interface SheetState {\r\n    name: string;\r\n    actions: SheetAction[];\r\n}\r\n\r\nexport interface SheetAction {\r\n    name: string;\r\n}\r\n\r\nexport interface StateCount {\r\n    state: string;\r\n    count: number;\r\n}\r\n\r\nexport interface SheetSaveReturnV<V> {\r\n\tid: number;\r\n\tflow: number;\r\n\tstate: string;\r\n\tverify: V[];\r\n}\r\n\r\nexport interface SheetSaveReturn extends SheetSaveReturnV<any> {\r\n}\r\n\r\ninterface GetSheetReturn<M> {\r\n\tbrief: any;\r\n\tdata: M;\r\n\tflows: any[];\r\n}\r\n\r\nexport class UqSheet<M, V> extends Entity {\r\n    get typeName(): string { return 'sheet';}\r\n\tstates: SheetState[];\r\n\tverify: {returns: ArrFields[]};\r\n\r\n    /*\r\n    setStates(states: SheetState[]) {\r\n        for (let state of states) {\r\n            this.setStateAccess(this.states.find(s=>s.name==state.name), state);\r\n        }\r\n    }*/\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n\t\tthis.states = schema.states;\r\n\t\tthis.verify = schema.verify;\r\n    }\r\n    build(obj:any) {\r\n        this.states = [];\r\n        for (let op of obj.ops) {\r\n            this.states.push({name: op, actions:undefined});\r\n        }\r\n        /*\r\n        for (let p in obj) {\r\n            switch(p) {\r\n                case '#':\r\n                case '$': continue;\r\n                default: this.states.push(this.createSheetState(p, obj[p])); break;\r\n            }\r\n        }*/\r\n    }\r\n    private createSheetState(name:string, obj:object):SheetState {\r\n        let ret:SheetState = {name:name, actions:[]};\r\n        let actions = ret.actions;\r\n        for (let p in obj) {\r\n            let action:SheetAction = {name: p};\r\n            actions.push(action);\r\n        }\r\n        return ret;\r\n    }\r\n    async save(discription:string, data:M):Promise<SheetSaveReturnV<V>> {\r\n        let {id} = this.uq;\r\n        let params = {app: id, discription: discription, data:data};\r\n        return await new SaveCaller(this, params).request();\r\n    }\r\n    async saveDebugDirect(discription:string, data:M):Promise<SheetSaveReturn> {\r\n        let {id} = this.uq;\r\n        let params = {app: id, discription: discription, data:data};\r\n        return await new SaveDirectCaller(this, params).request();\r\n    }\r\n    async action(id:number, flow:number, state:string, action:string) {\r\n        return await new ActionCaller(this, {id:id, flow:flow, state:state, action:action}).request();\r\n    }\r\n    async actionDebugDirect(id:number, flow:number, state:string, action:string) {\r\n        return await new ActionDirectCaller(this, {id:id, flow:flow, state:state, action:action}).request();\r\n    }\r\n    private unpack(data:any):GetSheetReturn<M> {\r\n        //if (this.schema === undefined) await this.loadSchema();\r\n        let ret = data[0];\r\n        let brief = ret[0];\r\n        let sheetData = this.unpackSheet(brief.data);\r\n        let flows = data[1];\r\n        return {\r\n            brief: brief,\r\n            data: sheetData,\r\n            flows: flows,\r\n        }\r\n    }\r\n    async getSheet(id:number):Promise<GetSheetReturn<M>> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.getSheet(this.name, id);\r\n        */\r\n        let ret = await new GetSheetCaller(this, id).request();\r\n        if (ret[0].length === 0) return await this.getArchive(id);\r\n        return this.unpack(ret);\r\n    }\r\n    async getArchive(id:number):Promise<GetSheetReturn<M>> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.sheetArchive(this.name, id)\r\n        return this.unpack(ret);\r\n        */\r\n        let ret = await new SheetArchiveCaller(this, id).request();\r\n        return this.unpack(ret);\r\n    }\r\n\r\n    async getArchives(pageStart:number, pageSize:number) {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.sheetArchives(this.name, {pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {pageStart:pageStart, pageSize:pageSize};\r\n        return await new SheetArchivesCaller(this, params).request();\r\n    }\r\n\r\n    async getStateSheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.stateSheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\r\n        return await new StateSheetsCaller(this, params).request();\r\n    }\r\n    //createPageStateItems<T>(): PageStateItems<T> {return new PageStateItems<T>(this);}\r\n\r\n    async stateSheetCount():Promise<StateCount[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret:StateCount[] = await this.uqApi.stateSheetCount(this.name);\r\n        return this.states.map(s => {\r\n            let n = s.name, count = 0;\r\n            let r = ret.find(v => v.state === n);\r\n            if (r !== undefined) count = r.count;\r\n            return {state: n, count: count} \r\n        });\r\n        */\r\n        return await new StateSheetCountCaller(this, undefined).request();\r\n    }\r\n\r\n    async userSheets(state:string, user:number, pageStart:number, pageSize:number):Promise<any[]> {\r\n        let params = {state:state, user:user, pageStart:pageStart, pageSize:pageSize};\r\n        return await new UserSheetsCaller(this, params).request();\r\n    }\r\n\r\n    async mySheets(state:string, pageStart:number, pageSize:number):Promise<any[]> {\r\n        /*\r\n        await this.loadSchema();\r\n        let ret = await this.uqApi.mySheets(this.name, {state:state, pageStart:pageStart, pageSize:pageSize});\r\n        return ret;\r\n        */\r\n        let params = {state:state, pageStart:pageStart, pageSize:pageSize};\r\n        return await new MySheetsCaller(this, params).request();\r\n    }\r\n}\r\n\r\nexport class Sheet extends UqSheet<any, any> {\r\n}\r\n\r\nabstract class SheetCaller<T> extends EntityCaller<T> {\r\n    protected get entity(): Sheet {return this._entity as Sheet;}\r\n    protected readonly suffix:string;\r\n    get path():string {return `sheet/${this.entity.name}/${this.suffix}`;}\r\n}\r\n\r\nclass SaveCaller extends SheetCaller<{app:number; discription:string; data:any}> {\r\n    get path():string {return `sheet/${this.entity.name}`;}\r\n    buildParams() {\r\n        let {app, discription, data} = this.params;\r\n        return {\r\n            app: app,\r\n            discription: discription,\r\n            data: this.entity.pack(data)\r\n        };\r\n    }\r\n    xresult(res:any):any {\r\n\t\tlet {verify} = this.entity;\r\n\t\tif (verify === undefined) return res;\r\n\t\tlet resVerify = res.verify;\r\n\t\tif (resVerify === undefined || resVerify.length === 0) {\r\n\t\t\tres.verify = undefined;\r\n\t\t\treturn res;\r\n\t\t}\r\n\t\tlet {returns} = verify;\r\n\t\tres.verify = this.entity.unpackReturns(resVerify, returns);\r\n        return res;\r\n    }\r\n}\r\n\r\nclass SaveDirectCaller extends SaveCaller {\r\n    get path():string {return `sheet/${this.entity.name}/direct`;}\r\n}\r\n\r\nclass ActionCaller extends SheetCaller<{id:number, flow:number, state:string, action:string}> {\r\n    method = 'PUT';\r\n    get path():string {return `sheet/${this.entity.name}`;}\r\n}\r\n\r\nclass ActionDirectCaller extends ActionCaller {\r\n    get path():string {return `sheet/${this.entity.name}/direct`;}\r\n}\r\n\r\nclass GetSheetCaller extends SheetCaller<number> {\r\n    //protected readonly params: number;  // id\r\n    method = 'GET';\r\n    //private id:number;\r\n    //protected readonly suffix = 'archive';\r\n    buildParams() {}\r\n    get path():string {return `sheet/${this.entity.name}/get/${this.params}`;}\r\n}\r\n\r\nclass SheetArchiveCaller extends SheetCaller<number> {\r\n    //protected readonly params: number;  // id\r\n    method = 'GET';\r\n    //protected readonly suffix = 'archive';\r\n    buildParams() {}\r\n    get path():string {return `sheet/${this.entity.name}/archive/${this.params}`;}\r\n}\r\n\r\nclass SheetArchivesCaller extends SheetCaller<{pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'archives';\r\n}\r\n\r\nclass StateSheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'states';\r\n}\r\n\r\nclass StateSheetCountCaller extends SheetCaller<undefined> {\r\n    method = 'GET';\r\n    protected readonly suffix = 'statecount';\r\n    xresult(res:any):any {\r\n        let {states} = this.entity;\r\n        return states.map(s => {\r\n            let n = s.name, count = 0;\r\n            let r = (res as any[]).find(v => v.state === n);\r\n            if (r !== undefined) count = r.count;\r\n            return {state: n, count: count} \r\n        });\r\n    }\r\n}\r\n\r\nclass UserSheetsCaller extends SheetCaller<{state:string, user:number, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'user-sheets';\r\n    xresult(res:any):any {\r\n        return res;\r\n    }\r\n}\r\n\r\nclass MySheetsCaller extends SheetCaller<{state:string, pageStart:number, pageSize:number}> {\r\n    protected readonly suffix = 'my-sheets';\r\n    xresult(res:any):any {\r\n        return res;\r\n    }\r\n}\r\n/*\r\nexport class PageStateItems<T> extends PageItems<T> {\r\n    private sheet: Sheet;\r\n    constructor(sheet: Sheet) {\r\n        super(true);\r\n        this.sheet = sheet;\r\n        this.pageSize = 10;\r\n\t}\r\n\tprotected async loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.sheet.getStateSheets(param, pageStart, pageSize);\r\n\t\treturn {$page: ret};\r\n\t}\r\n\tprotected getPageId(item:T) {\r\n\t\treturn item === undefined? 0 : (item as any).id;\r\n\t}\r\n}\r\n*/\r\n","import _ from 'lodash';\r\nimport {observable, IObservableArray} from 'mobx';\r\nimport { PageItems } from '../tool';\r\nimport {Field, ArrFields} from './uqMan';\r\nimport {Entity} from './entity';\r\nimport { QueryQueryCaller, QueryPageCaller } from './caller';\r\n\r\nexport type QueryPageApi = (name:string, pageStart:any, pageSize:number, params:any) => Promise<string>;\r\n\r\nexport class QueryPager<T extends any> extends PageItems<T> {\r\n\tprivate query: Query;\r\n\tprivate $page: any;\r\n\tprotected idFieldName: any;\r\n    constructor(query: Query, pageSize?: number, firstSize?: number, itemObservable?:boolean) {\r\n        super(itemObservable);\r\n        this.query = query;\r\n        if (pageSize !== undefined) this.pageSize = pageSize;\r\n\t\tif (firstSize !== undefined) this.firstSize = firstSize;\r\n\t}\r\n\r\n\tsetReverse() {\r\n\t\tthis.appendPosition = 'head';\r\n\t}\r\n\r\n    protected async onLoad() {\r\n\t\tif (this.$page) return;\r\n        let {schema} = this.query;\r\n        if (schema === undefined) {\r\n\t\t\tawait this.query.loadSchema();\r\n\t\t\tschema = this.query.schema;\r\n\t\t}\r\n\t\tif (schema === undefined) return;\r\n\t\tlet $page = this.$page = (schema.returns as any[]).find(v => v.name === '$page');\r\n\t\tif ($page === undefined) return;\r\n\t\tthis.sortOrder = $page.order;\r\n\t\tlet fields = $page.fields;\r\n\t\tif (fields !== undefined) {\r\n\t\t\tlet field = fields[0];\r\n\t\t\tif (field) this.idFieldName = field.name;\r\n\t\t}\r\n    }\r\n\r\n    protected async loadResults(param:any, pageStart:number, pageSize:number, $$user:number = undefined):Promise<{[name:string]:any[]}> {\r\n\t\tlet ret = await this.query.page(param, pageStart, pageSize, $$user);\r\n\t\treturn ret;\r\n\t}\r\n\tprotected getPageId(item:T) {\r\n\t\tif (item === undefined) return;\r\n\t\tif (typeof item === 'number') return item;\r\n\t\tlet start = (item as any)[this.idFieldName];\r\n\t\tif (start === null) return;\r\n\t\tif (start === undefined) return;\r\n\t\tif (typeof start === 'object') {\r\n\t\t\tlet id = start.id;\r\n\t\t\tif (id !== undefined) return id;\r\n\t\t}\r\n\t\treturn start;\r\n\t}\r\n\tasync refreshItems(item:T) {\r\n\t\tlet index = this._items.indexOf(item);\r\n\t\tif (index < 0) return;\r\n\t\tlet startIndex:number;\r\n\t\tif (this.appendPosition === 'tail') {\r\n\t\t\tstartIndex = index - 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tstartIndex = index + 1;\r\n\t\t}\r\n\t\tlet pageStart = this.getPageId(this._items[startIndex]);\r\n\t\tlet pageSize = 1;\r\n        let ret = await this.load(\r\n\t\t\tthis.param, \r\n\t\t\tpageStart,\r\n\t\t\tpageSize);\r\n\t\tlet len = ret.length;\r\n\t\tif (len === 0) {\r\n\t\t\tthis._items.splice(index, 1);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet newItem = ret[i];\r\n\t\t\tif (!newItem) continue;\r\n\t\t\tlet newId = newItem[this.idFieldName];\r\n\t\t\tif (newId === undefined || newId === null) continue;\r\n\t\t\tif (typeof newId === 'object') newId = newId.id;\r\n\t\t\tlet oldItem = this._items.find(v => {\r\n\t\t\t\tlet oldId = (v as any)[this.idFieldName];\r\n\t\t\t\tif (oldId === undefined || oldId === null) return false;\r\n\t\t\t\tif (typeof oldId === 'object') oldId = oldId.id;\r\n\t\t\t\treturn oldId = newId;\r\n\t\t\t});\r\n\t\t\tif (oldItem) {\r\n\t\t\t\t_.merge(oldItem, newItem);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n\r\nexport class UqQuery<P, R> extends Entity {\r\n    get typeName(): string { return 'query';}\r\n    private pageStart: any;\r\n    private pageSize:number;\r\n    private params:any;\r\n    private more: boolean;\r\n    private startField: Field;\r\n    list:IObservableArray; \r\n    returns: ArrFields[];\r\n\tisPaged: boolean;\r\n\t\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        let {returns} = schema;\r\n        this.returns = returns;\r\n        this.isPaged = returns && (returns as any[]).find(v => v.name === '$page') !== undefined;\r\n    }\r\n\r\n    resetPage(size:number, params:any) {\r\n        this.pageStart = undefined;\r\n        this.pageSize = size;\r\n        this.params = params;\r\n        this.more = false;\r\n        this.list = undefined;\r\n    }\r\n    get hasMore() {return this.more;}\r\n    async loadPage():Promise<void> {\r\n        if (this.pageSize === undefined) {\r\n            throw new Error('call resetPage(size:number, params:any) first');\r\n        }\r\n        let pageStart:any;\r\n        if (this.pageStart !== undefined) {\r\n            switch (this.startField.type) {\r\n                default: pageStart = this.pageStart; break;\r\n                case 'date':\r\n                case 'time':\r\n                case 'datetime': pageStart = (this.pageStart as Date).getTime(); break;\r\n            }\r\n        }\r\n\t\tlet ret = await this.page(this.params, pageStart, this.pageSize+1);\r\n\t\tlet page = (ret as any).$page;\r\n        this.list = observable.array([], {deep: false});\r\n        if (page !== undefined) {\r\n            if (page.length > this.pageSize) {\r\n                this.more = true;\r\n                page.pop();\r\n                let ret = this.returns.find(r => r.name === '$page');\r\n                this.startField = ret.fields[0];\r\n                this.pageStart = page[page.length-1][this.startField.name];\r\n            }\r\n            else {\r\n                this.more = false;\r\n            }\r\n            this.list.push(...page);\r\n        }\r\n    }\r\n\r\n    protected pageCaller(params: any, $$user:number = undefined, showWaiting: boolean = true): QueryPageCaller {\r\n        return new QueryPageCaller(this, params, $$user, showWaiting);\r\n    }\r\n\r\n    async page(params:P, pageStart:any, pageSize:number, $$user:number = undefined, showWaiting: boolean = true):Promise<R> {\r\n        let p = {pageStart, pageSize, params};\r\n        let res = await this.pageCaller(p, $$user, showWaiting).request();\r\n        return res;\r\n    }\r\n    protected queryCaller(params: P, $$user:number = undefined, showWaiting: boolean = true): QueryQueryCaller {\r\n        return new QueryQueryCaller(this, params, $$user, showWaiting);\r\n    }\r\n    async query(params:P, $$user:number = undefined, showWaiting:boolean = true):Promise<R> {\r\n        let res = await this.queryCaller(params, $$user, showWaiting).request();\r\n        return res;\r\n    }\r\n    async table(params:P, $$user:number = undefined, showWaiting:boolean = true): Promise<any[]> {\r\n        let ret = await this.query(params, $$user, showWaiting);\r\n        for (let i in ret) {\r\n            return (ret as any)[i];\r\n        }\r\n    }\r\n    async obj(params:P, $$user:number = undefined, showWaiting:boolean = true):Promise<any> {\r\n        let ret = await this.table(params, $$user,showWaiting);\r\n        if (ret.length > 0) return ret[0];\r\n    }\r\n    async scalar(params:P, $$user:number = undefined, showWaiting:boolean = true):Promise<any> {\r\n        let ret = await this.obj(params, $$user, showWaiting);\r\n        for (let i in ret) return ret[i];\r\n    }\r\n}\r\n\r\nexport class Query extends UqQuery<any, any> {\r\n}\r\n","import { UqQuery} from './query';\r\nimport { QueryQueryCaller } from './caller';\r\n\r\nexport class UqBook<P, R> extends UqQuery<P, R> {\r\n    get typeName(): string { return 'book';}\r\n    protected queryApiName = 'book';\r\n\r\n    protected queryCaller(params: any): QueryQueryCaller {\r\n        return new BookQueryCaller(this, params);\r\n    }\r\n}\r\n\r\nexport class Book extends UqBook<any, any> {\r\n}\r\n\r\nexport class BookQueryCaller extends QueryQueryCaller {\r\n    get path():string {return `book/${this.entity.name}`;}\r\n}\r\n","import { UqQuery } from './query';\r\n\r\nexport class UqHistory<P,R> extends UqQuery<P,R>  {\r\n    get typeName(): string { return 'history';}\r\n    protected queryApiName = 'history';\r\n}\r\n\r\nexport class History extends UqHistory<any, any> {\r\n}\r\n","import { Entity } from './entity';\r\nimport { Action, ActionSubmitCaller } from './action';\r\nimport { Query } from './query';\r\nimport { Field } from './uqMan';\r\nimport { EntityCaller, QueryPageCaller, QueryQueryCaller } from './caller';\r\n\r\ninterface MapActions {\r\n    add: Action;\r\n    del: Action;\r\n}\r\ninterface MapQueries {\r\n    all: Query;\r\n    page: Query;\r\n    query: Query;\r\n}\r\n\r\nexport class UqMap extends Entity {\r\n    get typeName(): string { return 'map';}\r\n    keys: Field[];\r\n    actions: MapActions = {} as any;\r\n    queries: MapQueries = {} as any;\r\n    schemaFrom: {owner:string; uq:string};\r\n\r\n    setSchema(schema:any) {\r\n        super.setSchema(schema);\r\n        this.schemaFrom = this.schema.from;\r\n        let {actions, queries, keys} = schema;\r\n        this.uq.buildFieldTuid(this.keys = keys);\r\n        for (let i in actions) {\r\n            let actionSchema = actions[i];\r\n            let {name} = actionSchema;\r\n            let action = this.uq.newAction(name, undefined);\r\n            action.setSchema(actionSchema);\r\n            action.buildFieldsTuid();\r\n            (this.actions as any)[i] = action;\r\n        }\r\n        for (let i in queries) {\r\n            let querySchema = queries[i];\r\n            let {name} = querySchema;\r\n            let query = this.uq.newQuery(name, undefined);\r\n            query.setSchema(querySchema);\r\n            query.buildFieldsTuid();\r\n            (this.queries as any)[i] = query;\r\n        }\r\n    }\r\n\r\n    async add(param:any) {\r\n        let ret = await new AddCaller(this, param).request();\r\n        return ret;\r\n    }\r\n\r\n    async del(param:any) {\r\n        let ret = await new DelCaller(this, param).request();\r\n        return ret;\r\n    }\r\n\r\n    async all() {\r\n        let ret = await new AllCaller(this, undefined).request();\r\n        return ret;\r\n    }\r\n\r\n    async page(param:any, pageStart:any, pageSize: number) {\r\n        let ret = await new PageCaller(this, {pageStart:pageStart, pageSize:pageSize, param:param}).request();\r\n        return ret;\r\n    }\r\n\r\n    async query(param:any) {\r\n       let qc = new QueryCaller(this, param);\r\n       let ret = await qc.request();\r\n       return ret;\r\n   }\r\n    async table(params:any): Promise<any[]> {\r\n        let ret = await this.query(params);\r\n        for (let i in ret) {\r\n            return ret[i];\r\n        }\r\n    }\r\n    async obj(params:any):Promise<any> {\r\n        let ret = await this.table(params);\r\n        if (ret.length > 0) return ret[0];\r\n    }\r\n    async scalar(params:any):Promise<any> {\r\n        let ret = await this.obj(params);\r\n        for (let i in ret) return ret[i];\r\n    }\r\n}\r\n\r\nexport class Map extends UqMap {\r\n}\r\n\r\nabstract class MapCaller extends EntityCaller<any> {\r\n    protected get entity(): Map {return this._entity as Map;}\r\n    get path():string {return undefined;}\r\n\r\n    protected abstract getCaller(param: any):EntityCaller<any>;\r\n\r\n    protected async innerCall(): Promise<any> {\r\n        let caller = this.getCaller(this.params);\r\n        let res = await this.entity.uqApi.xcall(caller);\r\n        let ret = caller.xresult(res.res);\r\n        return {res: ret};\r\n    }\r\n\r\n    buildParams() {\r\n        let p = super.buildParams();\r\n        return p;\r\n    }\r\n}\r\n\r\nclass AddCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapAddCaller(this.entity, this.entity.actions.add, param);\r\n    }\r\n}\r\n\r\nclass DelCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapDelCaller(this.entity, this.entity.actions.add, param);\r\n    }\r\n}\r\n\r\nclass AllCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapAllCaller(this.entity, this.entity.queries.all, param);\r\n    }\r\n}\r\n\r\nclass PageCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapPageCaller(this.entity, this.entity.queries.page, param);\r\n    }\r\n}\r\n\r\nclass QueryCaller extends MapCaller {\r\n    protected getCaller(param:any):EntityCaller<any> {\r\n        return new MapQueryCaller(this.entity, this.entity.queries.query, param);\r\n    }\r\n}\r\n\r\nclass MapAddCaller extends ActionSubmitCaller {\r\n    private map: Map;\r\n    constructor(map:Map, action:Action, params:any) {\r\n        super(action, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/add`}\r\n    get headers(): {[header:string]: string} {return undefined;}\r\n}\r\n\r\nclass MapDelCaller extends ActionSubmitCaller {\r\n    private map: Map;\r\n    constructor(map:Map, action:Action, params:any) {\r\n        super(action, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/del`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapAllCaller extends QueryPageCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/all`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapPageCaller extends QueryPageCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/page`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n\r\nclass MapQueryCaller extends QueryQueryCaller {\r\n    private map: Map;\r\n    constructor(map:Map, query:Query, params:any) {\r\n        super(query, params);\r\n        this.map = map;\r\n    }\r\n\r\n    get path():string {return `map/${this.map.name}/query`}\r\n    get headers(): {[header:string]: string} {return undefined}\r\n}\r\n","import { UqQuery } from './query';\r\n\r\nexport class UqPending<P,R> extends UqQuery<P,R>  {\r\n    get typeName(): string { return 'pending';}\r\n    protected queryApiName = 'pending';\r\n}\r\n\r\nexport class Pending extends UqPending<any, any> {\r\n}\r\n","import { Entity } from \"./entity\";\r\n\r\nexport class UqEnum extends Entity {\r\n    get typeName(): string { return 'enum';}\r\n}","import { TFunc } from \"../res\";\r\nimport { Entity } from \"./entity\";\r\nimport { Render, UI } from '../ui';\r\nimport { Uq } from \"./uqMan\";\r\n\r\nexport interface IDXEntity<M> {\r\n\treadonly ui: UI;\r\n\treadonly render: Render<M>;\r\n\treadonly t: TFunc;\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nexport class UqID<M extends {id:number}> extends Entity implements IDXEntity<M> {\r\n\treadonly ui: UI;\r\n\treadonly render: Render<M>;\r\n\treadonly t: TFunc;\r\n\tget typeName() {return 'id'}\r\n\tcreate: boolean;\r\n\tupdate: boolean;\r\n\towner: boolean;\r\n\tasync NO(): Promise<string> {\r\n\t\tlet ret = await this.uqApi.post('id-no', {ID:this.name});\r\n\t\treturn ret;\r\n\t};\r\n\tgetIdFromObj(value: any): number {return value['id'];}\r\n\tcacheTuids(defer: number): void {}\r\n\tasync loadValuesFromIds(divName: string, ids:number[]): Promise<M[]> {\r\n\t\tlet ret = await (this.uq as unknown as Uq).QueryID<M>({\r\n\t\t\tIDX: [this],\r\n\t\t\tid: ids\r\n\t\t});\r\n        return ret;\r\n\t}\r\n\tcacheTuidFieldValues(value: any): void {}\r\n\tunpackTuidIds(values:string[]): any[] {return;}\r\n}\r\n\r\nexport class ID extends UqID<any> {\t\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nexport class UqIDX<M> extends Entity implements IDXEntity<M> {\r\n\treadonly ui: UI;\r\n\treadonly render: Render<M>;\r\n\treadonly t: TFunc;\r\n\tget typeName() {return 'idx'}\r\n}\r\n\r\nexport class IDX extends UqIDX<any> {\r\n}\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nexport class UqIX<M> extends Entity implements IDXEntity<M> {\r\n\treadonly ui: UI;\r\n\treadonly render: Render<M>;\r\n\treadonly t: TFunc;\r\n\tget typeName() {return 'ix'}\r\n}\r\n\r\nexport class IX extends UqIX<any> {\r\n}\r\n\r\n/* eslint-enable no-unused-vars */\r\n","import { observable } from 'mobx';\r\nimport { Uq } from '../uqMan';\r\n\r\nconst maxCacheSize = 1000;\r\nconst delayLoad = 30; \t// 延迟loading的时间\r\nexport class IDCache {\r\n\tprotected uq: Uq;\r\n\tprivate queue: number[] = [];               \t\t\t\t\t\t\t// 每次使用，都排到队头\r\n\tprivate cache = observable.map<number, object|number>({}, {deep: false});    // 已经缓冲的, 如果是数值，则是重复取的次数\r\n\tprivate waitingIds: number[] = [];          \t\t\t\t\t\t\t// 等待loading的\r\n\tprivate timeoutHandler: any;\r\n\r\n\tconstructor(uq: Uq) {\r\n\t\tthis.uq = uq;\r\n\t}\r\n\r\n\tgetValue(id:number): object {\r\n\t\tlet ret = this.cache.get(id);\r\n\t\tif (ret === null) return;\r\n\t\tif (ret === undefined) {\r\n\t\t\tthis.useId(id);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (typeof ret === 'number') return;\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprotected async TvIdValues(waitingIds: number[]) {\r\n\t\treturn await this.uq.IDTv(waitingIds);\r\n\t}\r\n\r\n\tprivate timeOut = async () => {\r\n\t\tlet waitingIds = this.waitingIds;\r\n\t\tthis.waitingIds = [];\r\n\t\tif (waitingIds.length === 0) return;\r\n\t\tlet values = await this.TvIdValues(waitingIds);\r\n\t\tfor (let val of values) {\r\n\t\t\tlet {id} = val;\r\n\t\t\tif (waitingIds[0] < 0) id = -id;\r\n\t\t\tthis.cache.set(id, val);\r\n\t\t\tlet index = waitingIds.findIndex(v => v === id);\r\n\t\t\tif (index >= 0) waitingIds.splice(index, 1);\r\n\t\t}\r\n\t\tfor (let id of waitingIds) {\r\n\t\t\tthis.cache.set(id, null);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate useId(id:number) {\r\n\t\tif (!id) return;\r\n\t\tif (typeof id !== 'number') {\r\n\t\t\tconsole.error('id cache ' + id + ' is not number');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.cache.has(id) === true) {\r\n\t\t\tthis.moveToHead(id);\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tclearTimeout(this.timeoutHandler);\r\n\t\tthis.timeoutHandler = setTimeout(this.timeOut, delayLoad);\r\n\t\t//this.cache.set(id, 0);\r\n\t\tif (this.waitingIds.findIndex(v => v === id) >= 0) {\r\n\t\t\tthis.moveToHead(id);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (this.queue.length >= maxCacheSize) {\r\n\t\t\t// 缓冲已满，先去掉最不常用的\r\n\t\t\tlet r = this.queue.shift();\r\n\t\t\tif (r === id) {\r\n\t\t\t\t// 如果移除的，正好是现在用的，则插入\r\n\t\t\t\tthis.queue.push(r);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\r\n\t\t\t//let rKey = String(r);\r\n\t\t\tif (this.cache.has(r) === true) {\r\n\t\t\t\t// 如果移除r已经缓存\r\n\t\t\t\tthis.cache.delete(r);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t// 如果移除r还没有缓存\r\n\t\t\t\tlet index = this.waitingIds.findIndex(v => v === r);\r\n\t\t\t\tthis.waitingIds.splice(index, 1);\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.waitingIds.push(id);\r\n\t\tthis.queue.push(id);\r\n\t\treturn;\r\n\t}\r\n\r\n\tprivate moveToHead(id:number) {\r\n\t\tlet index = this.queue.findIndex(v => v === id);\r\n\t\tthis.queue.splice(index, 1);\r\n\t\tthis.queue.push(id);\r\n\t}\r\n\r\n\tremove(id:number) {\r\n\t\tthis.cache.delete(id);\r\n\t\tlet index = this.queue.findIndex(v => v === id);\r\n\t\tthis.queue.splice(index, 1);\r\n\t\t//this.localArr.removeItem(id);\r\n\t}\r\n\r\n\tresetCache(id:number) {\r\n\t\tthis.remove(id);\r\n\t\tthis.useId(id);\r\n\t}\r\n}\r\n","import { env } from '../tool';\r\nimport { UqData } from '../net';\r\nimport { UqMan } from './uqMan';\r\nimport { TuidImport, TuidInner } from './tuid';\r\n//import { nav } from '../components';\r\nimport { UqConfig } from '../appConfig';\r\nimport { Web } from '../web';\r\n\r\nexport interface TVs {\r\n    [uqName:string]: {\r\n        [tuidName: string]: (values: any) => JSX.Element;\r\n    }\r\n}\r\n\r\nexport class UQsMan {\r\n\tprivate web:Web;\r\n\tprivate uqMans: UqMan[] = [];\r\n    private collection: {[uqLower: string]: UqMan};\r\n    private readonly tvs: TVs;\r\n\tproxy: any;\r\n\r\n    constructor(web:Web, tvs:TVs) {\r\n\t\tthis.web = web;\r\n        this.tvs = tvs || {};\r\n\t\tthis.buildTVs();\r\n\t\tthis.uqMans = [];\r\n        this.collection = {};\r\n    }\r\n\r\n\tasync buildUqs(uqDataArr:UqData[], version:string, uqConfigs:UqConfig[], isBuildingUQ:boolean):Promise<string[]> {\r\n        await this.init(uqDataArr);\r\n\r\n\t\tlet localMap = env.localDb.map('$app');\r\n\t\tlet localCacheVersion = localMap.child('version');\r\n\t\tlet cacheVersion = localCacheVersion.get();\r\n\t\tif (version !== cacheVersion) {\r\n\t\t\tfor (let uqMan of this.uqMans) {\r\n\t\t\t\tuqMan.localMap.removeAll();\r\n\t\t\t}\r\n\t\t\tlocalCacheVersion.set(version);\r\n\t\t}\r\n\r\n        let retErrors = await this.load();\r\n\t\tif (retErrors.length > 0) return retErrors;\r\n\t\tif (isBuildingUQ === false) {\r\n\t\t\tthis.setTuidImportsLocal();\r\n\t\t}\r\n\t\tif (retErrors.length > 0) return retErrors;\r\n\t\tif (uqConfigs) {\r\n\t\t\tfor (let uqConfig of uqConfigs) {\r\n\t\t\t\tlet {dev, name, alias} = uqConfig;\r\n\t\t\t\tlet {name:owner, alias:ownerAlias} = dev;\r\n\t\t\t\tlet uqLower = (ownerAlias??owner).toLowerCase() + '/' + (alias??name).toLowerCase();\r\n\t\t\t\tlet uq = this.collection[uqLower];\r\n\t\t\t\tuq.config = uqConfig;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.proxy = this.buildUQs();\r\n\t}\r\n\r\n\tuq(uqName: string): UqMan {\r\n\t\treturn this.collection[uqName.toLowerCase()];\r\n\t}\r\n\t\r\n\tasync getUqUserRoles(uqLower:string):Promise<string[]> {\r\n\t\tlet uqMan = this.collection[uqLower];\r\n\t\tif (uqMan === undefined) return null;\r\n\t\tlet roles = await uqMan.getRoles();\r\n\t\treturn roles;\r\n\t}\r\n\r\n    private buildTVs() {\r\n\t\tif (!this.tvs) return;\r\n        for (let i in this.tvs) {\r\n            let uqTVs = this.tvs[i];\r\n            if (uqTVs === undefined) continue;\r\n            let l = i.toLowerCase();\r\n            if (l === i) continue;\r\n            this.tvs[l] = uqTVs;\r\n            for (let j in uqTVs) {\r\n                let en = uqTVs[j];\r\n                if (en === undefined) continue;\r\n                let lj = j.toLowerCase();\r\n                if (lj === j) continue;\r\n                uqTVs[lj] = en;\r\n            }\r\n        }\r\n    }\r\n\r\n    async init(uqsData:UqData[]):Promise<void> {\r\n        let promiseInits: PromiseLike<void>[] = [];\r\n\t\tfor (let uqData of uqsData) {\r\n\t\t\tlet {uqOwner, ownerAlias, uqName, uqAlias} = uqData;\r\n\r\n\t\t\t// 原名加入collection\r\n\t\t\tlet uqFullName = uqOwner + '/' + uqName;\r\n\t\t\tlet uqFull = this.collection[uqFullName];\r\n\t\t\tlet uq:UqMan;\r\n\t\t\tif (uqFull) {\r\n\t\t\t\tuq = uqFull;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tuq  = new UqMan(this.web, uqData, undefined, this.tvs[uqFullName] || this.tvs[uqName]);\r\n\t\t\t\tthis.collection[uqFullName] = uq;\r\n\t\t\t\tpromiseInits.push(uq.init());\r\n\t\t\t}\r\n\t\t\tthis.uqMans.push(uq);\r\n\t\t\tlet lower = uqFullName.toLowerCase();\r\n\t\t\tthis.collection[lower] = uq;\r\n\r\n\t\t\t// 别名加入collection\r\n\t\t\tif (uqAlias) uqName = uqAlias;\r\n\t\t\tif (ownerAlias) uqOwner = ownerAlias;\r\n\t\t\tuqFullName = uqOwner + '/' + uqName;\r\n\t\t\tlower = uqFullName.toLowerCase();\r\n\t\t\tthis.collection[lower] = uq;\r\n\t\t}\r\n        await Promise.all(promiseInits);\r\n    }\r\n\r\n    async load(): Promise<string[]> {\r\n        let retErrors:string[] = [];\r\n\t\tlet promises: PromiseLike<string>[] = [];\r\n\t\t//let lowerUqNames:string[] = [];\r\n\t\t// collection有小写名字，还有正常名字\r\n        //for (let i in this.collection) {\r\n\t\tfor (let uqMan of this.uqMans) {\r\n\t\t\t//let lower = (i as string).toLowerCase();\r\n\t\t\t//if (lowerUqNames.indexOf(lower) >= 0) continue;\r\n\t\t\t//lowerUqNames.push(lower);\r\n            //let uq = this.collection[i];\r\n            promises.push(uqMan.loadEntities());\r\n\t\t}\r\n\t\tlet results = await Promise.all(promises);\r\n        for (let result of results)\r\n        {\r\n            let retError = result; // await cUq.loadSchema();\r\n            if (retError !== undefined) {\r\n                retErrors.push(retError);\r\n            }\r\n\t\t}\r\n        return retErrors;\r\n    }\r\n\r\n    private buildUQs(): any {\r\n        let uqs:any = {};\r\n\t\tfunction setUq(uqKey: string, proxy: any):void {\r\n\t\t\tif (!uqKey) return;\r\n\t\t\tlet lower = uqKey.toLowerCase();\r\n\t\t\tuqs[uqKey] = proxy;\r\n\t\t\tif (lower !== uqKey) uqs[lower] = proxy;\r\n\t\t}\r\n\t\tfor (let uqMan of this.uqMans) {\r\n\t\t\tlet proxy = uqMan.createProxy();\r\n\t\t\tsetUq(uqMan.getUqKey(), proxy);\r\n\t\t\tsetUq(uqMan.getUqKeyWithConfig(), proxy);\r\n\t\t\t/*\r\n\t\t\tlet uqKey = uqMan.getUqKey();\r\n\t\t\tlet lower = uqKey.toLowerCase();\r\n\t\t\tuqs[uqKey] = proxy;\r\n\t\t\tif (lower !== uqKey) uqs[lower] = proxy;\r\n            let uqKeyWithConfig = uqMan.getUqKeyWithConfig();\r\n\t\t\tlet lowerWithConfig = uqKeyWithConfig.toLowerCase();\r\n\t\t\tuqs[uqKeyWithConfig] = proxy;\r\n\t\t\tif (lowerWithConfig !== uqKeyWithConfig) uqs[lowerWithConfig] = proxy;\r\n\t\t\t*/\r\n        }\r\n        return new Proxy(uqs, {\r\n            get: (target, key, receiver) => {\r\n                let lk = (key as string).toLowerCase();\r\n                let ret = target[lk];\r\n                if (ret !== undefined) return ret;\r\n                debugger;\r\n                console.error(`controller.uqs.${String(key)} undefined`);\r\n                this.showReload(`新增 uq ${String(key)}`);\r\n                return undefined;\r\n            },\r\n        });\r\n\t}\r\n\t\r\n\tgetUqMans() {\r\n\t\treturn this.uqMans;\r\n\t}\r\n\r\n    private showReload(msg: string) {\r\n\t\tfor (let uqMan of this.uqMans) {\r\n\t\t\tuqMan.localMap.removeAll();\r\n\t\t}\r\n        this.web.showReloadPage(msg);\r\n    }\r\n\r\n    setTuidImportsLocal():string[] {\r\n        let ret:string[] = [];\r\n        for (let uqMan of this.uqMans) {\r\n            for (let tuid of uqMan.tuidArr) {\r\n                if (tuid.isImport === true) {\r\n                    let error = this.setInner(tuid as TuidImport);\r\n                    if (error) ret.push(error);\r\n                }\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n\r\n    private setInner(tuidImport: TuidImport):string {\r\n        let {from} = tuidImport;\r\n        let fromName = from.owner + '/' + from.uq;\r\n        let uq = this.collection[fromName];\r\n        if (uq === undefined) {\r\n            //debugger;\r\n\t\t\tif (env.buildingUq === false) {\r\n            \tconsole.error(`setInner(tuidImport: TuidImport): uq ${fromName} is not loaded`);\r\n\t\t\t}\r\n\t\t\treturn;\r\n        }\r\n        let iName = tuidImport.name\r\n        let tuid = uq.tuid(iName);\r\n        if (tuid === undefined) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} has no Tuid ${iName}`;\r\n        }\r\n        if (tuid.isImport === true) {\r\n            //debugger;\r\n            return `setInner(tuidImport: TuidImport): uq ${fromName} Tuid ${iName} is import`;\r\n        }\r\n        tuidImport.setFrom(tuid as TuidInner);\r\n    }\r\n}\r\n","import { AppConfig as AppConfigCore, UqConfig } from '../appConfig';\r\nimport { UQsMan, TVs } from \"./uqsMan\";\r\nimport { LocalMap, LocalCache, env } from '../tool';\r\nimport { UqData, UqAppData, CenterAppApi } from '../net';\r\nimport { Web } from '../web';\r\n\r\nexport class UQsLoader {\r\n\treadonly web: Web;\r\n    protected readonly appConfig: AppConfigCore;\r\n\tprotected isBuildingUQ: boolean = false;\r\n\tuqsMan: UQsMan;         // value\r\n\r\n    constructor(web:Web, appConfig: AppConfigCore) {\r\n        this.appConfig = appConfig;\r\n\t\tthis.web = web;\r\n    }\r\n\r\n\tasync build() {\r\n\t\tlet {app, uqs} = this.appConfig;\r\n\t\tlet retErrors:string[];\r\n\t\tif (app) {\r\n\t\t\tretErrors = await this.loadApp();\r\n\t\t}\r\n\t\telse if (uqs) {\r\n\t\t\tretErrors = await this.loadUqs();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error('either uqs or app must be defined in AppConfig');\r\n\t\t}\r\n\t\treturn retErrors;\r\n\t}\r\n    /*\r\n\tasync buildUQs(uqsConfig: AppConfig) {\r\n\t\tlet {uqs, tvs, version} = uqsConfig;\r\n\t\tlet retErrors:string[];\r\n\t\tif (uqs) {\r\n\t\t\tUQsMan.isBuildingUQ = true;\r\n\t\t\tretErrors = await this.loadUqs();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error('either uqs or app must be defined in AppConfig');\r\n\t\t}\r\n\t\treturn retErrors;\r\n\t}\r\n    */\r\n\r\n\t// 返回 errors, 每个uq一行\r\n\tprivate async loadApp():Promise<string[]> {\r\n\t\tlet {app, uqs:uqConfigs, version} = this.appConfig;\r\n\r\n\t\tlet {name, dev} = app;\r\n        let uqsManApp = new UQsManApp(this.web, `${dev.name}/${name}`, undefined);\r\n\t\tthis.uqsMan = uqsManApp;\r\n        let {appOwner, appName, localData} = uqsManApp;\r\n        let uqAppData:UqAppData = localData.get();\r\n        if (!uqAppData || uqAppData.version !== version) {\r\n\t\t\tuqAppData = await this.loadUqAppData(appOwner, appName);\r\n\t\t\tif (!uqAppData.id) {\r\n\t\t\t\treturn [\r\n\t\t\t\t\t`${appOwner}/${appName}不存在。请仔细检查app全名。`\r\n\t\t\t\t];\r\n\t\t\t}\r\n            uqAppData.version = version;\r\n\r\n\t\t\tif (uqConfigs) {\r\n\t\t\t\tlet data = await this.loadUqData(uqConfigs);\r\n\t\t\t\tuqAppData.uqs.push(...data);\r\n\t\t\t}\r\n\r\n            localData.set(uqAppData);\r\n            // \r\n            for (let uq of uqAppData.uqs) uq.newVersion = true;\r\n        }\r\n        let {id, uqs} = uqAppData;\r\n\t\tuqsManApp.id = id;\r\n\t\treturn await this.uqsMan.buildUqs(uqs, version, uqConfigs, this.isBuildingUQ);\r\n\t}\r\n\r\n\t// 返回 errors, 每个uq一行\r\n\tasync loadUqs(/*uqConfigs: UqConfig[], version:string, tvs:TVs*/):Promise<string[]> {\r\n        let {uqs:uqConfigs, version} = this.appConfig;\r\n\t\tthis.uqsMan = new UQsMan(this.web, undefined);\r\n\t\tlet uqs = await this.loadUqData(uqConfigs);\r\n\t\treturn await this.uqsMan.buildUqs(uqs, version, uqConfigs, this.isBuildingUQ);\r\n\t}\r\n\r\n    private async loadUqAppData(appOwner:string, appName:string): Promise<UqAppData> {\r\n        let centerAppApi = new CenterAppApi('tv/', undefined);\r\n        let ret = await centerAppApi.appUqs(appOwner, appName);\r\n        return ret;\r\n    }\r\n    \r\n    private async loadUqData(uqConfigs: UqConfig[]): Promise<UqData[]> {\r\n        let uqs: {owner:string; ownerAlias: string; name:string; alias:string; version:string}[] = uqConfigs.map(\r\n            v => {\r\n                let {dev, name, version, alias} =v;\r\n                let {name:owner, alias:ownerAlias} = dev;\r\n                return {owner, ownerAlias, name, version, alias};\r\n            }\r\n        );\r\n        let centerAppApi = new CenterAppApi('tv/', undefined);\r\n        let ret:UqData[] = await centerAppApi.uqs(uqs);\r\n        if (ret.length < uqs.length) {\r\n            let err = `下列UQ：\\n${uqs.map(v => `${v.owner}/${v.name}`).join('\\n')}之一不存在`;\r\n            console.error(err);\r\n            throw Error(err);\r\n        }\r\n        for (let i=0; i<uqs.length; i++) {\r\n            let {ownerAlias, alias} = uqs[i];\r\n            ret[i].ownerAlias = ownerAlias;\r\n            ret[i].uqAlias = alias;\r\n        }\r\n        return ret;\r\n    }\r\n}\r\n\r\nclass UQsManApp extends UQsMan {\r\n    readonly appOwner: string;\r\n    readonly appName: string;\r\n    readonly localMap: LocalMap;\r\n    readonly localData: LocalCache;\r\n    id: number;\r\n\r\n\tconstructor(web:Web, tonvaAppName:string, tvs:TVs) {\r\n\t\tsuper(web, tvs);\r\n        let parts = tonvaAppName.split('/');\r\n        if (parts.length !== 2) {\r\n            throw new Error('tonvaApp name must be / separated, owner/app');\r\n        }\r\n        this.appOwner = parts[0];\r\n        this.appName = parts[1];\r\n        this.localMap = env.localDb.map(tonvaAppName);\r\n        this.localData = this.localMap.child('uqData');\r\n\t}\r\n}\r\n\r\nexport class UQsBuildingLoader extends UQsLoader {\r\n\tasync build() {\r\n\t\t//nav.forceDevelopment = true;\r\n\t\tenv.isDevelopment = true;\r\n\t\t//await nav.init();\r\n\t\tawait this.web.navInit();\r\n\t\tthis.isBuildingUQ = true;\r\n\t\tlet {uqs} = this.appConfig;\r\n\t\tlet retErrors:string[];\r\n\t\tif (uqs) {\r\n\t\t\tretErrors = await this.loadUqs();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthrow new Error('uqs must be defined in AppConfig');\r\n\t\t}\r\n\t\treturn retErrors;\r\n\t}\r\n}\r\n","// typescript version of krasimir/navigo\r\n\r\nexport type RouteFunc = (params?:string|{[name:string]:string}, query?:string) => void;\r\n\r\nexport interface NamedRoute {\r\n\tas: string;\r\n\tuses: RouteFunc;\r\n\thooks?: Hooks;\r\n}\r\nexport interface Hooks {\r\n\tbefore: (done:()=>void, params:object) => void;\r\n\tafter: (params:object) => void;\r\n\tleave: (params:object) => void;\r\n\talready: (params:object) => void;\r\n}\r\ninterface Handler {\r\n\thandler: RouteFunc;\r\n\thooks: Hooks;\r\n}\r\ninterface LastResolved {\r\n\turl: string;\r\n\tquery: string;\r\n\thooks: Hooks;\r\n\tparams?: {[name:string]:string};\r\n\tname?: string;\r\n}\r\ninterface Route {\r\n\troute: string|RegExp;\r\n\thandler: RouteFunc,\r\n\tname: string,\r\n\thooks: Hooks\r\n}\r\n\r\nexport class Navigo {\r\n\tprivate static PARAMETER_REGEXP = /([:*])(\\w+)/g;\r\n\tprivate static WILDCARD_REGEXP = /\\*/g;\r\n\tprivate static REPLACE_VARIABLE_REGEXP = '([^\\\\/]+)';   \t// 单\\，编译错误 ([^\\/]+)\r\n\tprivate static REPLACE_WILDCARD = `(?:.*)`;\r\n\tprivate static FOLLOWED_BY_SLASH_REGEXP = '(?:\\\\/$|$)';\t\t// 单\\，编译错误 (?:\\/$|$)\r\n\tprivate static MATCH_REGEXP_FLAGS = '';\r\n\r\n\tprivate static isPushStateAvailable() {\r\n\t\treturn !!(\r\n\t\t  typeof window !== 'undefined' &&\r\n\t\t  window.history &&\r\n\t\t  window.history.pushState\r\n\t\t);\r\n\t}\r\n\t\r\n\tprivate static clean(s:string|RegExp) {\r\n\t\tif (s instanceof RegExp) return s;\r\n\t\treturn Navigo.cleanUrl(s);\r\n\t}\r\n\tprivate static cleanUrl(s:string) {\r\n\t\treturn s.replace(/\\/+$/, '').replace(/^\\/+/, '^/');\r\n\t}\r\n\r\n\tprivate static regExpResultToParams(match:any[], names:string[]) {\r\n\t\tif (names.length === 0) return null;\r\n\t\tif (!match) return null;\r\n\t\treturn match\r\n\t\t  .slice(1, match.length)\r\n\t\t  .reduce((params, value, index) => {\r\n\t\t\t\tif (params === null) params = {};\r\n\t\t\t\tparams[names[index]] = decodeURIComponent(value);\r\n\t\t\t\treturn params;\r\n\t\t  }, null);\r\n\t}\r\n\t  \r\n\tprivate static replaceDynamicURLParts(route:string|RegExp) {\r\n\t\tlet paramNames:string[] = [], regexp:RegExp;\r\n\t  \r\n\t\tif (route instanceof RegExp) {\r\n\t\t\tregexp = route;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tregexp = new RegExp(\r\n\t\t\t\troute.replace(Navigo.PARAMETER_REGEXP, function (full, dots, name) {\r\n\t\t\t\t\t\tparamNames.push(name);\r\n\t\t\t\t\t\treturn Navigo.REPLACE_VARIABLE_REGEXP;\r\n\t\t\t\t\t})\r\n\t\t\t\t\t.replace(Navigo.WILDCARD_REGEXP, Navigo.REPLACE_WILDCARD) + Navigo.FOLLOWED_BY_SLASH_REGEXP\r\n\t\t\t\t, Navigo.MATCH_REGEXP_FLAGS);\r\n\t\t}\r\n\t\treturn { regexp, paramNames };\r\n\t}\r\n\t  \r\n\tprivate static getUrlDepth(url:string):number {\r\n\t\treturn url.replace(/\\/$/, '').split('/').length;\r\n\t}\r\n\t  \r\n\tprivate static compareUrlDepth(urlA:string, urlB:string) {\r\n\t\treturn Navigo.getUrlDepth(urlB) - Navigo.getUrlDepth(urlA);\r\n\t}\r\n\t  \r\n\tprivate static findMatchedRoutes(url:string, routes:Route[] = []) {\r\n\t\treturn routes.map(route => {\r\n\t\t\tlet { regexp, paramNames } = Navigo.replaceDynamicURLParts(Navigo.clean(route.route));\r\n\t\t\tlet match = url.replace(/^\\/+/, '/').match(regexp);\r\n\t\t\tlet params = Navigo.regExpResultToParams(match, paramNames);\r\n\t\t\treturn match ? { match, route, params } : false;\r\n\t\t}).filter(m => m);\r\n\t}\r\n\t  \r\n\tprivate static match(url:string, routes:Route[]) {\r\n\t\treturn Navigo.findMatchedRoutes(url, routes)[0] || false;\r\n\t}\r\n\t  \r\n\tprivate static root(url:string, routes:Route[]) {\r\n\t\tconst colonExp = RegExp('\\\\/:\\\\D(\\\\w*)', 'g');\r\n\t\tconst exp = ''; // '($|\\\\/)';  // 单\\，编译报错 ($|\\/)\r\n\t\tlet matched = routes.map(\r\n\t\t\troute => {\r\n\t\t\t\tlet r = route.route;\r\n\t\t\t\tif (r === '' || r === '*') return url;\r\n\t\t\t\tif (typeof r === 'string') {\r\n\t\t\t\t\tr = r.replace(colonExp, '\\\\/(\\\\w|%|[\\u4E00-\\u9FCC])+');\r\n\t\t\t\t}\r\n\t\t\t\tlet routeExp = r + exp;\r\n\t\t\t\tlet ret = url.split(new RegExp(routeExp))[0];\r\n\t\t\t\treturn ret;\r\n\t\t\t}\r\n\t\t);\r\n\t\tlet fallbackURL = Navigo.cleanUrl(url);\r\n\t\tlet len = matched.length;\r\n\t\tif (len === 0) return fallbackURL;\r\n\t\tlet matched0 = matched[0];\r\n\t\tif (len === 1) return matched0;\r\n\t\treturn matched.reduce((result, url) => {\r\n\t\t\tif (result.length > url.length) result = url;\r\n\t\t\treturn result;\r\n\t\t}, matched0);\r\n\t}\r\n\t  \r\n\tprivate static isHashChangeAPIAvailable() {\r\n\t\treturn typeof window !== 'undefined' && 'onhashchange' in window;\r\n\t}\r\n\t  \r\n\tprivate static extractGETParameters(url:string):string {\r\n\t\treturn url.split(/\\?(.*)?$/).slice(1).join('');\r\n\t}\r\n\t  \r\n\tprivate static getOnlyURL(url:string, useHash:boolean, hash:string) {\r\n\t\tlet onlyURL = url, split:string[];\r\n\t\tvar cleanGETParam = (str:string) => str.split(/\\?(.*)?$/)[0];\r\n\t  \r\n\t\tif (typeof hash === 'undefined') {\r\n\t\t\t// To preserve BC\r\n\t\t\thash = '#';\r\n\t\t}\r\n\t  \r\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\r\n\t\t  \tonlyURL = cleanGETParam(url).split(hash)[0];\r\n\t\t}\r\n\t\telse {\r\n\t\t\tsplit = url.split(hash);\r\n\t\t\tonlyURL = split.length > 1 ? cleanGETParam(split[1]) : cleanGETParam(split[0]);\r\n\t\t}\r\n\t\treturn onlyURL;\r\n\t}\r\n\t  \r\n\tprivate static manageHooks(handler:RouteFunc, hooks:Hooks, params?:any, exHooks?:Hooks) {\r\n\t\tif (hooks && typeof hooks === 'object') {\r\n\t\t\tif (hooks.before) {\r\n\t\t\t\thooks.before((shouldRoute = true) => {\r\n\t\t\t\tif (!shouldRoute) return;\r\n\t\t\t\thandler();\r\n\t\t\t\thooks.after && hooks.after(params);\r\n\t\t\t\t}, params);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\telse if (hooks.after) {\r\n\t\t\t\thandler();\r\n\t\t\t\thooks.after && hooks.after(params);\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\t\thandler();\r\n\t}\r\n\t  \r\n\tprivate static isHashedRoot(url:string, useHash:boolean, hash:string) {\r\n\t\tif (Navigo.isPushStateAvailable() && !useHash) {\r\n\t\t  return false;\r\n\t\t}\r\n\t  \r\n\t\tif (!url.match(hash)) {\r\n\t\t  return false;\r\n\t\t}\r\n\t  \r\n\t\tlet split = url.split(hash);\r\n\t  \r\n\t\treturn split.length < 2 || split[1] === '';\r\n\t}\r\n\t\r\n\tprivate root:string;\r\n\tprivate _routes:Route[] = [];\r\n\tprivate _useHash:boolean;\r\n\tprivate _hash:string;\r\n\tprivate _paused:boolean;\r\n\tprivate _destroyed:boolean;\r\n\tprivate _lastRouteResolved:LastResolved;\r\n\tprivate _notFoundHandler:Handler;\r\n\tprivate _defaultHandler:Handler;\r\n\tprivate _usePushState:boolean;\r\n\tprivate _genericHooks:Hooks;\r\n\tprivate _historyUpdateMethod: 'pushState' | 'replaceState'; // HistoryUpdateMethod;\r\n\tprivate timout: any; //NodeJS.Timeout;\r\n\r\n\tconstructor(r:string = null, useHash:boolean = false, hash:string = '#') {\r\n\t\tthis.root = null;\r\n\t\tthis._useHash = useHash;\r\n\t\tthis._hash = (!hash)? '#' : hash;\r\n\t\tthis._paused = false;\r\n\t\tthis._destroyed = false;\r\n\t\tthis._lastRouteResolved = null;\r\n\t\tthis._notFoundHandler = null;\r\n\t\tthis._defaultHandler = null;\r\n\t\tthis._usePushState = !useHash && Navigo.isPushStateAvailable();\r\n\t\t//this._onLocationChange = this._onLocationChange.bind(this);\r\n\t\tthis._genericHooks = null;\r\n\t\tthis._historyUpdateMethod = 'pushState';\r\n\t\r\n\t\tif (r) {\r\n\t\t\tthis.root = useHash ? r.replace(/\\/$/, '/' + this._hash) : r.replace(/\\/$/, '');\r\n\t\t} else if (useHash) {\r\n\t\t\tthis.root = this._cLoc().split(this._hash)[0].replace(/\\/$/, '/' + this._hash);\r\n\t\t}\r\n\t\r\n\t\tthis._listen();\r\n\t\tthis.updatePageLinks();\r\n\t}\r\n  \r\n\tnavigate(path:string, absolute:boolean = false):Navigo {\r\n\t\tlet to:string;\r\n\t\tpath = path || '';\r\n\t\tif (this._usePushState) {\r\n\t\t\tto = (!absolute ? this._getRoot() + '/' : '') + path.replace(/^\\/+/, '/');\r\n\t\t\tto = to.replace(/([^:])(\\/{2,})/g, '$1/');\r\n\t\t\tto = to.replace('/#test/', '/');\r\n\t\t\tthis._historyUpdate({}, '', to);\r\n\t\t\tthis.resolve();\r\n\t\t}\r\n\t\telse if (typeof window !== 'undefined') {\r\n\t\t\tpath = path.replace(new RegExp('^' + this._hash), '');\r\n\t\t\tlet {location} = window;\r\n\t\t\tlocation.href = location.href\r\n\t\t\t\t.replace(/#$/, '')\r\n\t\t\t\t.replace(new RegExp(this._hash + '.*$'), '') + this._hash + path;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\ton(...args:any[]):Navigo {\r\n\t\tlet arg0 = args[0];\r\n\t\tlet arg1 = args[1];\r\n\t\tswitch (typeof arg0) {\r\n\t\t\tcase 'function':\r\n\t\t\t\tthis._defaultHandler = { handler: arg0, hooks: arg1 };\r\n\t\t\t\tif (!this._notFoundHandler) {\r\n\t\t\t\t\tthis._notFoundHandler = this._defaultHandler;\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'object':\r\n\t\t\t\tlet orderedRoutes = Object.keys(arg0).sort(Navigo.compareUrlDepth);\r\n\t\t\t\torderedRoutes.forEach(route => this.on(route, arg0[route]));\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\t\tif (args.length < 2) break;\r\n\t\t\t\tif (arg0 === '/') {\r\n\t\t\t\t\tthis._defaultHandler = { \r\n\t\t\t\t\t\thandler: typeof arg1 === 'object'? arg1.uses : arg1, \r\n\t\t\t\t\t\thooks: args[2],\r\n\t\t\t\t\t};\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t\tthis._add(arg0, arg1, args[2]);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\treturn this;\r\n\t}\r\n\r\n\toff(handler:RouteFunc):Navigo {\r\n\t\tif (this._defaultHandler !== null && handler === this._defaultHandler.handler) {\r\n\t\t\tthis._defaultHandler = null;\r\n\t\t}\r\n\t\telse if (this._notFoundHandler !== null && handler === this._notFoundHandler.handler) {\r\n\t\t\tthis._notFoundHandler = null;\r\n\t\t}\r\n\t\tthis._routes = this._routes.reduce((result, r) => {\r\n\t\t\tif (r.handler !== handler) result.push(r);\r\n\t\t\treturn result;\r\n\t\t}, []);\r\n\t\treturn this;\r\n\t}\r\n\r\n\tnotFound(handler:RouteFunc, hooks:Hooks):Navigo {\r\n\t\tthis._notFoundHandler = { handler, hooks };\r\n\t\treturn this;\r\n\t}\r\n\r\n\tresolve(current?:string) {\r\n\t\tlet c = current || this._cLoc();\r\n\t\tlet root = this._getRoot();\r\n\t\tlet url = c.replace(root, '');\r\n\t\r\n\t\tif (this._useHash) {\r\n\t\t\tconst exp = '^\\\\/';  // 单\\，编译报错 ^\\/\r\n\t\t\turl = url.replace(new RegExp(exp + this._hash), '/');\r\n\t\t}\r\n\t\r\n\t\tlet GETParameters = Navigo.extractGETParameters(current || this._cLoc());\r\n\t\tlet onlyURL = Navigo.getOnlyURL(url, this._useHash, this._hash);\r\n\t\tif (onlyURL.startsWith('/') === false) {\r\n\t\t\tonlyURL = '/' + onlyURL;\r\n\t\t}\r\n\t\r\n\t\tif (this._paused) return false;\r\n\t\r\n\t\tif (\r\n\t\t\tthis._lastRouteResolved &&\r\n\t\t\tonlyURL === this._lastRouteResolved.url &&\r\n\t\t\tGETParameters === this._lastRouteResolved.query\r\n\t\t) {\r\n\t\t\tif (this._lastRouteResolved.hooks && this._lastRouteResolved.hooks.already) {\r\n\t\t\t\tthis._lastRouteResolved.hooks.already(this._lastRouteResolved.params);\r\n\t\t\t}\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\r\n\t\tlet matched = Navigo.match(onlyURL, this._routes);\r\n\t\r\n\t\tlet manageHooks = (handler:Handler) => {\r\n\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\tquery: GETParameters, \r\n\t\t\t\t\t\thooks: handler.hooks\r\n\t\t\t\t\t};\r\n\t\t\t\t\thandler.handler(GETParameters);\r\n\t\t\t\t}, handler.hooks);\r\n\t\t\t}, this._genericHooks);\r\n\t\t}\r\n\r\n\t\tif (matched === false) {\r\n\t\t\tif (this._defaultHandler && (\r\n\t\t\t\tonlyURL === '' ||\r\n\t\t\t\tonlyURL === '/' ||\r\n\t\t\t\tonlyURL === this._hash ||\r\n\t\t\t\tNavigo.isHashedRoot(onlyURL, this._useHash, this._hash)\r\n\t\t\t)) {\r\n\t\t\t\t/*\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\t\tquery: GETParameters, \r\n\t\t\t\t\t\t\thooks: this._defaultHandler.hooks\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._defaultHandler.handler(GETParameters);\r\n\t\t\t\t\t}, this._defaultHandler.hooks);\r\n\t\t\t\t}, this._genericHooks);\r\n\t\t\t\t*/\r\n\t\t\t\tmanageHooks(this._defaultHandler);\r\n\t\t\t\treturn true;\r\n\t\t\t}\r\n\t\t\telse if (this._notFoundHandler) {\r\n\t\t\t\t/*\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\t\tthis._callLeave();\r\n\t\t\t\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\t\t\t\turl: onlyURL,\r\n\t\t\t\t\t\t\tquery: GETParameters,\r\n\t\t\t\t\t\t\thooks: this._notFoundHandler.hooks\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tthis._notFoundHandler.handler(GETParameters);\r\n\t\t\t\t\t}, this._notFoundHandler.hooks);\r\n\t\t\t\t}, this._genericHooks);\r\n\t\t\t\t*/\r\n\t\t\t\tmanageHooks(this._notFoundHandler);\r\n\t\t\t}\r\n\t\t\treturn false;\t\r\n\t\t}\r\n\t\tlet m = matched;\r\n\t\tif (m) {\r\n\t\t\tthis._callLeave();\r\n\t\t\tthis._lastRouteResolved = {\r\n\t\t\t\turl: onlyURL,\r\n\t\t\t\tquery: GETParameters,\r\n\t\t\t\thooks: m.route.hooks,\r\n\t\t\t\tparams: m.params,\r\n\t\t\t\tname: m.route.name\r\n\t\t\t};\r\n\t\t\tlet handler = m.route.handler;\r\n\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\tNavigo.manageHooks(() => {\r\n\t\t\t\t\tm.route.route instanceof RegExp ?\r\n\t\t\t\t\thandler(...(m.match.slice(1, m.match.length))) :\r\n\t\t\t\t\thandler(m.params, GETParameters);\r\n\t\t\t\t}, m.route.hooks, m.params, this._genericHooks);\r\n\t\t\t}, this._genericHooks, m.params);\r\n\t\t\treturn m;\r\n\t\t}\r\n\t}\r\n\r\n\tdestroy() {\r\n\t\tthis._routes = [];\r\n\t\tthis._destroyed = true;\r\n\t\tthis._lastRouteResolved = null;\r\n\t\tthis._genericHooks = null;\r\n\t\tclearTimeout(this.timout);\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\twindow.removeEventListener('popstate', this._onLocationChange);\r\n\t\t\twindow.removeEventListener('hashchange', this._onLocationChange);\r\n\t\t}\r\n\t}\r\n\r\n\tupdatePageLinks() {\r\n\t\t//var self = this;\r\n\t\tif (typeof document === 'undefined') return;\r\n\t\t\tthis._findLinks().forEach(link => {\r\n\t\t\tif (!link.hasListenerAttached) {\r\n\t\t\t\tlink.addEventListener('click', (e: React.MouseEvent<HTMLElement>) => {\r\n\t\t\t\t\tif((e.ctrlKey || e.metaKey) && e.currentTarget.tagName.toLowerCase() === 'a'){ return false; }\r\n\t\t\t\t\tvar location = this.getLinkPath(link);\r\n\t\t\r\n\t\t\t\t\tif (!this._destroyed) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t\tthis.navigate(location.replace(/\\/+$/, '').replace(/^\\/+/, '/'));\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tlink.hasListenerAttached = true;\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\tgenerate(name:string, data:any = {}) {\r\n\t\tlet result = this._routes.reduce((result, route) => {\r\n\t\t\tif (route.name === name) {\r\n\t\t\t\tresult = route.route.toString();\r\n\t\t\t\tfor (let key in data) {\r\n\t\t\t\t\tresult = result.replace(':' + key, data[key]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\treturn result;\r\n\t\t}, '');\r\n\t\r\n\t\treturn this._useHash ? this._hash + result : result;\r\n\t}\r\n\r\n\tlink(path:string) {\r\n\t\treturn this._getRoot() + path;\r\n\t}\r\n\r\n\tpause(status:boolean = true) {\r\n\t\tthis._paused = status;\r\n\t\tif (status) {\r\n\t\t\tthis._historyUpdateMethod = 'replaceState';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._historyUpdateMethod = 'pushState';\r\n\t\t}\r\n\t}\r\n\r\n\tresume() {\r\n\t\tthis.pause(false);\r\n\t}\r\n\r\n\thistoryAPIUpdateMethod(value:'pushState' | 'replaceState') {\r\n\t\tif (typeof value === 'undefined') return this._historyUpdateMethod;\r\n\t\tthis._historyUpdateMethod = value;\r\n\t\treturn value;\r\n\t}\r\n\r\n\tdisableIfAPINotAvailable() {\r\n\t\tif (!Navigo.isPushStateAvailable()) {\r\n\t\t\tthis.destroy();\r\n\t\t}\r\n\t}\r\n\r\n\tlastRouteResolved() {\r\n\t\treturn this._lastRouteResolved;\r\n\t}\r\n\r\n\tgetLinkPath(link:any) {\r\n\t\treturn link.getAttribute('href');\r\n\t}\r\n\r\n\thooks(hooks:Hooks) {\r\n\t\tthis._genericHooks = hooks;\r\n\t}\r\n\r\n\tprivate _add(route:string|RegExp, handler:RouteFunc|NamedRoute, hooks:Hooks) {\r\n\t\tif (typeof route === 'string') {\r\n\t\t\troute = encodeURI(route);\r\n\t\t}\r\n\t\tthis._routes.push(\r\n\t\t\ttypeof handler === 'object' ?\r\n\t\t\t{\r\n\t\t\t\troute,\r\n\t\t\t\thandler: handler.uses,\r\n\t\t\t\tname: handler.as,\r\n\t\t\t\thooks: hooks || handler.hooks\r\n\t\t\t} \r\n\t\t\t:\r\n\t\t\t{\r\n\t\t\t\troute,\r\n\t\t\t\thandler, \r\n\t\t\t\tname: undefined,\r\n\t\t\t\thooks,\r\n\t\t\t}\r\n\t\t);\r\n\t\treturn this._add;\r\n\t}\r\n\r\n\tprivate _historyUpdate(data:any, title:string, url?:string) {\r\n\t\tswitch (this._historyUpdateMethod) {\r\n\t\t\tdefault: throw Error('unknow history method ' + this._historyUpdateMethod);\r\n\t\t\tcase 'pushState': window.history.pushState(data, title, url); return;\r\n\t\t\tcase 'replaceState': window.history.replaceState(data, title, url); return;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _getRoot() {\r\n\t\tif (this.root === null) {\r\n\t\t\tlet cLoc = this._cLoc();\r\n\t\t\tlet cLocRoot = cLoc.split('?')[0];\r\n\t\t\tthis.root = Navigo.root(cLocRoot, this._routes);\r\n\t\t}\r\n\t\tlet root = this.root.replace('#test', '');\r\n\t\treturn root;\r\n\t}\r\n\r\n\tprivate _listen() {\r\n\t\tif (this._usePushState) {\r\n\t\t\twindow.addEventListener('popstate', this._onLocationChange);\r\n\t\t}\r\n\t\telse if (Navigo.isHashChangeAPIAvailable()) {\r\n\t\t\twindow.addEventListener('hashchange', this._onLocationChange);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet cached = this._cLoc();\r\n\t\r\n\t\t\tlet check = () => {\r\n\t\t\t\tlet current = this._cLoc();\r\n\t\t\t\tif (cached !== current) {\r\n\t\t\t\t\tcached = current;\r\n\t\t\t\t\tthis.resolve();\r\n\t\t\t\t}\r\n\t\t\t\tif (this.timout) clearTimeout(this.timout);\r\n\t\t\t\tthis.timout = setTimeout(check, 200);\r\n\t\t\t};\r\n\t\t\tcheck();\r\n\t\t}\r\n\t}\r\n\r\n\tprivate _cLoc() {\r\n\t\tif (typeof window !== 'undefined') {\r\n\t\t\t//if (typeof window.__NAVIGO_WINDOW_LOCATION_MOCK__ !== 'undefined') {\r\n\t\t\t//\treturn window.__NAVIGO_WINDOW_LOCATION_MOCK__;\r\n\t\t\t//}\r\n\t\t\tlet {href} = window.location;\r\n\t\t\treturn Navigo.cleanUrl(href);\r\n\t\t}\r\n\t\treturn '';\r\n\t}\r\n\r\n\tprivate _findLinks() {\r\n\t\treturn [].slice.call(document.querySelectorAll('[data-navigo]'));\r\n\t}\r\n\r\n\tprivate _onLocationChange = () => {\r\n\t\tconsole.log('_onLocationChange');\r\n\t\tthis.resolve();\r\n\t}\r\n\r\n\tprivate _callLeave() {\r\n\t\tconst lastRouteResolved = this._lastRouteResolved;\t\r\n\t\tif (lastRouteResolved) {\r\n\t\t\tlet {params, hooks} = lastRouteResolved;\r\n\t\t\tif (hooks) {\r\n\t\t\t\tif (hooks.leave) {\r\n\t\t\t\t\thooks.leave(params);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n}\r\n","import _ from 'lodash';\r\nimport {observable, IObservableArray, computed, makeObservable, runInAction} from 'mobx';\r\n//import { Tonva } from '../Tonva';\r\n\r\nexport abstract class PageItems<T> {\r\n\t//protected tonva: Tonva;\r\n    loading: boolean = false;\r\n    beforeLoad: boolean = true;\r\n    loaded: boolean = false;\r\n    _items:IObservableArray<T> = null;\r\n    allLoaded: boolean = false;\r\n    get items():IObservableArray<T> {\r\n        if (this.beforeLoad === true) return null;\r\n        if (this.loaded === false) return undefined;\r\n        return this._items;\r\n\t}\r\n    topDiv:string = '$$top';\r\n\tbottomDiv:string = '$$bottom';\r\n\r\n    constructor(itemObservable:boolean = false) {\r\n\t\t//this.tonva = tonva;\r\n\t\tmakeObservable(this, {\r\n\t\t\tloading: observable,\r\n\t\t\tbeforeLoad: observable,\r\n\t\t\tloaded: observable,\r\n\t\t\t_items: observable,\r\n\t\t\tallLoaded: observable,\r\n\t\t\titems: computed,\r\n\t\t\ttopDiv: observable,\r\n\t\t\tbottomDiv: observable,\r\n\t\t});\r\n\t\tif (itemObservable === undefined) itemObservable = false;\r\n        this._items = observable.array<T>([], {deep:itemObservable});\r\n    }\r\n\tprivate isFirst: boolean = true;\r\n\tprivate pageItemAction: (item:T, results:{[name:string]:any[]}) => void;\r\n\tprivate itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T;\r\n\r\n\tsetEachPageItem(pageItemAction: (item:T, results:{[name:string]:any[]}) => void) {\r\n\t\tthis.pageItemAction = pageItemAction;\r\n\t}\r\n\r\n\tsetItemConverter(itemConverter: (item:any, queryResults:{[name:string]:any[]}) => T) {\r\n\t\tthis.itemConverter = itemConverter;\r\n\t}\r\n\r\n    scrollToTop = () => {\r\n\t\tthis.scrollIntoView(this.topDiv);\r\n\t\t//let id = '$$top'+uid();\r\n\t\t//this.topDiv = id;\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(this.topDiv);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t\t*/\r\n    }\r\n    scrollToBottom = () => {\r\n\t\tthis.scrollIntoView(this.bottomDiv);\r\n\t\t//let id = '$$bottom'+uid();\r\n\t\t//this.bottomDiv = id;\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(this.bottomDiv);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t\t*/\r\n\t}\r\n\tprivate scrollIntoView(divId:string) {\r\n\t\tsetTimeout(() => {\r\n\t\t\tlet div = document.getElementById(divId);\r\n\t\t\tdiv?.scrollIntoView();\r\n\t\t}, 20);\r\n\t}\r\n\r\n    protected param: any;\r\n    protected firstSize = 100;\r\n    protected pageStart:any = undefined;\r\n    protected pageSize = 30;\r\n    protected appendPosition:'head'|'tail' = 'tail';\r\n\r\n\tprotected sortOrder:'asc'|'desc';\r\n\tprotected abstract loadResults(param:any, pageStart:any, pageSize:number):Promise<{[name:string]:any[]}>;\r\n\tprotected getPageId(item:T):any {return;}\r\n\tprotected setPageStart(item:T) {\r\n\t\tthis.pageStart = this.getPageId(item);\r\n\t}\r\n\t\r\n\tprotected async load(param:any, pageStart:any, pageSize:number):Promise<any[]> {\r\n\t\tlet results = await this.loadResults(param, pageStart, pageSize);\r\n\t\tlet pageList = results.$page;\r\n\t\tif (this.itemConverter) {\r\n\t\t\tlet ret:T[] = [];\r\n\t\t\tlet len = pageList.length;\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tlet item = this.itemConverter(pageList[i], results);\r\n\t\t\t\tret.push(item);\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\tif (this.pageItemAction !== undefined) {\r\n\t\t\tlet len = pageList.length;\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tthis.pageItemAction(pageList[i], results);\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn pageList;\r\n\t}\r\n\r\n    reset() {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.isFirst = true;\r\n\t\t\tthis.beforeLoad = true;\r\n\t\t\tthis.loaded = false;\r\n\t\t\tthis.param = undefined;\r\n\t\t\tthis.allLoaded = false;\r\n\t\t\tthis.pageStart = undefined;\r\n\t\t\tthis._items.clear();\r\n\t\t\t//this.setPageStart(undefined);\r\n\t\t});\r\n    }\r\n\r\n    append(item:T) {\r\n        if (this.appendPosition === 'tail')\r\n            this._items.unshift(item);\r\n        else\r\n            this._items.push(item);\r\n    }\r\n\r\n    async first(param:any):Promise<void> {\r\n        this.reset();\r\n        this.beforeLoad = false;\r\n        this.param = param;\r\n        await this.more();\r\n\t}\r\n\r\n\tprivate changing = false;\r\n\tasync attach(): Promise<void> {\r\n\t\tif (this.sortOrder === undefined) {\r\n\t\t\tconsole.error('没有定义增减序，无法attach');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.changing === true) return;\r\n\t\tthis.changing = true;\r\n\t\tlet items = this._items;\r\n\t\tlet isAsc = this.sortOrder === 'asc';\r\n\t\t//let isTail:boolean, \r\n\t\tlet endItem:T;\r\n\t\tlet scrollToEnd:() => void;\r\n\t\tlet pushItem:(item:T) => void;\r\n\t\tif (this.appendPosition === 'tail') {\r\n\t\t\t//isTail = true;\r\n\t\t\tendItem = items[0];\r\n\t\t\tscrollToEnd = this.scrollToTop;\r\n\t\t\tpushItem = (item:T) => items.unshift(item);\r\n\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//isTail = false;\r\n\t\t\tlet endIndex = items.length;\r\n\t\t\tendItem = items[endIndex-1];\r\n\t\t\tscrollToEnd = this.scrollToBottom;\r\n\t\t\tpushItem = (item:T) => items.splice(endIndex, 0, item);\r\n\t\t}\r\n\t\tlet startId = this.getPageId(endItem);\r\n\t\tlet pid = undefined;\r\n\t\tlet sum = 0, max = 50;\r\n\t\tfor (;sum < max;) {\r\n\t\t\tlet ret = await this.load(this.param, pid, 3);\r\n\t\t\tlet len = ret.length;\r\n\t\t\tif (len === 0) break;\r\n\r\n\t\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t\tlet item = ret[i];\r\n\t\t\t\tpid = this.getPageId(item);\r\n\t\t\t\tif (isAsc === true) {\r\n\t\t\t\t\tif (pid >= startId) {\r\n\t\t\t\t\t\tmax = 0;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (pid <= startId) {\r\n\t\t\t\t\t\tmax = 0;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tpushItem(item);\r\n\t\t\t\t/*\r\n\t\t\t\tif (isTail === true) {\r\n\t\t\t\t\tthis._items.unshift(item);\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis._items.push(item);\r\n\t\t\t\t}\r\n\t\t\t\t*/\r\n\t\t\t\t++sum;\r\n\t\t\t}\r\n\t\t}\r\n\t\tthis.changing = false;\r\n\t\tif (sum > 0) {\r\n\t\t\tscrollToEnd();\r\n\t\t\t/*\r\n\t\t\tif (isTail === true) this.scrollToTop();\r\n\t\t\telse this.scrollToBottom();\r\n\t\t\t*/\r\n\t\t}\r\n\t}\r\n\r\n\tasync refresh(): Promise<void> {\r\n\t\tif (this.changing === true) return;\r\n\t\tthis.changing = true;\r\n\t\tlet ret = await this.load(this.param, undefined, this.firstSize>this.pageSize? this.firstSize:this.pageSize);\r\n\t\tthis._items.clear();\r\n\t\tthis.setLoaded(ret);\r\n\t\t/*\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\tlet item = ret[i];\r\n\t\t\tlet pid = this.getRefreshPageId(item);\r\n\t\t\tlet index = this._items.findIndex(v => this.getRefreshPageId(v) === pid);\r\n\t\t\t//let index = _.sortedIndexBy(this._items, item, v=>this.getRefreshPageId(v));\r\n\t\t\t//let oldItem = this._items[index];\r\n\t\t\t//let oid = this.getRefreshPageId(oldItem);\r\n\t\t\tif (index >= 0) {\r\n\t\t\t\t_.merge(this._items[index], item);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._items.splice(0, 0, item);\r\n\t\t\t}\r\n\t\t}\r\n\t\t*/\r\n\t\tthis.changing = false;\r\n\t}\r\n\r\n\tprotected getRefreshPageId(item:T) {\r\n\t\treturn this.getPageId(item);\r\n\t}\r\n\r\n    protected async onLoad(): Promise<void> {}\r\n    protected async onLoaded(): Promise<void> {}\r\n\r\n    async more():Promise<boolean> {\r\n        if (this.allLoaded === true) return false;\r\n\t\tif (this.loading === true) return true;\r\n\t\tif (this.changing === true) return true;\r\n\t\trunInAction(() => {\r\n\t\t\tthis.loading = true;\r\n\t\t\tthis.changing = true;\r\n\t\t});\r\n        await this.onLoad();\r\n        if (this.pageStart === undefined) this.setPageStart(undefined);\r\n        let pageSize = this.pageSize + 1;\r\n        if (this.isFirst === true) {\r\n            if (this.firstSize > this.pageSize) pageSize = this.firstSize+1;\r\n        }\r\n        let ret = await this.load(\r\n                this.param, \r\n                this.pageStart,\r\n\t\t\t\tpageSize);\r\n\t\tlet len = ret.length;\r\n\t\tlet allLoaded:boolean;\r\n        if ((this.isFirst===true && len>this.firstSize) ||\r\n            (this.isFirst===false && len>this.pageSize))\r\n        {\r\n            allLoaded = false;\r\n            --len;\r\n            ret.splice(len, 1);\r\n        }\r\n        else {\r\n            allLoaded = true;\r\n\t\t}\r\n\t\tthis.setLoaded(ret);\r\n\t\tthis.onLoaded();\r\n\t\trunInAction(() => {\r\n\t\t\tthis.loaded = true;\r\n\t\t\tthis.allLoaded = allLoaded;\r\n\t\t\tthis.isFirst = false;\r\n\t\t\tthis.changing = false;\r\n\t\t\tthis.loading = false;\r\n\t\t});\r\n\t\treturn !this.allLoaded;\r\n\t}\r\n\t\r\n\tprivate setLoaded(data:any[]) {\r\n\t\tlet len = data.length;\r\n        if (len === 0) {\r\n\t\t\tthis.setPageStart(undefined);\r\n            this._items.clear();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.setPageStart(data[len-1]);\r\n\t\t\tif (this.appendPosition === 'tail') {\r\n\t\t\t\tthis._items.push(...data);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._items.unshift(...data.reverse());\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tfindItem(item:any):T {\r\n\t\tlet pid = this.getPageId(item);\r\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\r\n\t\tif (index < 0) return;\r\n\t\treturn this._items[index];\r\n\t}\r\n\r\n\tremoveItem(item:any):T {\r\n\t\tlet pid = this.getPageId(item);\r\n\t\tlet index = _.findIndex(this._items, v => this.getPageId(v) === pid);\r\n\t\tif (index < 0) return;\r\n\t\tlet ret = this._items.splice(index, 1);\r\n\t\treturn ret[0];\r\n\t}\r\n}\r\n","import { env } from './env';\r\n\r\nexport class LocalData {\r\n    user = env.localDb.child('user');\r\n    guest = env.localDb.child('guest');\r\n    unit = env.localDb.child('unit');\r\n\r\n    private _user:string;\r\n    private _guest:string;\r\n    private _unit:string;\r\n    readToMemory() {\r\n        this._user = this.user.get();\r\n        this._guest = this.guest.get();\r\n        this._unit = this.unit.get();\r\n    }\r\n    saveToLocalStorage() {\r\n        this.user.set(this._user);\r\n        this.guest.set(this._guest);\r\n        this.unit.set(this._unit);\r\n    }\r\n\r\n    logoutClear() {\r\n        [\r\n            this.user,\r\n            this.unit,\r\n        ].forEach(d => d.remove());\r\n    }\r\n}\r\n","export function getObjPropIgnoreCase(obj:any, prop:string):any {\r\n\tif (!obj) return;\r\n\tif (!prop) return;\r\n\tlet keys = Object.keys(obj);\r\n\tprop = prop.toLowerCase();\r\n\tfor (let key of keys) {\r\n\t\tif (key.toLowerCase() === prop) return obj[key];\r\n\t}\r\n\treturn;\r\n}\r\n","import { env } from \".\";\r\n\r\nconst options:Intl.DateTimeFormatOptions = { \r\n\tweekday: 'long', \r\n\tyear: 'numeric', \r\n\tmonth: 'long', \r\n\tday: 'numeric' \r\n}\r\n\r\nexport function toLocaleDateString(date:Date) {\r\n\tif (!date) return '';\r\n\treturn date.toLocaleDateString('zh-cn', options);\r\n}\r\n\r\nexport const minute2020_01_01 = 26297280;  // 2020-1-1 到 1970-1-1 的毫秒数\r\nexport function dateFromMinuteId(id: number, timeZone?: number): Date {\r\n\tlet envTimezone = env.timeZone;\r\n\tlet m = (id / Math.pow(2, 20)) + (- envTimezone + (timeZone??envTimezone)) * 60;\r\n\treturn new Date((m + minute2020_01_01) * 60000);\r\n}\r\n\r\nexport function dateFromHourId(id: number, timeZone?: number): Date {\r\n\tlet envTimezone = env.timeZone;\r\n\tlet m = id + (- envTimezone + (timeZone??envTimezone));\r\n\treturn new Date((m + minute2020_01_01/60) * 60 * 60000);\r\n}\r\n","export function capitalCase(s:string):string {\r\n\tlet parts = s.split(/[-._]/);\r\n\treturn parts.map(v => firstCharUppercase(v)).join('_');\r\n}\r\n\r\nexport function camelCase(s:string):string {\r\n\tlet parts = s.split(/[-._]/);\r\n\tlet len = parts.length;\r\n\tparts[0] = firstCharLowercase(parts[0]);\r\n\tfor (let i=1; i<len; i++) {\r\n\t\tparts[1] = firstCharUppercase(parts[1]);\r\n\t}\r\n\treturn parts.join('_');\r\n}\r\n\r\nconst aCode = 'a'.charCodeAt(0);\r\nconst zCode = 'z'.charCodeAt(0);\r\nfunction firstCharUppercase(s:string) {\r\n\tif (!s) return '';\r\n\tlet c = s.charCodeAt(0);\r\n\tif (c >= aCode && c <= zCode) {\r\n\t\treturn String.fromCharCode(c - 0x20) + s.substr(1);\r\n\t}\r\n\treturn s;\r\n}\r\nconst ACode = 'A'.charCodeAt(0);\r\nconst ZCode = 'Z'.charCodeAt(0);\r\nfunction firstCharLowercase(s:string) {\r\n\tif (!s) return '';\r\n\tlet c = s.charCodeAt(0);\r\n\tif (c >= ACode && c <= ZCode) {\r\n\t\treturn String.fromCharCode(c + 0x20) + s.substr(1);\r\n\t}\r\n\treturn s;\r\n}\r\n","\r\nexport const mobileRegex = /^[0-9]*$/;\r\nexport const emailRegex = /\\w+([-+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*/;\r\n// /^([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\\_|\\.]?)*[a-zA-Z0-9]+\\.[a-zA-Z]{2,3}$/\r\n\r\nexport const EmailFieldRule = (value:any): string|string[] => {\r\n    if (emailRegex.test(value as string) === false) return '电子邮件格式错误';\r\n}\r\n\r\nexport const MobileFieldRule = (value:any): string|string[] => {\r\n    if (emailRegex.test(value as string) === false) return '手机格式错误';\r\n}\r\n","import {makeObservable, observable} from 'mobx';\r\nimport _ from 'lodash';\r\nimport {Page} from '../components';\r\nimport { resOptions } from '../res/res';\r\nimport { Navigo, RouteFunc, Hooks, NamedRoute } from 'tonva-core';\r\n\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport '../css/va-form.css';\r\nimport '../css/va.css';\r\nimport '../css/animation.css';\r\nimport { ReloadPage, ConfirmReloadPage } from '../components/reloadPage';\r\nimport { PageWebNav } from '../components/page';\r\nimport { createLogin, Login, showForget, showRegister } from '../components/login';\r\n//import { env, FetchError, LocalData, User } from 'tonva-core';\r\nimport { SystemNotifyPage } from './FetchErrorView';\r\n\r\nimport {User, Guest} from 'tonva-core';\r\nimport {netToken} from 'tonva-core';\r\nimport {FetchError} from 'tonva-core';\r\nimport {LocalData, env} from 'tonva-core';\r\nimport {guestApi, logoutApis, setCenterUrl, setCenterToken, host, resUrlFromHost, messageHub} from 'tonva-core';\r\nimport { userApi } from 'tonva-core';\r\nimport { NavView } from './NavView';\r\n\r\nexport type NavPage = (params:any) => Promise<void>;\r\n\r\nexport interface NavSettings {\r\n    oem?: string;\r\n    loginTop?: JSX.Element;\r\n    privacy?: string;\r\n\thtmlTitle?: string;\r\n}\r\n\r\nlet logMark: number;\r\nconst logs:string[] = [];\r\nexport class Nav {\r\n    private navView:NavView;\r\n\tprivate wsHost: string;\r\n    private local: LocalData = new LocalData();\r\n\tprivate navigo: Navigo;\r\n\tnavSettings: NavSettings;\r\n    user: User = null;\r\n    testing: boolean;\r\n    language: string;\r\n    culture: string;\r\n    resUrl: string;\r\n\r\n    constructor() {\r\n\t\tmakeObservable(this, {\r\n\t\t\tuser: observable,\r\n\t\t});\r\n        let {lang, district} = resOptions;\r\n        this.language = lang;\r\n        this.culture = district;\r\n\t\tthis.testing = false;\r\n    }\r\n\r\n    renderNavView(onLogined: (isUserLogin?:boolean)=>Promise<void>,\r\n        notLogined?: ()=>Promise<void>,\r\n\t    userPassword?: () => Promise<{user:string; password:string}>,\r\n    )\r\n    {\r\n        return <NavView ref={nv => this.navView = nv} \r\n            onLogined={onLogined}\r\n            notLogined={notLogined}\r\n            userPassword={userPassword} />;\r\n    }\r\n\r\n    get guest(): number {\r\n        let guest = this.local.guest;\r\n        if (guest === undefined) return 0;\r\n        let g = guest.get();\r\n        if (g === undefined) return 0;\r\n        return g.guest;\r\n    }\r\n\r\n    set(navView:NavView) {\r\n        //this.logo = logo;\r\n        this.navView = navView;\r\n\t}\r\n\t/*\r\n    registerReceiveHandler(handler: (message:any)=>Promise<void>):number {\r\n        //if (this.ws === undefined) return;\r\n        return messageHub.onReceiveAny(handler);\r\n    }\r\n\r\n    unregisterReceiveHandler(handlerId:number) {\r\n        //if (this.ws === undefined) return;\r\n        if (handlerId === undefined) return;\r\n        messageHub.endReceive(handlerId);\r\n    }\r\n\t*/\r\n    async onReceive(msg:any) {\r\n        //if (this.ws === undefined) return;\r\n        await messageHub.dispatch(msg);\r\n    }\r\n\r\n\tprivate async loadUnitJson() {\r\n\t\ttry {\r\n\t\t\tlet unitJsonPath = this.unitJsonPath();\r\n\t\t\tlet unitRes = await fetch(unitJsonPath, {});\r\n\t\t\tlet res = await unitRes.json();\r\n\t\t\treturn res.unit;\r\n\t\t}\r\n\t\tcatch (err1) {\r\n\t\t\tthis.local.unit.remove();\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n    private async getPredefinedUnitName() {\t\t\r\n\t\tlet el = document.getElementById('unit');\r\n\t\tif (el) {\r\n\t\t\treturn el.innerText;\r\n\t\t}\r\n\t\tel = document.getElementById('unit.json');\r\n\t\tif (!el) {\r\n\t\t\treturn await this.loadUnitJson();\r\n\t\t}\r\n\t\ttry {\r\n            let json = el.innerHTML;\r\n            let res = JSON.parse(json);\r\n            return res.unit;\r\n        }\r\n        catch (err) {\r\n\t\t\treturn await this.loadUnitJson();\r\n        }\r\n    }\r\n\r\n    private async loadPredefinedUnit() {\r\n        let envUnit = process.env.REACT_APP_UNIT;\r\n        if (envUnit !== undefined) {\r\n            return Number(envUnit);\r\n        }\r\n        let unitName:string;\r\n        let unit = this.local.unit.get();\r\n        if (unit !== undefined) {\r\n            if (env.isDevelopment !== true) return unit.id;\r\n            unitName = await this.getPredefinedUnitName();\r\n            if (unitName === undefined) return;\r\n            if (unit.name === unitName) return unit.id;\r\n        }\r\n        else {\r\n            unitName = await this.getPredefinedUnitName();\r\n            if (unitName === undefined) return;\r\n        }\r\n        let unitId = await guestApi.unitFromName(unitName);\r\n        if (unitId !== undefined) {\r\n            this.local.unit.set({id: unitId, name: unitName});\r\n        }\r\n        return unitId;\r\n    }\r\n\r\n    setSettings(settings?: NavSettings) {\r\n        this.navSettings = settings;\r\n\t\tlet {htmlTitle} = settings;\r\n\t\tif (htmlTitle) {\r\n\t\t\tdocument.title = htmlTitle;\r\n\t\t}\r\n\t\tlet html = document.getElementsByTagName('html');\r\n\t\tlet html0 = html[0];\r\n\t\tif (html0) {\r\n\t\t\tlet version = html0?.getAttribute('data-version');\r\n\t\t\tif (version) {\r\n\t\t\t\t//appConfig.version = version;\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\r\n    get oem():string {\r\n        return this.navSettings && this.navSettings.oem;\r\n    }\r\n\r\n    hashParam: string;\r\n    private centerHost: string;\r\n    private arrs = ['/test', '/test/'];\r\n    private unitJsonPath():string {\r\n        let {origin, pathname} = document.location;\r\n\t\tpathname = pathname.toLowerCase();\r\n        for (let item of this.arrs) {\r\n            if (pathname.endsWith(item) === true) {\r\n                pathname = pathname.substr(0, pathname.length - item.length);\r\n                break;\r\n            }\r\n        }\r\n        if (pathname.endsWith('/') === true || pathname.endsWith('\\\\') === true) {\r\n            pathname = pathname.substr(0, pathname.length-1);\r\n        }\r\n        return origin + pathname + '/unit.json';\r\n    }\r\n    private windowOnError = (event: Event | string, source?: string, lineno?: number, colno?: number, error?: Error) => {\r\n\t\tdebugger;\r\n        console.error('windowOnError');\r\n        console.error(error);\r\n    }\r\n    private windowOnUnhandledRejection = (ev: PromiseRejectionEvent) => {\r\n\t\tdebugger;\r\n        console.error('windowOnUnhandledRejection');\r\n        console.error(ev.reason);\r\n    }\r\n    private windowOnClick = (ev: MouseEvent) => {\r\n        console.error('windowOnClick');\r\n    }\r\n    private windowOnMouseMove = (ev: MouseEvent) => {\r\n        console.log('navigator.userAgent: ' + navigator.userAgent);\r\n        console.log('mouse move (%s, %s)', ev.x, ev.y);\r\n    }\r\n    private windowOnScroll = (ev: Event) => {\r\n        console.log('scroll event');\r\n\t}\r\n\r\n\tforceDevelopment:boolean;\r\n\t\r\n\tasync init() {\r\n\t\tthis.testing = env.testing;\r\n\t\tif (this.forceDevelopment === true) {\r\n\t\t\tenv.isDevelopment = true;\r\n\t\t}\r\n\t\tawait host.start(this.testing);\r\n\t\t/*\r\n\t\tlet hash = document.location.hash;\r\n\t\tif (hash !== undefined && hash.length > 0) {\r\n\t\t\tlet pos = getExHashPos();\r\n\t\t\tif (pos < 0) pos = undefined;\r\n\t\t\tthis.hashParam = hash.substring(1, pos);\r\n\t\t}\r\n\t\t*/\r\n\t\tlet {url, ws, resHost} = host;\r\n\t\tthis.centerHost = url;\r\n\t\tthis.resUrl = resUrlFromHost( resHost);\r\n\t\tthis.wsHost = ws;\r\n\t\tsetCenterUrl(url);\r\n\r\n\t\tlet guest:Guest = this.local.guest.get();\r\n\t\tif (guest === undefined) {\r\n\t\t\tguest = await guestApi.guest();\r\n\t\t}\r\n\t\tif (!guest) {\r\n\t\t\tdebugger;\r\n\t\t\tthrow Error('guest can not be undefined');\r\n\t\t}\r\n\t\tthis.setGuest(guest);\r\n\t}\r\n\r\n\treloadUser = () => {\r\n\t\tlet user: User = this.local.user.get();\r\n\t\tlet curUser = this.user;\r\n\t\tif (!user && !curUser) return;\r\n\t\tif (user?.id === curUser?.id) return;\r\n\t\tif (!user) {\r\n\t\t\tthis.logout();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.logined(user);\r\n\t\t}\r\n\t}\r\n\r\n    //private appStarted:boolean = false;\r\n    async appStart() {\r\n        //if (this.appStarted === true) return;\r\n        //this.appStarted = true;\r\n        await this.init();\r\n        await this.start();\r\n    }\r\n\r\n    async start() {\r\n        try {\r\n            window.onerror = this.windowOnError;\r\n            window.onunhandledrejection = this.windowOnUnhandledRejection;\r\n            window.onfocus = this.reloadUser;\r\n            if (env.isMobile === true) {\r\n                document.onselectstart = function() {return false;}\r\n                document.oncontextmenu = function() {return false;}\r\n            }\r\n\t\t\tthis.clear();\r\n\t\t\tthis.startWait();\r\n            \r\n            let user: User = this.local.user.get();\r\n            if (user === undefined) {\r\n                let {userPassword} = this.navView.props;\r\n\t\t\t\tif (userPassword) {\r\n\t\t\t\t\tlet ret = await userPassword();\r\n\t\t\t\t\tif (ret) {\r\n\t\t\t\t\t\tlet {user:userName, password} = ret;\r\n\t\t\t\t\t\tlet logindUser = await userApi.login({\r\n\t\t\t\t\t\t\tuser: userName,\r\n\t\t\t\t\t\t\tpwd: password,\r\n\t\t\t\t\t\t\tguest: this.guest,\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t\tuser = logindUser;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (user === undefined) {\r\n\t\t\t\t\tlet {notLogined} = this.navView.props;\r\n\t\t\t\t\tif (notLogined !== undefined) {\r\n\t\t\t\t\t\tawait notLogined();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tawait this.showLogin(undefined);\r\n\t\t\t\t\t\t//nav.navigateToLogin();\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn;\r\n\t\t\t\t}\r\n            }\r\n\r\n            await this.logined(user);\r\n        }\r\n        catch (err) {\r\n\t\t\tconsole.error(err);\r\n\t\t\tdebugger;\r\n        }\r\n        finally {\r\n            this.endWait();\r\n        }\r\n\t}\r\n\r\n\tresolveRoute() {\r\n\t\t//if (this.isRouting === false) return;\r\n\t\tif (this.navigo === undefined) return;\r\n\t\tthis.navigo.resolve();\r\n\t}\r\n\r\n\ton(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\ton(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\ton(...args:any[]):Navigo {\r\n\t\tif (this.navigo === undefined) {\r\n\t\t\tthis.navigo = new Navigo();\r\n\t\t\tif (this.isWebNav !== true) this.navigo.historyAPIUpdateMethod('replaceState');\r\n\t\t}\r\n\t\treturn this.navigo.on(args[0], args[1], args[2]);\r\n\t}\r\n\r\n\tprivate navLogin:NavPage = async (params:any) => {\r\n\t\tthis.showLogin(async (user: User) => window.history.back(), false);\r\n\t}\r\n\r\n\tprivate navLogout:NavPage = async (params:any) => {\r\n\t\tthis.showLogout(async () => window.history.back());\r\n\t}\r\n\r\n\tprivate navRegister:NavPage = async (params:any) => {\r\n\t\tthis.showRegister();\r\n\t}\r\n\r\n\tprivate navForget:NavPage = async (params:any) => {\r\n\t\tthis.showForget();\r\n\t}\r\n\r\n\tnavigateToLogin() {\r\n\t\tthis.navigate('/login');\r\n\t}\r\n\r\n\topenSysPage(url: string):boolean {\r\n\t\tlet navPage: NavPage = this.sysRoutes[url];\r\n\t\tif (navPage === undefined) {\r\n\t\t\t//alert(url + ' is not defined in sysRoutes');\r\n\t\t\treturn false;\r\n\t\t}\r\n\t\tnavPage(undefined);\r\n\t\treturn true;\r\n\t}\r\n\r\n\tprivate navPageRoutes: {[url:string]: NavPage};\r\n\tprivate routeFromNavPage(navPage: NavPage) {\r\n\t\treturn (params: any, queryStr: any) => {\r\n\t\t\tif (navPage) {\r\n\t\t\t\tif (this.isWebNav) this.clear();\r\n\t\t\t\tnavPage(params);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tonNavRoute(navPage: NavPage) {\r\n\t\tthis.on(this.routeFromNavPage(navPage));\r\n\t}\r\n\tprivate doneSysRoutes:boolean = false;\r\n\tprivate sysRoutes: { [route: string]: NavPage } = {\r\n\t\t'/login': this.navLogin,\r\n\t\t'/logout': this.navLogout,\r\n\t\t'/register': this.navRegister,\r\n\t\t'/forget': this.navForget,\r\n\t}\r\n\t/*\r\n\tonSysNavRoutes() {\r\n\t\tthis.onNavRoutes(this.sysRoutes);\r\n\t}\r\n\t*/\r\n\tonNavRoutes(navPageRoutes: {[url:string]: NavPage}) {\r\n\t\tif (this.doneSysRoutes === false) {\r\n\t\t\tthis.doneSysRoutes = true;\r\n\t\t\tthis.internalOnNavRoutes(this.sysRoutes);\r\n\t\t}\r\n\t\tthis.internalOnNavRoutes(navPageRoutes);\r\n\t}\r\n\r\n\tprivate internalOnNavRoutes(navPageRoutes: {[url:string]: NavPage}) {\r\n\t\tif (!navPageRoutes) return;\r\n\t\tthis.navPageRoutes = _.merge(this.navPageRoutes, navPageRoutes);\r\n\t\tlet navOns: { [route: string]: (params: any, queryStr: any) => void } = {};\r\n\t\tfor (let route in navPageRoutes) {\r\n\t\t\tlet navPage = navPageRoutes[route];\r\n\t\t\tnavOns[route] = this.routeFromNavPage(navPage);\r\n\t\t}\r\n\t\tthis.on(navOns);\r\n\t}\r\n\r\n\tisWebNav:boolean = false;\r\n\tbackIcon = <i className=\"fa fa-angle-left\" />;\r\n\tcloseIcon = <i className=\"fa fa-close\" />;\r\n\tsetIsWebNav() {\r\n\t\tthis.isWebNav = true;\r\n\t\tthis.backIcon = <i className=\"fa fa-arrow-left\" />;\r\n\t\tthis.closeIcon = <i className=\"fa fa-close\" />;\r\n\t}\r\n\r\n\tpageWebNav: PageWebNav;\r\n\r\n\tnavigate(url:string, absolute?:boolean) {\r\n\t\tif (!this.navigo) {\r\n\t\t\talert('Is not in webnav state, cannot navigate to url \"' + url + '\"');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (this.testing === true) {\r\n\t\t\turl += '#test';\r\n\t\t}\r\n\t\treturn this.navigo.navigate(url, absolute);\r\n\t}\r\n\r\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tif (this.navigo !== undefined) {\r\n\t\t\tthis.navigate(url, absolute);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tshowPage();\r\n\t\t}\r\n\t}\r\n\r\n    async showAppView(isUserLogin?: boolean) {\r\n        let {onLogined} = this.navView.props;\r\n        if (onLogined === undefined) {\r\n            this.push(<div>NavView has no prop onLogined</div>);\r\n            return;\r\n        }\r\n        this.clear();\r\n        await onLogined(isUserLogin);\r\n    }\r\n\r\n    setGuest(guest: Guest) {\r\n        this.local.guest.set(guest);\r\n        netToken.set(0, guest.token);\r\n    }\r\n\r\n    saveLocalUser() {\r\n        this.local.user.set(this.user);\r\n    }\r\n\r\n\tsetUqRoles(uq:string, roles:string[]) {\r\n\t\tlet {roles:userRoles} = this.user;\r\n\t\tif (!userRoles) {\r\n\t\t\tthis.user.roles = {};\r\n\t\t}\r\n\t\tthis.user.roles[uq] = roles;\r\n\t\tthis.local.user.set(this.user);\r\n\t}\r\n\r\n    async loadMe() {\r\n        let me = await userApi.me();\r\n        this.user.icon = me.icon;\r\n        this.user.nick = me.nick;\r\n    }\r\n\r\n\tprivate async internalLogined(user: User, callback: (user:User)=>Promise<void>, isUserLogin:boolean) {\r\n        logoutApis();\r\n        this.user = user;\r\n        this.saveLocalUser();\r\n\t\tnetToken.set(user.id, user.token);\r\n\t\tthis.clear();\r\n\r\n\t\tawait this.onChangeLogin?.(this.user);\r\n        if (callback !== undefined) {\r\n            await callback(user);\r\n\t\t}\r\n        else if (this.isWebNav === true) {\r\n\t\t\tthis.navigate('/index');\r\n\t\t}\r\n\t\telse {\r\n            await this.showAppView(isUserLogin);\r\n        }\r\n\t}\r\n\r\n\tonChangeLogin: (user:User) => Promise<void>;\r\n\r\n\t// 缓冲登录\r\n    async logined(user: User, callback?: (user:User)=>Promise<void>) {\r\n\t\tawait this.internalLogined(user, callback, false);\r\n    }\r\n\r\n\t// 用户操作之后登录\r\n    async userLogined(user: User, callback?: (user:User)=>Promise<void>) {\r\n\t\tawait this.internalLogined(user, callback, true);\r\n    }\r\n\r\n    loginTop(defaultTop:JSX.Element) {\r\n        return (this.navSettings && this.navSettings.loginTop) || defaultTop;\r\n    }\r\n\r\n    privacyEntry() {\r\n        if (!this.getPrivacyContent()) return;\r\n        return <div className=\"text-center\">\r\n            <button className=\"btn btn-sm btn-link\"\r\n                onClick={this.showPrivacyPage}>\r\n                <small className=\"text-muted\">隐私政策</small>\r\n            </button>\r\n        </div>;\r\n    }\r\n\r\n    private getPrivacyContent():string {\r\n        if (!this.navSettings) return;\r\n        let {privacy} = this.navSettings;\r\n        return privacy;\r\n    }\r\n\r\n    showPrivacyPage = () => {\r\n        let privacy = this.getPrivacyContent();\r\n        if (privacy) {\r\n            this.privacyPage(privacy);\r\n        }\r\n        else {\r\n            this.push(<Page header=\"隐私政策\">\r\n                <div className=\"p-3\">AppConfig 中没有定义 privacy。可以定义为字符串，或者url。markdown格式</div>\r\n            </Page>);\r\n        }\r\n    }\r\n\r\n    private privacyPage = async (htmlString: string) => {\r\n        //let html = await this.getPrivacy(privacy);\r\n\t\t//let content = {__html: marked(html)};\r\n\t\tlet content = {__html: htmlString};\r\n        this.push(<Page header=\"隐私政策\">\r\n            <div className=\"p-3\" dangerouslySetInnerHTML={content} />\r\n        </Page>);\r\n    }\r\n\r\n\tprivate createLogin = createLogin;\r\n\tsetCreateLogin(createLogin: ()=>Promise<Login>) {\r\n\t\tthis.createLogin = createLogin;\r\n\t}\r\n\r\n\tprivate login: Login;\r\n\tprivate async getLogin():Promise<Login> {\r\n\t\tif (this.login) return this.login;\r\n\t\treturn this.login = await this.createLogin();\r\n\t}\r\n\tasync showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean) {\r\n\t\tlet login = await this.getLogin();\r\n\t\tlogin.showLogin(callback, withBack);\r\n    }\r\n\r\n    async showLogout(callback?: ()=>Promise<void>) {\r\n\t\tlet login = await this.getLogin();\r\n\t\tlogin.showLogout(callback);\r\n\t}\r\n\t\r\n\tasync showRegister() {\r\n\t\tshowRegister();\r\n\t}\r\n\r\n\tasync showForget() {\r\n\t\tshowForget();\r\n\t}\r\n\r\n    async logout(callback?:()=>Promise<void>) { //notShowLogin?:boolean) {\r\n\t\tthis.local.logoutClear();\r\n        this.user = undefined; //{} as User;\r\n        logoutApis();\r\n        let guest = this.local.guest.get();\r\n        setCenterToken(0, guest && guest.token);\r\n\t\tthis.clear();\r\n        if (callback === undefined)\r\n            await this.start();\r\n        else\r\n            await callback();\r\n\t\tthis.onChangeLogin?.(undefined);\r\n\t}\r\n\r\n    async changePassword() {\r\n\t\tlet login = await this.getLogin();\r\n\t\tlogin.showChangePassword();\r\n    }\r\n\r\n    async userQuit() {\r\n        let login = await this.getLogin();\r\n        login.showUserQuit();\r\n    }\r\n\r\n    get level(): number {\r\n        return this.navView.level;\r\n    }\r\n    startWait() {\r\n        this.navView?.startWait();\r\n    }\r\n    endWait() {\r\n        this.navView?.endWait();\r\n    }\r\n    async onError(fetchError: FetchError)\r\n    {\r\n        let err = fetchError.error;\r\n        if (err !== undefined) {\r\n            if (err.unauthorized === true) {\r\n\t\t\t\tawait this.showLogin(undefined);\r\n\t\t\t\t//nav.navigateToLogin();\r\n                return;\r\n            }\r\n            switch (err.type) {\r\n                case 'unauthorized':\r\n                    await this.showLogin(undefined);\r\n\t\t\t\t\t//nav.navigateToLogin();\r\n                    return;\r\n                case 'sheet-processing':\r\n                    this.push(<SystemNotifyPage message=\"单据正在处理中。请重新操作！\" />);\r\n                    return;\r\n            }\r\n        }\r\n        this.navView.setState({\r\n            fetchError,\r\n        });\r\n    }\r\n\r\n    private upgradeUq = () => {\r\n        this.start();\r\n    }\r\n\r\n    async showUpgradeUq(uq:string, version:number):Promise<void> {\r\n        this.show(<Page header={false}>\r\n            <div>\r\n                UQ升级了，请点击按钮升级 <br />\r\n                <small className=\"text-muted\">{uq} ver-{version}</small>\r\n                <button className=\"btn btn-primary\" onClick={this.upgradeUq}>升级</button>\r\n            </div>\r\n        </Page>)\r\n    }\r\n\r\n    show (view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.show(view, disposer);\r\n    }\r\n    push(view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.push(view, disposer);\r\n    }\r\n    replace(view: JSX.Element, disposer?: ()=>void): void {\r\n        this.navView.replace(view, disposer);\r\n    }\r\n    pop(level:number = 1) {\r\n        this.navView.pop(level);\r\n    }\r\n    topKey():number {\r\n        return this.navView.topKey();\r\n    }\r\n    popTo(key:number) {\r\n        this.navView.popTo(key);\r\n    }\r\n    clear() {\r\n        this.navView?.clear();\r\n    }\r\n    navBack() {\r\n        this.navView.navBack();\r\n    }\r\n    ceaseTop(level?:number) {\r\n        this.navView.ceaseTop(level);\r\n    }\r\n    removeCeased() {\r\n        this.navView.removeCeased();\r\n    }\r\n    async back(confirm:boolean = true) {\r\n        await this.navView.back(confirm);\r\n    }\r\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        this.navView.regConfirmClose(confirmClose);\r\n    }\r\n    confirmBox(message?:string): boolean {\r\n        return this.navView.confirmBox(message);\r\n\t}\r\n\t/*\r\n    async navToApp(url: string, unitId: number, apiId?:number, sheetType?:number, sheetId?:number):Promise<void> {\r\n        return new Promise<void>((resolve, reject) => {\r\n            let sheet = this.centerHost.includes('http://localhost:') === true? 'sheet_debug':'sheet'\r\n            let uh = sheetId === undefined?\r\n                    appUrl(url, unitId) :\r\n                    appUrl(url, unitId, sheet, [apiId, sheetType, sheetId]);\r\n            console.log('navToApp: %s', JSON.stringify(uh));\r\n            nav.push(<article className='app-container'>\r\n                <span id={uh.hash} onClick={()=>this.back()}/>\r\n                    <i className=\"fa fa-arrow-left\" />\r\n                </span>\r\n                {\r\n                    // eslint-disable-next-line \r\n                    <iframe src={uh.url} title={String(sheetId)} />\r\n                }\r\n            </article>, \r\n            ()=> {\r\n                resolve();\r\n            });\r\n        });\r\n    }\r\n\r\n    navToSite(url: string) {\r\n        // show in new window\r\n        window.open(url);\r\n\t}\r\n\t*/\r\n\r\n    get logs() {return logs};\r\n    log(msg:string) {\r\n        logs.push(msg);\r\n    }\r\n    logMark() {\r\n        let date = new Date();\r\n        logMark = date.getTime();\r\n        logs.push('log-mark: ' + date.toTimeString());\r\n    }\r\n    logStep(step:string) {\r\n        logs.push(step + ': ' + (new Date().getTime() - logMark));\r\n    }\r\n\r\n    showReloadPage(msg: string) {\r\n        let seconds = -1;\r\n\t\tthis.push(<ReloadPage message={msg} seconds={seconds} />);\r\n\t\t/*\r\n\t\tif (seconds > 0) {\r\n\t\t\tenv.setTimeout(undefined, this.reload, seconds*1000);\r\n\t\t}\r\n\t\t*/\r\n    }\r\n\r\n    reload = async () => {\r\n        let waiting:Promise<void> = new Promise<void>((resolve, reject) => {\r\n            setTimeout(resolve, 100);\r\n        });\r\n\r\n        if ('serviceWorker' in navigator) {\r\n            let registration =await Promise.race([waiting, navigator.serviceWorker.ready]);\r\n            if (registration) registration.unregister();\r\n        }\r\n\t\twindow.document.location.reload();\r\n\t\t// dcloud hbuilder里面的app自动升级，需要清webview的缓存\r\n\t\tlet plus = (window as any).plus;\r\n\t\tif (plus) {\r\n\t\t\tlet webview = plus.webview;\r\n\t\t\tif (webview) {\r\n\t\t\t\tif (webview.reload) webview.reload(true);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tlet webView = plus.webView;\r\n\t\t\t\tif (webView) {\r\n\t\t\t\t\tif (webView.reload) webView.reload(true);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t//plus.webview.reload(true)\r\n\t\t}\r\n    }\r\n\r\n    resetAll = () => {\r\n        this.push(<ConfirmReloadPage confirm={(ok:boolean):Promise<void> => {\r\n            if (ok === true) {\r\n                this.showReloadPage('彻底升级');\r\n\t\t\t\tlocalStorage.clear();\r\n\t\t\t\t/*\r\n                this.local.readToMemory();\r\n                env.localDb.removeAll();\r\n\t\t\t\tthis.local.saveToLocalStorage();\r\n\t\t\t\t*/\r\n            }\r\n            else {\r\n                this.pop();\r\n            }\r\n            return;\r\n        }} />);\r\n    }\r\n\r\n    async checkVersion():Promise<string> {\r\n        let {href} = document.location;\r\n        href += (href.indexOf('?')>=0? '&':'?') + '_t_t_=' + new Date().getTime();\r\n        let ret = await fetch(href);\r\n        let r = await ret.text();\r\n        let parser = new DOMParser();\r\n        let htmlDoc = parser.parseFromString(r, 'text/html');\r\n        let elHtml = htmlDoc.getElementsByTagName('html');\r\n        let newVersion = elHtml[0].getAttribute('data-version');\r\n        return newVersion;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { nav } from '../nav';\r\nimport { Page } from './page/page';\r\n\r\ninterface Props {\r\n    message: string,\r\n    seconds: number\r\n}\r\n\r\ninterface State {\r\n    seconds: number\r\n}\r\n\r\nexport class ReloadPage extends React.Component<Props, State> {\r\n    private timerHandler:any;\r\n    constructor(props:Props) {\r\n\t\tsuper(props);\r\n\t\tlet {seconds} = props;\r\n\t\tif (seconds===undefined) return;\r\n        this.state = {seconds};\r\n\t\tif (seconds <= 0) return;\r\n        this.timerHandler = setInterval(() => {\r\n\t\t\tlet {seconds} = this.state;\r\n            seconds--;\r\n            if (seconds <= 0) {\r\n                this.reload();\r\n            }\r\n            else {\r\n                this.setState({seconds: seconds});\r\n            }\r\n        }, 1000);\r\n    }\r\n    private reload = () => {\r\n        clearInterval(this.timerHandler);\r\n        nav.reload();\r\n    }\r\n    render() {\r\n\t\tlet {seconds} = this.state;\r\n\t\tlet title:string, msg:string;\t\t\r\n\t\tif (seconds > 0) {\r\n\t\t\ttitle = '程序升级中...';\r\n\t\t\tmsg = this.state.seconds + '秒钟之后自动重启动';\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttitle = '程序需要升级';\r\n\t\t\tmsg = '请点击下面按钮重启';\r\n\t\t}\r\n        return <Page header={false}>\r\n            <div className=\"text-center p-5\">\r\n                <div className=\"text-info py-5\">\r\n\t\t\t\t\t<span className=\"text-danger\">{title}</span>\r\n\t\t\t\t\t<br/>\r\n\t\t\t\t\t{msg}\r\n                    <br/>\r\n                    <span className=\"small text-muted\">{this.props.message}</span>\r\n                </div>\r\n                <button className=\"btn btn-danger\" onClick={this.reload}>立刻重启</button>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\ninterface ConfirmReloadPageProps {\r\n    confirm: (ok: boolean)=>Promise<void>;\r\n}\r\nexport const ConfirmReloadPage = (props: ConfirmReloadPageProps):JSX.Element => {\r\n    return <Page header=\"升级软件\" back=\"close\">\r\n        <div className=\"py-5 px-3 my-5 mx-2 border bg-white rounded\">\r\n            <div className=\"text-center text-info\">\r\n                升级将清除所有本机缓冲区内容，并从服务器重新安装程序！\r\n            </div>\r\n            <div className=\"text-center mt-5\">\r\n                <button className=\"btn btn-danger me-3\" onClick={()=>props.confirm(true)}>确认升级</button>\r\n            </div>\r\n        </div>\r\n    </Page>;\r\n    // <button className=\"btn btn-outline-danger\" onClick={()=>props.confirm(false)}>暂不</button>\r\n}\r\n","import * as React from 'react';\r\nimport { FetchError, refetchApi } from 'tonva-core';\r\nimport { Page } from '../components';\r\n\r\nexport interface FetchErrorProps extends FetchError {\r\n    clearError: ()=>void\r\n}\r\n\r\nexport default class FetchErrorView extends React.Component<FetchErrorProps, null> {\r\n    private reApi = async () => {\r\n        this.props.clearError();\r\n        const {channel, url, options, resolve, reject} = this.props;\r\n        await refetchApi(channel, url, options, resolve, reject);\r\n    }\r\n    private close = async () => {\r\n        this.props.clearError();\r\n    }\r\n    render() {\r\n        let {error, url} = this.props;\r\n        let errContent:any;\r\n        if (typeof error === 'object') {\r\n            let err = [];\r\n            for (let i in error) {\r\n                err.push(<li key={i}><label>{i}</label><div style={{wordWrap:\"break-word\"}}>{error[i]}</div></li>);\r\n            }\r\n            errContent = <ul>{err}</ul>;\r\n        }\r\n        else {\r\n            errContent = <div>{error}</div>;\r\n        }\r\n        return <div className=\"tv-page\">\r\n            <article>\r\n\t\t\t\t<main className=\"va-error p-3\">\r\n\t\t\t\t\t<div>网络出现问题</div>\r\n\t\t\t\t\t<div>点击重新访问</div>\r\n\t\t\t\t\t<div style={{wordWrap:\"break-word\"}}>url: {url}</div>\r\n\t\t\t\t\t{errContent}\r\n\t\t\t\t\t<div className=\"p-3 text-center\">\r\n\t\t\t\t\t<button className=\"btn btn-primary me-3\" type='button' onClick={this.close}>关闭</button>\r\n\t\t\t\t\t\t<button className=\"btn btn-outline-primary\" type='button' onClick={this.reApi}>重试</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</main>\r\n            </article>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport const SystemNotifyPage = ({message}:{message:string}):JSX.Element => {\r\n    return <Page header=\"系统提醒\">\r\n        <div className=\"px-3\">{message}</div>\r\n    </Page>;\r\n}","import * as React from 'react';\r\nimport { env, FetchError } from 'tonva-core';\r\nimport { Loading } from '../components';\r\nimport FetchErrorView from './FetchErrorView';\r\nimport { FA } from '../components';\r\n\r\nexport interface Props\r\n{\r\n    onLogined: (isUserLogin?:boolean)=>Promise<void>;\r\n    notLogined?: ()=>Promise<void>;\r\n\tuserPassword?: () => Promise<{user:string; password:string}>;\r\n};\r\nlet stackKey = 1;\r\nexport interface StackItem {\r\n    key: number;\r\n    view: JSX.Element;\r\n    ceased: boolean;\r\n    confirmClose?: ()=>Promise<boolean>;\r\n    disposer?: ()=>void;\r\n}\r\nexport interface NavViewState {\r\n\tnotSupportedBrowser: boolean;\r\n    stack: StackItem[];\r\n    wait: 0|1|2;\r\n    fetchError: FetchError;\r\n}\r\n\r\nconst notSupportedBrowsers = ['IE'];\r\n\r\nexport class NavView extends React.Component<Props, NavViewState> {\r\n    private stack: StackItem[];\r\n    private waitCount: number = 0;\r\n    private waitTimeHandler?: NodeJS.Timer;\r\n\r\n    constructor(props:Props) {\r\n        super(props);\r\n        this.stack = [];\r\n\t\tlet {browser} = env;\r\n\t\tlet notSupportedBrowser = notSupportedBrowsers.findIndex(v => v === browser) >= 0;\r\n        this.state = {\r\n\t\t\tnotSupportedBrowser,\r\n            stack: this.stack,\r\n            wait: 0,\r\n            fetchError: undefined\r\n        };\r\n        //nav.set(this);\r\n    }\r\n    async componentDidMount()\r\n    {\r\n\t\tif (this.state.notSupportedBrowser === true) return;\r\n\t\twindow.addEventListener('popstate', this.navBack);\r\n    }\r\n\r\n    get level(): number {\r\n        return this.stack.length;\r\n    }\r\n\r\n    startWait() {\r\n        if (this.waitCount === 0) {\r\n            this.setState({wait: 1});\r\n            this.waitTimeHandler = env.setTimeout(\r\n                'NavView.startWait',\r\n                () => {\r\n                    this.waitTimeHandler = undefined;\r\n                    this.setState({wait: 2});\r\n                },\r\n                1000) as NodeJS.Timer;\r\n        }\r\n        ++this.waitCount;\r\n        this.setState({\r\n            fetchError: undefined,\r\n        });\r\n    }\r\n\r\n    endWait() {\r\n        env.setTimeout(\r\n            undefined, //'NavView.endWait',\r\n            () => {\r\n            /*\r\n            this.setState({\r\n                fetchError: undefined,\r\n            });*/\r\n            --this.waitCount;\r\n            if (this.waitCount === 0) {\r\n                if (this.waitTimeHandler !== undefined) {\r\n                    env.clearTimeout(this.waitTimeHandler);\r\n                    this.waitTimeHandler = undefined;\r\n                }\r\n                this.setState({wait: 0});\r\n            }\r\n        },100);\r\n    }\r\n\r\n    show(view: JSX.Element, disposer?: ()=>void): number {\r\n        this.clear();\r\n        return this.push(view, disposer);\r\n    }\r\n\r\n    push(view: JSX.Element, disposer?: ()=>void): number {\r\n        this.removeCeased();\r\n        if (this.stack.length > 0) {\r\n            window.history.pushState('forward', null, null);\r\n        }\r\n        let key = stackKey++;\r\n        this.stack.push({\r\n            key: key,\r\n            view: view, \r\n            ceased: false,\r\n            disposer: disposer\r\n        });\r\n        this.refresh();\r\n        //console.log('push: %s pages', this.stack.length);\r\n        return key;\r\n    }\r\n\r\n    replace(view: JSX.Element, disposer?: ()=>void): number {\r\n        let item:StackItem = undefined;\r\n        let stack = this.stack;\r\n        if (stack.length > 0) {\r\n            item = stack.pop();\r\n            //this.popAndDispose();\r\n        }\r\n        let key = stackKey++;\r\n        this.stack.push({\r\n            key: key, \r\n            view: view, \r\n            ceased: false,\r\n            disposer: disposer\r\n        });\r\n        if (item !== undefined) this.dispose(item.disposer);\r\n        this.refresh();\r\n        //console.log('replace: %s pages', this.stack.length);\r\n        return key;\r\n    }\r\n\r\n    ceaseTop(level:number = 1) {\r\n        let p = this.stack.length - 1;\r\n        for (let i=0; i<level; i++, p--) {\r\n            if (p < 0) break;\r\n            let item = this.stack[p];\r\n            item.ceased = true;\r\n        }\r\n    }\r\n\r\n    pop(level:number = 1) {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        //console.log('pop start: %s pages level=%s', len, level);\r\n        if (level <= 0 || len <= 1) return;\r\n        if (len < level) level = len;\r\n        let backLevel = 0;\r\n        for (let i = 0; i < level; i++) {\r\n            if (stack.length === 0) break;\r\n            //stack.pop();\r\n            this.popAndDispose();\r\n            ++backLevel;\r\n        }\r\n        if (backLevel >= len) backLevel--;\r\n        this.refresh();\r\n        if (this.isHistoryBack !== true) {\r\n            //window.removeEventListener('popstate', this.navBack);\r\n            //window.history.back(backLevel);\r\n            //window.addEventListener('popstate', this.navBack);\r\n        }\r\n        //console.log('pop: %s pages', stack.length);\r\n    }\r\n\r\n    popTo(key: number) {\r\n        if (key === undefined) return;\r\n        if (this.stack.find(v => v.key === key) === undefined) return;\r\n        while (this.stack.length >0) {\r\n            let len = this.stack.length;\r\n            let top = this.stack[len-1];\r\n            if (top.key === key) break;\r\n            this.pop();\r\n        }\r\n    }\r\n\r\n    topKey():number {\r\n        let len = this.stack.length;\r\n        if (len === 0) return undefined;\r\n        return this.stack[len-1].key;\r\n    }\r\n\r\n    removeCeased() {\r\n        for (;;) {\r\n            let p=this.stack.length-1;\r\n            if (p < 0) break;\r\n            let top = this.stack[p];\r\n            if (top.ceased === false) break;\r\n            let item = this.stack.pop();\r\n            let {disposer} = item;\r\n            this.dispose(disposer);\r\n        }\r\n        this.refresh();\r\n    }\r\n\r\n    private popAndDispose() {\r\n        this.removeCeased();\r\n        let item = this.stack.pop();\r\n\t\tif (item === undefined) return;\r\n\t\t//if (nav.isRouting) {\r\n\t\t//\twindow.history.back();\r\n\t\t//}\r\n        let {disposer} = item;\r\n        this.dispose(disposer);\r\n        this.removeCeased();\r\n        return item;\r\n    }\r\n\r\n    private dispose(disposer:()=>void) {\r\n        if (disposer === undefined) return;\r\n        let item = this.stack.find(v => v.disposer === disposer);\r\n        if (item === undefined) disposer();\r\n    }\r\n\r\n    clear() {\r\n        let len = this.stack.length;\r\n        while (this.stack.length > 0) this.popAndDispose();\r\n        //this.refresh();\r\n        if (len > 1) {\r\n            //window.removeEventListener('popstate', this.navBack);\r\n            //window.history.back(len-1);\r\n            //window.addEventListener('popstate', this.navBack);\r\n        }\r\n    }\r\n\r\n    regConfirmClose(confirmClose:()=>Promise<boolean>) {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        if (len === 0) return;\r\n        let top = stack[len-1];\r\n        top.confirmClose = confirmClose;\r\n    }\r\n\r\n    private isHistoryBack:boolean = false;\r\n    navBack = () => {\r\n        //nav.log('backbutton pressed - nav level: ' + this.stack.length);\r\n        let tick = Date.now();\r\n        this.isHistoryBack = true;\r\n        this.back(true);\r\n        this.isHistoryBack = false;\r\n        console.log(`///\\\\\\\\ ${Date.now()-tick}ms backbutton pressed - nav level: ${this.stack.length}`);\r\n    }\r\n\r\n    back = async (confirm:boolean = true) => {\r\n        let stack = this.stack;\r\n        let len = stack.length;\r\n        if (len === 0) return;\r\n        if (len === 1) {\r\n            if (window.self !== window.top) {\r\n                window.top.postMessage({type:'pop-app'}, '*');\r\n            }\r\n            return;\r\n        }\r\n        let top = stack[len-1];\r\n        if (confirm===true && top.confirmClose) {\r\n            if (await top.confirmClose()===true) this.pop();\r\n        }\r\n        else {\r\n            this.pop();\r\n        }\r\n    }\r\n\r\n    confirmBox(message?:string): boolean {\r\n        return window.confirm(message);\r\n    }\r\n    clearError = () => {\r\n        this.setState({fetchError: undefined});\r\n    }\r\n    render() {\r\n        const {notSupportedBrowser, wait, fetchError} = this.state;\r\n\t\tif (notSupportedBrowser === true) {\r\n\t\t\treturn <div className=\"p-3 text-danger\">\r\n\t\t\t\t{env.browser} not supported !\r\n\t\t\t</div>;\r\n\t\t}\r\n        let {stack} = this.state;\r\n        let top = stack.length - 1;\r\n        let elWait = null, elError = null;\r\n        switch (wait) {\r\n            case 1:\r\n                elWait = <div className=\"va-wait va-wait1\">\r\n                </div>;\r\n                break;\r\n            case 2:\r\n                elWait = <div className=\"va-wait va-wait2\">\r\n                    <Loading />\r\n                </div>;\r\n                break;\r\n        }\r\n        if (fetchError) {\r\n            elError = <FetchErrorView clearError={this.clearError} {...fetchError} />;\r\n\t\t\t++top;\r\n\t\t}\r\n        let test = env.testing===true && \r\n\t\t\t<span className=\"cursor-pointer position-fixed\" style={{top:0,left:'0.2rem',zIndex:90001}}>\r\n                <FA className=\"text-warning\" name=\"info-circle\" />\r\n\t\t\t</span>;\r\n        return <>\r\n\t\t\t{stack.map((item, index) => {\r\n\t\t\t\tlet {key, view} = item;\r\n\t\t\t\treturn <div key={key} style={index<top? {visibility: 'hidden', position: 'absolute'}:undefined}>\r\n\t\t\t\t\t{view}\r\n\t\t\t\t</div>\r\n\t\t\t})}\r\n\t\t\t{elWait}\r\n\t\t\t{elError}\r\n\t\t\t{test}\r\n\t\t</>;\r\n    }\r\n\r\n    private refresh() {\r\n        this.setState({stack: this.stack });\r\n    }\r\n}\r\n","import { Nav } from './Nav';\r\nimport { NavView } from './NavView';\r\n\r\nexport const nav: Nav = new Nav();\r\nexport class TonvaView extends NavView {\r\n\r\n}\r\nexport * from './Nav';\r\nexport * from './NavView';\r\n","import _ from 'lodash';\r\nimport { resLang } from '../res';\r\nimport { inputRes, InputRes } from '../res/inputRes';\r\n\r\nexport abstract class Rule {\r\n    abstract check(defy:string[], value:any):void;\r\n}\r\n\r\n//export type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\r\nexport type FieldRule = (value:any) => string[] | string;\r\n\r\nconst defaultInputRes:InputRes = resLang<InputRes>(inputRes);\r\n\r\nexport class RuleCustom extends Rule {\r\n    private func: FieldRule;\r\n    constructor(func: FieldRule) {\r\n        super();\r\n        this.func = func;\r\n    }\r\n    check(defy:string[], value:any) {\r\n        let ret = this.func(value);\r\n        if (ret === undefined) return;\r\n        switch (typeof ret) {\r\n            case 'undefined': return;\r\n            case 'string': defy.push(ret as string); return;\r\n            default: defy.push(...ret); return;\r\n        }        \r\n    }\r\n}\r\n\r\nexport abstract class RulePredefined extends Rule {\r\n    protected res: InputRes;\r\n    constructor(res?: InputRes) {\r\n        super();\r\n        this.res = res ?? defaultInputRes;\r\n    }\r\n}\r\n\r\nexport class RuleRequired extends RulePredefined {\r\n    check(defy:string[], value:any) {\r\n        switch (typeof value) {\r\n            default:\r\n            case 'boolean': return;\r\n            case 'object':\r\n                if (value !== null) return;\r\n                break;\r\n            case 'string':\r\n                if ((value as string).trim().length > 0) return;\r\n                break;\r\n            case 'number':\r\n                if (isNaN(value as number) === false) return;\r\n                break;\r\n            case 'undefined':\r\n                break;\r\n        }\r\n        defy.push(this.res.required);\r\n    }\r\n}\r\n\r\nexport class RuleNum extends RulePredefined {\r\n    private minMsg: _.TemplateExecutor;\r\n    private maxMsg: _.TemplateExecutor;\r\n    protected min: number;\r\n    protected max: number\r\n    constructor(res: InputRes, min?: number, max?: number) {\r\n        super(res);\r\n        this.minMsg = _.template(this.res.min);\r\n        this.maxMsg = _.template(this.res.max);\r\n        this.min = min;\r\n        this.max = max;\r\n    }\r\n    check(defy:string[], value:any) {\r\n        if (value === undefined || value === null) return;\r\n        let n = Number(value);\r\n        if (isNaN(n) === true) {\r\n            defy.push(this.res.number);\r\n        }\r\n        else {\r\n            this.checkMore(defy, n);\r\n        }\r\n    }\r\n\r\n    protected checkMore(defy:string[], value: number) {\r\n        if (this.min !== undefined && Number(value) < this.min) {\r\n            defy.push(this.minMsg({min:this.min}));\r\n        }\r\n        if (this.max !== undefined && Number(value) > this.max) {\r\n            defy.push(this.maxMsg({max:this.max}));\r\n        }\r\n    }\r\n}\r\n\r\nexport class RuleInt extends RuleNum {\r\n    protected checkMore(defy:string[], n: number) {\r\n        super.checkMore(defy, n);\r\n        if (Number.isInteger(n) === false) {\r\n            defy.push(this.res.integer);\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { UiItem, ChangingHandler, ChangedHandler } from '../../schema';\r\nimport { FieldProps } from '../field';\r\nimport { Context } from '../context';\r\nimport { ItemSchema } from '../../schema';\r\nimport { Rule, RuleRequired, RuleCustom, FieldRule } from '../../inputRules';\r\nimport { computed, makeObservable, observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport abstract class Widget {\r\n    name: string;\r\n    protected context: Context;\r\n    protected fieldProps:FieldProps;\r\n    protected children: React.ReactNode;\r\n    protected _itemSchema: ItemSchema;\r\n    protected _ui: UiItem;\r\n\tprotected defaultValue: any;\r\n    protected rules: Rule[];\r\n    protected readOnly:boolean;\r\n\t\r\n\tdisabled:boolean = false;\r\n    errors: string[] = [];\r\n    contextErrors: string[] = [];\r\n    get hasError():boolean {return (this.errors.length + this.contextErrors.length)>0}\r\n    visible:boolean = null;\r\n\tvalue: any = null;\r\n\r\n    constructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tmakeObservable(this, {\r\n\t\t\terrors: observable,\r\n\t\t\tcontextErrors: observable,\r\n\t\t\thasError: computed,\r\n\t\t\tvisible: observable,\r\n\t\t\tvalue: observable,\r\n\t\t\tdisabled: observable,\r\n\t\t\tisOk: computed,\r\n\t\t});\r\n        this.context = context;\r\n        let {name} = itemSchema;\r\n        this.name = name;\r\n        this._itemSchema = itemSchema;\r\n        this.fieldProps = fieldProps;\r\n        this.children = children;\r\n        this._ui = context.getUiItem(name);\r\n        if (this.ui === undefined) {\r\n            this.readOnly = false;\r\n            this.disabled = false;\r\n            this.visible = true;\r\n        }\r\n        else {\r\n            let {readOnly, disabled, visible} = this.ui;\r\n            this.readOnly = (readOnly === true);\r\n            this.disabled = (disabled === true);\r\n            this.visible = !(visible === false);\r\n        }\r\n        this.value = this.defaultValue =  context.getValue(name); //defaultValue;\r\n        // this.init();\r\n    }\r\n\r\n    protected get itemSchema(): ItemSchema {return this._itemSchema};\r\n    protected get ui(): UiItem {return this._ui};\r\n\r\n    init() {\r\n        this.rules = [];\r\n        if (this.itemSchema.required === true) {\r\n            this.rules.push(new RuleRequired(this.context.form.res));\r\n        }\r\n        this.buildRules();\r\n        if (this.ui === undefined) return;\r\n        let {rules} = this.ui;\r\n        if (rules === undefined) return;\r\n        if (Array.isArray(rules) === false) {\r\n            this.rules.push(new RuleCustom(rules as FieldRule));\r\n            return;\r\n        }\r\n        for (let rule of rules as FieldRule[]) {\r\n            this.rules.push(new RuleCustom(rule));\r\n        }\r\n    }\r\n\r\n    protected buildRules() {\r\n    }\r\n\r\n    checkRules() {\r\n        let defy:string[] = [];\r\n        for (let r of this.rules) r.check(defy, this.value);\r\n        if (defy.length === 0) {\r\n            this.context.removeErrorWidget(this);\r\n        }\r\n        else {\r\n            this.context.addErrorWidget(this);\r\n            this.errors.push(...defy);\r\n        }\r\n    }\r\n\r\n    get isOk() {\r\n        return this.errors.length ===0;\r\n    }\r\n\r\n    setError(err:string | string[]) {\r\n        if (err === undefined) return;\r\n        if (typeof err === 'string') this.errors.push(err);\r\n        else this.errors.push(...err);\r\n    }\r\n\r\n    setContextError(err:string | string[]) {\r\n        if (err === undefined) return;\r\n        if (typeof err === 'string') this.contextErrors.push(err);\r\n        else this.contextErrors.push(...err);\r\n    }\r\n\r\n    clearError() {\r\n        this.errors.splice(0);\r\n    }\r\n\r\n    clearContextError() {\r\n        this.contextErrors.splice(0);\r\n    }\r\n\r\n    protected parse(value:any):any {return value}\r\n\r\n    protected setElementValue(value:any) {}\r\n    protected setDataValue(value:any) {\r\n        if (this.isChanging === true) return;\r\n        this.context.initData[this.name] = this.value = this.parse(value);\r\n    }\r\n\r\n    setValue(value:any) {\r\n        if (this.isChanging === true) return;\r\n        this.changeValue(value, false);\r\n    }\r\n\r\n    getValue() {\r\n        return this.context.getValue(this.name);\r\n    }\r\n\r\n    getReadOnly():boolean {return this.readOnly}\r\n    getDisabled():boolean {return this.disabled}\r\n    getVisible():boolean {return this.visible}\r\n    setReadOnly(value:boolean) {this.readOnly = value}\r\n    setDisabled(value:boolean) {\r\n\t\tthis.disabled = value;\r\n\t}\r\n    setVisible(value:boolean) {this.visible = value}\r\n\r\n    private isChanging: boolean;\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n        this.changeValue(evt.target.value, true);\r\n    }\r\n\r\n    protected changeValue(newValue: any, fromElement: boolean) {\r\n        let prev = this.value;\r\n        let onChanging: ChangingHandler;\r\n        let onChanged: ChangedHandler;\r\n        if (this.ui !== undefined) {\r\n            onChanging = this.ui.onChanging;\r\n            onChanged = this.ui.onChanged;\r\n        }\r\n        let allowChange = true;\r\n        if (onChanging !== undefined) {\r\n            this.isChanging = true;\r\n            allowChange = onChanging(this.context, this.value, prev);\r\n            this.isChanging = false;\r\n        }\r\n        if (allowChange === true) {\r\n            this.setDataValue(newValue);\r\n            if (fromElement !== true) this.setElementValue(newValue);\r\n            if (onChanged !== undefined) {\r\n                this.isChanging = true;\r\n                onChanged(this.context, this.value, prev);\r\n                this.isChanging = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    protected get className():string {\r\n        let fieldClass:string;\r\n        if (this.context.inNode === false) fieldClass = 'form-control';\r\n        return classNames(fieldClass, this.context.form.FieldClass, this.ui && this.ui.className);\r\n    }\r\n\r\n    protected abstract render():JSX.Element;\r\n\r\n    protected renderBody():JSX.Element {\r\n        let elDiscription;\r\n        if (this.hasError === false && this.ui) {\r\n            let {discription, discriptionClassName} = this.ui;\r\n            if (discriptionClassName === undefined) discriptionClassName = 'small text-muted';\r\n            elDiscription = <span className={discriptionClassName}>\r\n                {discription}\r\n            </span>;\r\n        }\r\n        return <>\r\n            {this.render()}\r\n            {elDiscription}\r\n        </>;\r\n    }\r\n\r\n    container = observer(():JSX.Element => {\r\n        if (this.visible === false) return null;\r\n        let {form, inNode} = this.context;\r\n        if (inNode === true) return this.render();\r\n        let label:any = this.label;\r\n        if (this.itemSchema.required === true && form.props.requiredFlag !== false) {\r\n            if (label !== null) label = <>{label}&nbsp;<span className=\"text-danger\">*</span></>;\r\n        }\r\n        return form.FieldContainer(label, this.renderBody());\r\n    })\r\n\r\n    protected get label():string {\r\n        let label:any;\r\n        if (this.ui === undefined) {\r\n            label = this.name;\r\n        }\r\n        else {\r\n            let uiLabel = this.ui.label;\r\n            if (uiLabel === null) label = null;\r\n            else label = uiLabel || this.name;\r\n        }\r\n        return label;\r\n    }\r\n\r\n    protected renderTemplet():JSX.Element | undefined {\r\n        if (this.children !== undefined) {\r\n            return <>{this.children}</>;\r\n        }\r\n        if (this.ui === undefined) return undefined;\r\n        let {Templet} = this.ui;\r\n        if (typeof Templet === 'function') return Templet(this.value);\r\n        return Templet;\r\n    }\r\n\r\n    protected renderErrors() {\r\n        let errorList:string[] = [...this.errors, ...this.contextErrors];\r\n        if (errorList.length === 0) return null;\r\n        let {inNode} = this.context;\r\n        let tag = inNode === true? 'span' : 'div';\r\n        return errorList.map(err => React.createElement(tag, \r\n            {\r\n                key: err, \r\n                className: 'text-danger d-inline-block my-2 ms-3'\r\n            },\r\n            <><i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}</>\r\n        ));\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { makeObservable, observable, runInAction } from 'mobx';\r\nimport { UiTextItem, StringSchema, ItemSchema } from '../../schema';\r\nimport { Context } from '../context';\r\nimport { FieldProps } from '../field';\r\nimport { Widget } from './widget';\r\n\r\nexport class TextWidget extends Widget {\r\n    protected inputType = 'text';\r\n    protected get ui(): UiTextItem {return this._ui as UiTextItem};\r\n    protected input: HTMLInputElement;\r\n    hasFocus: boolean = false;\r\n\r\n\tconstructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tsuper(context, itemSchema, fieldProps, children);\r\n\t\tmakeObservable(this, {\r\n\t\t\thasFocus: observable,\r\n\t\t})\r\n\t}\r\n\r\n    protected setElementValue(value:any) {\r\n        if (this.input === null) return;\r\n        this.input.value = value;\r\n    }\r\n    protected get placeholder() {\r\n\t\tif (this.ui) {\r\n\t\t\tlet {placeholder} = this.ui;\r\n\t\t\tif (placeholder) return placeholder;\r\n\t\t\tlet {label} = this.ui;\r\n\t\t\tif (label) return label;\r\n\t\t}\r\n\t\treturn this.name\r\n\t}\r\n    protected onKeyDown = async (evt:React.KeyboardEvent<HTMLInputElement>) => {\r\n        this.internalOnKeyDown(evt);\r\n        if (evt.keyCode !== 13) return;\r\n        let {onEnter} = this.context.form.props;\r\n        if (onEnter === undefined) return;\r\n\r\n        this.changeValue(evt.currentTarget.value, true);\r\n\r\n        //this.checkRules();\r\n        //this.context.checkContextRules();\r\n        this.input.blur();\r\n\r\n        let ret = await onEnter(this.name, this.context);\r\n        if (ret !== undefined) {\r\n            this.context.setError(this.name, ret);\r\n        }\r\n    }\r\n\r\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\r\n    }\r\n\r\n    protected onBlur = (evt: React.FocusEvent<any>) => {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.onInputChange(evt);\r\n\t\t\tthis.checkRules();\r\n\t\t\tthis.context.checkContextRules();\r\n\t\t\tthis.hasFocus = false;\r\n\t\t});\r\n    }\r\n    protected onFocus = (evt: React.FocusEvent<any>) => {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.clearError();\r\n\t\t\tthis.context.removeErrorWidget(this);\r\n\t\t\tthis.context.clearErrors();\r\n\t\t\tthis.hasFocus = true;\r\n\t\t});\r\n\t\tsetTimeout(() => {\r\n\t\t\tconsole.log('focus and select');\r\n\t\t\tthis.input.focus();\r\n\t\t\tthis.input.select();\r\n\t\t}, 10)\r\n    }\r\n    protected onChange(evt: React.ChangeEvent<any>) {\r\n\t\tthis.onInputChange(evt);\r\n    }\r\n\r\n    setReadOnly(value:boolean) {\r\n        if (this.input === null) return;\r\n        this.input.readOnly = this.readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        if (this.input === null) return;\r\n        this.input.disabled = this.disabled = value;\r\n    }\r\n\r\n    render() {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn:any = {\r\n            //'form-control': true,\r\n        };\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        return <><input ref={input=>this.input = input}\r\n            className={classNames(this.className, cn)}\r\n            type={this.inputType}\r\n            defaultValue={this.value}\r\n            onChange={(evt: React.ChangeEvent<any>) => this.onChange(evt)}\r\n            placeholder={typeof this.placeholder === 'string'? this.placeholder : undefined}\r\n            readOnly={this.readOnly}\r\n            disabled={this.disabled}\r\n            onKeyDown = {this.onKeyDown}\r\n            onFocus = {this.onFocus}\r\n            onBlur={this.onBlur}\r\n            maxLength={(this.itemSchema as StringSchema).maxLength} />\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiTextAreaItem } from '../../schema';\r\nimport { StringSchema } from '../../schema';\r\n\r\nexport class TextAreaWidget extends Widget {\r\n    protected get itemSchema(): StringSchema {return this._itemSchema as StringSchema};\r\n    protected input: HTMLTextAreaElement;\r\n    protected get ui(): UiTextAreaItem {return this._ui as UiTextAreaItem};\r\n\r\n    protected setElementValue(value:any) {this.input.value = value}\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.setValue(evt.currentTarget.value);\r\n    }\r\n\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n\tprotected onBlur = (evt: React.FocusEvent<any>) => {\r\n        this.onInputChange(evt);\r\n        this.checkRules();\r\n        this.context.checkContextRules();\r\n    }\r\n    protected onFocus = (evt: React.FocusEvent<any>) => {\r\n        this.clearError();\r\n        this.context.removeErrorWidget(this);\r\n        this.context.clearErrors();\r\n    }\r\n\r\n    render() {\r\n        let renderTemplet = this.renderTemplet();\r\n        if (renderTemplet !== undefined) return renderTemplet;\r\n        let cn:any = {};\r\n        if (this.hasError === true) {\r\n            cn['is-invalid'] = true;\r\n        }\r\n        else {\r\n            cn['required-item'] = this.itemSchema.required === true;\r\n        }\r\n        return <>\r\n\t\t\t<textarea ref={(input) => this.input=input}\r\n\t\t\t\tonBlur={this.onBlur} \r\n\t\t\t\tonFocus={this.onFocus}\r\n                className={classNames(this.className, cn)}\r\n                rows={this.ui && this.ui.rows}\r\n                maxLength={this.itemSchema.maxLength}\r\n                defaultValue={this.defaultValue} onChange={this.onInputChange} />\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\n\r\nexport class PasswordWidget extends TextWidget {\r\n    protected inputType = 'password';\r\n}\r\n\r\nexport class UrlWidget extends TextWidget {\r\n    protected inputType = 'url';\r\n}\r\n\r\nexport class EmailWidget extends TextWidget {\r\n    protected inputType = 'email';\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\nimport { NumBaseSchema } from '../../schema';\r\nimport { RuleInt, RuleNum } from '../../inputRules';\r\n\r\nexport class NumberWidget extends TextWidget {\r\n    protected inputType = 'number';\r\n    protected get itemSchema(): NumBaseSchema {return this._itemSchema as NumBaseSchema};\r\n\r\n    protected buildRules() {\r\n        super.buildRules();\r\n        let res = this.context.form.res;\r\n        let {min, max} = this.itemSchema;\r\n        this.rules.push(\r\n            this.itemSchema.type === 'integer'?\r\n            new RuleInt(res, min, max) :\r\n            new RuleNum(res, min, max)\r\n        );\r\n    }\r\n\r\n    protected parse(value:any):any {\r\n        switch (typeof value) {\r\n            default: return;\r\n            case 'undefined': return;\r\n            case 'number': return value;\r\n            case 'string':\r\n                if ((value as string).trim().length === 0) return;\r\n                return Number(value);\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { NumberWidget } from './numberWidget';\r\n\r\nexport class UpdownWidget extends NumberWidget {\r\n    protected inputType = 'number';\r\n\r\n    protected isValidKey(key:number):boolean {\r\n        return key===46 || key===8 || key===37 || key===39\r\n            || (key>=48 && key<=57)\r\n            || (key>=96 && key<=105)\r\n            || key===109 || key===189;\r\n    }\r\n    \r\n    protected internalOnKeyDown(evt:React.KeyboardEvent<HTMLInputElement>) {\r\n        let key = evt.keyCode;\r\n        window.event.returnValue = this.isValidKey(key);\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { TextWidget } from './textWidget';\r\n\r\nexport class DateWidget extends TextWidget {\r\n    protected inputType = 'date';\r\n}\r\n\r\nexport class DateTimeWidget extends TextWidget {\r\n    protected inputType = 'datetime';\r\n}\r\n\r\nexport class TimeWidget extends TextWidget {\r\n    protected inputType = 'time';\r\n}\r\n\r\nexport class MonthWidget extends TextWidget {\r\n    protected inputType = 'month';\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiCheckItem } from '../../schema';\r\n\r\nexport class CheckBoxWidget extends Widget {\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiCheckItem {return this._ui as UiCheckItem};\r\n    protected trueValue: any;\r\n    protected falseValue: any;\r\n\r\n    init() {\r\n        super.init();\r\n        if (this.ui !== undefined) {\r\n            let {trueValue, falseValue} = this.ui;\r\n            if (trueValue === undefined) this.trueValue = true;\r\n            else this.trueValue = trueValue;\r\n            if (falseValue === undefined) this.falseValue = false;\r\n            else this.falseValue = falseValue;\r\n        }\r\n        else {\r\n            this.trueValue = true;\r\n            this.falseValue = false;\r\n        }\r\n    }\r\n    protected setElementValue(value:any) {\r\n        this.input.checked = value === this.trueValue;\r\n    }\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        let v = evt.target.checked === true? this.trueValue : this.falseValue;\r\n        this.setDataValue(v);\r\n    }\r\n\r\n    protected onClick = () => {\r\n        this.context.clearErrors();\r\n    }\r\n\r\n    render() {\r\n        let cn = classNames(this.className, 'form-check-inline p-0');\r\n        let input = <input\r\n            ref={(input)=>this.input = input}\r\n            className={'align-self-center'}\r\n            type=\"checkbox\"\r\n            defaultChecked={this.defaultValue} \r\n            onChange={this.onInputChange}\r\n            onClick={this.onClick} />;\r\n        if (this.context.inNode === true) {\r\n            return <label className={cn}>\r\n                {input} {(this.ui&&this.ui.label) || this.name}\r\n            </label>\r\n        }\r\n        else {\r\n            return <div className={cn}>\r\n                <label className=\"w-100 h-100 mb-0 d-flex justify-content-center\">{input}</label>\r\n            </div>;\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { Widget } from './widget';\r\nimport { ItemSchema, UiSelect } from '../../schema';\r\nimport { Context } from '../context';\r\nimport { FieldProps } from '../field';\r\n\r\nexport class SelectWidget extends Widget {\r\n    protected select: HTMLSelectElement;\r\n    protected get ui(): UiSelect {return this._ui as UiSelect};\r\n    readOnly: boolean = false;\r\n\r\n\tconstructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tsuper(context, itemSchema, fieldProps, children);\r\n\t\tmakeObservable(this, {\r\n\t\t\treadOnly: observable,\r\n\t\t})\r\n\t}\r\n\r\n    protected setElementValue(value:any) {this.select.value = value}\r\n    protected onInputChange = (evt:React.ChangeEvent<HTMLSelectElement>) => {\r\n        this.setDataValue(evt.target.value);\r\n    }\r\n\r\n    setReadOnly(value:boolean) {this.select.disabled = this.readOnly = !value}\r\n    setDisabled(value:boolean) {this.select.disabled = this.disabled = value}\r\n\r\n    render() {\r\n        if (this.readOnly === true) {\r\n            let option = this.ui.list.find(v => v.value === this.value);\r\n            let title = (option === undefined)? '(???)' : option.title;\r\n            return <span className=\"form-control w-min-6c\">{title}</span>;\r\n        }\r\n        return <select\r\n            ref={(select)=>this.select = select}\r\n            className={classNames(this.className, 'form-control')}\r\n            defaultValue={this.defaultValue} \r\n            onChange={this.onInputChange}>\r\n            {this.ui.list.map((v,index) => {\r\n                let {title, value} = v;\r\n                let cn:string;\r\n                //if (value === undefined || value === null) cn = 'text-light small';\r\n                //else cn = 'text-danger';\r\n                return <option className={cn} key={index} value={value}>{title || value}</option>\r\n            })}\r\n        </select>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n//import { TextWidget } from './textWidget';\r\nimport { Widget } from './widget';\r\nimport { UiRadio } from '../../schema';\r\nimport { RowContext } from '../context';\r\n\r\n\r\nconst radioStyle:React.CSSProperties = {height: 'auto'};\r\n\r\nexport class RadioWidget extends Widget {\r\n    protected inputs: {[index:number]: HTMLInputElement} = {};\r\n    protected get ui(): UiRadio {return this._ui as UiRadio};\r\n\r\n    protected setElementValue(value:any) {\r\n        for (let i in this.inputs) {\r\n            let input = this.inputs[i];\r\n            input.checked = value === input.value;\r\n        }\r\n    }\r\n    setReadOnly(value:boolean) {\r\n        this.readOnly = value;\r\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        this.disabled = value;\r\n        for (let i in this.inputs) this.inputs[i].disabled = value\r\n    }\r\n\r\n    /*\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n        this.changeValue(evt.target.value, true);\r\n    }\r\n    */\r\n\r\n    render() {\r\n        let {defaultValue, list} = this.ui;\r\n        let {isRow} = this.context;\r\n        let rowKey:number;\r\n        if (isRow === true) {\r\n            rowKey = (this.context as RowContext).rowKey;\r\n        }\r\n        let cn = classNames(this.className, 'py-0');\r\n        return <span className={cn} style={radioStyle}>\r\n                {list.map((v,index) => {\r\n                    let {value, title} = v;\r\n                    let name = this.name;\r\n                    if (rowKey !== undefined) name += '-' + rowKey;\r\n                    return <label key={index} className=\"form-radio-inline\">\r\n                        <input ref={input=>this.inputs[index]=input} type=\"radio\" name={name}\r\n                            value={value} defaultChecked={(this.defaultValue || defaultValue)===value}\r\n                            onChange={this.onInputChange} />\r\n                        {title || value}\r\n                    </label>;\r\n                    //</span>\r\n                })}\r\n            </span>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { UiRange } from '../../schema';\r\nimport { Widget } from './widget';\r\n\r\nexport class RangeWidget extends Widget {\r\n    protected inputType = 'range';\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiRange {return this._ui as UiRange};\r\n\r\n    setReadOnly(value:boolean) {this.input.readOnly = this.readOnly = value}\r\n    setDisabled(value:boolean) {this.input.disabled = this.disabled = value}\r\n\r\n    render() {\r\n        let {min, max, step} = this.ui;\r\n        return <><input ref={input=>this.input = input}\r\n            className={classNames(this.className, 'form-control', 'w-min-6c')}\r\n            type={this.inputType}\r\n            defaultValue={this.defaultValue} \r\n            onChange={this.onInputChange}\r\n            max={max}\r\n            min={min}\r\n            step={step}\r\n            />\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiIdItem, TempletType } from '../../schema';\r\nimport { runInAction } from 'mobx';\r\n\r\nconst none = <small className=\"text-muted\">[无]</small>;\r\n\r\nexport class IdWidget extends Widget {\r\n    protected get ui(): UiIdItem {return this._ui as UiIdItem};\r\n\r\n    setReadOnly(value:boolean) {this.readOnly = value}\r\n    setDisabled(value:boolean) {this.disabled = value}    \r\n\r\n    protected onClick = async () => {\r\n        let pickId = this.ui && this.ui.pickId;\r\n        if (pickId === undefined) {\r\n            alert('no pickId defined!');\r\n            return;\r\n        }\r\n\t\tlet id = await pickId(this.context, this.name, this.value);\r\n\t\trunInAction(() => {\r\n\t\t\tthis.setDataValue(id);\r\n\t\t\tthis.clearError();\r\n\t\t\tthis.clearContextError();\r\n\t\t\tthis.checkRules();\t\r\n\t\t});\r\n    }\r\n\r\n\tsetValue(value:any) {\r\n\t\tsuper.setValue(value);\r\n\t}\r\n\r\n    render() {\r\n        let placeholder:string|JSX.Element, Templet: TempletType;\r\n        if (this.ui !== undefined) {\r\n            placeholder = this.ui.placeholder;\r\n            Templet = this.ui.Templet;\r\n        }\r\n        let cn:any = {\r\n            'form-control': true,\r\n            'required-item': this.itemSchema.required === true,\r\n            'cursor-pointer': true,\r\n            'is-invalid': this.hasError,\r\n        };\r\n        let content;\r\n        if (this.value === undefined || this.value === null) {\r\n            content = placeholder || none;\r\n            cn['text-muted'] = true;\r\n        }\r\n        else if (Templet === undefined) {\r\n            let c: any;\r\n            if (this.value === null) {\r\n                c = 'null';\r\n            }\r\n            else {\r\n                switch (typeof this.value) {\r\n                    case 'undefined': c = none; break;\r\n                    case 'object': c = (this.value as any).id; break;\r\n                    default: c = this.value; break;\r\n                }\r\n            }\r\n            content = <>{c}</>;\r\n        }\r\n        else if (typeof Templet === 'function') {\r\n            content = Templet(this.value);\r\n        }\r\n        else {\r\n            content = Templet;\r\n        }\r\n        return <>\r\n            <div className={classNames(cn)} onClick={this.onClick}>{content}</div>\r\n            {this.renderErrors()}\r\n        </>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { DataType } from '../../schema';\r\nimport { UiType } from '../../schema';\r\n\r\nexport const Unknown = (dataType:DataType, uiType:UiType, dataTypes:DataType[]) => {\r\n    return <span className=\"text-danger\">!!data type {dataType} only support {(dataTypes || []).join(', ')}, can't use ui {uiType}!!</span>;\r\n};\r\n","import * as React from 'react';\r\nimport { UiButton, TempletType } from '../../schema';\r\nimport { Unknown } from './unknown';\r\nimport { Widget } from './widget';\r\nimport { observer } from 'mobx-react';\r\nimport { runInAction } from 'mobx';\r\n\r\nexport class ButtonWidget extends Widget {\r\n    protected get ui(): UiButton {return this._ui as UiButton};\r\n\r\n    protected onClick = async () => {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.clearError();\r\n\t\t\tthis.clearContextError();\r\n\t\t})\r\n        let {name, type} = this.itemSchema;\r\n        if (type === 'submit') {\r\n\t\t\tawait this.context.submit(name);\r\n\t\t\treturn;\r\n        }\r\n        let {onButtonClick} = this.context.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`button ${name} clicked. you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(name, this.context);\r\n        if (ret === undefined) return;\r\n\t\trunInAction(() => {\r\n\t\t\tthis.context.setError(name, ret);\r\n\t\t});\r\n    }\r\n\r\n    private observerRender = observer(() => {\r\n        let {name, type} = this.itemSchema;\r\n        let Templet:TempletType, cn:string, caption:string|JSX.Element;\r\n        if (this.ui !== undefined) {\r\n            let {widget:widgetType} = this.ui;\r\n            if (widgetType !== 'button') return Unknown(type, widgetType, ['button']);\r\n            Templet = this.ui.Templet;\r\n            cn = this.ui.className;\r\n            caption = this.ui.label;\r\n        }\r\n        let {form, hasError} = this.context;\r\n        let context = this.context;\r\n        let disabled = (type==='submit' && hasError) || this.disabled;\r\n        let content:any;\r\n        if (this.children !== undefined) content = this.children;\r\n        else if (typeof Templet === 'function') content = Templet();\r\n        else if (Templet !== undefined) content = Templet;\r\n        else content = caption; \r\n        let button = <button \r\n            className={cn} \r\n            type=\"button\"\r\n            disabled={disabled}\r\n            onClick={this.onClick}>\r\n            {content || name}\r\n        </button>;\r\n        if (context.inNode === true) return <>{button}{this.renderErrors()}</>;\r\n        return <div className={form.ButtonClass}>\r\n            <div>{this.renderErrors()}</div>\r\n            {button}\r\n        </div>;\r\n    });\r\n    \r\n    protected get label():string {return null}\r\n\r\n    render() {\r\n        return React.createElement(this.observerRender);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { Form } from './form';\r\nimport { UiSchema, UiArr, UiItem } from '../schema';\r\nimport { ArrSchema, ItemSchema } from '../schema';\r\nimport { Widget } from './widgets/widget';\r\n//import { ArrRow } from './arrRow';\r\nimport { observable, computed, makeObservable, runInAction } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport type ContextRule = (context:Context)=>{[target:string]:string[]|string} | string[] | string;\r\n\r\nexport abstract class Context {\r\n    private subContexts:{[name:string]:{[rowKey:string]:Context}};\r\n    readonly form: Form;\r\n    readonly uiSchema: UiSchema;\r\n    readonly initData: any;\r\n    readonly inNode: boolean;           // true: 在</> 流中定义Field\r\n    readonly widgets: {[name:string]: Widget} = {};\r\n    readonly rules: ContextRule[];\r\n\treadonly isRow: boolean;\r\n\t\r\n    errors: string[] = [];\r\n    errorWidgets:Widget[] = [];\r\n\r\n    constructor(form: Form, uiSchema: UiSchema, data: any, inNode: boolean, isRow: boolean) {\r\n\t\tmakeObservable(this, {\r\n\t\t\terrors: observable,\r\n\t\t\terrorWidgets: observable,\r\n\t\t\thasError: computed,\r\n\t\t});\r\n        this.form = form;\r\n        this.uiSchema = uiSchema;\r\n        this.initData = data;\r\n        this.inNode = inNode;\r\n        this.isRow = isRow;\r\n        if (uiSchema !== undefined) {\r\n            let {rules} = uiSchema;\r\n            if (rules !== undefined) {\r\n                this.rules = [];\r\n                if (Array.isArray(rules) === false)\r\n                    this.rules.push(rules as ContextRule);\r\n                else\r\n                    this.rules.push(...rules as ContextRule[]);\r\n            }\r\n        }\r\n    }\r\n\r\n    getArrRowContexts(arrName: string) {\r\n        if (this.subContexts === undefined) this.subContexts = {};\r\n        let arrRowContexts = this.subContexts[arrName];\r\n        if (arrRowContexts === undefined) this.subContexts[arrName] = arrRowContexts = {};\r\n        return arrRowContexts;\r\n    }\r\n\r\n    abstract get data():any;\r\n    abstract getItemSchema(itemName:string):ItemSchema;\r\n    abstract getUiItem(itemName:string):UiItem;\r\n    get arrName():string {return undefined}\r\n    getValue(itemName:string):any {return this.initData[itemName]}\r\n    setValue(itemName:string, value:any) {\r\n        this.initData[itemName] = value;\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setValue(value);\r\n    }\r\n    getDisabled(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) return widget.getDisabled();\r\n        return undefined;\r\n    }\r\n    setDisabled(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setDisabled(value);\r\n    }\r\n    getReadOnly(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.getReadOnly();\r\n        return undefined;\r\n    }\r\n    setReadOnly(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setReadOnly(value);\r\n    }\r\n    getVisible(itemName:string):boolean {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.getVisible();\r\n        return undefined;\r\n    }\r\n    setVisible(itemName:string, value:boolean) {\r\n        let widget = this.widgets[itemName];\r\n        if (widget !== undefined) widget.setVisible(value);\r\n    }\r\n\r\n    async submit(buttonName: string) {\r\n        this.checkRules()\r\n        if (this.hasError === true) {\r\n            let err = '';\r\n            for (let ew of this.errorWidgets) {\r\n                err += ew.name + ':\\n' + ew.errors.join('\\n');\r\n            }\r\n            console.error(err);\r\n            return;\r\n        }\r\n        let {onButtonClick} = this.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`button ${buttonName} clicked. you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(buttonName, this);\r\n        if (ret === undefined) return;\r\n        this.setError(buttonName, ret);\r\n\r\n    }\r\n\r\n    checkFieldRules() {\r\n        for (let i in this.widgets) {\r\n            this.widgets[i].checkRules();\r\n        }\r\n        if (this.subContexts === undefined) return;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                arrRowContexts[j].checkFieldRules();\r\n            }\r\n        }\r\n    }\r\n\r\n    checkContextRules() {\r\n        this.clearErrors();\r\n        if (this.rules === undefined) return;\r\n        for (let rule of this.rules) {\r\n            let ret = rule(this);\r\n            if (ret === undefined) continue;\r\n            if (Array.isArray(ret) === true) {\r\n                this.errors.push(...ret as string[]);\r\n            }\r\n            else if (typeof ret === 'string') {\r\n                this.errors.push(ret as string);\r\n            }\r\n            else {\r\n                for (let i in ret as object) this.setError(i, (ret as any)[i]);\r\n            }\r\n        }\r\n        if (this.subContexts === undefined) return;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                let rowContext = arrRowContexts[j];\r\n                rowContext.clearErrors();\r\n                rowContext.checkContextRules();\r\n            }\r\n        }\r\n    }\r\n\r\n    setError(itemName:string, error:string) {\r\n\t\trunInAction(() => {\r\n\t\t\tlet widget = this.widgets[itemName];\r\n\t\t\tif (widget === undefined) return;\r\n\t\t\twidget.setContextError(error);\r\n\t\t\tthis.addErrorWidget(widget);\t\r\n\t\t})\r\n    }\r\n\r\n    clearContextErrors() {\r\n\t\trunInAction(() => {\r\n\t\t\tfor (let i in this.widgets) {\r\n\t\t\t\tlet widget = this.widgets[i];\r\n\t\t\t\tif (widget === undefined) continue;\r\n\t\t\t\twidget.clearContextError();\r\n\t\t\t}\t\r\n\t\t});\r\n    }\r\n\r\n    clearWidgetsErrors() {\r\n\t\trunInAction(() => {\r\n\t\t\tfor (let i in this.widgets) {\r\n\t\t\t\tlet widget = this.widgets[i];\r\n\t\t\t\tif (widget === undefined) continue;\r\n\t\t\t\twidget.clearError();\r\n\t\t\t}\t\r\n\t\t});\r\n    }\r\n\r\n    checkRules() {\r\n        this.clearErrors();\r\n        this.clearWidgetsErrors();\r\n        this.checkFieldRules();\r\n        if (this.hasError === true) return;\r\n        this.checkContextRules();\r\n    }\r\n\r\n    addErrorWidget(widget:Widget) {\r\n        let pos = this.errorWidgets.findIndex(v => v === widget);\r\n        if (pos < 0) this.errorWidgets.push(widget);\r\n    }\r\n    removeErrorWidget(widget:Widget) {\r\n        let pos = this.errorWidgets.findIndex(v => v === widget);\r\n        if (pos >= 0) this.errorWidgets.splice(pos, 1);\r\n    }\r\n\r\n    protected checkHasError():boolean {\r\n        let ret = (this.errorWidgets.length + this.errors.length) > 0;\r\n        if (ret === true) return true;\r\n        if (this.subContexts === undefined) return false;\r\n        for (let i in this.subContexts) {\r\n            let arrRowContexts = this.subContexts[i];\r\n            for (let j in arrRowContexts) {\r\n                if (arrRowContexts[j].hasError === true) return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n\r\n    get hasError():boolean {\r\n        return this.checkHasError();\r\n    };\r\n\r\n    clearErrors() {\r\n\t\trunInAction(() => {\r\n\t\t\tthis.errors.splice(0);\r\n\t\t\tthis.errorWidgets.splice(0);\r\n\t\t\tthis.clearContextErrors();\t\r\n\t\t});\r\n    }\r\n\r\n    renderErrors = observer((): JSX.Element => {\r\n        let {errors} = this;\r\n        if (errors.length === 0) return null;\r\n        return <>\r\n            {errors.map(err => <span key={err} className=\"text-danger inline-block my-1 ms-3\">\r\n                <i className=\"fa fa-exclamation-circle\" /> &nbsp;{err}\r\n            </span>)}\r\n        </>\r\n    });\r\n}\r\n\r\nlet rowKeySeed:number = 1;\r\nexport class RowContext extends Context {\r\n    readonly parentContext: Context;\r\n    readonly arrSchema: ArrSchema;\r\n    readonly rowKey: number;\r\n\treadonly data: any;\r\n    //readonly uiSchema: UiArr;\r\n\t\r\n    constructor(parentContext:Context, arrSchema: ArrSchema, data: any, inNode: boolean) {\r\n        let uiArr:UiArr;\r\n        let {uiSchema} = parentContext;\r\n        if (uiSchema !== undefined) {\r\n            let {items} = uiSchema;\r\n            if (items !== undefined) uiArr = items[arrSchema.name] as UiArr;\r\n        }\r\n        super(parentContext.form, uiArr, data, inNode, true);\r\n        this.parentContext = parentContext;\r\n        this.arrSchema = arrSchema;\r\n        this.rowKey = rowKeySeed++;\r\n        this.data = data;\r\n    }\r\n    getItemSchema(itemName:string):ItemSchema {return this.arrSchema.itemSchemas[itemName]}\r\n    getUiItem(itemName:string):UiItem {\r\n        if (this.uiSchema === undefined) return undefined;\r\n        let {items} = this.uiSchema;\r\n        if (items === undefined) return undefined;\r\n        return items[itemName]\r\n    }\r\n    get arrName():string {return this.arrSchema.name}\r\n    clearErrors() {\r\n        super.clearErrors();\r\n        this.parentContext.clearErrors();\r\n    }\r\n\r\n    get parentData():any {return this.parentContext.data;}\r\n}\r\n\r\nexport class FormContext extends Context {\r\n    constructor(form:Form, inNode:boolean) {\r\n        super(form, form.uiSchema, form.data, inNode, false);\r\n    }\r\n    get data():any {return this.form.data}\r\n    getItemSchema(itemName:string):ItemSchema {return this.form.itemSchemas[itemName]}\r\n    getUiItem(itemName:string):UiItem {\r\n        let {uiSchema} = this.form;\r\n        if (uiSchema === undefined) return undefined;\r\n        let {items} = uiSchema;\r\n        if (items === undefined) return undefined;\r\n        return items[itemName];\r\n    }\r\n}\r\n\r\nexport const ContextContainer = React.createContext<Context>({} as any);\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\n//import { ArrRow } from '../arrRow';\r\nimport { Context, RowContext, ContextContainer } from '../context';\r\nimport { ArrSchema } from '../../schema';\r\nimport { UiArr, TempletType } from '../../schema';\r\nimport { Unknown } from './unknown';\r\nimport { factory } from './factory';\r\n\r\nexport const ArrComponent = observer((\r\n    {parentContext, arrSchema, children}:{parentContext: Context, arrSchema: ArrSchema, children: React.ReactNode}) => \r\n{\r\n    let {name, arr} = arrSchema;\r\n    let data = parentContext.initData[name] as any[];\r\n    let {form} = parentContext;\r\n    let arrRowContexts = parentContext.getArrRowContexts(name);\r\n\tlet ui = parentContext.getUiItem(name) as UiArr;\r\n\tlet {onDeleted, onRestored} = ui;\r\n    let arrLabel:string|JSX.Element = name;\r\n    let Templet:TempletType;\r\n    let selectable:boolean, deletable:boolean, restorable:boolean;\r\n    let {ArrContainer, RowContainer, RowSeperator, uiSchema} = form;\r\n    if (uiSchema !== undefined) {\r\n        let {selectable:formSelectable, deletable:formDeletable, restorable:formRestorable} = uiSchema;\r\n        if (selectable !== true) selectable = formSelectable;\r\n        if (deletable !== true) deletable = formDeletable;\r\n        if (restorable !== true) restorable = formRestorable;\r\n    }\r\n    if (ui !== undefined) {\r\n        let {widget:widgetType, label, \r\n            selectable:arrSelectable, deletable:arrDeletable, restorable:arrRestorable,\r\n            ArrContainer:ac, RowContainer:rc, RowSeperator:rs\r\n        } = ui;\r\n        if (arrSelectable !== undefined) selectable = arrSelectable;\r\n        if (arrDeletable !== undefined) deletable = arrDeletable;\r\n        if (arrRestorable !== undefined) restorable = arrRestorable;\r\n        if (ac !== undefined) ArrContainer = ac;\r\n        if (rc !== undefined) RowContainer = rc;\r\n        if (rs !== undefined) RowSeperator = rs;\r\n        Templet = ui.Templet;\r\n        if (widgetType !== 'arr') return Unknown(arrSchema.type, widgetType, ['arr']);\r\n        arrLabel = label || arrLabel;\r\n    }\r\n    let first = true;\r\n    return ArrContainer(arrLabel, <>\r\n        {data.map((row:any, index) => {\r\n            let rowContext: RowContext;\r\n            let rowContent: JSX.Element;\r\n            let sep = undefined;\r\n            if (first === false) sep = RowSeperator;\r\n            else first = false;\r\n            if (children !== undefined) {\r\n                rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                rowContent = <>{children}</>;\r\n            }\r\n            else {\r\n                let typeofTemplet = typeof Templet;\r\n                if (typeofTemplet === 'function') {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                    rowContent = React.createElement(observer(Templet as React.StatelessComponent), row);\r\n                }\r\n                else if (typeofTemplet === 'object') {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, true);\r\n                    rowContent = Templet as JSX.Element;\r\n                }\r\n                else {\r\n                    rowContext = new RowContext(parentContext, arrSchema, row, false);\r\n                    rowContent = <>{\r\n                        arr.map((v, index) => {\r\n                            return <React.Fragment key={v.name}>\r\n                                {factory(rowContext, v, undefined)}\r\n                            </React.Fragment>\r\n                        })}\r\n                    </>;\r\n                }\r\n            }\r\n            let {rowKey} = rowContext;\r\n            arrRowContexts[rowKey] = rowContext;\r\n\r\n            let selectCheck:JSX.Element, deleteIcon:JSX.Element;\r\n            if (selectable === true) {\r\n                let onClick = (evt: React.MouseEvent<HTMLInputElement>)=>{\r\n                    let {checked} = (evt.target as HTMLInputElement);\r\n                    row.$isSelected = checked;\r\n                    let {$source} = row;\r\n                    if ($source !== undefined) $source.$isSelected = checked;\r\n                    rowContext.clearErrors();\r\n                }\r\n                selectCheck = <div className=\"form-row-checkbox\">\r\n                    <input type=\"checkbox\" onClick={onClick} defaultChecked={row.$isSelected} />\r\n                </div>;\r\n            }\r\n            let isDeleted = !(row.$isDeleted===undefined || row.$isDeleted===false);\r\n            if (deletable === true) {\r\n                let icon = isDeleted? 'fa-undo' : 'fa-trash';\r\n                let onDelClick = () => {\r\n                    if (restorable === true) {\r\n                        row.$isDeleted = !isDeleted;\r\n                        let {$source} = row;\r\n\t\t\t\t\t\tif ($source !== undefined) $source.$isDeleted = !isDeleted;\r\n\t\t\t\t\t\tif (onRestored) onRestored(row);\r\n                    }\r\n                    else {\r\n                        let p = data.indexOf(row);\r\n\t\t\t\t\t\tif (p>=0) data.splice(p, 1);\r\n\t\t\t\t\t\tif (onDeleted) onDeleted(row);\r\n                    }\r\n                    rowContext.clearErrors();\r\n                }\r\n                deleteIcon = <div className=\"form-row-edit text-info\" onClick={onDelClick}>\r\n                    <i className={classNames('fa', icon, 'fa-fw')} />\r\n                </div>;\r\n            }\r\n            let editContainer = selectable===true || deletable===true?\r\n                (content:any) => <fieldset disabled={isDeleted}><div className={classNames('d-flex', {'deleted':isDeleted, 'row-selected':row.$isSelected})}>\r\n                    {selectCheck}\r\n                    <div className={selectable===true && deletable===true? \"form-row-content\":\"form-row-content-1\"}>{content}</div>\r\n                    {deleteIcon}\r\n                </div></fieldset>\r\n                :\r\n                (content:any) => content;\r\n\r\n            return <ContextContainer.Provider key={rowKey} value={rowContext}>\r\n                {sep}\r\n                {RowContainer(editContainer(<><rowContext.renderErrors />{rowContent}</>))}\r\n            </ContextContainer.Provider>;\r\n        })}\r\n    </>);\r\n});\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { nav } from '../nav';\r\n\r\nexport interface ImageProps {\r\n    src: string;\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    altImage?: string;\r\n}\r\n\r\n// src = .src, 表示fontawesome Icon\r\nexport function Image(props: ImageProps) {\r\n\tlet {className, style, src, altImage} = props;\r\n\tlet icon:string;\r\n    if (src) {\r\n\t\tif (src.indexOf('.') !== 0) {\r\n\t\t\tif (src.startsWith(':') === true) {\r\n\t\t\t\tsrc = nav.resUrl + src.substr(1);\r\n\t\t\t}\r\n\t\t\treturn <img src={src} className={className} alt=\"img\"\r\n\t\t\t\tstyle={style}\r\n\t\t\t\tonError={evt=>{\r\n\t\t\t\t\tif (altImage) evt.currentTarget.src=altImage;\r\n\t\t\t\t\telse evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\r\n\t\t\t\t}} />;\r\n\t\t}\r\n\t\ticon = src.substr(1);\r\n\t}\r\n\telse {\r\n\t\ticon = 'file-o'\r\n\t}\r\n\treturn <span className={classNames(className, 'image-none')} style={style}>\r\n\t\t<i className={'fa fa-' + icon} />\r\n\t</span>;\r\n}\r\n","export function Loading() {\r\n    return <div className=\"d-flex h-100 align-items-center justify-content-center\">\r\n        <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />\r\n    </div>;\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport '../../css/va-badge.css';\r\n\r\nexport interface BadgeProps {\r\n    className?: string;\r\n    badge?: string|number;\r\n    size?: 'xs' | 'sm' | 'lg';\r\n    color?: 'secondary'|'success'|'danger'|'primary'|'info'|'warning';\r\n    badgeAlign?: 'left'|'center'|'right';\r\n    badgeVertical?: 'top'|'middle'|'bottom';\r\n}\r\n\r\n@observer\r\nexport class Badge extends React.Component<BadgeProps> {\r\n    render() {\r\n        let {className, badge, size, color, badgeAlign, badgeVertical, children} = this.props;\r\n        let cn = classNames(\r\n            className,\r\n            'va-badge',\r\n            size && 'va-badge-'+size,\r\n            'va-badge-' + (color||'secondary'),\r\n            badgeAlign && 'va-badg-'+badgeAlign,\r\n            badgeVertical && 'va-badg-'+badgeVertical,\r\n        );\r\n        let b;\r\n        if (badge) b = <b>{badge}</b>;\r\n        return <div className={cn}>\r\n            {children}\r\n            {b}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport '../../css/va-lmr.css';\r\n\r\nexport interface LMRProps {\r\n    className?: string | string[];\r\n\tstyle?: React.CSSProperties,\r\n    left?: string|JSX.Element;\r\n    right?: string|JSX.Element;\r\n    onClick?: ()=>void;\r\n}\r\n\r\n@observer\r\nexport class LMR extends React.Component<LMRProps> {\r\n    render() {\r\n        let {className, style, left, children, right, onClick} = this.props;\r\n        let l, r;\r\n        if (left !== undefined) l = <header>{left}</header>;\r\n        if (right !== undefined) r = <footer>{right}</footer>;\r\n        let cursor;\r\n        if (onClick !== undefined) cursor = 'cursor-pointer';\r\n        return <div className={classNames('va-lmr', className, cursor)}\r\n\t\t\tstyle={style}\r\n\t\t\tonClick={onClick}>\r\n            {l}\r\n            <div>{children}</div>\r\n            {r}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport interface FAProps {\r\n    name: string;\r\n    className?: string;\r\n    size?: 'lg'|'2x'|'3x'|'4x'|'5x';\r\n    spin?: boolean;\r\n    fixWidth?: boolean;\r\n    border?: boolean;\r\n    pull?: 'left'|'right';\r\n    pulse?: boolean;\r\n    rotate?: 90|180|270;\r\n    flip?: 'horizontal'|'vertical';\r\n    inverse?: boolean;\r\n}\r\n\r\nexport class FA extends React.Component<FAProps> {\r\n    render() {\r\n        let {name, className, size, spin, fixWidth, border, pull, pulse, rotate, flip, inverse} = this.props;\r\n        let cn = classNames(className, 'fa',\r\n            name && ('fa-' + name),\r\n            size && 'fa-'+size,\r\n            fixWidth && 'fa-fw',\r\n            border && 'fa-border',\r\n            pull && 'fa-pull-' + pull,\r\n            spin && 'fa-spin',\r\n            pulse && 'fa-pulse',\r\n            rotate && 'fa-rotate-' + rotate,\r\n            flip && 'fa-flip-' + flip,\r\n            inverse && 'fa-inverse',\r\n        );\r\n        return <i className={cn} />\r\n    }\r\n}\r\n\r\nexport interface StackedFAProps {\r\n    className?: string;\r\n    size?: 'lg',\r\n}\r\nexport class StackedFA extends React.Component<StackedFAProps> {\r\n    render() {\r\n        let {className, size, children} = this.props;\r\n        let cn = classNames(\r\n            'fa-stack',\r\n            className,\r\n            size && 'fa-' + size);\r\n        return <span className={cn}>\r\n            {children}\r\n        </span>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {FA} from './FA';\r\n\r\nexport interface IconTextProps {\r\n    icon: string;\r\n    iconClass?: string;\r\n    text: string | JSX.Element;\r\n    textClass?: string;\r\n}\r\n\r\nexport class IconText extends React.Component<IconTextProps> {\r\n    render() {\r\n        let {icon, iconClass, text, textClass} = this.props;\r\n        return <div className=\"py-2\">\r\n            <FA className={iconClass} name={icon} fixWidth={true} />\r\n            <span className={textClass}>{text}</span>\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { nav } from '../nav';\r\nimport { Loading } from './loading';\r\nimport { Image as ImageControl } from './image';\r\nimport { Page } from './page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { LMR } from './simple';\r\n\r\nexport interface ResUploaderProps {\r\n    className?: string;\r\n    label?: string;\r\n    multiple?: boolean;\r\n    maxSize?: number;\r\n    onFilesChange?: (evt: React.ChangeEvent<HTMLInputElement>) => void;\r\n}\r\n\r\n@observer\r\nexport class ResUploader extends React.Component<ResUploaderProps> {\r\n    private fileInput: HTMLInputElement;\r\n\tfileName: string = null;\r\n\t\r\n\tconstructor(props: ResUploaderProps) {\r\n\t\tsuper(props);\r\n\t\tmakeObservable(this, {\r\n\t\t\tfileName: observable,\r\n\t\t});\r\n\t}\r\n\r\n    buildFormData():FormData {\r\n        let {maxSize} = this.props;\r\n        if (maxSize === undefined || maxSize <= 0) \r\n            maxSize = 100000000000;\r\n        else\r\n            maxSize = maxSize * 1024;\r\n        var files:FileList = this.fileInput.files;\r\n        var data = new FormData();\r\n        let len = files.length;\r\n        for (let i=0; i<len; i++) {\r\n            let file = files[i];\r\n            if (file.size > maxSize) return null;\r\n            data.append('files[]', file, file.name);\r\n        }\r\n    }\r\n\r\n    getFile0(): File {\r\n        return this.fileInput.files[0];\r\n    }\r\n\r\n    upload = async (formData?: FormData):Promise<string|{error:any}> => {\r\n        let resUrl = nav.resUrl + 'upload';\r\n        if (!formData) formData = this.buildFormData();\r\n        try {\r\n            nav.startWait();\r\n            let headers = new Headers();\r\n            headers.append('Access-Control-Allow-Origin', '*');\r\n            //2019-12-18：因为 vivo按oppo某些版本不支持，暂时先不要 \r\n            //let abortController = new AbortController();\r\n            let res = await fetch(resUrl, {\r\n                method: \"POST\",\r\n                body: formData,\r\n                headers: headers,\r\n                //signal: abortController.signal,\r\n            });\r\n            let json = await res.json();\r\n            return ':' + json.res.id;\r\n        }\r\n        catch (err) {\r\n            console.error('%s %s', resUrl, err);\r\n            return {error:err};\r\n        }\r\n        finally {\r\n            nav.endWait();\r\n        }\r\n    }\r\n\r\n    private onFilesChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        let {onFilesChange} = this.props;\r\n        if (onFilesChange) onFilesChange(evt);\r\n        let files = evt.target.files;\r\n        let len = files.length;\r\n        let names:string[] = [];\r\n        for (let i=0; i<len; i++) {\r\n            names.push(files.item(i).name);\r\n        }\r\n        this.fileName = names.join(', ');\r\n    }\r\n\r\n    render() {\r\n        let {className, multiple, label} = this.props;\r\n        return <div>\r\n                <label className=\"btn btn-outline-success\">\r\n                    {label || '选择文件'} \r\n                    <input \r\n                        className={className}\r\n                        ref={t=>this.fileInput=t} \r\n                        onChange={this.onFilesChange}\r\n                        type='file' name='file' \r\n                        multiple={multiple} style={{display:'none'}} />\r\n                </label>\r\n                &nbsp;\r\n                {this.fileName}\r\n            </div>\r\n    }\r\n}\r\n\r\nfunction formatSize(size:number, pointLength:number=2, units?:string[]) {\r\n    var unit;\r\n    units = units || [ 'B', 'K', 'M', 'G', 'TB' ];\r\n    while ( (unit = units.shift()) && size > 1024 ) {\r\n        size = size / 1024;\r\n    }\r\n    return (unit === 'B' ? size : size.toFixed( pointLength === undefined ? 2 : pointLength)) + unit;\r\n}\r\n\r\ninterface ImageUploaderProps {\r\n    id?: string;\r\n    label?: string;\r\n    size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw';\r\n\tonSaved?: (imageId:string) => Promise<void>;\r\n\timageTypes?: string[];\r\n}\r\n\r\nconst xlargeSize = 1600;\r\nconst largeSize = 800;\r\nconst mediumSize = 400;\r\nconst smallSize = 180;\r\n\r\n@observer\r\nexport class ImageUploader extends React.Component<ImageUploaderProps> {\r\n\tprivate static imageTypes = ['gif', 'jpg', 'jpeg', 'png', 'svg', 'apng', 'bmp', 'ico', 'cur', 'tiff', 'tif', 'webp'];\r\n\tprivate imgBaseSize: number;\r\n\tprivate imageTypes: string[];\r\n    private suffix: string;\r\n\tprivate resUploader: ResUploader;\r\n\t\r\n    file: File = null;\r\n    desImgWidth: number = null;\r\n    desImgHeight: number = null;\r\n    desImgSize: number = null;\r\n    srcImgWidth: number = null;\r\n    srcImgHeight: number = null;\r\n    isChanged: boolean = false;\r\n    resId: string = null;\r\n    enableUploadButton: boolean = false;\r\n    srcImage: string = null;\r\n    desImage: string = null;\r\n    fileError: string = null;\r\n    uploaded: boolean = false;\r\n\r\n    constructor(props: ImageUploaderProps) {\r\n\t\tsuper(props);\r\n\t\tmakeObservable(this, {\r\n\t\t\tfile: observable,\r\n\t\t\tdesImgWidth: observable,\r\n\t\t\tdesImgHeight: observable,\r\n\t\t\tdesImgSize: observable,\r\n\t\t\tsrcImgWidth: observable,\r\n\t\t\tsrcImgHeight: observable,\r\n\t\t\tisChanged: observable,\r\n\t\t\tresId: observable,\r\n\t\t\tenableUploadButton: observable,\r\n\t\t\tsrcImage: observable,\r\n\t\t\tdesImage: observable,\r\n\t\t\tfileError: observable,\r\n\t\t\tuploaded: observable,\r\n\t\t});\r\n\t\tthis.resId = props.id;\r\n\t\tthis.imageTypes = props.imageTypes || ImageUploader.imageTypes;\r\n    }\r\n\r\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.fileError = undefined;\r\n        this.uploaded = false;\r\n        this.enableUploadButton = evt.target.files.length > 0;\r\n        if (this.enableUploadButton) {\r\n            this.file = evt.target.files[0];\r\n            let pos = this.file.name.lastIndexOf('.');\r\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\r\n            if(this.imageTypes.indexOf(this.suffix) < 0){\r\n                this.fileError = `图片类型必须是 ${this.imageTypes.join(', ')} 中的一种`;\r\n                return;\r\n            }\r\n            let reader = new FileReader();\r\n            reader.readAsDataURL(this.file);\r\n            reader.onload = async () => {\r\n\t\t\t\tthis.srcImage = reader.result as string;\r\n\t\t\t\tswitch (this.suffix ) {\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\tawait this.setSize(this.props.size);\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'svg':\r\n\t\t\t\t\t\tthis.imgBaseSize = mediumSize;\r\n\t\t\t\t\t\tthis.desImgSize = this.srcImage.length;\r\n\t\t\t\t\t\tthis.desImage = this.srcImage;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n            };\r\n        }\r\n    }\r\n\r\n    private async setSize(size?: 'sm' | 'md' | 'lg' | 'xl' | 'raw') {\r\n        switch (size) {\r\n            default:\r\n            case 'sm':\r\n                this.imgBaseSize = smallSize; break;\r\n            case 'md':\r\n                this.imgBaseSize = mediumSize; break;\r\n            case 'lg':\r\n\t\t\t\tthis.imgBaseSize = largeSize; break;\r\n\t\t\tcase 'xl':\r\n\t\t\t\tthis.imgBaseSize = xlargeSize; break;\r\n\t\t\tcase 'raw':\r\n\t\t\t\tthis.imgBaseSize = -1; break;\r\n\t\t}\r\n\t\tthis.desImage = await this.compress();\r\n    }\r\n\r\n    private compress = ():Promise<string> => {\r\n        return new Promise<string>((resolve, reject) => {\r\n            var img = new Image();\r\n            img.src = this.srcImage;\r\n            img.onload = () => {\r\n                //var that = this;\r\n                // 默认按比例压缩\r\n                let {width, height} = img;\r\n                this.srcImgWidth = width;\r\n                this.srcImgHeight = height;\r\n                let scale = width / height;\r\n\t\t\t\tlet w:number, h:number;\r\n\t\t\t\tif (this.imgBaseSize < 0) {\r\n\t\t\t\t\tw = width;\r\n\t\t\t\t\th = height;\r\n\t\t\t\t}\r\n                else if (width <= this.imgBaseSize && height <= this.imgBaseSize) {\r\n                    w = width;\r\n                    h = height;\r\n                }\r\n                else if (scale < 0) {\r\n                    w = this.imgBaseSize;\r\n                    h = w / scale;\r\n                }\r\n                else {\r\n                    h = this.imgBaseSize;\r\n                    w = h * scale;\r\n                }\r\n                this.desImgWidth = Math.round(w);\r\n                this.desImgHeight = Math.round(h);\r\n                var quality = 0.7;  // 默认图片质量为0.7\r\n                //生成canvas\r\n                var canvas = document.createElement('canvas');\r\n                var ctx = canvas.getContext('2d');\r\n                // 创建属性节点\r\n                var anw = document.createAttribute(\"width\");\r\n                anw.nodeValue = String(w);\r\n                var anh = document.createAttribute(\"height\");\r\n                anh.nodeValue = String(h);\r\n                canvas.setAttributeNode(anw);\r\n                canvas.setAttributeNode(anh);\r\n                ctx.drawImage(img, 0, 0, w, h);\r\n                let base64 = canvas.toDataURL('image/' + this.suffix , quality);\r\n                let blob = this.convertBase64UrlToBlob(base64);\r\n                this.desImgSize = blob.size;\r\n                if (this.desImgSize > 3*1024*1024) {\r\n                    this.fileError = \"图片大于3M，无法上传\";\r\n                    this.enableUploadButton = false;\r\n                }\r\n                resolve(base64);\r\n            }\r\n        });\r\n    }\r\n\r\n    private convertBase64UrlToBlob(urlData: string):Blob {\r\n        let arr = urlData.split(',');\r\n        let mime = arr[0].match(/:(.*?);/)[1];\r\n        let bstr = atob(arr[1]);\r\n        let n = bstr.length;\r\n        let u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        return new Blob([u8arr], {type:mime});\r\n    }\r\n\r\n    private upload = async () => {\r\n        if (!this.resUploader) return;\r\n        let formData = new FormData();\r\n        let blob = this.convertBase64UrlToBlob(this.desImage);\r\n        formData.append('image', blob, this.file.name);\r\n        let ret = await this.resUploader.upload(formData);\r\n        if (typeof ret === 'object') {\r\n            let {error} = ret;\r\n            let type = typeof error;\r\n            let err:string;\r\n            switch (type) {\r\n                case 'undefined': err = 'error: undefined'; break;\r\n                case 'string': err = error; break;\r\n                case 'object': err = error.message; break;\r\n                default: err = String(err); break;\r\n            }\r\n            this.fileError = 'error: ' + type + ' - ' + err;\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.props.id);\r\n        this.uploaded = true;\r\n    }\r\n\r\n    private onSaved = (): Promise<void> => {\r\n        let {onSaved} = this.props;\r\n        onSaved && onSaved(this.resId);\r\n        return;\r\n    }\r\n\r\n    private showOrgImage = () => {\r\n        nav.push(<Page header=\"原图\">\r\n            <div className=\"p-3 text-center\">\r\n                <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.srcImage} />\r\n            </div>\r\n        </Page>);\r\n    }\r\n\r\n    private levelDiv() {\r\n        if (this.props.size) return;\r\n        let arr = [{caption:'小图', size:'sm'}];\r\n        if (this.srcImgHeight > mediumSize || this.srcImgWidth > mediumSize) {\r\n            arr.push({caption:'中图', size:'md'});\r\n        }\r\n        if (this.srcImgHeight > largeSize || this.srcImgWidth > largeSize) {\r\n            arr.push({caption:'大图', size:'lg'});\r\n        }\r\n        if (this.srcImgHeight > xlargeSize || this.srcImgWidth > xlargeSize) {\r\n\t\t\tarr.push({caption:'超大图', size:'xl'});\r\n\t\t\tarr.push({caption:'原图', size:'raw'});\r\n        }\r\n        if (arr.length < 2) return;\r\n        return <div>{arr.map((v, index) => {\r\n            let {caption, size} = v;\r\n            return <label key={index} className=\"me-3\"><input type=\"radio\" name=\"size\" \r\n                onChange={()=>this.setSize(size as any)}\r\n                defaultChecked={index===0} /> {caption}</label>;\r\n        })}</div>\r\n    }\r\n\r\n    render() {\r\n        let {label} = this.props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={this.onSaved}>保存</button>;\r\n        return <Page header={label || '更改图片'} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div className=\"mb-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} \r\n                            multiple={false} maxSize={2048} \r\n                            label=\"选择图片文件\"\r\n                            onFilesChange={this.onFileChange} />\r\n                        <div className=\"small text-muted\">支持 {this.imageTypes.join(', ')} 格式图片。</div>\r\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\r\n                    </div>\r\n                    <LMR left=\r\n                    {\r\n                        this.uploaded === true? \r\n                            <div className=\"text-success p-2\">上传成功！</div>\r\n                            :\r\n                            this.file && this.desImgSize > 0 && <div className=\"mb-3 d-flex align-items-end\">\r\n                                <div className=\"me-5\">\r\n                                    {this.levelDiv()}\r\n                                    <div>分辨率：{this.desImgWidth} x {this.desImgHeight}\r\n                                    &nbsp; &nbsp;\r\n                                    文件大小：{formatSize(this.desImgSize)}\r\n                                    </div>\r\n                                </div>\r\n                                <button className=\"btn btn-primary\" \r\n                                    disabled={!this.enableUploadButton}\r\n                                    onClick={this.upload}>上传</button>\r\n                            </div>\r\n                    }\r\n                    right={this.desImage && \r\n                        <button className=\"btn btn-link btn-sm text-right mb-3\" onClick={this.showOrgImage}>\r\n                            原图大小: {formatSize(this.file.size)}<br/>\r\n                            分辨率：{this.srcImgWidth} x {this.srcImgHeight}\r\n                        </button>\r\n                    }\r\n                    ></LMR>\r\n                </div>\r\n                <div className=\"text-center\" \r\n                    style={{\r\n                        border: (this.uploaded===true? '2px solid green' : '1px dotted gray'),\r\n                        padding: '8px'\r\n                    }}>\r\n                    <ImageControl className=\"h-min-4c\" style={{maxWidth:'100%'}} src={this.desImage} />\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\ninterface AudioUploaderProps {\r\n    id?: string;\r\n    label?: string;\r\n    onSaved?: (imageId:string) => Promise<void>;\r\n}\r\n\r\n@observer\r\nexport class AudioUploader extends React.Component<AudioUploaderProps> {\r\n\tprivate static audioTypes = ['mp3', 'wav'];\r\n\r\n    private suffix: string;\r\n\tprivate resUploader: ResUploader;\r\n\r\n\tcontent: string = null;\r\n\tfile: File = null;\r\n\tfileSize: number = null;\r\n    isChanged: boolean = false;\r\n    resId: string = null;\r\n    enableUploadButton: boolean = false;\r\n    fileError: string = null;\r\n\tuploaded: boolean = false;\r\n\tuploading: boolean = false;\r\n\r\n    constructor(props: AudioUploaderProps) {\r\n\t\tsuper(props);\r\n\t\tmakeObservable(this, {\r\n\t\t\tcontent: observable,\r\n\t\t\tfile: observable,\r\n\t\t\tfileSize: observable,\r\n\t\t\r\n\t\t\tisChanged: observable,\r\n\t\t\tresId: observable,\r\n\t\t\tenableUploadButton: observable,\r\n\t\t\tfileError: observable,\r\n\t\t\tuploaded: observable,\r\n\t\t\tuploading: observable,\r\n\t\t});\r\n        this.resId = props.id;\r\n    }\r\n\r\n    private onFileChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.fileError = undefined;\r\n        this.uploaded = false;\r\n        this.enableUploadButton = evt.target.files.length > 0;\r\n        if (this.enableUploadButton) {\r\n            this.file = evt.target.files[0];\r\n            let pos = this.file.name.lastIndexOf('.');\r\n            if (pos >= 0) this.suffix = this.file.name.substr(pos+1).toLowerCase();\r\n            if(AudioUploader.audioTypes.indexOf(this.suffix) < 0){\r\n                this.fileError = `音频类型必须是 ${AudioUploader.audioTypes.join(', ')} 中的一种`;\r\n                return;\r\n            }\r\n            let reader = new FileReader();\r\n            reader.readAsDataURL(this.file);\r\n            reader.onload = async () => {\r\n\t\t\t\tthis.content = reader.result as string;\r\n\t\t\t\tthis.fileSize = this.content.length;\r\n            };\r\n        }\r\n    }\r\n\r\n    private convertBase64UrlToBlob(urlData: string):Blob {\r\n        let arr = urlData.split(',');\r\n        let mime = arr[0].match(/:(.*?);/)[1];\r\n        let bstr = atob(arr[1]);\r\n        let n = bstr.length;\r\n        let u8arr = new Uint8Array(n);\r\n        while(n--){\r\n            u8arr[n] = bstr.charCodeAt(n);\r\n        }\r\n        return new Blob([u8arr], {type:mime});\r\n    }\r\n\r\n    private upload = async () => {\r\n\t\tif (!this.resUploader) return;\r\n\t\tthis.uploading = true;\r\n        let formData = new FormData();\r\n        let blob = this.convertBase64UrlToBlob(this.content);\r\n        formData.append('image', blob, this.file.name);\r\n        let ret = await this.resUploader.upload(formData);\r\n        if (typeof ret === 'object') {\r\n            let {error} = ret;\r\n            let type = typeof error;\r\n            let err:string;\r\n            switch (type) {\r\n                case 'undefined': err = 'error: undefined'; break;\r\n                case 'string': err = error; break;\r\n                case 'object': err = error.message; break;\r\n                default: err = String(err); break;\r\n            }\r\n            this.fileError = 'error: ' + type + ' - ' + err;\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.props.id);\r\n        this.uploaded = true;\r\n    }\r\n\r\n    private onSaved = (): Promise<void> => {\r\n        let {onSaved} = this.props;\r\n        onSaved && onSaved(this.resId);\r\n        return;\r\n    }\r\n\r\n    render() {\r\n        let {label} = this.props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={this.onSaved}>保存</button>;\r\n        return <Page header={label || '更改文件'} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div className=\"mb-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} \r\n                            multiple={false} maxSize={2048} \r\n                            label=\"选择音频文件\"\r\n                            onFilesChange={this.onFileChange} />\r\n                        <div className=\"small text-muted\">支持 {AudioUploader.audioTypes.join(', ')} 格式。</div>\r\n                        {this.fileError && <div className=\"text-danger\">{this.fileError}</div>}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\t\t\t<LMR left=\r\n                    {\r\n                        this.uploaded === true? \r\n                            <div className=\"text-success p-2\">上传成功！</div>\r\n\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\tthis.uploading === true?\r\n\t\t\t\t\t\t\t\t<div className=\"m-3\"><Loading /></div>\r\n\t\t\t\t\t\t\t\t:\r\n\t\t\t\t\t\t\t\tthis.file && this.content && <div className=\"m-3\">\r\n\t\t\t\t\t\t\t\t\t<div className=\"mb-3\">\r\n\t\t\t\t\t\t\t\t\t\t文件大小：{formatSize(this.fileSize)}\r\n\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t<button className=\"btn btn-primary\" \r\n\t\t\t\t\t\t\t\t\t\tdisabled={!this.enableUploadButton}\r\n\t\t\t\t\t\t\t\t\t\tonClick={this.upload}>上传</button>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t/>\r\n        </Page>;\r\n    }\r\n}\r\n","import { ItemSchema, UiItem, UiSelectBase } from '../schema';\r\nimport { nav } from '../../nav';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { Image } from '../image';\r\nimport { Edit } from './edit';\r\nimport { FieldRule } from '../inputRules';\r\n\r\nexport abstract class ItemEdit {\r\n\tprotected edit: Edit;\r\n\tprotected name: string;\r\n\tprotected _itemSchema: ItemSchema;\r\n    get itemSchema(): ItemSchema {return this._itemSchema}\r\n    protected _uiItem:UiItem;\r\n    get uiItem():UiItem {return this._uiItem}\r\n    value: any;\r\n\tlabel: string|JSX.Element;\r\n\tget editInRow(): boolean {return false;}\r\n    protected newValue: any;\r\n\r\n    error: string = null;\r\n    isChanged: boolean = false;\r\n\r\n    constructor(edit:Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any) {\r\n\t\tmakeObservable(this, {\r\n\t\t\terror: observable,\r\n\t\t\tisChanged: observable,\r\n\t\t});\r\n\t\tthis.edit = edit;\r\n        this._itemSchema = itemSchema;\r\n        this._uiItem = uiItem\r\n        this.value = value;\r\n        let {name} = itemSchema;\r\n        this.name = name;\r\n        this.label = label;\r\n\t}\r\n\t\r\n\tinit() {\t\t\r\n\t}\r\n\r\n    async start():Promise<any> {\r\n        return await this.internalStart();\r\n    }\r\n\r\n    protected abstract internalStart():Promise<any>;\r\n\r\n    async end():Promise<any> {\r\n        await this.internalEnd()\r\n    }\r\n\r\n\trenderContent() {\r\n        let {name, type} = this._itemSchema;\r\n        let divValue:any;\r\n        let uiItem = this._uiItem;\r\n        let label:string|JSX.Element, labelHide:boolean;\r\n        if (uiItem === undefined) {\r\n            label = name;\r\n        }\r\n        else {\r\n\t\t\tlabel = uiItem.label;\r\n\t\t\tlabelHide = uiItem.labelHide;\r\n            let templet = uiItem.Templet;\r\n            if (templet !== undefined) {\r\n                if (typeof templet === 'function') {\r\n\t\t\t\t\tif (this.value !== undefined) divValue = templet(this.value);\r\n\t\t\t\t}\r\n                else {\r\n\t\t\t\t\tdivValue = {templet};\r\n\t\t\t\t}\r\n            }\r\n            else if (this.value !== undefined) {\r\n                switch (uiItem.widget) {\r\n                    case 'radio':\r\n                    case 'select':\r\n                        let {list} = uiItem as UiSelectBase;\r\n                        divValue = <b>{list.find(v => v.value === this.value).title}</b>;\r\n                        break;\r\n                    case 'id':\r\n                        divValue = <b>no templet for {name}={this.value}</b>\r\n                        break;\r\n                }\r\n            }\r\n        }\r\n        if (divValue === undefined) {\r\n            switch (type) {\r\n                default:\r\n                    divValue = this.value? \r\n\t\t\t\t\t\t<b>{this.value}</b> \r\n\t\t\t\t\t\t:\r\n\t\t\t\t\t\t<small className=\"text-muted\">[{labelHide===true? label:'无'}]</small>;\r\n                    break;\r\n                case 'image':\r\n                    divValue = <Image className=\"w-4c h-4c\" src={this.value} />;\r\n                    break;\r\n            }\r\n\t\t}\r\n\t\treturn divValue;\r\n\t}\r\n\r\n    protected async internalEnd():Promise<void> {nav.pop()}\r\n\r\n    protected verifyValue() {\r\n        if (this.uiItem === undefined) return;\r\n        let {rules} = this.uiItem;\r\n        if (rules === undefined) return;\r\n        let nv = this.newValue;\r\n        function verifyRule(rule:FieldRule, value: any):string {\r\n            let error = rule(nv);\r\n            if (error !== undefined) {\r\n                if (typeof error !== 'object')\r\n                    return error;\r\n                else\r\n                    return JSON.stringify(error);\r\n            }\r\n        }\r\n        if (Array.isArray(rules)) {\r\n            for (let rule of rules) {\r\n                let error = verifyRule(rule as FieldRule, nv);\r\n                if (error !== undefined) {\r\n                    this.error = error;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            this.error = verifyRule(rules as FieldRule, nv);\r\n        }\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { observer } from 'mobx-react';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { ItemSchema, UiImageItem, UiItem } from '../schema';\r\nimport { ImageUploader } from '../resUploader';\r\nimport { nav } from '../../nav';\r\nimport { ItemEdit } from './itemEdit';\r\nimport { Edit } from './edit';\r\n\r\nexport class ImageItemEdit extends ItemEdit {\r\n    get uiItem(): UiImageItem {return this._uiItem as UiImageItem}\r\n\tresId: string = null;\r\n\t\r\n\tconstructor(edit:Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any) {\r\n\t\tsuper(edit, itemSchema, uiItem, label, value);\r\n\t\tmakeObservable(this, {\r\n\t\t\tresId: observable\r\n\t\t})\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        this.resId = this.value;\r\n        return new Promise<any>((resolve, reject) => {\r\n            nav.push(React.createElement(this.page, {resolve:resolve, reject:reject}), ()=>reject());\r\n        });\r\n    }\r\n\r\n    /*\r\n    private upload = async () => {\r\n        if (!this.resUploader) return;\r\n        let ret = await this.resUploader.upload();\r\n        if (ret === null) {\r\n            this.overSize = true;\r\n            env.setTimeout('imageItemEdit upload', () => this.overSize = false, 3000);\r\n            return;\r\n        }\r\n        this.resId = ret;\r\n        this.isChanged = (this.resId !== this.value);\r\n    }\r\n    */\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let size:any = this.uiItem && this.uiItem.size;\r\n\r\n        /*\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>resolve(this.resId)}>保存</button>;\r\n        let overSize:any;\r\n        if (this.overSize === true) {\r\n            overSize = <div className=\"text-danger\">\r\n                <i className=\"fa fa-times-circle\" /> 图片文件大小超过2M，无法上传\r\n            </div>;\r\n        }\r\n        */\r\n        return <ImageUploader \r\n            label={'更改' + this.label}\r\n            id={this.resId}\r\n            size={size}\r\n            onSaved={(resId):Promise<void>=>{resolve(resId); return;}} />;\r\n        /*\r\n        return <Page header={'更改' + this.label} right={right}>\r\n            <div className=\"my-3 px-3 py-3 bg-white\">\r\n                <div>\r\n                    <div>上传图片：</div>\r\n                    <div className=\"my-3\">\r\n                        <ResUploader ref={v=>this.resUploader=v} multiple={false} maxSize={2048} />\r\n                    </div>\r\n                    <div>\r\n                        <button className=\"btn btn-primary\" onClick={this.upload}>上传</button>\r\n                    </div>\r\n                </div>\r\n                {overSize}\r\n                <div className=\"small muted my-4\">支持JPG、GIF、PNG格式图片，不超过2M。</div>\r\n                <div className=\"d-flex\">\r\n                    <div className=\"w-12c h-12c me-4\"\r\n                        style={{border: '1px dotted gray', padding: '8px'}}>\r\n                        <Image className=\"w-100 h-100\" src={this.resId} />\r\n                    </div>\r\n                    <div>\r\n                        <div className=\"small\">图片预览</div>\r\n                        <Image className=\"w-4c h-4c mt-3\" src={this.resId} />\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </Page>;\r\n        */\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { ItemSchema, UiImageItem } from '../../schema';\r\nimport { Image } from '../../image';\r\nimport { ImageItemEdit } from '../../edit/imageItemEdit';\r\nimport { observer } from 'mobx-react';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { Context } from '../context';\r\nimport { FieldProps } from '../field';\r\n\r\nexport class ImageWidget extends Widget {\r\n    protected input: HTMLInputElement;\r\n    protected get ui(): UiImageItem {return this._ui as UiImageItem};\r\n\r\n\timageSrc: string = null;\r\n\r\n\tconstructor(context:Context, itemSchema:ItemSchema, fieldProps:FieldProps, children: React.ReactNode) {\r\n\t\tsuper(context, itemSchema, fieldProps, children);\r\n\t\tmakeObservable(this, {\r\n\t\t\timageSrc: observable,\r\n\t\t})\r\n\t}\r\n\r\n    init() {\r\n        super.init();\r\n        this.imageSrc = this.value;\r\n    }\r\n\r\n    protected onClick = async () => {\r\n        let edit = new ImageItemEdit(undefined, this.itemSchema, this.ui, this.ui.label, this.value);\r\n        let ret = await edit.start();\r\n        if (ret !== null) {\r\n            this.setValue(ret);\r\n            this.imageSrc = ret;\r\n        }\r\n        await edit.end();\r\n    }\r\n\r\n    render() {\r\n        return React.createElement(this.observerRender);\r\n    }\r\n\r\n    private observerRender = observer(() => {\r\n        let cn = [\r\n            'bg-white p-1 d-flex justify-content-center',\r\n        ];\r\n        let onClick: any;\r\n        if (!this.readOnly && !this.disabled) {\r\n            cn.push('cursor-pointer');\r\n            onClick = this.onClick;\r\n        }\r\n        return <div className={classNames(cn)} onClick={onClick}>\r\n            <Image src={this.imageSrc} className=\"w-4c h-4c\"/>\r\n        </div>;\r\n    });\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Widget } from './widget';\r\nimport { UiTag, IValuesViewRenderOptions } from '../../schema';\r\nimport { RowContext } from '../context';\r\n\r\nabstract class TagWidget extends Widget {\r\n    protected inputs: {[index:number]: HTMLInputElement} = {};\r\n    protected get ui(): UiTag {return this._ui as UiTag};\r\n\r\n    protected setElementValue(value:any) {\r\n        for (let i in this.inputs) {\r\n            let input = this.inputs[i];\r\n            input.checked = value === input.value;\r\n        }\r\n    }\r\n    setReadOnly(value:boolean) {\r\n        this.readOnly = value;\r\n        for (let i in this.inputs) this.inputs[i].readOnly = value;\r\n    }\r\n    setDisabled(value:boolean) {\r\n        this.disabled = value;\r\n        for (let i in this.inputs) this.inputs[i].disabled = value\r\n\t}\r\n\t\r\n\tabstract render():JSX.Element;\r\n}\r\n\r\nexport class TagSingleWidget extends TagWidget {\r\n\trender() {\r\n\t\tlet {valuesView, wrapClassName} = this.ui;\r\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\r\n        let {isRow} = this.context;\r\n        let rowKey:number;\r\n        if (isRow === true) {\r\n            rowKey = (this.context as RowContext).rowKey;\r\n        }\r\n        let cn = classNames(this.className, 'py-0');\r\n\t\tlet name = this.name;\r\n\t\tif (rowKey !== undefined) name += '-' + rowKey;\r\n\t\tlet options:IValuesViewRenderOptions = {\r\n\t\t\tclassName: cn,\r\n\t\t\tinputName: name,\r\n\t\t\twrapClassName,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t}\r\n\t\treturn valuesView.renderRadios(this.defaultValue, options);\r\n    }\r\n}\r\n\r\nexport class TagMultiWidget extends TagWidget {\r\n\tprivate defaultArr:number[];\r\n\tinit() {\r\n\t\tsuper.init();\r\n\t\tlet def = this.defaultValue;\r\n\t\tswitch (typeof def) {\r\n\t\t\tdefault:\r\n\t\t\t\tthis.defaultArr = [];\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'string':\r\n\t\t\t\tthis.defaultArr = def.split('|').map(v => Number(v));\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n    protected onInputChange = (evt: React.ChangeEvent<any>) => {\r\n\t\tlet values:string[] = [];\r\n\t\tfor (let i in this.inputs) {\r\n\t\t\tlet input = this.inputs[i];\r\n\t\t\tif (input.checked === true) values.push(input.value);\r\n\t\t}\r\n        this.changeValue(values.join('|'), true);\r\n\t}\r\n\trender() {\r\n\t\tlet {valuesView, wrapClassName} = this.ui;\r\n\t\tif (valuesView === undefined) return <>valuesView must be defined</>;\r\n        let cn = classNames(this.className, 'py-0');\r\n\t\tlet options:IValuesViewRenderOptions = {\r\n\t\t\tclassName: cn,\r\n\t\t\tinputs: this.inputs,\r\n\t\t\twrapClassName,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t}\r\n\t\treturn valuesView.renderChecks(this.defaultValue, options);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { ArrSchema, DataType, ItemSchema } from '../../schema';\r\nimport { TypeWidget, UiCustom } from '../../schema';\r\nimport { TextWidget } from './textWidget';\r\nimport { TextAreaWidget } from './textareaWidget';\r\nimport { PasswordWidget, UrlWidget, EmailWidget } from './passwordWidget';\r\nimport { UpdownWidget } from './updownWidget';\r\nimport { NumberWidget } from './numberWidget';\r\nimport { DateWidget, DateTimeWidget, TimeWidget, MonthWidget } from './dateWidget';\r\nimport { CheckBoxWidget } from './checkBoxWidget';\r\nimport { FieldProps } from '../field';\r\nimport { Context } from '../context';\r\nimport { SelectWidget } from './selectWidget';\r\nimport { RadioWidget } from './radioWidget';\r\nimport { RangeWidget } from './rangeWidget';\r\nimport { IdWidget } from './idWidget';\r\nimport { ButtonWidget } from './buttonWidget';\r\nimport { ArrComponent } from './arrComponent';\r\nimport { ImageWidget } from './imageWidget';\r\nimport { TagSingleWidget, TagMultiWidget } from './tagWidget';\r\n\r\ninterface WidgetFactory {\r\n\twidget?: TypeWidget;\r\n\tdataTypes?: DataType[];\r\n};\r\n\r\nconst stringWidget: WidgetFactory = {\r\n\tdataTypes: ['integer', 'number', 'string'],\r\n\twidget: TextWidget\r\n};\r\n\r\nconst widgetFactories: {[type: string]: WidgetFactory} = {\r\n    id: {\r\n        dataTypes: ['id'],\r\n        widget: IdWidget,\r\n    },\r\n    text: stringWidget,\r\n\tstring: stringWidget,\r\n    textarea: {\r\n        dataTypes: ['string'],\r\n        widget: TextAreaWidget\r\n    },\r\n    password: {\r\n        dataTypes: ['string'],\r\n        widget: PasswordWidget\r\n    },\r\n    date: {\r\n        dataTypes: ['date'],\r\n        widget: DateWidget\r\n    },\r\n    datetime: {\r\n        dataTypes: ['date'],\r\n        widget: DateTimeWidget\r\n    },\r\n    time: {\r\n        dataTypes: ['date'],\r\n        widget: TimeWidget\r\n    },\r\n    month: {\r\n        dataTypes: ['date'],\r\n        widget: MonthWidget\r\n    },\r\n    select: {\r\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\r\n        widget: SelectWidget\r\n    },\r\n    url: {\r\n        dataTypes: ['string'],\r\n        widget: UrlWidget\r\n    },\r\n    email: {\r\n        dataTypes: ['string'],\r\n        widget: EmailWidget\r\n    },\r\n    number: {\r\n        dataTypes: ['integer', 'number'],\r\n        widget: NumberWidget\r\n    },\r\n    updown: {\r\n        dataTypes: ['integer', 'number'],\r\n        widget: UpdownWidget\r\n    },\r\n    color: {\r\n\r\n    },\r\n    checkbox: {\r\n        dataTypes: ['boolean', 'integer', 'number'],\r\n        widget: CheckBoxWidget\r\n    },\r\n    image: {\r\n        dataTypes: ['string'],\r\n        widget: ImageWidget,\r\n    },\r\n    checkboxes: {\r\n\r\n    },\r\n    radio: {\r\n        dataTypes: ['integer', 'number', 'string', 'date', 'boolean'],\r\n        widget: RadioWidget\r\n\t},\r\n\ttagSingle: {\r\n\t\tdataTypes: ['integer'],\r\n\t\twidget: TagSingleWidget\r\n\t},\r\n\ttagMulti: {\r\n\t\tdataTypes: ['string'],\r\n\t\twidget: TagMultiWidget\r\n\t},\r\n    range: {\r\n        dataTypes: ['integer'],\r\n        widget: RangeWidget,\r\n    },\r\n    button: {\r\n        dataTypes: ['button', 'submit'],\r\n        widget: ButtonWidget,\r\n    }\r\n}\r\n\r\nexport function factory(context: Context, itemSchema: ItemSchema, children:React.ReactNode, fieldProps?: FieldProps):JSX.Element {\r\n    if (context === undefined) {\r\n        debugger;\r\n        return null;\r\n    }\r\n    if (itemSchema === undefined) return undefined;\r\n    let {name, type} = itemSchema;\r\n    switch (type) {\r\n    case 'arr':\r\n        let arrSchema = context.getItemSchema(name) as ArrSchema;\r\n        return <ArrComponent parentContext={context} arrSchema={arrSchema} children={children} />;\r\n    default:\r\n        break;\r\n    }\r\n\r\n    let typeWidget: TypeWidget;\r\n    let ui = context.getUiItem(name);\t\r\n    function getTypeWidget(t:DataType): TypeWidget {\r\n        switch(t) {\r\n        default: return TextWidget; \r\n        case 'id': return IdWidget;\r\n        case 'integer': return UpdownWidget;\r\n        case 'number': return NumberWidget; \r\n        case 'string': return TextWidget; \r\n        case 'date': return DateWidget; \r\n        case 'boolean': return CheckBoxWidget; \r\n        case 'button':\r\n        case 'submit': return ButtonWidget;\r\n        }\r\n    }\r\n    if (ui === undefined) { \r\n        typeWidget = getTypeWidget(type);\r\n    }\r\n    else {\r\n        let {widget:widgetType, hiden} = ui;\r\n\t\tif (hiden === true) return null;\r\n        switch (widgetType) {\r\n        default:\r\n            if (widgetType !== undefined) {\r\n                let widgetFactory = widgetFactories[widgetType];\r\n\t\t\t\tif (!widgetFactory) {\r\n\t\t\t\t\tdebugger;\r\n\t\t\t\t\tthrow new Error(`unknown widget ${widgetType}`);\r\n\t\t\t\t}\r\n                typeWidget = widgetFactory.widget;\r\n            }\r\n            if (typeWidget === undefined) typeWidget = getTypeWidget(type);\r\n            break;\r\n        case 'custom':\r\n            typeWidget = (ui as UiCustom).WidgetClass;\r\n            break;\r\n        case 'group':\r\n            return <span>impletment group</span>;\r\n        }\r\n        //label = uiLabel || name;\r\n    }\r\n    \r\n\tlet {widgets} = context;\r\n\tlet widget = widgets[name];\r\n\tif (!widget) {\r\n\t\twidget = new typeWidget(context, itemSchema, fieldProps, children);\r\n\t\twidget.init();\r\n\t\twidgets[name] = widget;\r\n\t}\r\n\r\n    return <widget.container />;\r\n    /*\r\n    if (isRow === false) {\r\n        let WidgetElement = observer(() => widget.container());\r\n        return <WidgetElement />;\r\n    }\r\n    else {\r\n        let widgetElement = widget.container();\r\n        return widgetElement;\r\n    }\r\n    */\r\n}\r\n\r\n","import * as React from 'react';\r\nimport {observable, IReactionDisposer, autorun} from 'mobx';\r\nimport classNames from 'classnames';\r\nimport { Schema, ItemSchema, ArrSchema, UiSchema, TempletType } from '../schema';\r\nimport { factory } from './widgets';\r\nimport 'font-awesome/css/font-awesome.min.css';\r\nimport { ContextContainer, FormContext, Context } from './context';\r\nimport { InputRes, inputRes, resLang } from '../../res';\r\n\r\nexport type FormButtonClick = (name:string, context: Context) => Promise<any>;\r\nexport type InputEnter = (name:string, context: Context) => Promise<any>;\r\n\r\nexport interface FormProps {\r\n    className?: string;\r\n    schema: Schema;\r\n    uiSchema?: UiSchema;\r\n    formData?: any;\r\n    onButtonClick?: FormButtonClick;\r\n    onEnter?: InputEnter;\r\n    fieldLabelSize?: number;            // col-sm-2 for label\r\n\tfieldLabelAlign?: 'left'|'center'|'right';\r\n    requiredFlag?: boolean;             // default=true\r\n    beforeShow?: (formContext:FormContext) => void;\r\n    res?: InputRes;\r\n\r\n    Container?: (content:JSX.Element) => JSX.Element;\r\n    FieldContainer?: (label:string|JSX.Element, content:JSX.Element) => JSX.Element;\r\n    FieldClass?: string;\r\n    ButtonClass?: string;\r\n}\r\n\r\nexport class Form extends React.Component<FormProps> {\r\n    readonly schema: Schema;\r\n    readonly itemSchemas: {[name:string]: ItemSchema};\r\n    readonly uiSchema: UiSchema;\r\n    readonly res?: InputRes;\r\n    formContext: FormContext;\r\n    private disposer: IReactionDisposer;\r\n    readonly data:any;\r\n\r\n    readonly Container: (content:JSX.Element) => JSX.Element;\r\n    readonly FieldContainer: (label:any, content:JSX.Element) => JSX.Element;\r\n    readonly FieldClass: string;\r\n    readonly ButtonClass: string;\r\n    \r\n    constructor(props:FormProps) {\r\n        super(props);\r\n        let {schema, uiSchema, \r\n            Container, FieldContainer, FieldClass, \r\n            ButtonClass, res,\r\n\t\t} = props;\r\n        this.Container = Container || this.DefaultContainer;\r\n        this.FieldContainer = FieldContainer || this.DefaultFieldContainer;\r\n        this.FieldClass = FieldClass!==undefined && FieldClass!==''&&FieldClass!==null? FieldClass : this.DefaultFieldClass;\r\n        this.res = res || this.DefaultRes;\r\n        this.ButtonClass = ButtonClass || this.DefaultButtonClass;\r\n\r\n        this.schema = schema;\r\n        this.itemSchemas = {};\r\n        for (let itemSchema of this.schema) {\r\n            this.itemSchemas[itemSchema.name] = itemSchema;\r\n        }\r\n        this.uiSchema = uiSchema;\r\n\r\n        this.disposer = autorun(this.watch);\r\n        this.data = {};\r\n    }\r\n\r\n    private renderContent():any {\r\n        this.initData(this.props.formData);\r\n        let {children} = this.props;\r\n        if (children !== undefined) {\r\n            this.formContext = new FormContext(this, true);\r\n            return <>{children}</>;\r\n        }\r\n\r\n        let Templet: TempletType;\r\n        if (this.uiSchema !== undefined) {\r\n            Templet = this.uiSchema.Templet;\r\n        }\r\n        if (Templet !== undefined) {\r\n            this.formContext = new FormContext(this, true);\r\n            return typeof(Templet) === 'function'? Templet(this.data) : Templet;\r\n        }\r\n\r\n\t\tif (!this.formContext) {\r\n\t\t\tthis.formContext = new FormContext(this, false);\r\n\t\t}\r\n        return <>{this.schema.map((v, index) => {\r\n            return <React.Fragment key={index}>{factory(this.formContext, v, children)}</React.Fragment>\r\n        })}</>;\r\n    }\r\n\r\n    private initData(formData: any) {\r\n        if (formData === undefined) formData = {};\r\n        if (this.uiSchema !== undefined) {\r\n            let {items} = this.uiSchema;\r\n            if (items !== undefined) {\r\n                for (let i in items) {\r\n                    let ui = items[i];\r\n                    let dv = ui.defaultValue;\r\n                    if (dv !== undefined) {\r\n                        if (formData[i] === undefined) {\r\n                            formData[i] = dv;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        for (let itemSchema of this.schema) {\r\n            this.initDataItem(itemSchema, this.data, formData);\r\n        }\r\n    }\r\n\r\n    private initDataItem(itemSchema: ItemSchema, data:any, formData: any):any {\r\n        let {name, type} = itemSchema;\r\n        if (type === 'button') return;\r\n        if (type !== 'arr') {\r\n            data[name] = formData[name];\r\n            return;\r\n        }\r\n\r\n        let arrItem:ArrSchema = itemSchema as ArrSchema;\r\n        let {arr:arrItems} = arrItem;\r\n        if (arrItems === undefined) return;\r\n        let arrDict:any = arrItem.itemSchemas = {};\r\n        for (let item of arrItems) {\r\n            arrDict[item.name] = item;\r\n        }\r\n        let val:any[] = formData[name];\r\n        if (val === undefined) val = [];\r\n        else if (Array.isArray(val) === false) val = [val];\r\n        let arr:any[] = [];\r\n        for (let row of val) {\r\n            let {$isSelected, $isDeleted} = row;\r\n            let r = {\r\n                $source: row,\r\n                $isSelected: $isSelected,\r\n                $isDeleted: $isDeleted,\r\n            };\r\n            for (let item of arrItems) {\r\n                this.initDataItem(item, r, row);\r\n            }\r\n            arr.push(r);\r\n        }\r\n        // 如果没有observable，行删除标志点击不管用\r\n        // 不知道这里为什么要去掉observable。有可能会有别的问题\r\n        data[name] = observable(arr);\r\n        //data[name] = arr;\r\n        return;\r\n    }\r\n\r\n    private watch = () => {\r\n        let {formData} = this.props;\r\n        if (formData === undefined) return;\r\n        //this.initData(formData);\r\n        this.calcSelectOrDelete();\r\n    }\r\n    private calcSelectOrDelete() {\r\n        for (let itemSchema of this.schema) {\r\n            this.arrItemOperated(itemSchema);\r\n        }\r\n    }\r\n\r\n    private arrItemOperated(itemSchema: ItemSchema) {\r\n        let {name, type} = itemSchema;\r\n        if (type !== 'arr') return;\r\n        if (this.data === undefined) return;\r\n        let formArrVal = this.data[name];\r\n        if (formArrVal === undefined) return;\r\n        let {arr: arrItems} = itemSchema as ArrSchema;\r\n        for (let row of formArrVal) {\r\n            let {$source} = row;\r\n            if ($source === undefined) continue;\r\n            let {$isSelected, $isDeleted} = $source;\r\n            row.$isSelected = $isSelected;\r\n            row.$isDeleted = $isDeleted;\r\n            //console.log($isSelected, $isDeleted);\r\n            for (let item of arrItems) {\r\n                this.arrItemOperated(item);\r\n            }\r\n        }\r\n    }\r\n\r\n    componentDidMount() {\r\n        let {beforeShow} = this.props;\r\n        if (beforeShow !== undefined) beforeShow(this.formContext);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.disposer !== undefined) this.disposer();\r\n    }\r\n\r\n    render() {\r\n        let content = this.renderContent();\r\n        return <ContextContainer.Provider value={this.formContext}>\r\n            {React.createElement(this.formContext.renderErrors)}\r\n            {this.Container(content)}\r\n        </ContextContainer.Provider>;\r\n    }\r\n\r\n    async buttonClick(buttonName:string) {\r\n        this.formContext.checkRules()\r\n        if (this.formContext.hasError === true) return;\r\n\r\n        let {onButtonClick} = this.formContext.form.props;\r\n        if (onButtonClick === undefined) {\r\n            alert(`you should define form onButtonClick`);\r\n            return;\r\n        }\r\n        let ret = await onButtonClick(buttonName, this.formContext);\r\n        if (ret === undefined) return;\r\n        this.formContext.setError(buttonName, ret);\r\n    }\r\n\r\n    protected DefaultContainer = (content:JSX.Element): JSX.Element => {\r\n        return <form className={classNames(this.props.className)} onSubmit={e=>e.preventDefault()}>\r\n            {content}\r\n        </form>;\r\n    }\r\n    protected DefaultFieldContainer = (label:string|JSX.Element, content:JSX.Element): JSX.Element => {\r\n        let {fieldLabelSize, fieldLabelAlign} = this.props;\r\n\r\n        if (fieldLabelSize > 0) {\r\n            let labelView:any;\r\n            if (label === null) {\r\n                fieldLabelSize = 0;\r\n            }\r\n            else {\r\n\t\t\t\tlet cnAlign: string;\r\n\t\t\t\tswitch (fieldLabelAlign) {\r\n\t\t\t\t\tcase 'right': cnAlign = 'text-sm-right'; break;\r\n\t\t\t\t\tcase 'center': cnAlign = 'text-sm-center'; break;\r\n\t\t\t\t}\r\n                labelView = <label className={classNames('col-sm-' + fieldLabelSize, 'col-form-label', cnAlign)}>{label}</label>\r\n            }\r\n            let fieldCol = 'col-sm-' + (12 - fieldLabelSize);\r\n            return <div className=\"mb-3 row\">\r\n                {labelView}\r\n                <div className={fieldCol}>{content}</div>\r\n            </div>;\r\n        }\r\n        return <div className=\"mb-3\">\r\n            {label===null? null:<label className=\"col-form-label\">{label}</label>}\r\n            {content}\r\n        </div>;\r\n    }\r\n    protected DefaultFieldClass:string = undefined;\r\n    protected DefaultButtonClass = 'text-center py-2';\r\n    protected DefaultRes:InputRes = resLang<InputRes>(inputRes);\r\n\r\n    ArrContainer = (label:any, content:JSX.Element): JSX.Element => {\r\n        return <div>\r\n            <div className={classNames('small text-muted text-center bg-light py-1 px-3 mt-4 mb-1')}>{label}</div>\r\n            {content}\r\n        </div>;\r\n    }\r\n    RowContainer = (content:JSX.Element): JSX.Element => {\r\n        let cn = classNames({\r\n            'py-3': true\r\n        });\r\n        return <div className={cn}>{content}</div>\r\n    }\r\n    RowSeperator = <div className=\"border border-gray border-top\" />;\r\n}\r\n","import * as React from 'react';\r\nimport { factory } from './widgets';\r\nimport { ContextContainer, Context } from './context';\r\n\r\nexport interface FieldProps {\r\n    name: string;\r\n}\r\n\r\nexport class FormField extends React.Component<FieldProps> {\r\n    static contextType = ContextContainer;\r\n    render() {\r\n        let {name, children } = this.props;\r\n        let context:Context = this.context;\r\n        if (context === undefined) return <span className=\"text-danger\">!only in Form!</span>;\r\n        let itemSchema = context.getItemSchema(name);\r\n        let content = factory(context, itemSchema, children, this.props);\r\n        if (content === undefined) {\r\n            return <span className=\"text-danger\">!!{name} is not defined!!</span>;\r\n        }\r\n        return content;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { UiTextItem } from '../schema';\r\nimport { nav } from '../../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport interface InputOptions {\r\n\ttype: string;\r\n\tmin?: number;\r\n\tmax?: number;\r\n\tstep?: number;\r\n}\r\n\r\nexport class StringItemEdit extends ItemEdit {\r\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve, reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.verifyValue();\r\n    }\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n\t}\r\n\t\r\n\tprotected inputOptions():InputOptions {\r\n\t\treturn {\r\n\t\t\ttype: 'text',\r\n\t\t}\r\n\t}\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n\t\tlet {resolve} = props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (!this.error) {\r\n\t\t\t\tlet val = this.newValue;\r\n\t\t\t\tresolve(val);\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>;\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\t\tif (evt.keyCode === 13) onSave();\r\n\t\t}\r\n\t\tlet {type, max, min, step} = this.inputOptions();\r\n        return <Page header={this.label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<input type={type}\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n                    className=\"form-control\" \r\n                    defaultValue={this.value} min={min} max={max} step={step} />\r\n                {\r\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiRadio } from '../schema';\r\nimport { nav } from '../../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class RadioItemEdit extends ItemEdit {\r\n    get uiItem(): UiRadio {return this._uiItem as UiRadio}\r\n\r\n\tinit() {\r\n        if (this.value === undefined) {\r\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\r\n        }\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (value: any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let {name} = this.itemSchema;\r\n        let {list} = this.uiItem;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>{\r\n                this.verifyValue();\r\n                if (!this.error) resolve(this.newValue);\r\n            }}>保存</button>;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\r\n                    <input name={name} type=\"radio\" value={value} \r\n                        onClick={()=>this.onChange(value)} \r\n                        defaultChecked={value === this.value} /> {title || value} &nbsp;\r\n                </label></div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<div className=\"row row-cols-2 row-cols-sm-3 row-cols-md-4\">{content}</div>\r\n\t\t\t</div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiSelect } from '../schema';\r\nimport { nav } from '../../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class SelectItemEdit extends ItemEdit {\r\n    get uiItem(): UiSelect {return this._uiItem as UiSelect}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (value:any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let {list} = this.uiItem;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\r\n                    {title || value}\r\n                </div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label}>\r\n            <div className=\"my-3\">\r\n                {content}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiIdItem } from '../schema';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class IdItemEdit extends ItemEdit {\r\n    get uiItem(): UiIdItem {return this._uiItem as UiIdItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>(async (resolve, reject) => {\r\n            //let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            //nav.push(element,reject);\r\n\r\n            let {pickId} = this.uiItem;\r\n            if (pickId === undefined) {\r\n                alert('IdItemEdit.pickId = undefined');\r\n                return;\r\n            }\r\n            let boxId = await pickId(undefined, undefined, this.value);\r\n            //if (typeof id === 'object') {\r\n            //    id = (id as any).id;\r\n            //}\r\n            this.onChange(boxId.id);\r\n            resolve(boxId);\r\n            //this.newValue = id;\r\n        });\r\n    }\r\n\r\n    protected async internalEnd():Promise<void> {}\r\n\r\n    private onChange = (value:any) => {\r\n        this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        /*\r\n        let {resolve, reject} = props;\r\n        let {list} = this.uiItem;\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {title, value} = v;\r\n                return <div key={index} className=\"px-3 py-2 cursor-pointer bg-white mb-1\" onClick={()=>{this.onChange(value); resolve(this.newValue)}}>\r\n                    {title || value}\r\n                </div>;\r\n            })\r\n            :\r\n            <>no list defined</>;\r\n        return <Page header={'更改' + this.label}>\r\n            <div className=\"my-3\">\r\n                {content}\r\n            </div>\r\n        </Page>;\r\n        */\r\n        return <Page header={'更改' + this.label}>\r\n            ddd\r\n        </Page>\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport { UiTag } from '../schema';\r\nimport { nav } from '../../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nabstract class TagItemEdit extends ItemEdit {\r\n\tprotected inputs: {[index:number]: HTMLInputElement} = {};\r\n\tprotected inputType: 'checkbox' | 'radio';\r\n    get uiItem(): UiTag {return this._uiItem as UiTag};\r\n\r\n\tinit() {\r\n        if (this.value === undefined) {\r\n            this.value = this._uiItem===undefined? undefined : this._uiItem.defaultValue;\r\n        }\r\n\t}\r\n\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve:resolve, reject:reject});\r\n            nav.push(element,reject);\r\n        });\r\n\t}\r\n\t\r\n\trenderContent() {\r\n\t\tlet valuesView = this.uiItem.valuesView;\r\n\t\tif (valuesView === undefined) return super.renderContent();\r\n\t\treturn valuesView.render(this.value);\r\n\t}\r\n\r\n\tprotected abstract renderInputs():JSX.Element;\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n        let {resolve} = props;\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={()=>{\r\n                this.verifyValue();\r\n                if (!this.error) resolve(this.newValue);\r\n\t\t\t}}>保存</button>;\r\n\t\t/*\r\n        let content = list?\r\n            list.map((v, index:number) => {\r\n                let {name:itemName, id} = v;\r\n                return <div key={index} className=\"col\"><label className=\"px-3 py-2 cursor-pointer\">\r\n                    <input ref={input=>this.inputs[id] = input} name={name} type={this.inputType} value={id} \r\n\t\t\t\t\t\tonClick={(e)=>this.onChange(e.currentTarget.checked, id)}\r\n                        defaultChecked={this.defaultChecked(id)} /> {itemName} &nbsp;\r\n                </label></div>;\r\n            })\r\n            :\r\n\t\t\t<>no list defined</>;\r\n\t\t*/\r\n        return <Page header={'更改' + this.label} right={right}>\r\n\t\t\t<div className=\"p-3\">\r\n\t\t\t\t{this.renderInputs()}\r\n\t\t\t</div>\r\n        </Page>;\r\n    })\r\n}\r\n\r\nexport class TagSingleItemEdit extends TagItemEdit {\r\n\tprotected inputType:'radio'|'checkbox' = 'radio';\r\n    protected onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet {currentTarget} = evt;\r\n\t\tif (currentTarget.checked === false) return;\r\n        this.newValue = Number(currentTarget.value);\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n\t}\r\n\t\r\n\tprotected renderInputs():JSX.Element {\r\n\t\tlet {valuesView} = this.uiItem;\r\n\t\tlet options = {\r\n\t\t\tinputs: this.inputs,\r\n\t\t\tonInputChange: this.onInputChange,\r\n\t\t};\r\n\t\treturn valuesView.renderRadios(this.value, options);\r\n\t}\r\n}\r\n\r\nexport class TagMultiItemEdit extends TagItemEdit {\r\n\t//private arr:number[];\r\n\tprotected inputType:'radio'|'checkbox' = 'checkbox';\r\n\r\n\tprivate onInputChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n\t\tlet values:string[] = [];\r\n\t\tfor (let i in this.inputs) {\r\n\t\t\tlet input = this.inputs[i];\r\n\t\t\tif (input.checked === true) values.push(input.value);\r\n\t\t}\r\n        this.newValue = values.join('|');\r\n        //this.newValue = value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n\t}\r\n\tprotected renderInputs():JSX.Element {\r\n\t\tlet {valuesView} = this.uiItem;\r\n\t\tlet options = {\r\n\t\t\tinputs: this.inputs,\r\n\t\t\tonInputChange: this.onInputChange\r\n\t\t};\r\n\t\treturn valuesView.renderChecks(this.value, options);\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport { UiTextItem } from '../schema';\r\nimport { nav } from '../../nav';\r\nimport { Page } from '../page/page';\r\nimport { observer } from 'mobx-react';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class TextAreaItemEdit extends ItemEdit {\r\n    get uiItem(): UiTextItem {return this._uiItem as UiTextItem}\r\n    protected async internalStart():Promise<any> {\r\n        return new Promise<any>((resolve, reject) => {\r\n            let element = React.createElement(this.page, {resolve, reject});\r\n            nav.push(element,reject);\r\n        });\r\n    }\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLTextAreaElement>) => {\r\n        this.verifyValue();\r\n    }\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n    }\r\n\r\n    private page = observer((props:{resolve:(value:any)=>void, reject: (resean?:any)=>void}):JSX.Element => {\r\n\t\tlet {resolve} = props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (!this.error) {\r\n\t\t\t\tlet val = this.newValue;\r\n\t\t\t\tresolve(val);\t\t\t\t\r\n\t\t\t}\r\n\t\t}\r\n        let right = <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>;\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLTextAreaElement>) => {\r\n\t\t\t// if (evt.keyCode === 13) onSave();\r\n\t\t}\r\n        return <Page header={this.label} right={right}>\r\n            <div className=\"m-3\">\r\n                <textarea\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n                    className=\"form-control\" \r\n\t\t\t\t\tdefaultValue={this.value}\r\n\t\t\t\t\trows={6} />\r\n                {\r\n                    this.uiItem && <div className=\"small muted m-2\">{this.uiItem.placeholder}</div>\r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n        </Page>;\r\n    })\r\n}\r\n","import React from 'react';\r\nimport { UiCheckItem } from '../schema';\r\nimport { ItemEdit } from './itemEdit';\r\n\r\nexport class CheckBoxItemEdit extends ItemEdit {\r\n\tprivate input: HTMLInputElement;\r\n    get uiItem(): UiCheckItem {return this._uiItem as UiCheckItem}\r\n\tget editInRow(): boolean {return true;}\r\n    protected async internalStart():Promise<any> {\r\n\t\tif (!this.input) return;\r\n\t\tlet uiItem = this.uiItem;\r\n\t\tif (uiItem === undefined) return this.input.checked;\r\n\t\tlet {checked} = this.input;\r\n\t\treturn this.getValue(checked);\r\n    }\r\n\tasync end():Promise<any> {}\r\n\trenderContent() {\r\n\t\tlet {readOnly} = this.uiItem;\r\n\t\tlet disabled = readOnly === true;\r\n\t\tlet onChange:any;\r\n\t\tif (readOnly !== true) onChange = this.onChange;\r\n\t\treturn <input ref={r => this.input=r} type=\"checkbox\" \r\n\t\t\tdefaultChecked={this.value} disabled={disabled}\r\n\t\t\tonChange={onChange} />\r\n\t}\r\n\r\n\tprivate getValue(checked: boolean) {\r\n\t\tlet {trueValue, falseValue} = this.uiItem;\r\n        return checked === true? (trueValue??true) : (falseValue??false);\r\n\t}\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = this.getValue(evt.target.checked);\r\n        let preValue = this.value;\r\n\t\tthis.isChanged = (this.newValue !== preValue);\r\n\t\tthis.edit.onItemChanged(this, this.newValue);\r\n    }\r\n}\r\n","import { UiRange } from \"../schema\";\r\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\r\n\r\nexport class RangeItemEdit extends StringItemEdit {\r\n\tprotected inputOptions():InputOptions {\r\n\t\tlet min:number, max:number, step:number;\r\n\t\tif (this._uiItem) {\r\n\t\t\tmin = (this._uiItem as UiRange).min\r\n\t\t\tmax = (this._uiItem as UiRange).max\r\n\t\t\tstep = (this._uiItem as UiRange).step\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttype: 'range',\r\n\t\t\tmin, max, step\r\n\t\t}\r\n\t}\r\n}\r\n","import { UiNumberItem } from \"../schema\";\r\nimport { InputOptions, StringItemEdit } from \"./stringItemEdit\";\r\n\r\nexport class NumberItemEdit extends StringItemEdit {\r\n\tprotected inputOptions():InputOptions {\r\n\t\tlet min:number, max:number, step:number;\r\n\t\tif (this._uiItem) {\r\n\t\t\tmin = (this._uiItem as UiNumberItem).min\r\n\t\t\tmax = (this._uiItem as UiNumberItem).max\r\n\t\t\tstep = (this._uiItem as UiNumberItem).step\r\n\t\t}\r\n\t\treturn {\r\n\t\t\ttype: 'number',\r\n\t\t\tmin, max, step\r\n\t\t}\r\n\t}\r\n}\r\n","import * as React from 'react';\r\n//import _ from 'lodash';\r\nimport { observer } from 'mobx-react';\r\nimport { Schema, UiSchema, ItemSchema, UiItem, UiRadio, UiTagSingle, UiTagMulti } from '../schema';\r\nimport { ItemEdit } from './itemEdit';\r\nimport { StringItemEdit } from './stringItemEdit';\r\nimport { ImageItemEdit } from './imageItemEdit';\r\nimport { RadioItemEdit } from './radioItemEdit';\r\nimport { SelectItemEdit } from './selectItemEdit';\r\nimport { IdItemEdit } from './idItemEdit';\r\nimport { TagSingleItemEdit, TagMultiItemEdit } from './tagItemEdit';\r\nimport { TextAreaItemEdit } from './textAreaItemEdit';\r\nimport { CheckBoxItemEdit } from './checkBoxItemEdit';\r\nimport { RangeItemEdit } from './rangeItemEdit';\r\nimport { NumberItemEdit } from './numberItemEdit';\r\n\r\nexport interface EditProps {\r\n    className?: string;\r\n    schema: Schema;\r\n    data: any;\r\n    onItemClick?: (itemSchema: ItemSchema, uiItem: UiItem, value: any) => Promise<void>;\r\n    onItemChanged?: (itemSchema: ItemSchema, newValue:any, preValue:any) => Promise<void>;\r\n    stopEdit?: boolean;\r\n    uiSchema?: UiSchema;\r\n    sepClassName?: string;\r\n    topBorderClassName?: string;\r\n    bottomBorderClassName?: string;\r\n    rowContainerClassName?: string;\r\n}\r\n\r\n@observer\r\nexport class Edit extends React.Component<EditProps> {\r\n    private defaultSepClassName = 'border-top edit-sep-light-gray';\r\n    private defaultRowContainerClassName = 'd-flex px-3 py-2 bg-white align-items-center';\r\n    private topBorder:JSX.Element;\r\n    private bottomBorder:JSX.Element;\r\n    private rowContainerClassName?: string;\r\n    private sep:JSX.Element;\r\n\tprivate uiSchema: {[name:string]: UiItem};\r\n\r\n    constructor(props: EditProps) {\r\n        super(props);\r\n        let {topBorderClassName, bottomBorderClassName, sepClassName, rowContainerClassName, uiSchema} = props;\r\n        this.topBorder = <div className={topBorderClassName || this.defaultSepClassName} />;\r\n        this.bottomBorder = <div className={bottomBorderClassName || this.defaultSepClassName} />;\r\n        this.rowContainerClassName = rowContainerClassName || this.defaultRowContainerClassName;\r\n        //if (stopEdit !== true) this.rowContainerClassName += ' cursor-pointer';\r\n        this.sep = <div className={sepClassName || this.defaultSepClassName} />;\r\n\t\tthis.uiSchema = (uiSchema && uiSchema.items) || {};\r\n    }\r\n\r\n    render() {\r\n        let {schema} = this.props;\r\n\t\tlet sep:any;\r\n        return <div>\r\n\t\t\t{this.topBorder}\r\n            {schema.map((itemSchema, index) => {\r\n\t\t\t\tlet {stopEdit} = this.props;\r\n\t\t\t\tlet {name} = itemSchema;\r\n\t\t\t\tlet uiItem = this.uiSchema===undefined? undefined : this.uiSchema[name];\r\n\t\t\t\tlet label:string|JSX.Element, labelHide:any;\r\n\t\t\t\tif (uiItem !== undefined) {\r\n\t\t\t\t\tlabel = uiItem.label || name;\r\n\t\t\t\t\tlabelHide = uiItem.labelHide;\r\n\t\t\t\t};\r\n\t\t\t\tlet value = this.props.data[name];\r\n\t\t\t\tlet itemEdit = createItemEdit(this, itemSchema, uiItem, label, value);\r\n\t\t\t\tlet rowContainerClassName = this.rowContainerClassName;\r\n\t\t\t\tlet {editInRow} = itemEdit;\r\n\t\t\t\tif (editInRow === false) {\r\n\t\t\t\t\tif (stopEdit !== true) editInRow = false;\r\n\t\t\t\t}\r\n\t\t\t\tif (editInRow === false) rowContainerClassName += ' cursor-pointer';\r\n\r\n\t\t\t\tlet {required} = itemSchema;\r\n\t\t\t\tlet requireFlag = required===true && <span className=\"text-danger\">*</span>;\r\n\t\t\t\tlet divLabel:any, cn:string = 'flex-fill d-flex ';\r\n\t\t\t\tif (labelHide === true) {\r\n\t\t\t\t\tdivLabel = undefined;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tdivLabel = <div>{label} {requireFlag}</div>;\r\n\t\t\t\t\tcn += 'justify-content-end';\r\n\t\t\t\t}\r\n\t\t\t\tlet ret = <React.Fragment key={index}>\r\n\t\t\t\t\t{sep}\r\n\t\t\t\t\t<div className={'d-flex align-items-center' + rowContainerClassName} \r\n\t\t\t\t\t\tonClick={async ()=>await this.rowClick(itemEdit)}>\r\n\t\t\t\t\t\t{divLabel}\r\n\t\t\t\t\t\t<div className={cn}>{\r\n\t\t\t\t\t\t\titemEdit===undefined? undefined: itemEdit.renderContent()\r\n\t\t\t\t\t\t}</div>\r\n\t\t\t\t\t\t{editInRow === false && <div className=\"w-2c text-right\"><i className=\"fa fa-angle-right\" /></div>}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</React.Fragment>;\r\n\t\t\t\tsep = this.sep;\r\n\t\t\t\treturn ret;\r\n\t\t\t})}\r\n\t\t\t{this.bottomBorder}\r\n\t\t</div>;\r\n    }\r\n\r\n\tasync onItemChanged(itemEdit:ItemEdit, newValue:any) {\r\n\t\tlet {itemSchema, uiItem, value} = itemEdit;\r\n\t\tthis.props.data[itemSchema.name] = newValue;\r\n        let {onItemChanged, stopEdit} = this.props;\r\n\t\tif (stopEdit === true) return;\r\n\t\tif (uiItem?.readOnly === true) return;\r\n\t\tif (onItemChanged === undefined) {\r\n\t\t\talert(`${itemSchema.name} value changed, new: ${newValue}, pre: ${value}`);\r\n\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\r\n\t\t\t//this.props.data[itemSchema.name] = changeValue;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tawait onItemChanged(itemSchema, newValue, value);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate rowClick = async (itemEdit:ItemEdit) => {\r\n\t\tif (itemEdit === undefined) {\r\n\t\t\talert('item has no edit');\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet {itemSchema, uiItem, value, editInRow} = itemEdit;\r\n\t\tif (editInRow === true) return;\r\n        let {onItemChanged, onItemClick, stopEdit} = this.props;\r\n\t\tif (stopEdit === true) return;\r\n\t\tif (uiItem?.readOnly === true) return;\r\n        let changeValue:any;\r\n        if (onItemClick !== undefined) {\r\n            await onItemClick(itemSchema, uiItem, value);\r\n            return;\r\n        }\r\n        //let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);\r\n        if (itemEdit === undefined) {\r\n            alert('undefined: let itemEdit:ItemEdit = createItemEdit(itemSchema, uiItem, label, value);');\r\n            return;\r\n        }\r\n        try {\r\n            changeValue = await itemEdit.start();\r\n            if (changeValue !== value) {\r\n\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以移到这里来\r\n\t\t\t\tthis.props.data[itemSchema.name] = changeValue;\r\n                if (onItemChanged === undefined) {\r\n                    alert(`${itemSchema.name} value changed, new: ${changeValue}, pre: ${value}`);\r\n\t\t\t\t\t// 2020-04-15：改值之后，应该赋值吧。所以这一句移到前面去\r\n                    //this.props.data[itemSchema.name] = changeValue;\r\n                }\r\n                else {\r\n                    await onItemChanged(itemSchema, changeValue, value);\r\n                }\r\n            }\r\n            await itemEdit.end();\r\n        }\r\n        catch (err) {\r\n            // 如果直接back，会触发reject，就到这里了\r\n\t\t\tconsole.log('no value changed');\r\n\t\t\tconsole.error(err);\r\n        }\r\n    }\r\n}\r\n\r\ntype NewItemEdit = new (edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any) => ItemEdit;\r\n\r\nfunction createItemEdit(edit: Edit, itemSchema: ItemSchema, uiItem:UiItem, label:string|JSX.Element, value: any):ItemEdit {\r\n\tlet ie: ItemEdit;\r\n    let itemEdit: NewItemEdit;\r\n    if (uiItem !== undefined) {\r\n        switch (uiItem.widget) {\r\n            default: break;\r\n            case 'id': itemEdit = IdItemEdit; break;\r\n\t\t\tcase 'text': itemEdit = StringItemEdit; break;\r\n\t\t\tcase 'textarea': itemEdit = TextAreaItemEdit; break;\r\n            case 'image': itemEdit = ImageItemEdit; break;\r\n\t\t\tcase 'select': itemEdit = SelectItemEdit; break;\r\n\t\t\tcase 'range': itemEdit = RangeItemEdit; break;\r\n\t\t\tcase 'number':\r\n\t\t\tcase 'updown': itemEdit = NumberItemEdit; break;\r\n\t\t\tcase 'checkbox': itemEdit = CheckBoxItemEdit; break;\r\n            case 'radio': \r\n\t\t\t\tie = new RadioItemEdit(edit, itemSchema, uiItem as UiRadio, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tagSingle':\r\n\t\t\t\tie = new TagSingleItemEdit(edit, itemSchema, uiItem as UiTagSingle, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'tagMulti':\r\n\t\t\t\tie = new TagMultiItemEdit(edit, itemSchema, uiItem as UiTagMulti, label, value);\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t}\r\n\tif (ie === undefined) {\r\n\t\tif (itemEdit === undefined) {\r\n\t\t\tswitch (itemSchema.type) {\r\n\t\t\t\tcase 'string': itemEdit = StringItemEdit; break;\r\n\t\t\t\tcase 'image': itemEdit = ImageItemEdit; break;\r\n\t\t\t\tcase 'boolean': itemEdit = CheckBoxItemEdit; break;\r\n\t\t\t\tcase 'number':\r\n\t\t\t\tcase 'integer': itemEdit = RangeItemEdit; break;\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (itemEdit === undefined) return;\r\n\t\tie = new itemEdit(edit, itemSchema, uiItem, label, value);\r\n\t}\r\n\tie.init();\r\n\treturn ie;\r\n}\r\n","import { IObservableArray, computed, makeObservable } from 'mobx';\r\nimport { PageItems } from 'tonva-core';\r\nimport {List} from './index';\r\n\r\nexport abstract class ListBase {\r\n    protected list: List;\r\n    constructor(list: List) {\r\n        this.list = list;\r\n\t\tmakeObservable(this, {\r\n\t\t\tloading: computed,\r\n\t\t});\r\n    }\r\n    get isPaged():boolean {\r\n        let items = this.list.props.items;\r\n        return (items !== null && items !== undefined && Array.isArray(items) === false);\r\n    }\r\n    get items():any[]|IObservableArray<any> {\r\n        let items = this.list.props.items;\r\n        if (items === null) return null;\r\n        if (items === undefined) return undefined;\r\n        if (Array.isArray(items) === true)\r\n            return items as IObservableArray<any>;\r\n        else\r\n            return (items as PageItems<any>).items;\r\n    }\r\n    get loading():boolean {\r\n        let items = this.list.props.items;\r\n        if (items === null) return false;\r\n        if (items === undefined) return true;\r\n        let pageItems = items as PageItems<any>;\r\n        if (pageItems.items === undefined) return false;\r\n        return pageItems.loading;\r\n    }\r\n    get selectedItems():any[] { return undefined; }\r\n    //updateProps(nextProps:any) {}\r\n    dispose() {};\r\n    abstract render: (item:any, index:number) => JSX.Element;\r\n    protected renderContent(item:any, index:number) {\r\n        let {render} = this.list.props.item;\r\n        if (render === undefined) return <div className=\"px-3 py-2\">{JSON.stringify(item)}</div>;\r\n        return render(item, index);\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {ListBase} from './base';\r\n\r\nexport class Clickable extends ListBase {\r\n    render = (item:any, index:number):JSX.Element => {\r\n        let {className, key, onClick} = this.list.props.item;\r\n        return <li key={key===undefined?index:key(item)} className={classNames('va-row-clickable', className)} onClick={()=>onClick && onClick(item)}>\r\n            {this.renderContent(item, index)}\r\n        </li>\r\n    }\r\n}\r\n","import classNames from 'classnames';\r\nimport { uid } from 'tonva-core';\r\nimport { ListBase } from './base';\r\n\r\nexport class Static extends ListBase {\r\n    render = (item:any, index:number):JSX.Element => {\r\n        let {className, key} = this.list.props.item;\r\n        if (typeof item === 'string') {\r\n            let cn = classNames('va-list-gap', 'px-3', 'pt-1');\r\n            return <li key={uid()} className={cn}>{item}</li>;\r\n        }\r\n        return <li key={key===undefined?index:key(item)} className={classNames(className)}>\r\n            {this.renderContent(item, index)}\r\n        </li>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport {observable, IObservableArray, isObservableArray, observe, makeObservable} from 'mobx';\r\nimport classNames from 'classnames';\r\nimport { uid, PageItems } from 'tonva-core';\r\nimport {ListBase} from './base';\r\nimport { List } from './index';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport interface SelectableItem {\r\n    selected: boolean;\r\n    item: any;\r\n    labelId: string;\r\n}\r\n\r\nexport class Selectable extends ListBase {\r\n    _items: SelectableItem[] = null;\r\n    private inputItems:{[uid:string]: HTMLInputElement} = {};\r\n\r\n    constructor(list: List) {\r\n\t\tsuper(list);\r\n\t\tmakeObservable(this, {\r\n\t\t\t_items: observable\r\n\t\t})\r\n        this.buildItems();\r\n        this.listenArraySplice();\r\n    }    \r\n\r\n    private listenArraySplice() {\r\n        let {items} = this.list.props;\r\n        if (items === undefined) return;\r\n        if (items === null) return;\r\n        let itemsArray:any;\r\n        if (Array.isArray(items) === true) {\r\n            itemsArray = items as any;\r\n        }\r\n        else {\r\n            itemsArray = (items as PageItems<any>).items;\r\n        }\r\n        if (isObservableArray(items) === true) {\r\n            observe(itemsArray as IObservableArray<any>, (change) => {                \r\n                if (change.type === 'splice') {\r\n                    let {index, removedCount, added} = change;\r\n                    let _added = added && added.map(v => {\r\n                        return {\r\n                            selected: false, \r\n                            item: v, \r\n                            labelId:uid()\r\n                        }\r\n                    });\r\n                    this._items.splice(index, removedCount, ..._added);\r\n                    this.buildItems();\r\n                }\r\n            }, true);\r\n        }\r\n    }\r\n\r\n    private buildItems = () => {\r\n        let {items, isItemSelected, selectedItems, compare} = this.list.props;\r\n        let itemsArray:any[] | IObservableArray<any>;\r\n        if (items === undefined) {\r\n            this._items = undefined;\r\n            return;\r\n        }\r\n        if (items === null) {\r\n            this._items = null;\r\n            return;\r\n        }\r\n        \r\n        if (Array.isArray(items) === true) {\r\n            itemsArray = items as any;\r\n        }\r\n        else {\r\n            itemsArray = (items as PageItems<any>).items;\r\n        }\r\n\r\n\t\tif (isItemSelected) {\r\n\t\t\tlet retItems = itemsArray.map(v => {\r\n\t\t\t\treturn {\r\n\t\t\t\t\tselected: isItemSelected(v),\r\n\t\t\t\t\titem: v, \r\n\t\t\t\t\tlabelId:uid()\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tthis._items = retItems;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tlet comp: ((item:any, selectItem:any)=>boolean);\r\n\t\t\tif (compare === undefined) {\r\n\t\t\t\tcomp = (item:any, selectItem:any) => item === selectItem;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tcomp = compare;\r\n\t\t\t}\r\n\t\t\tlet retItems = itemsArray.map(v => {\r\n\t\t\t\t//let isObserved = isObservable(v);\r\n\t\t\t\t//let obj = isObserved === true? toJS(v) : v;\r\n\t\t\t\t//let obj = v;\r\n\t\t\t\tlet selected = selectedItems === undefined?\r\n\t\t\t\t\tfalse\r\n\t\t\t\t\t: selectedItems.find(si => comp(v, si)) !== undefined;\r\n\t\t\t\treturn {\r\n\t\t\t\t\tselected: selected, \r\n\t\t\t\t\titem: v, \r\n\t\t\t\t\tlabelId:uid()\r\n\t\t\t\t};\r\n\t\t\t});\r\n\t\t\tthis._items = retItems;\r\n\t\t}\r\n    }\r\n\r\n    get items() {\r\n        //if (this._items === undefined) \r\n        //this.buildItems();\r\n        return this._items;\r\n    }\r\n    private checkAll(on: boolean) {\r\n        for (let i in this.inputItems) this.inputItems[i].checked = on;\r\n        for (let item of this._items) item.selected = on;\r\n    }\r\n    selectAll() {\r\n        //if (this._items) this._items.forEach(v => v.selected = true);\r\n        this.checkAll(true);\r\n        this.list.props.item.onSelect(undefined, true, this.anySelected);\r\n    }\r\n    unselectAll() {\r\n        this.checkAll(false);\r\n        this.list.props.item.onSelect(undefined, false, this.anySelected);\r\n    }\r\n\r\n\tprivate get anySelected():boolean {return this._items.some(v => v.selected)}\r\n    private onSelect(item:SelectableItem, selected:boolean) {\r\n        item.selected = selected;\r\n        this.list.props.item.onSelect(item.item, selected, this.anySelected);\r\n    }\r\n    \r\n    get selectedItems():any[] {\r\n        return this._items.filter(v => v.selected === true).map(v => v.item);\r\n    }\r\n\r\n\trender = (item:SelectableItem, index:number):JSX.Element => {\r\n        let {key} = this.list.props.item;\r\n\t\treturn React.createElement(this.row, {item, index, key:key===undefined?index:key(item)});\r\n    }\r\n\r\n    private row = observer((props: {item:SelectableItem, index:number}):JSX.Element => {\r\n        let {item, index} = props;\r\n        let {className} = this.list.props.item;\r\n        let {labelId, selected, item:obItem} = item;\r\n        return <li className={classNames(className)}>\r\n            <div className=\"d-flex align-items-center px-3\">\r\n                <input ref={input=>{if (input) this.inputItems[labelId] = input;}}\r\n                    className=\"\" type=\"checkbox\" value=\"\" id={labelId}\r\n                    defaultChecked={selected}\r\n                    onChange={(e)=>{\r\n                        this.onSelect(item, e.target.checked)} \r\n                    }/>\r\n                <label className=\"\" style={{flex:1, marginBottom:0}} htmlFor={labelId}>\r\n                    {this.renderContent(obItem, index)}\r\n                </label>\r\n            </div>\r\n        </li>\r\n    })\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {observer} from 'mobx-react';\r\nimport _ from 'lodash';\r\nimport {PageItems} from 'tonva-core';\r\nimport {ListBase} from './base';\r\nimport {Clickable} from './clickable';\r\nimport {Static} from './static';\r\nimport {Selectable} from './selectable';\r\nimport '../../css/va-list.css';\r\nimport { IObservableArray } from 'mobx';\r\nimport { resLang } from '../../res/res';\r\nimport { ListRes, listRes } from '../../res';\r\n\r\ntype StaticRow = string|JSX.Element|(()=>string|JSX.Element);\r\ninterface ItemProps {\r\n\tclassName?: string|string[];\r\n\trender?: (item:any, index:number) => JSX.Element;\r\n\tonSelect?: (item:any, isSelected:boolean, anySelected:boolean)=>void;\r\n\tonClick?: (item:any)=>void;\r\n\tkey?: (item:any)=>string|number;\r\n}\r\n\r\nexport interface ListProps {\r\n    className?: string|string[];\r\n    items: any[] | IObservableArray<any> | PageItems<any>;\r\n    item: ItemProps;\r\n\tisItemSelected?: (item:any) => boolean;\r\n    compare?: (item:any, selectItem:any) => boolean;\r\n\tselectedItems?:any[];\r\n    header?: StaticRow;\r\n    footer?: StaticRow;\r\n    before?: StaticRow;\r\n    loading?: StaticRow;\r\n\tnone?: StaticRow;\r\n\tonFocus?: (evt: React.FocusEvent<HTMLUListElement>)=>void;\r\n}\r\n\r\n@observer\r\nexport class List extends React.Component<ListProps> {\r\n\tprivate static res:ListRes = resLang<ListRes>(listRes);\r\n\r\n\tprivate listBase: ListBase;\r\n\tprivate selectable: Selectable;\r\n    constructor(props:ListProps) {\r\n\t\tsuper(props);\r\n        this.buildBase();\r\n    }\r\n    _$scroll = (direct: 'top'|'bottom') => {\r\n        console.log('############### items scroll to ' + direct);\r\n    }\r\n    private buildBase() {\r\n        let {item} = this.props;\r\n        let {onClick, onSelect} = item;\r\n        if (onSelect !== undefined)\r\n            this.selectable = this.listBase = new Selectable(this);\r\n        else if (onClick !== undefined)\r\n            this.listBase = new Clickable(this);\r\n        else\r\n            this.listBase = new Static(this);\r\n\t}\r\n\tcomponentDidUpdate(prevProps: Readonly<ListProps>, prevState: Readonly<any>) {\r\n\t\tif (_.isEqual(this.props.item, prevProps.item) === false) {\r\n\t\t\tthis.buildBase();\r\n\t\t\tthis.forceUpdate();\r\n\t\t}\r\n\t}\r\n    componentWillUnmount() {\r\n        this.listBase.dispose();\r\n    }\r\n    selectAll() {\r\n        if (this.selectable) this.selectable.selectAll();\r\n    }\r\n    unselectAll() {\r\n        if (this.selectable) this.selectable.unselectAll();\r\n    }\r\n    get selectedItems():any[] {\r\n        return this.listBase.selectedItems;\r\n    }\r\n    render() {\r\n        let {className, header, footer, before, loading, none, onFocus} = this.props;\r\n        if (before === undefined) before = '-';\r\n        if (loading === undefined) loading = () => <i className=\"fa fa-spinner fa-spin fa-2x fa-fw text-info\" />;\r\n        if (none === undefined) none = List.res.none;\r\n        let {items, loading:isLoading} = this.listBase;\r\n        function staticRow(row:StaticRow, type:string) {\r\n            if (!row) return;\r\n            switch (typeof row) {\r\n                default:\r\n                case 'string': return <li className={\"va-list-\"+type}>{row}</li>;\r\n                case 'function': return <li className={\"va-list-\"+type}>{(row as ()=>string|JSX.Element)()}</li>;\r\n                case 'object': return <li>{row}</li>\r\n            } \r\n        }\r\n        let content:any, waitingMore:any;\r\n        if (items === null)\r\n            content = staticRow(before, 'before');\r\n        else if (items === undefined)\r\n            content = staticRow(loading, 'loading');\r\n        else if (items.length === 0)\r\n            content = staticRow(none, 'none');\r\n        else {\r\n            content = items.map((item, index) => {\r\n                return this.listBase.render(item, index);\r\n            });\r\n        }\r\n        if (isLoading === true && items) {\r\n            waitingMore = staticRow(loading, 'loading');\r\n\t\t}\r\n\t\tlet tabIndex:number;\r\n\t\tif (onFocus !== undefined) tabIndex = -1;\r\n        return <ul className={classNames('va-list', className)} onFocus={onFocus} tabIndex={tabIndex}>\r\n            {staticRow(header, 'header')}\r\n            {content}\r\n            {waitingMore}\r\n            {staticRow(footer, 'footer')}\r\n        </ul>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { setRes } from '../../res';\r\n\r\nexport interface EasyDateProps {\r\n    date: Date | number;\r\n\ttimeZone?: number;\r\n}\r\n\r\n//type YMD = (year:number, month:number, date:number) => string;\r\n//type MD = (month:number, date:number) => string;\r\n\r\nconst timeRes:{[prop:string]:any} = {\r\n\tmd: (month:number, date:number) => `${month}-${date}`,\r\n\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\r\n\tyesterday: 'Yday',\r\n\ttoday: 'Today',\r\n\ttomorrow: 'Tmw',\r\n\t$zh: {\r\n\t\tmd: (month:number, date:number) => `${month}月${date}日`,\r\n\t\tymd: (year:number, month:number, date:number) => `${year}年${month}月${date}日`,\r\n\t\tyesterday: '昨天',\r\n\t\ttoday: '今天',\r\n\t\ttomorrow: '明天',\r\n\t},\r\n\t$en: {\r\n\t\tmd: (month:number, date:number) => `${month}-${date}`,\r\n\t\tymd: (year:number, month:number, date:number) => `${year}-${month}-${date}`,\r\n\t\tyesterday: 'Yday',\r\n\t\ttoday: 'Today',\r\n\t\ttomorrow: 'Tmw',\r\n\t}\r\n}\r\n\r\nsetRes(timeRes, timeRes);\r\n\r\nfunction tt(str:string):any {\r\n\treturn timeRes[str];\r\n}\r\n\r\nfunction renderDate(vDate:Date|number, withTime:boolean, always:boolean = false) {\r\n    if (!vDate) return null;\r\n    let date: Date;\r\n    switch (typeof vDate) {\r\n        default: date = vDate as Date; break;\r\n        case 'string': date = new Date(vDate); break;\r\n        case 'number': date = new Date((vDate as number)*1000); break;\r\n    }\r\n\r\n    let now = new Date();\r\n    let tick:number, nDate:number, _date:number, month:number, year:number, nowYear:number;\r\n    let d = date;\r\n    tick = now.getTime() - d.getTime();\r\n    let hour=d.getHours(), minute=d.getMinutes();\r\n    nDate=now.getDate();\r\n    _date=d.getDate();\r\n    month=d.getMonth()+1;\r\n    year=d.getFullYear();\r\n\tnowYear = now.getFullYear();\r\n\r\n\tlet appendTime:boolean = false;\r\n\tlet dPart:string = (function() {\r\n\t\tif (tick < -24*3600*1000) {\r\n\t\t\tif (year === nowYear) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt('md')(month, _date);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt('ymd')(year, month, _date);\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (tick < 24*3600*1000) {\r\n\t\t\tif (_date!==nDate) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn tt(tick < 0? 'tomorrow' : 'yesterday');\r\n\t\t\t}\r\n\t\t\tif (withTime===true) {\r\n\t\t\t\tappendTime = true;\r\n\t\t\t\treturn '';\r\n\t\t\t}\r\n\t\t\treturn tt('today');\r\n\t\t}\r\n\t\tif (year === nowYear) {\r\n\t\t\treturn tt('md')(month, _date);\r\n\t\t}\r\n\t\treturn tt('ymd')(year, month, _date);\r\n\t})();\r\n\r\n\tlet hm = hour + ((minute<10?':0':':') + minute);\r\n\r\n\t/*\r\n    if (tick < -24*3600*1000) {\r\n        if (year === nowYear)\r\n            return tt('md')(month, _date) + ' ' + hm;\r\n        else\r\n            return tt('ymd')(year, month, _date) + ' ' + hm;\r\n    }\r\n    if (always === true || tick < 24*3600*1000) {\r\n        return _date!==nDate? \r\n            tt(tick < 0? 'tomorrow' : 'yesterday') + ' ' + hm \r\n            : withTime===true? hm : tt('today');\r\n    }\r\n    if (year === nowYear) {\r\n        return tt('md')(month, _date);\r\n    }\r\n\treturn tt('ymd')(year, month, _date);\r\n\t*/\r\n\tif (appendTime === true || always === true) {\r\n\t\treturn dPart + ' ' + hm;\r\n\t}\r\n\treturn dPart;\r\n}\r\n\r\n\r\nexport class EasyDate extends React.Component<EasyDateProps> {\r\n    render() {\r\n        return renderDate(this.props.date, false);\r\n    }\r\n}\r\n\r\ninterface EasyTimeProps extends EasyDateProps {\r\n\talways?: boolean;\r\n}\r\nexport class EasyTime extends React.Component<EasyTimeProps> {\r\n    render() {\r\n\t\tlet {date, always} = this.props;\r\n        return renderDate(date, true, always);\r\n    }\r\n}\r\n\r\ninterface DateProps {\r\n\tdate: Date;\r\n\thideTime?: boolean;\r\n\thideSameYear?: boolean;\r\n}\r\nexport const VDate: React.FunctionComponent<DateProps> = (props) => {\r\n\tlet {date, hideTime, hideSameYear} = props;\r\n\tlet year = date.getFullYear();\r\n\tlet vTime:any;\r\n\tif (hideTime !== true) {\r\n\t\tvTime = <>{date.getHours()}:{String(100 + date.getMinutes()).substr(1,2)}</>;\r\n\t}\r\n\tlet vDate = <>{date.getMonth()+1}-{date.getDate()}</>;\r\n\tif (hideSameYear === true && year === new Date().getFullYear()) {\r\n\t}\r\n\telse {\r\n\t\tvDate = <>{year}-{vDate}</>;\r\n\t}\r\n\treturn <>\r\n\t\t{vDate} {vTime}\r\n\t</>;\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\n\r\nexport interface DropdownAction {\r\n    icon?: string;\r\n    caption?: string;\r\n\taction?: () => void;\r\n\ticonClass?: string;\r\n\tcaptionClass?: string;\r\n}\r\n\r\nexport interface DropdownActionsProps {\r\n    icon?: string;\r\n\tcontent?: string|JSX.Element;\r\n    actions: DropdownAction[];\r\n    isRight?: boolean;\r\n\tclassName?: string;\r\n\tcontainerClass?: string;\r\n\titemIconClass?: string;\r\n\titemCaptionClass?: string;\r\n}\r\n\r\nexport interface DropdownActionsState {\r\n    dropdownOpen: boolean;\r\n}\r\n\r\nexport class DropdownActions extends React.Component<DropdownActionsProps, DropdownActionsState> {\r\n    private menu: HTMLDivElement;\r\n    private button: HTMLElement;\r\n    constructor(props:DropdownActionsProps) {\r\n        super(props);\r\n        this.state = {\r\n            dropdownOpen: false\r\n        };\r\n    }\r\n\r\n\t/*\r\n    componentDidMount() {\r\n        document.addEventListener('click', this.handleDocumentClick);\r\n        document.addEventListener('touchstart', this.handleDocumentClick);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('click', this.handleDocumentClick);\r\n        document.removeEventListener('touchstart', this.handleDocumentClick);\r\n    }\r\n\t*/\r\n\r\n    private handleDocumentClick = (evt:any) => {\r\n\t\tdocument.removeEventListener('click', this.handleDocumentClick);\r\n\t\tdocument.removeEventListener('touchstart', this.handleDocumentClick);\r\n\t\tif (this.state.dropdownOpen === false) return;\r\n        //if (this.button && this.button.contains(evt.target)) return;\r\n        if (!this.menu) return;\r\n        //if (!this.menu.contains(evt.target)) \r\n        this.toggle();\r\n    }\r\n\r\n    private toggle = () => {\r\n\t\tlet {dropdownOpen} = this.state;\r\n\t\tdropdownOpen = !dropdownOpen;\r\n        this.setState({dropdownOpen});\r\n\t\tif (dropdownOpen === true) {\r\n\t\t\tsetTimeout(() => {\r\n\t\t\t\tdocument.addEventListener('click', this.handleDocumentClick);\r\n\t\t\t\tdocument.addEventListener('touchstart', this.handleDocumentClick);\t\r\n\t\t\t},10)\r\n\t\t}\r\n    }\r\n\r\n    render() {\r\n        let {icon, content, actions, isRight, className, containerClass, itemIconClass, itemCaptionClass} = this.props;\r\n        if (isRight === undefined) isRight = true;\r\n        let hasIcon = actions.some(v => {\r\n\t\t\tif (!v) return false;\r\n\t\t\treturn v.icon !== undefined\r\n\t\t});\r\n        let {dropdownOpen} = this.state;\r\n\t\t//isOpen={this.state.dropdownOpen} toggle={this.toggle}\r\n\t\tlet cn = className || 'cursor-pointer dropdown-toggle btn btn-sm';\r\n\t\t//if (className) cn += className;\r\n        return <div className={classNames('dropdown', containerClass)}>\r\n\t\t\t<button ref={v=>this.button=v} \r\n\t\t\t\tclassName={cn}\r\n                data-toggle=\"dropdown\"\r\n                aria-expanded={dropdownOpen}\r\n                onClick={this.toggle}>\r\n                {icon!==null && <i className={classNames('fa fa-fw ', 'fa-'+(icon||'ellipsis-v'))} />}\r\n\t\t\t\t{content && <span className=\"ms-1\">{content}</span>}\r\n            </button>\r\n            <div ref={v => this.menu=v} className={classNames({\"dropdown-menu\":true, \"dropdown-menu-right\":isRight, \"show\":dropdownOpen})}>\r\n                {\r\n                    actions.map((v,index) => {\r\n\t\t\t\t\t\tif (!v) {\r\n                            return <div className=\"dropdown-divider\" key={index}/>;\r\n\t\t\t\t\t\t}\r\n                        let {icon, caption, action, iconClass, captionClass} = v;\r\n                        if (icon === undefined && caption === undefined) \r\n                            return <div className=\"dropdown-divider\" />;\r\n                        let i:any;\r\n                        if (hasIcon === true) {\r\n                            if (icon !== undefined) icon = 'fa-' + icon;\r\n\t\t\t\t\t\t\tif (!iconClass) iconClass = 'text-info';\r\n\t\t\t\t\t\t\ti = <i className={classNames('me-2', 'fa', icon, 'fa-fw', iconClass || itemIconClass)}\r\n\t\t\t\t\t\t\t\taria-hidden={true}></i>;\r\n                        }\r\n                        if (action === undefined) \r\n                            return <h6 className=\"dropdown-header\">{i} {caption}</h6>;\r\n                        let onMenuItemClick = (evt:React.MouseEvent<HTMLAnchorElement>)=>{\r\n                            evt.preventDefault();\r\n                            action();\r\n                        }\r\n                        let onTouchStart = (evt: React.TouchEvent<HTMLAnchorElement>) => {\r\n                            action();\r\n                        }\r\n                            // eslint-disable-next-line\r\n                        return <a className=\"dropdown-item\" key={index} href=\"#/\" \r\n                            onClick={onMenuItemClick} onTouchStart={onTouchStart}\r\n                            >{i} <span className={captionClass || itemCaptionClass}>{caption}</span></a>\r\n                    })\r\n                }\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport className from 'classnames';\r\nimport {PropGridProps} from './PropGrid';\r\nimport {LabeledProp, StringProp, NumberProp, ListProp, ComponentProp} from './propView';\r\n\r\nexport abstract class PropRow {\r\n    setValues(values: any) {}\r\n    abstract render(key:string): any;\r\n}\r\n\r\nexport class PropBorder extends PropRow {\r\n    render(key:string): JSX.Element {\r\n        return <div key={'_b_' + key} className=\"\">\r\n            <div className=\"w-100\">\r\n                <div style={{borderTop: '1px solid #f0f0f0'}} />\r\n            </div>\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport class PropGap extends PropRow {\r\n    private param: string;\r\n    constructor(param?: string) {\r\n        super();\r\n        this.param = param;\r\n    }\r\n    render(key:string): JSX.Element {\r\n        let w: string;\r\n        switch (this.param) {\r\n            default: w = 'py-2'; break;\r\n            case '=': w = 'py-1'; break;\r\n            case '-': w = 'pb-1'; break;\r\n        }\r\n        let cn = className(w);\r\n        return <div key={'_g_' + key} className={cn} />;\r\n    }\r\n}\r\n\r\nconst valueAlignStart = 'justify-content-start';\r\nconst valueAlignCenter = 'justify-content-center';\r\nconst valueAlignEnd = 'justify-content-end';\r\nexport abstract class LabeledPropRow extends PropRow {\r\n    protected gridProps: PropGridProps;\r\n    protected _prop: LabeledProp;\r\n    protected get prop():LabeledProp {return this._prop}\r\n    protected content: any;\r\n    protected col: string;\r\n    //protected values: any;\r\n    constructor(gridProps:PropGridProps, prop: LabeledProp) {\r\n        super();\r\n        this.gridProps = gridProps;\r\n        this._prop = prop;\r\n        this.col = gridProps.labelFixLeft === true? 'col' : 'col-sm';\r\n        //this.values = values;\r\n    }\r\n    render(key:string):any {\r\n        let {onClick, bk} = this.prop;\r\n        let cn = className({\r\n            \"cursor-pointer\": onClick !== undefined,\r\n            \"bg-white\": bk === undefined, \r\n            \"row\": true\r\n        });\r\n        return <div key={key} className={cn} onClick={onClick}>\r\n            {this.renderLabel()}\r\n            {this.renderProp()}\r\n        </div>;\r\n    }\r\n    protected renderLabel():any {\r\n        let {label} = this.prop;\r\n        if (label === undefined) return null;\r\n        return <label className={this.col + '-3 col-form-label'}>\r\n            {label}\r\n        </label>;\r\n    }\r\n    protected renderProp():any {\r\n        let {label} = this.prop;\r\n        let align, vAlign;\r\n        switch (this.gridProps.alignValue) {\r\n            case 'left': align = valueAlignStart; break;\r\n            case 'center': align = valueAlignCenter; break;\r\n            case 'right': align = valueAlignEnd; break;\r\n        }\r\n        switch (this.prop.vAlign) {\r\n            case 'top': vAlign = 'align-items-start'; break;\r\n            default:\r\n            case 'center': vAlign = 'align-items-center'; break;\r\n            case 'bottom': vAlign = 'align-items-end'; break;\r\n            case 'stretch': vAlign = 'align-items-stretch'; break;\r\n        }\r\n        let col:string = this.col + (label===undefined? '-12':'-9');\r\n        let cn = className(align, vAlign, col, 'd-flex');\r\n        return <div className={cn}>\r\n            {this.renderPropBody()}\r\n        </div>;\r\n    }\r\n    protected renderPropBody():any {\r\n        return <div className=\"form-control-plaintext\">\r\n            {this.renderPropContent()}\r\n        </div>;\r\n    }\r\n    protected renderPropContent():any {\r\n        return this.content;\r\n    }\r\n}\r\n\r\nexport class StringPropRow extends LabeledPropRow {\r\n    protected get prop(): StringProp {return this._prop as StringProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else this.content = values[this.prop.name];\r\n    }\r\n}\r\n\r\nexport class NumberPropRow extends LabeledPropRow {\r\n    protected get prop(): NumberProp {return this._prop as NumberProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else this.content = values[this.prop.name];\r\n    }\r\n}\r\n\r\nexport class ListPropRow extends LabeledPropRow {\r\n    protected get prop(): ListProp {return this._prop as ListProp;}\r\n    setValues(values:any) {\r\n        if (values === undefined) this.content = undefined;\r\n        else {\r\n            let list = this.prop.list;\r\n            if (typeof list === 'string') this.content = values[list];\r\n            else this.content = undefined;\r\n        }\r\n    }\r\n    protected renderPropBody() {\r\n        let {list, row} = this.prop;\r\n        let items:any[] = typeof list === 'string'? this.content : list;\r\n        if (items === undefined) return <div/>;\r\n        // new row(item)\r\n        return <div className=\"w-100\">\r\n            {\r\n                items.map((item, index) => <React.Fragment key={index}>\r\n                    {index===0? null: <div style={{width:'100%', borderBottom:'1px solid #f0f0f0'}} />}\r\n                    {React.createElement(row, item)}\r\n                </React.Fragment>)\r\n            }\r\n        </div>;\r\n    }\r\n}\r\n\r\nexport class ComponentPropRow extends LabeledPropRow {\r\n    protected get prop(): ComponentProp {return this._prop as ComponentProp;}\r\n    protected renderPropBody() {\r\n        let {component} = this.prop;\r\n        return component;\r\n    }\r\n    protected renderProp():any {\r\n        let {label, full} = this.prop;\r\n        let align, vAlign;\r\n        switch (this.gridProps.alignValue) {\r\n            case 'left': align = valueAlignStart; break;\r\n            case 'center': align = valueAlignCenter; break;\r\n            case 'right': align = valueAlignEnd; break;\r\n        }\r\n        switch (this.prop.vAlign) {\r\n            case 'top': vAlign = 'align-items-start'; break;\r\n            default:\r\n            case 'center': vAlign = 'align-items-center'; break;\r\n            case 'bottom': vAlign = 'align-items-end'; break;\r\n            case 'stretch': vAlign = 'align-items-stretch'; break;\r\n        }\r\n        let col:string;\r\n        if (full !== true)\r\n            col = this.col + (label===undefined? '-12':'-9');\r\n        else\r\n            col = 'w-100';\r\n        let cn = className(align, vAlign, col, 'd-flex');\r\n        return <div className={cn}>\r\n            {this.renderPropBody()}\r\n        </div>;\r\n    }\r\n}\r\n","import { PropGridProps } from './PropGrid';\r\nimport {\r\n    PropRow, PropBorder, PropGap, \r\n    StringPropRow, NumberPropRow, ListPropRow, ComponentPropRow\r\n} from './row';\r\n\r\nexport interface Format {\r\n\r\n}\r\n\r\nexport interface PropBase {\r\n    onClick?: () => void;\r\n}\r\n\r\nexport interface LabeledProp extends PropBase {\r\n    label?: string;\r\n    bk?: string;\r\n    vAlign?: 'top' | 'bottom' | 'center' | 'stretch';\r\n}\r\n\r\nexport interface StringProp extends LabeledProp {\r\n    type: 'string';\r\n    name: string;\r\n}\r\n\r\nexport interface NumberProp extends LabeledProp {\r\n    type: 'number';\r\n    name: string;\r\n\tisInt: boolean;\t\t// 整数\r\n\ttime: boolean;\t\t// 字段log的time可以客户端输入\r\n}\r\n\r\nexport interface FormatProp extends LabeledProp {\r\n    type: 'format';\r\n    format: Format;\r\n}\r\n\r\nexport interface ListProp extends LabeledProp {\r\n    type: 'list';\r\n    list: string | any[];  // string 表示名字，否则就是值\r\n    row: new (props: any) => React.Component;\r\n}\r\n\r\nexport interface ComponentProp extends LabeledProp {\r\n    type: 'component';\r\n    full?: boolean;\r\n    component: any; //JSX.Element;\r\n}\r\n\r\nexport type Prop = StringProp | NumberProp | FormatProp | ListProp | ComponentProp | string;\r\n\r\nexport class PropView {\r\n    private gridProps: PropGridProps\r\n    private props: Prop[];\r\n    //private values:any;\r\n    private rows: PropRow[];\r\n\r\n    constructor(gridProps: PropGridProps, props: Prop[]) {\r\n        this.gridProps = gridProps;\r\n        this.props = props;\r\n        //this.values = values;\r\n        this.buildRows();\r\n    }\r\n\r\n    private buildRows() {\r\n        this.rows = [];\r\n        let isGap: boolean = true;\r\n        for (let prop of this.props) {\r\n            if (typeof prop === 'string') {\r\n                this.rows.push(new PropGap(prop));\r\n                isGap = true;\r\n            }\r\n            else {\r\n                if (!isGap) this.rows.push(new PropBorder());\r\n                let row;\r\n                switch (prop.type) {\r\n                    default: continue;\r\n                    case 'string': row = new StringPropRow(this.gridProps, prop); break;\r\n                    case 'number': row = new NumberPropRow(this.gridProps, prop); break;\r\n                    case 'list': row = new ListPropRow(this.gridProps, prop); break;\r\n                    case 'component': row = new ComponentPropRow(this.gridProps, prop); break;\r\n                }\r\n                this.rows.push(row);\r\n                isGap = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    setValues(values: any) {\r\n        for (let r of this.rows) r.setValues(values);\r\n    }\r\n\r\n    render() {\r\n        return this.rows.map((row, index) => row.render(String(index)));\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport {observer} from 'mobx-react';\r\nimport {Prop, PropView} from './propView';\r\n\r\nexport interface PropGridProps {\r\n    className?: string;\r\n    rows: Prop[];\r\n    values: any;\r\n    alignValue?: 'left'|'center'|'right';\r\n    labelFixLeft?: boolean;\r\n}\r\n\r\n@observer\r\nexport class PropGrid extends React.Component<PropGridProps> {\r\n    render() {\r\n        let {className, rows, values} = this.props;\r\n        let propView = new PropView(this.props, rows);\r\n        propView.setValues(values);\r\n        let cn = classNames('container-fluid', className);\r\n        return <div className={cn}>\r\n            {propView.render()}\r\n        </div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { nav } from '../nav';\r\nimport { observer } from 'mobx-react';\r\nimport { observable } from 'mobx';\r\nimport { User, userApi } from 'tonva-core';\r\n\r\nexport type UserLoader = (userId:number)=>Promise<any>;\r\n\r\nexport class UserCache<T> {\r\n\tprivate loader: UserLoader;\r\n\tprivate onLoaded: (user:User) => void;\r\n\tprivate map = observable(new Map<number, T|number>());\r\n\r\n\tconstructor(loader: UserLoader) {\r\n\t\tif (loader === undefined) loader = (userId:number)=>userApi.user(userId);\r\n\t\tthis.loader = loader;\r\n\t}\r\n\r\n\tuse(id:number|any, onLoaded?:(user:User)=>void) {\t\t\r\n\t\tif (!id) return;\r\n\t\tif (typeof id === 'object') id = id.id;\r\n\t\tif (!id) return;\r\n\t\tthis.onLoaded = onLoaded;\r\n\t\tid = Number(id);\r\n\t\tlet ret = this.map.get(id);\r\n\t\tif (ret === undefined) {\r\n\t\t\tthis.map.set(id, id);\r\n\t\t}\r\n\t}\r\n\r\n\tgetValue(id:number|any):any {\r\n\t\tif (!id) return;\r\n\t\tswitch (typeof(id)) {\r\n\t\t\tcase 'object': \r\n\t\t\t\tid = id.id; \r\n\t\t\t\tif (!id) return;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t\tlet ret = this.map.get(id);\r\n\t\tif (!ret) return;\r\n\t\tswitch (typeof(ret)) {\r\n\t\tdefault:\r\n\t\t\treturn ret;\r\n\t\tcase 'number':\r\n\t\t\tif (ret < 0) return id;\r\n\t\t\tthis.map.set(id, -id);\r\n\t\t\tthis.loader(id).then(v => {\r\n\t\t\t\tif (!v) v = null;\r\n\t\t\t\tthis.map.set(id, v);\r\n\t\t\t\tif (this.onLoaded) this.onLoaded(v);\r\n\t\t\t}).catch(reason => {\r\n\t\t\t\tconsole.error(reason);\r\n\t\t\t});\r\n\t\t\treturn id;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst userCache = new UserCache(undefined);\r\n\r\nexport interface UserIconProps {\r\n    id: number;\r\n    className?: string;\r\n    style?: React.CSSProperties;\r\n    altImage?: string;\r\n    noneImage?: any;\r\n}\r\n\r\nexport const UserIcon = observer((props: UserIconProps):JSX.Element => {\r\n    let {className, style, id, altImage, noneImage} = props;\r\n    let user = userCache.getValue(id);\r\n    switch (typeof user) {\r\n\tcase 'undefined':\r\n\tcase 'number':\r\n        return <div className={classNames(className, 'image-none')} style={style}>\r\n            {noneImage || <i className=\"fa fa-file-o\" />}\r\n        </div>;\r\n    }\r\n    let {icon} = user;\r\n    if (!icon) {\r\n        return <div className={classNames(className, 'image-none')} style={style}>\r\n            <i className=\"fa fa-file-o\" />\r\n        </div>;\r\n    }\r\n    if (icon.startsWith(':') === true) {\r\n        icon = nav.resUrl + icon.substr(1);\r\n    }\r\n    return <img src={icon} className={className} alt=\"img\"\r\n        style={style}\r\n        onError={evt=>{\r\n            if (altImage) evt.currentTarget.src=altImage;\r\n            else evt.currentTarget.src = 'https://tv.jkchemical.com/imgs/0001.png';\r\n        }} />;\r\n});\r\n\r\nexport interface UserViewProps {\r\n\tid?: number;\r\n\tuser?: number|User;\r\n\trender: (user:User) => JSX.Element;\r\n\tonLoaded?: (user:User) => void\r\n}\r\n\r\nexport const UserView = observer((props: UserViewProps):JSX.Element => {\r\n\tlet {id:idProp, user, render, onLoaded} = props;\r\n\tif (user === null) return <>null</>;\r\n\tswitch (typeof user) {\r\n\t\tcase 'undefined': \r\n\t\t\tuser = userCache.getValue(idProp);\r\n\t\t\tbreak;\r\n\t\tcase 'object': \r\n\t\t\tlet {/*obj, */id} = user as any;\r\n\t\t\t//if (typeof obj !== 'object') {\r\n\t\t\t\tuseUser(id, onLoaded);\r\n\t\t\t\tuser = userCache.getValue(id);\r\n\t\t\t//}\r\n\t\t\tbreak;\r\n\t\tcase 'number':\r\n\t\t\tuseUser(user as number, onLoaded);\r\n\t\t\tuser = userCache.getValue(user as number);\r\n\t\t\tbreak;\r\n\t\tcase 'string':\r\n\t\t\tuseUser(Number(user), onLoaded);\r\n\t\t\tuser = userCache.getValue(Number(user));\r\n\t\t\tbreak;\r\n\t\tdefault:\r\n\t\t\tuser = undefined;\r\n\t\t\tbreak;\r\n\t}\r\n    switch (typeof user) {\r\n\t\tcase 'undefined':\r\n\t\tcase 'number':\r\n        \treturn <>{user}</>;\r\n    }\r\n    return render(user);\r\n});\r\n\r\nexport function useUser(id: number|object, onLoaded?: (user:User)=>void) {\r\n\tif (!id) return;\r\n\tif (typeof(id) === 'object') {\r\n\t\tid = (id as any).id;\r\n\t}\r\n\tuserCache.use(id, onLoaded);\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { Image } from '.';\r\n\r\nexport interface MediaProps {\r\n    icon: string;\r\n    main: string|JSX.Element;\r\n    discription?: string | JSX.Element;\r\n    px?: number;\r\n    py?: number;\r\n}\r\n\r\nexport class Media extends React.Component<MediaProps> {\r\n    render() {\r\n        let {icon, main, discription, px, py} = this.props;\r\n        let disp:any;\r\n        if (typeof discription === 'string')\r\n            disp = <div>{discription}</div>;\r\n        else\r\n            disp = discription;\r\n        let cn = classNames(\r\n            'media', \r\n            px===undefined? 'px-0':'px-'+px, \r\n            py===undefined? 'py-2':'py-'+py);\r\n        return <div className={cn}>\r\n            <Image className=\"me-3 w-4c h-4c\" src={icon} />\r\n            <div className=\"media-body\">\r\n                <h5 className=\"mt-0\">{main}</h5>\r\n                {disp}\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport classNames from 'classnames';\r\nimport { env } from 'tonva-core';\r\n\r\nexport interface SearchBoxProps {\r\n    className?: string;\r\n    label?: string;\r\n    initKey?: string;\r\n    placeholder?: string;\r\n    buttonText?: string;\r\n    maxLength?: number;\r\n    size?: 'sm' | 'md' | 'lg';\r\n    inputClassName?: string;\r\n    onSearch: (key:string)=>Promise<void>;\r\n    onFocus?: ()=>void;\r\n    allowEmptySearch?: boolean;\r\n}\r\n\r\n/*\r\nexport interface SearchBoxState {\r\n    disabled: boolean;\r\n}*/\r\n\r\nexport class SearchBox extends React.Component<SearchBoxProps> { //}, SearchBoxState> {\r\n    private input: HTMLInputElement;\r\n\tprivate button: HTMLButtonElement;\r\n    private key: string = null;\r\n\t\r\n    private onChange = (evt: React.ChangeEvent<any>) => {\r\n        this.key = evt.target.value;\r\n        if (this.key !== undefined) {\r\n            this.key = this.key.trim();\r\n            if (this.key === '') this.key = undefined;\r\n        }\r\n\t\tconsole.log('key = ' + this.key);\r\n        if (this.props.allowEmptySearch === true) {\r\n\t\t}\r\n\t\telse {\r\n            this.button.disabled = this.key === undefined || this.key.length === 0;\r\n        }\r\n    }\r\n    private onSubmit = async (evt: React.FormEvent<any>) => {\r\n        evt.preventDefault();\r\n        if (this.key === null) this.key = this.props.initKey || '';\r\n        if (this.props.allowEmptySearch !== true) {\r\n            if (!this.key) return;\r\n            if (this.input) this.input.disabled = true;\r\n\t\t\tif (this.button) this.button.disabled = true;\r\n        }\r\n        await this.props.onSearch(this.key);\r\n        if (this.input) this.input.disabled = false;\r\n\t\tif (this.button) this.button.disabled = false;\r\n    }\r\n    clear() {\r\n        if (this.input) this.input.value = '';\r\n    }\r\n    render() {\r\n\t\tlet {className, inputClassName, onFocus,\r\n\t\t\tlabel, placeholder, buttonText, maxLength, size} = this.props;\r\n\t\tlet inputSize:string;\r\n\t\tswitch (size) {\r\n\t\t\tdefault:\r\n\t\t\tcase 'sm': inputSize = 'input-group-sm'; break;\r\n\t\t\tcase 'md': inputSize = 'input-group-md'; break;\r\n\t\t\tcase 'lg': inputSize = 'input-group-lg'; break;\r\n\t\t}\r\n\t\tlet autoComplete:string;\r\n\t\tif (env.isMobile === true) autoComplete = 'off';\r\n\t\treturn <form className={className} onSubmit={this.onSubmit} autoComplete={autoComplete}>\r\n\t\t\t<div className={classNames(\"input-group\", inputSize)}>\r\n\t\t\t\t{label && <div className=\"input-group-addon align-self-center me-2\">{label}</div>}\r\n\t\t\t\t<input ref={v=>this.input=v} onChange={this.onChange}\r\n\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\tname=\"key\"\r\n\t\t\t\t\tonFocus={onFocus}\r\n\t\t\t\t\tclassName={classNames('form-control', inputClassName || 'border-primary')}\r\n\t\t\t\t\tplaceholder={placeholder}\r\n\t\t\t\t\tdefaultValue={this.props.initKey}\r\n\t\t\t\t\tmaxLength={maxLength} />\r\n\t\t\t\t<div className=\"input-group-append\">\r\n\t\t\t\t\t<button ref={v=>this.button=v} className=\"btn btn-primary\"\r\n\t\t\t\t\t\ttype=\"submit\"\r\n\t\t\t\t\t\tdisabled={this.props.allowEmptySearch !== true}>\r\n\t\t\t\t\t\t<i className='fa fa-search' />\r\n\t\t\t\t\t\t<i className=\"fa\"/>\r\n\t\t\t\t\t\t{buttonText}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</form>;\t\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport classNames from 'classnames';\r\nimport { nav } from \"../../nav\";\r\n\r\nexport interface AxProps extends React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement> {\r\n\t//children: React.ReactNode;\r\n\t//href: string;\r\n\t//onClick?: (event:React.MouseEvent) => void;\r\n\t//className?: string;\r\n\taClassName?: string;\r\n\tnaClassName?: string;\r\n\t//target?: string;\r\n\t//props?: any;\r\n}\r\n\r\n// 如果是web方式，用webNav方式route网页\r\n// 如果是app方式，用click方式压栈页面\r\nexport const Ax = (axProps: AxProps) => {\r\n\tlet {href, children, className, onClick} = axProps;\r\n\tif (nav.isWebNav === true) {\r\n\t\tlet {aClassName } = axProps;\r\n\t\tif (!href) return <span className=\"text-danger\">Error: href not defined in Ax</span>;\r\n\t\tlet onAxClick = (evt: React.MouseEvent<HTMLAnchorElement>) => {\r\n\t\t\tevt.preventDefault();\r\n\t\t\tlet ret:boolean;\r\n\t\t\tif (onClick) {\r\n\t\t\t\tret = onClick(evt) as unknown as boolean;\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tnav.navigate(href);\r\n\t\t\t\tret = false;\r\n\t\t\t}\r\n\t\t\treturn ret;\r\n\t\t}\r\n\t\treturn <a {...axProps} className={classNames(className, aClassName)} onClick={onAxClick}>{children}</a>;\r\n\t}\r\n\telse {\r\n\t\tlet {naClassName} = axProps;\r\n\t\tif (!onClick) {\r\n\t\t\tonClick = () => {\r\n\t\t\t\tif (nav.openSysPage(href) === false) {\r\n\t\t\t\t\tnav.navigate(href);\r\n\t\t\t   };\r\n\t\t\t   return false;\r\n\t\t   }\r\n\t\t}\r\n\t\treturn <span className={classNames(className, 'cursor-pointer', naClassName)} onClick={onClick}>{children}</span>;\r\n\t}\r\n}\r\n\r\n// 同普通的a tag\r\n// 会自动处理href，处理生产版跟测试版之间的不同\r\nexport const A = (props: React.DetailedHTMLProps<React.AnchorHTMLAttributes<HTMLAnchorElement>, HTMLAnchorElement>) => {\r\n\tlet {children} = props;\r\n\tif (nav.isWebNav === false) {\r\n\t\treturn <a {...props}>{children}</a>;\r\n\t}\r\n\tlet {href} = props;\r\n\t//if (nav.testing === true) href += '#test';\r\n\tlet onClick = (evt: React.MouseEvent<HTMLAnchorElement>) => {\r\n\t\tevt.preventDefault();\r\n\t\tnav.navigate(href);\r\n\t\treturn false;\r\n\t}\r\n\treturn <a {...props} href={href} onClick={onClick}>{children}</a>;\r\n}\r\n","import { action, makeObservable, observable } from \"mobx\";\r\nimport { observer } from \"mobx-react\";\r\nimport React, { Component } from \"react\";\r\nimport { Rule, RuleCustom, RuleRequired } from \"../inputRules\";\r\n\r\nexport interface InputProps {\r\n    className?: string;\r\n    defaultValue?: any;\r\n    disabled?: boolean;\r\n    onValueChange?: (newValue:any, preValue:any, ruleMessage:string) => void;\r\n    required?: boolean;\r\n    containerClassName?: string;\r\n    ruleClassName?: string;\r\n    requiredFlagElement?: JSX.Element;\r\n    rules?: ((value:any) => string[] | string)[];\r\n}\r\n\r\nexport abstract class Input<P extends InputProps, V> extends Component<P> {\r\n    static defaultRequiredFlagElement = <span className=\"mx-2 text-danger\">*</span>;\r\n    static defaultRuleClassName = ' mx-2 text-danger ';\r\n    protected readonly rules: Rule[] = [];\r\n    protected value: V = null;\r\n    protected input: HTMLInputElement;\r\n    protected abstract get type(): 'text' | 'number' | 'checkbox' | 'radio';\r\n    protected get placeholder(): string {return undefined;}\r\n    protected get max(): number {return undefined;}\r\n    protected get min(): number {return undefined;}\r\n    protected get maxLength(): number {return undefined;}\r\n    protected get className(): string {return this.props.className}\r\n    protected requiredFlagElement?: JSX.Element;\r\n    ruleMessage: string = null;\r\n    constructor(props: P) {\r\n        super(props);\r\n        makeObservable(this, {\r\n            ruleMessage: observable,\r\n            onChange: action,\r\n            onFocus: action,\r\n            onBlur: action,\r\n        });\r\n        this.init();\r\n    }\r\n\r\n    private init() {\r\n        let {required, rules, requiredFlagElement, defaultValue} = this.props;\r\n        if (required === true) {\r\n            if (requiredFlagElement === undefined) requiredFlagElement = Input.defaultRequiredFlagElement;\r\n            this.requiredFlagElement = requiredFlagElement;\r\n            this.rules.push(new RuleRequired());\r\n        }\r\n        this.buildRules();\r\n        if (rules) {\r\n            for (let rule of rules) {this.rules.push(new RuleCustom(rule))};\r\n        }\r\n        this.value = defaultValue;\r\n    }\r\n\r\n    protected buildRules() {\r\n    }\r\n\r\n    getValue(): V {return this.value;}\r\n    setValue(v: V) {\r\n        let p = this.value;\r\n        this.value = v;\r\n        this.checkRules();\r\n        let {onValueChange} = this.props;\r\n        if (!onValueChange) return;\r\n        if (v !== p) onValueChange(v, p, this.ruleMessage);\r\n    }\r\n\r\n    render(): JSX.Element {\r\n        let {defaultValue, disabled, required} = this.props;\r\n        let content = <input ref={inp => this.input = inp}\r\n            className={this.className} type={this.type}\r\n            placeholder={this.placeholder}\r\n            defaultValue={defaultValue}\r\n            defaultChecked={defaultValue}\r\n            maxLength={this.maxLength}\r\n            max={this.max}\r\n            min={this.min}\r\n            disabled={disabled}\r\n            onChange={() => this.onChange()}\r\n            onBlur={() => this.onBlur()}\r\n            onFocus={() => this.onFocus()} />;\r\n        if (this.rules.length === 0) return content;\r\n        let {containerClassName, ruleClassName} = this.props;\r\n        return <span className={containerClassName}>\r\n            {required===true && this.requiredFlagElement}\r\n            {content}\r\n            {\r\n                React.createElement(observer(() => {\r\n                    return <span className={ruleClassName ?? Input.defaultRuleClassName}>{this.ruleMessage}</span>\r\n                }))\r\n            }\r\n        </span>;\r\n    }\r\n\r\n    onChange() {\r\n        let preValue = this.value;\r\n        let value = this.value = this.valueFromInput();\r\n        this.checkRules();\r\n        let {onValueChange} = this.props;\r\n        if (!onValueChange) return;\r\n        if (value !== preValue) onValueChange(value, preValue, this.ruleMessage);\r\n    }\r\n\r\n    protected valueFromInput():V {return;}\r\n\r\n    protected checkRules() {\r\n        let defy:string[] = [];\r\n        for (let rule of this.rules) {\r\n            rule.check(defy, this.value);\r\n        }\r\n        if (defy.length === 0) {\r\n            this.ruleMessage = null;\r\n        }\r\n        else {\r\n            this.ruleMessage = defy[0];\r\n        }\r\n    }\r\n\r\n    onBlur() {\r\n        this.checkRules();\r\n    }\r\n\r\n    onFocus() {\r\n        this.ruleMessage = null;\r\n    }\r\n}\r\n","import { RuleInt, RuleNum } from \"../../inputRules\";\r\nimport { Input, InputProps } from \"./../input\";\r\n\r\ninterface InputNumberProps extends InputProps {\r\n    placeholder?: string;\r\n    max?: number;\r\n    min?: number;\r\n}\r\n\r\nexport class InputNumber<P extends InputNumberProps> extends Input<P, number> {\r\n    static defaultClassName = 'form-control w-8c d-inline text-right';\r\n\r\n    protected get type(): 'text' | 'number' | 'checkbox' | 'radio' {return 'number'}\r\n    protected get max(): number {return this.props.max;}\r\n    protected get min(): number {return this.props.min;}\r\n    protected get className(): string {\r\n        let {className} = this.props;\r\n        if (className === null) return null;\r\n        if (!className) return InputNumber.defaultClassName;\r\n        return className;\r\n    }\r\n\r\n    protected buildRules() {\r\n        let {max, min} = this.props;\r\n        this.rules.push(new RuleNum(undefined, min, max));\r\n    }\r\n\r\n    protected parseValue(): number {\r\n        return Number.parseFloat(this.input.value);\r\n    }\r\n\r\n    protected valueFromInput(): number {\r\n        let v = this.parseValue();\r\n        if (isNaN(v) === true) return undefined;\r\n        return v;\r\n    }\r\n}\r\n\r\nexport interface InputIntegerProps extends InputNumberProps {\r\n}\r\n\r\nexport class InputInteger<P extends InputIntegerProps> extends InputNumber<P> {\r\n    protected buildRules() {\r\n        let {max, min} = this.props;\r\n        this.rules.push(new RuleInt(undefined, min, max));\r\n    }\r\n\r\n    protected parseValue(): number {\r\n        return Number.parseInt(this.input.value);\r\n    }\r\n}\r\n","import { Input, InputProps } from \"../input\";\r\n\r\nexport interface InputCheckBoxProps extends InputProps {\r\n}\r\n\r\nexport class InputCheckBox extends Input<InputCheckBoxProps, boolean> {\r\n    static defaultClassName = 'form-check-input p-2';\r\n\r\n    protected get type(): 'text' | 'number' | 'checkbox' | 'radio' {return 'checkbox'}\r\n    protected get className(): string {\r\n        let {className} = this.props;\r\n        if (className === null) return null;\r\n        if (!className) return InputCheckBox.defaultClassName;\r\n        return className;\r\n    }\r\n\r\n    protected valueFromInput(): boolean {\r\n        return this.input.checked;\r\n    }\r\n    onBlur() {}\r\n    onFocus() {}\r\n    setValue(v: boolean) {\r\n        super.setValue(v);\r\n        this.input.checked = v;\r\n    }\r\n}\r\n","import fs from 'fs';\r\nimport { capitalCase } from \"../tool\";\r\nimport { UqMan } from \"../uqCore\";\r\nimport { BuildContext } from './context';\r\n\r\nexport const red = '\\x1b[41m%s\\x1b[0m';\r\nexport let lastBuildTime:number = 0;\r\n//export const uqTsSrcPath = 'src/UqApp';\r\n\r\nexport function saveSrcTsFileIfNotExists(context:BuildContext, fileName:string, suffix:string, content:string) {\r\n\tlet tsFilePath = `${context.uqTsSrcPath}/${fileName}.${suffix}`;\r\n\tsaveTsFileIfNotExists(tsFilePath, content);\r\n\t//if (fs.existsSync(tsFile) === true) return;\r\n\t//saveTsFile(fileName, content, suffix);\r\n}\r\nexport function saveTsFile(context:BuildContext, fileName:string, content:string, suffix:string = 'ts') {\r\n\tlet {uqTsSrcPath} = context;\r\n\tlet srcFile = `${uqTsSrcPath}/${fileName}.${suffix}.txt`;\r\n\tlet tsFile = `${uqTsSrcPath}/${fileName}.${suffix}`;\r\n\tif (!fs.existsSync(srcFile)) {\r\n\t\tif (fs.existsSync(tsFile)) {\r\n\t\t\tfs.renameSync(tsFile, srcFile);\r\n\t\t}\r\n\t}\r\n\tfs.writeFileSync(tsFile, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${tsFile} is built`);\r\n}\r\nexport function overrideTsFile(path:string, content:string) {\r\n\t//let tsFile = `${path}/${fileName}.${suffix}`;\r\n\tfs.writeFileSync(path, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${path} is built`);\r\n}\r\n//fileName:string, \r\n//, suffix:string = 'ts'\r\nexport function saveTsFileIfNotExists(tsFilePath:string, content:string) {\r\n\t//let tsFilePath = `${path}/${fileName}.${suffix}`;\r\n\tif (fs.existsSync(tsFilePath) === true) return;\r\n\toverrideTsFile(tsFilePath, content);\r\n}\r\n\r\n/*\r\nfunction createTsFile(path:string, fileName:string, content:string, suffix:string = 'ts') {\r\n\tlet tsFile = `${path}/${fileName}.${suffix}`;\r\n\tif (fs.existsSync(tsFile) === true) return;\r\n\tfs.writeFileSync(tsFile, content);\r\n\tlastBuildTime = Date.now();\r\n\tconsole.log(red, `${tsFile} is built`);\r\n}\r\n*/\r\nexport function buildTsHeader() {\r\n\treturn `//=== UqApp builder created on ${new Date()} ===//`;\r\n}\r\n\r\nexport function entityName(s:string):string {\r\n\treturn capitalCase(s);\r\n}\r\n\r\nexport function getNameFromUq(uqMan:UqMan):{devName:string; uqName:string} {\r\n\tlet {config} = uqMan;\r\n\tlet devPart:string, uqPart:string;\r\n\tif (config) {\r\n\t\tlet {dev, name, alias} = config;\r\n\t\tlet {name:devName, alias:devAlias} = dev;\r\n\t\tdevPart = devAlias || devName;\r\n\t\tuqPart = alias || name;\r\n\t}\r\n\telse {\r\n\t\tlet {uqOwner, uqName} = uqMan;\r\n\t\tdevPart = uqOwner;\r\n\t\tuqPart = uqName;\r\n\t}\r\n\treturn {\r\n\t\tdevName: capitalCase(devPart),\r\n\t\tuqName: capitalCase(uqPart),\r\n\t};\r\n}\r\n","import * as React from 'react';\r\nimport { Page, Image, UserView } from '../components';\r\nimport { env, User } from 'tonva-core';\r\nimport { Controller } from './controller';\r\nimport { VPage } from './vpage';\r\n\r\nexport abstract class View<C extends Controller> {\r\n    protected controller: C;\r\n    protected readonly res: any;\r\n\tprotected readonly x: any;\r\n\tprotected readonly t: (str:string)=>any;\r\n\r\n    constructor(controller: C) {\r\n        this.controller = controller;\r\n\t\tthis.t = controller.t;\r\n    }\r\n\r\n\tprotected get isDev() {return  env.isDevelopment}\r\n\tget isWebNav(): boolean {return this.controller.isWebNav}\r\n\tnavigate(url:string) {this.controller.navigate(url)}\r\n\tprotected isMe(id:any) {return this.controller.isMe(id)}\r\n    abstract render(param?:any): JSX.Element;\r\n\r\n    protected renderVm(vm: new (controller: C)=>View<C>, param?:any) {\r\n        return (new vm(this.controller)).render(param);\r\n    }\r\n\r\n    protected async openVPage(vp: new (controller: C)=>VPage<C>, param?:any, afterBack?:()=>Promise<void>):Promise<void> {\r\n        await (new vp(this.controller)).open(param, afterBack);\r\n    }\r\n\r\n    protected async event(type:string, value?:any) {\r\n        await this.controller.event(type, value);\r\n\t}\r\n\t\r\n\tprotected go(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tthis.controller.go(showPage, url, absolute);\r\n\t}\r\n\r\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\r\n        return await this.controller.vCall(vp, param);\r\n    }\r\n\r\n    protected returnCall(value:any) {\r\n        this.controller.returnCall(value);\r\n    }\r\n\r\n\tprotected renderUser(user:any, imageClassName?:string, textClassName?:string) {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick, icon} = user;\r\n\t\t\treturn <>\r\n\t\t\t\t<Image src={icon} className={imageClassName || 'w-1c h-1c me-2'} />\r\n\t\t\t\t<span className={textClassName}>{nick || name}</span>\r\n\t\t\t</>;\r\n\t\t}\r\n\t\treturn <UserView user={user} render={renderUser} />\r\n\t}\r\n\r\n\tprotected renderUserText(user:any) {\r\n\t\tlet renderUser = (user:User) => {\r\n\t\t\tlet {name, nick} = user;\r\n\t\t\treturn <>{nick || name}</>;\r\n\t\t}\r\n\t\treturn <UserView user={user} render={renderUser} />\r\n\t}\r\n\r\n\tprotected renderMe(imageClassName?:string, textClassName?:string) {\r\n\t\tlet {user} = this.controller;\r\n\t\tif (!user) return;\r\n\t\treturn this.renderUser(user.id, imageClassName, textClassName);\r\n\t}\r\n\r\n    protected openPage(view: React.StatelessComponent<any>, param?:any, onClosePage?:(ret:any)=>void) {\r\n        let type = typeof param;\r\n        if (type === 'object' || type === 'undefined') {\r\n            this.controller.openPage(React.createElement(view, param), onClosePage);\r\n        }\r\n        else {\r\n            this.controller.openPage(<Page header=\"param type error\">\r\n                View.openPage param must be object, but here is {type}\r\n            </Page>, onClosePage);\r\n        }\r\n    }\r\n\r\n    protected replacePage(view: React.StatelessComponent<any>, param?:any) {\r\n        this.controller.replacePage(React.createElement(view, param));\r\n    }\r\n\r\n    protected openPageElement(page: JSX.Element, onClosePage?: ()=>void) {\r\n        this.controller.openPage(page, onClosePage);\r\n    }\r\n\r\n    protected replacePageElement(page: JSX.Element, onClosePage?: ()=>void) {\r\n        this.controller.replacePage(page, onClosePage);\r\n    }\r\n\r\n    protected backPage() {\r\n        this.controller.backPage();\r\n    }\r\n\r\n    protected closePage(level?:number) {\r\n        this.controller.closePage(level);\r\n    }\r\n\r\n    protected ceasePage(level?:number) {\r\n        this.controller.ceasePage(level);\r\n    }\r\n\r\n    protected removeCeased() {\r\n        this.controller.removeCeased();\r\n    }\r\n\r\n    protected regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        this.controller.regConfirmClose(confirmClose);\r\n\t}\r\n\r\n\tprotected popToTopPage() {\r\n\t\tthis.controller.popToTopPage();\r\n\t}\r\n}\r\n","import { Page, Scroller, TabsProps } from \"../components\";\r\nimport { View } from \"./view\";\r\nimport { Controller } from \"./controller\";\r\n\r\nexport abstract class VPage<C extends Controller> extends View<C> {\r\n\tprotected retOnClosePage: any;\r\n\r\n    open(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\r\n\t\tthis.init(param);\r\n\t\tlet _onClosePage: ()=>void;\r\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\r\n\t\tthis.openPageElement(this.renderPage(), _onClosePage);\r\n\t\treturn;\r\n\t}\r\n\r\n    replaceOpen(param?:any, onClosePage?:(ret:any)=>void):Promise<void> {\r\n\t\tthis.init(param);\r\n\t\tlet _onClosePage: ()=>void;\r\n\t\tif (onClosePage !== undefined) _onClosePage = () => onClosePage(this.retOnClosePage);\r\n\t\tthis.replacePageElement(this.renderPage(), _onClosePage);\r\n\t\treturn;\r\n\t}\r\n\r\n\trender(param?:any):JSX.Element {\r\n\t\tthis.init(param);\r\n\t\treturn this.renderPage();\r\n\t}\r\n\r\n\tinit(param?:any):void {return;}\r\n\r\n\theader():string|boolean|JSX.Element {return null;}\r\n\tright():JSX.Element {return null;}\r\n\tcontent():JSX.Element {return null;}\r\n\tfooter():JSX.Element {return null;}\r\n\tlogout(): boolean | (()=>Promise<void>) {return false;}\r\n\tprotected renderPage():JSX.Element {\r\n\t\tlet header = this.header();\r\n\t\tif (!header) header = false;\r\n\t\tlet logout = this.logout();\r\n\t\treturn <Page\r\n\t\t\theader={header} right={this.right()} footer={this.footer()}\r\n\t\t\tonScroll={(e:any)=>this.onPageScroll(e)}\r\n\t\t\tonScrollTop={(scroller: Scroller) => this.onPageScrollTop(scroller)}\r\n\t\t\tonScrollBottom={(scroller: Scroller) => this.onPageScrollBottom(scroller)}\r\n\t\t\tback={this.back}\r\n\t\t\theaderClassName={this.headerClassName}\r\n\t\t\tclassName={this.className}\r\n\t\t\tafterBack={()=>this.afterBack()}\r\n\t\t\ttabsProps={this.tabsProps}\r\n\t\t\tlogout={logout}\r\n\t\t\twebNav={this.controller.pageWebNav}\r\n\t\t>\r\n\t\t\t{this.content()}\r\n\t\t</Page>;\r\n\t}\r\n\r\n\tprotected onPageScroll(e:any) {}\r\n\tprotected async onPageScrollTop(scroller: Scroller): Promise<boolean> {return false;}\r\n\tprotected async onPageScrollBottom(scroller: Scroller): Promise<void> {return;}\r\n\tprotected afterBack():void {}\r\n\tprotected get back(): 'close' | 'back' | 'none' {return 'back'}\r\n\tprotected get headerClassName(): string {return null;}\r\n\tprotected get className(): string {return null;}\r\n\tprotected get tabsProps(): TabsProps {return null;}\r\n}\r\n","import React from 'react';\r\nimport _ from 'lodash';\r\nimport { FA, Page } from '../../components';\r\nimport { Controller } from \"../controller\";\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport interface CStringEditProps {\r\n\tlabel?: string;\r\n\tplaceholder?: string;\r\n\tmaxLength?: number;\r\n\tonValueChange?: (value: string) => Promise<void>;\r\n}\r\n\r\nexport class CStringEdit extends Controller {\r\n\tprivate props: CStringEditProps = {\r\n\t\tlabel: '编辑'\r\n\t}\r\n\tvalue: string = null;\r\n\tnewValue: string = null;\r\n\tisChanged: boolean = null;\r\n\terror: string = null;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tmakeObservable(this, {\r\n\t\t\tvalue: observable,\r\n\t\t\tnewValue: observable,\r\n\t\t\tisChanged: observable,\r\n\t\t\terror: observable,\r\n\t\t});\r\n\t}\r\n\r\n\tprotected async internalStart() {}\r\n\trender(value:string, props?:CStringEditProps) {\r\n\t\tthis.value = value;\r\n\t\tif (props) _.merge(this.props, props);\r\n\t\treturn React.createElement(observer(()=><>{this.renderValue()}{this.renderPencil()}</>))\r\n\t}\r\n\r\n\tprotected renderValue() {return <>{this.value}</>}\r\n\tprotected renderPencil() {\r\n\t\treturn <span onClick={this.onEdit} className=\"cursor-pointer\">\r\n\t\t\t&nbsp; <FA className=\"text-info\" name=\"pencil-square-o\" /> &nbsp;\r\n\t\t</span>;\r\n\t}\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.verifyValue();\r\n\t}\r\n\t\r\n\tprotected verifyValue() {}\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n\t}\r\n\t\r\n\tprivate onEdit = () => {\r\n\t\tlet {label, maxLength, placeholder, onValueChange} = this.props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (this.error === undefined) {\r\n\t\t\t\tthis.value = this.newValue;\r\n\t\t\t\tthis.closePage();\r\n\t\t\t\tif (onValueChange) onValueChange(this.value);\r\n\t\t\t}\r\n\t\t}\r\n        let right = React.createElement(observer(() => <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>));\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\t\tif (evt.keyCode === 13) onSave();\r\n\t\t}\r\n\t\tthis.openPage(<Page header={label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<input type=\"text\"\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\tdefaultValue={this.value}\r\n\t\t\t\t\tmaxLength={maxLength} />\r\n                {\r\n\t\t\t\t\tReact.createElement(observer(()=> placeholder && <div className=\"small muted m-2\">{placeholder}</div>))                    \r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n\t\t</Page>);\r\n\t}\r\n}\r\n","import * as React from 'react';\r\nimport {observer} from 'mobx-react';\r\nimport {PageHeaderProps, renderPageHeader} from './pageHeader';\r\nimport { TabsProps, TabsView } from './tabs';\r\nimport { ScrollProps, ScrollView, PageWebNav, WebNavScrollView } from './scrollView';\r\nimport { nav } from '../../nav';\r\n\r\nexport interface IVPage {\r\n\tcontent():JSX.Element;\r\n\theader():JSX.Element|string;\r\n\tfooter():JSX.Element;\r\n}\r\n\r\nexport interface PageProps extends ScrollProps {\r\n    back?: 'close' | 'back' | 'none';\r\n    header?: boolean | string | JSX.Element;\r\n    right?: JSX.Element;\r\n    footer?: JSX.Element;\r\n    logout?: boolean | (()=>Promise<void>);\r\n\theaderClassName?: string;\r\n\tclassName?: string;\r\n\tafterBack?: () => void;\r\n\ttabsProps?: TabsProps;\r\n\twebNav?: PageWebNav;\r\n}\r\n\r\n@observer\r\nexport class Page extends React.Component<PageProps> {\r\n\tprivate tabsView: TabsView;\r\n    constructor(props: PageProps) {\r\n\t\tsuper(props);\r\n\t\tlet {tabsProps} = props;\r\n\t\tif (tabsProps) {\r\n\t\t\tthis.tabsView = new TabsView(tabsProps);\r\n\t\t}\r\n\t}\r\n\r\n\tprivate renderHeader(webNav?: PageWebNav) {\r\n\t\tconst {back, header, right, headerClassName, afterBack, logout} = this.props;\r\n\t\tif (header === false) return;\r\n\t\t//const {webNav} = this.props;\r\n\t\tlet inWebNav = false;\r\n\t\tlet pageHeaderProps:PageHeaderProps = {\r\n\t\t\tback,\r\n\t\t\tcenter: header as any,\r\n\t\t\tright,\r\n\t\t\tlogout,\r\n\t\t\tclassName: headerClassName,\r\n\t\t\tafterBack,\r\n\t\t};\r\n\t\tif (webNav !== undefined) {\r\n\t\t\tinWebNav = true;\r\n\t\t\tlet {renderPageHeader: rph} = webNav;\r\n\t\t\tif (rph) return rph(pageHeaderProps);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tinWebNav = false;\r\n\t\t}\r\n\t\treturn renderPageHeader(pageHeaderProps, inWebNav);\r\n\t\t/*\r\n\t\tlet pageHeader = header !== false && <PageHeader \r\n\t\t\tback={back} \r\n\t\t\tcenter={header as any}\r\n\t\t\tright={right}\r\n\t\t\tlogout={this.props.logout}\r\n\t\t\tclassName={headerClassName}\r\n\t\t\tafterBack={afterBack}\r\n\t\t\t/>;\r\n\t\treturn pageHeader;\r\n\t\t*/\r\n\t}\r\n\r\n\tprivate renderFooter(webNav?: PageWebNav) {\r\n\t\tconst {footer} = this.props;\r\n\t\tif (!footer) return;\r\n\t\tlet elFooter = <footer>{footer}</footer>;\r\n\t\tif (webNav) return elFooter;\r\n\t\treturn <>\r\n\t\t\t<section className=\"tv-page-footer\">{elFooter}</section>\r\n\t\t\t{elFooter}\r\n\t\t</>;\r\n\t}\r\n\r\n\tcomponentDidCatch(error: Error, errorInfo: React.ErrorInfo) {\r\n\t\t// You can also log the error to an error reporting service\r\n\t\t//logErrorToMyService(error, errorInfo);\r\n\t\tdebugger;\r\n\t}\r\n\t\r\n    render() {\r\n\t\tif (this.tabsView) {\r\n\t\t\treturn React.createElement(this.tabsView.content);\r\n\t\t}\r\n\t\tconst {onScroll, onScrollTop, onScrollBottom, children, className, webNav} = this.props;\r\n\t\tlet pageWebNav:PageWebNav;\r\n\t\tif (!webNav) {\r\n\t\t\tpageWebNav = nav.pageWebNav;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tpageWebNav = webNav;\r\n\t\t}\r\n\t\tlet content = <>\r\n\t\t\t{this.renderHeader(pageWebNav)}\r\n\t\t\t<main>{children}</main>\r\n\t\t\t{this.renderFooter(pageWebNav)}\r\n\t\t</>;\r\n\t\tif (pageWebNav) {\r\n\t\t\treturn <WebNavScrollView\r\n\t\t\t\tonScroll={onScroll}\r\n\t\t\t\tonScrollTop={onScrollTop}\r\n\t\t\t\tonScrollBottom={onScrollBottom}\r\n\t\t\t\tclassName={className}\r\n\t\t\t\twebNav={pageWebNav}\r\n\t\t\t>\r\n\t\t\t\t{content}\r\n\t\t\t</WebNavScrollView>;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn <ScrollView\r\n\t\t\t\tonScroll={onScroll}\r\n\t\t\t\tonScrollTop={onScrollTop}\r\n\t\t\t\tonScrollBottom={onScrollBottom}\r\n\t\t\t\tclassName={className}\r\n\t\t\t>\r\n\t\t\t\t{content}\r\n\t\t\t</ScrollView>;\r\n\t\t}\r\n\t}\r\n}\r\n","import { KeyValueRes, Res } from './res';\r\n\r\nexport interface ListRes extends KeyValueRes {\r\n    none: string;\r\n}\r\n\r\n/*eslint no-template-curly-in-string: 0*/\r\nexport const listRes:Res<ListRes> = {\r\n    _: {\r\n        none: '[none]',\r\n    },\r\n    zh: {\r\n        _: {\r\n            none: '[无]',\r\n        }\r\n    },\r\n}\r\n","import jwtDecode from 'jwt-decode';\r\n\r\nexport interface Unit {\r\n    id: number;\r\n    name: string;\r\n}\r\n\r\nexport interface Guest {\r\n    id: number;             // id = 0\r\n    guest: number;\r\n    token: string;\r\n}\r\n\r\nexport interface User extends Guest {\r\n    id: number;\r\n    name: string;\r\n    nick?: string;\r\n\ticon?: string;\r\n\troles?: {[uq:string]: string[]}\r\n}\r\n\r\nexport function decodeUserToken(token: string): User {\r\n    let ret:any = jwtDecode(token);\r\n    let user: User = {\r\n        id: ret.id,\r\n        name: ret.name,\r\n        guest: ret.guest,\r\n        token: token,\r\n    };\r\n    return user;\r\n}\r\n\r\nexport function decodeGuestToken(token: string): Guest {\r\n    let ret:any = jwtDecode(token);\r\n    let guest: Guest = {\r\n        id: 0,\r\n        guest: ret.guest,\r\n        token: token,\r\n    };\r\n    return guest;\r\n}\r\n","import _ from 'lodash';\r\n\r\nexport interface KeyValueRes {\r\n    [key:string]: any;\r\n}\r\n\r\nexport interface Res<T extends KeyValueRes> {\r\n    [lang:string]: T | {[district:string]: T};\r\n}\r\n\r\nexport const resOptions:{\r\n\tlang: string;\r\n\t$lang: string;\r\n\tdistrict: string;\r\n\t$district: string;\r\n} = {\r\n\tlang: undefined,\r\n\t$lang: undefined,\r\n\tdistrict: undefined,\r\n\t$district: undefined,\r\n}\r\n\r\nexport function setResOptions(lang:string, district:string) {\r\n\tresOptions.lang = lang;\r\n\tresOptions.$lang = '$' + lang;\r\n    resOptions.district = district;\r\n    resOptions.$district = '$' + district;\r\n}\r\n\r\n(function() {\r\n    let lang: string, district: string;\r\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\r\n        || navigator.language; // ||   // All browsers\r\n    //navigator.userLanguage; // IE <= 10\r\n    if (!language) {\r\n        lang = 'zh';\r\n        district = 'CN';\r\n    }\r\n    else {\r\n        let parts = language.split('-');\r\n        lang = parts[0];\r\n        if (parts.length > 1) district = parts[1].toUpperCase();\r\n    }\r\n    setResOptions(lang, district);\r\n}());\r\n\r\nexport function resLang<T extends KeyValueRes>(res:Res<T>):T {\r\n    let {lang, district} = resOptions;\r\n    let ret:T = {} as T;\r\n    if (res === undefined) return ret;\r\n    _.merge(ret, res._);\r\n    let l = res[lang];\r\n    if (l === undefined) return ret;\r\n    _.merge(ret, l._);\r\n    let d = l[district];\r\n    if (d === undefined) return ret;\r\n    _.merge(ret, d);\r\n    let {entity} = ret;\r\n    if (entity !== undefined) {\r\n        for (let i in entity) {\r\n            entity[i.toLowerCase()] = entity[i];\r\n        }\r\n    }\r\n    return ret;\r\n}\r\n\r\nconst resGlobal:any = {};\r\nexport function setRes(target: any, res: any):(str:string)=>any {\r\n\tif (res === undefined) return;\r\n\tlet {$lang, $district} = resOptions;\r\n\t_.merge(target, res);\r\n\tif ($lang !== undefined) {\r\n\t\tlet l = res[$lang];\r\n\t\tif (l !== undefined) {\r\n\t\t\t_.merge(target, l);\r\n\t\t\tlet d = l[$district];\r\n\t\t\tif (d !== undefined) {\r\n\t\t\t\t_.merge(target, d);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn function(str:string) {\r\n\t\treturn target[str] || str;\r\n\t}\r\n}\r\nexport function setGlobalRes(res: any) {\r\n\tsetRes(resGlobal, res);\r\n}\r\nexport function t(str:string):string|JSX.Element {\r\n\treturn resGlobal[str] || str;\r\n}\r\nexport type TFunc = (str:string|JSX.Element) => string|JSX.Element;\r\n","import React from 'react';\r\nimport { PageHeaderProps } from './pageHeader';\r\n\r\nconst scrollAfter = 20; // 20ms之后，scroll执行\r\nexport class Scroller {\r\n    private el: HTMLBaseElement;\r\n    constructor(el: HTMLBaseElement) {\r\n        this.el = el;\r\n    }\r\n\r\n    scrollToTop():void {\r\n        setTimeout(() => this.el.scrollTo(0, 0), scrollAfter);\r\n    }\r\n    scrollToBottom():void {\r\n        setTimeout(() => this.el.scrollTo(0, this.el.scrollTop + this.el.offsetHeight), scrollAfter);\r\n    }\r\n}\r\n\r\nexport interface ScrollProps {\r\n    onScroll?: (e:any) => void;\r\n    onScrollTop?: (scroller: Scroller) => Promise<boolean>;\r\n\tonScrollBottom?: (scroller: Scroller) => Promise<void>;\r\n\tclassName?: string;\r\n}\r\ninterface ScrollViewProps extends ScrollProps {\r\n\tclassName?: string;\r\n\tstyle?: React.CSSProperties;\r\n}\r\nconst scrollTimeGap = 100;\r\nconst scrollEdgeGap = 30;\r\nabstract class ScrollViewBase<T extends ScrollViewProps> extends React.Component<T, null> {\r\n    private bottomTime:number = 0;\r\n\tprivate topTime:number = 0;\r\n\tprivate div: HTMLDivElement;\r\n\r\n\tprotected refDiv = (div:HTMLDivElement) => {\r\n\t\tif (!div) {\r\n\t\t\tif (this.div) {\r\n\t\t\t\tthis.div.removeEventListener('resize', this.onResize)\r\n\t\t\t}\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.div = div;\r\n\t\tthis.div.addEventListener('resize', this.onResize);\r\n\t}\r\n\r\n\tprivate onResize = (ev:UIEvent) => {\r\n\t\tconsole.error('div resize');\r\n\t};\r\n\r\n    protected onScroll = async (e:any) => {\r\n        let {onScroll, onScrollTop, onScrollBottom} = this.props;\r\n        if (onScroll) onScroll(e);\r\n        let el = e.target as HTMLBaseElement;\r\n        let scroller = new Scroller(el);\r\n        if (el.scrollTop < scrollEdgeGap) {\r\n            if (onScrollTop !== undefined) {\r\n                let topTime = new Date().getTime();\r\n                if (topTime-this.topTime > scrollTimeGap) {\r\n                    this.topTime = topTime;\r\n\t\t\t\t\tonScrollTop(scroller).then(ret => {\r\n\t\t\t\t\t\t // has more\r\n\t\t\t\t\t\tif (ret === true) {\r\n\t\t\t\t\t\t\tlet sh = el.scrollHeight;\r\n\t\t\t\t\t\t\tlet top = 200;\r\n\t\t\t\t\t\t\tif (top > sh) top = sh;\r\n\t\t\t\t\t\t\tel.scrollTop = top;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n                }\r\n            }\r\n        }\r\n        if (el.scrollTop + el.offsetHeight > el.scrollHeight - scrollEdgeGap) {\r\n            if (onScrollBottom !== undefined) {\r\n                let bottomTime = new Date().getTime();\r\n                if (bottomTime - this.bottomTime > scrollTimeGap) {\r\n                    this.bottomTime = bottomTime;\r\n                    onScrollBottom(scroller);\r\n                }\r\n            }\r\n        }\r\n    }\r\n    private eachChild(c:any, direct:'top'|'bottom') {\r\n        let { props } = c;\r\n        if (props === undefined)\r\n            return;\r\n        let { children } = props;\r\n        if (children === undefined)\r\n            return;\r\n        React.Children.forEach(children, (child, index) => {\r\n            let {_$scroll} = child as any;\r\n            if (_$scroll) _$scroll(direct);\r\n            console.log(child.toString());\r\n            this.eachChild(child, direct);\r\n        });\r\n\t}\r\n}\r\n\r\nexport class ScrollView extends ScrollViewBase<ScrollViewProps> {\r\n    render() {\r\n\t\tlet {className, style} = this.props;\r\n\t\treturn <div ref={this.refDiv} className=\"tv-page\"\r\n\t\t\tonScroll={this.onScroll} style={style}>\r\n\t\t\t<article className={className}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</article>\r\n\t\t</div>;\r\n    }\r\n}\r\n\r\nexport interface PageWebNav {\r\n\tnavHeader?: JSX.Element; \r\n\tnavRawHeader?: JSX.Element; \r\n\tnavFooter?: JSX.Element; \r\n\tnavRawFooter?: JSX.Element; \r\n\trenderPageHeader?: (props:PageHeaderProps)=>JSX.Element;\r\n}\r\ninterface WebNavScrollViewProps extends ScrollViewProps {\r\n\twebNav: PageWebNav;\r\n}\r\n\r\nexport class WebNavScrollView extends ScrollViewBase<WebNavScrollViewProps> {\r\n    render() {\r\n\t\tlet {className, style, webNav} = this.props;\r\n\t\tlet {navHeader, navRawHeader, navFooter, navRawFooter} = webNav;\r\n\t\tlet vHeader:any, vFooter:any;\r\n\t\tif (navRawHeader) vHeader = navRawHeader;\r\n\t\telse if (navHeader) vHeader = <header><main>{navHeader}</main></header>\r\n\t\tif (navRawFooter) vFooter = navRawFooter;\r\n\t\telse if (navFooter) vFooter = <footer><main>{navFooter}</main></footer>\r\n\r\n\t\treturn <div ref={this.refDiv} className=\"tv-page-webnav\"\r\n\t\t\tonScroll={this.onScroll} style={style}>\r\n\t\t\t{vHeader}\r\n\t\t\t<article className={className}>\r\n\t\t\t\t{this.props.children}\r\n\t\t\t</article>\r\n\t\t\t{vFooter}\r\n\t\t</div>;\r\n    }\r\n}\r\n","import _ from 'lodash';\r\n\r\nclass _LocalStorage {\r\n    getItem(key:string) {\r\n        return localStorage.getItem(key)\r\n    }\r\n    setItem(key:string, value:string) {\r\n        localStorage.setItem(key, value);\r\n    }\r\n    removeItem(key:string) {\r\n        localStorage.removeItem(key);\r\n    }\r\n}\r\n\r\nconst __ls = new _LocalStorage(); // new Ls;\r\n\r\nexport class LocalCache {\r\n    private readonly local: Local;\r\n    //private value: T;\r\n    readonly key: string|number;\r\n\r\n    constructor(local:Local, key:string|number) {\r\n        this.local = local;\r\n        this.key = key;\r\n    }\r\n    get():any {\r\n        try {\r\n            // 下面缓冲的内容不能有，可能会被修改，造成circular引用\r\n            //if (this.value !== undefined) return this.value;\r\n            let text = this.local.getItem(this.key);\r\n            if (text === null) return;\r\n            if (text === undefined) return undefined;\r\n            //return this.value = \r\n            return JSON.parse(text);\r\n        }\r\n        catch (err) {\r\n            this.local.removeItem(this.key);\r\n            return;\r\n        }\r\n    }\r\n    set(value:any) {\r\n\t\tlet t = JSON.stringify(value, (key, value) => {\r\n\t\t\tif (key !== '_tuid') return value;\r\n\t\t});\r\n\t\tthis.local.setItem(this.key, t);\r\n    }\r\n    remove(local?:Local) {\r\n        if (local === undefined) {\r\n            this.local.removeItem(this.key);\r\n        }\r\n        else {\r\n            this.local.removeLocal(local);\r\n        }\r\n    }\r\n    child(key:string|number):LocalCache {\r\n        return this.local.child(key);\r\n    }\r\n    arr(key:string|number):LocalArr {\r\n        return this.local.arr(key);\r\n    }\r\n    map(key:string|number):LocalMap {\r\n        return this.local.map(key);\r\n    }\r\n}\r\n\r\nabstract class Local {\r\n    private readonly caches: {[key:string]:LocalCache};\r\n    private readonly locals: {[key:string]:Local};\r\n    protected readonly name: string;\r\n    constructor(name: string) {\r\n        this.name = name;\r\n        this.caches = {};\r\n        this.locals = {};\r\n    }\r\n\r\n    protected abstract keyForGet(key:string|number):string;\r\n    protected abstract keyForSet(key:string|number):string;\r\n    protected abstract keyForRemove(key:string|number):string;\r\n    abstract removeAll():void;\r\n    getItem(key:string|number):string {\r\n        let k = this.keyForGet(key);\r\n        if (k === undefined) return;\r\n        return __ls.getItem(k);\r\n    }\r\n    setItem(key:string|number, value: string):void {\r\n        let k = this.keyForSet(key);\r\n        __ls.setItem(k, value);\r\n    }\r\n    removeItem(key:string|number):void {\r\n        let k = this.keyForSet(key);\r\n        if (k === undefined) return;\r\n        localStorage.removeItem(k);\r\n    }\r\n    arr(key:string|number):LocalArr {\r\n        let sk = String(key);\r\n        let arr = this.locals[sk] as LocalArr;\r\n        if (arr === undefined) {\r\n            let k = this.keyForSet(key);\r\n            this.locals[sk] = arr = new LocalArr(k);\r\n        }\r\n        return arr;\r\n    }\r\n    map(key:string|number):LocalMap {\r\n        let sk = String(key);\r\n        let map = this.locals[sk] as LocalMap;\r\n        if (map === undefined) {\r\n            let k = this.keyForSet(key);\r\n            this.locals[sk] = map = new LocalMap(k);\r\n        }\r\n        return map;\r\n    }\r\n    removeLocal(local:Local) {\r\n        let sk = local.name;\r\n        let k = this.keyForRemove(sk);\r\n        if (k === undefined) return;\r\n        let arr = this.locals[sk];\r\n        if (arr === undefined) arr = new LocalArr(k);\r\n        else this.locals[sk] = undefined;\r\n        arr.removeAll();\r\n    }\r\n    child(key:string|number):LocalCache {\r\n        let ks = String(key);\r\n        let ret = this.caches[ks];\r\n        if (ret !== undefined) return ret;\r\n        return this.caches[ks] =ret = new LocalCache(this, key);\r\n    }\r\n}\r\n\r\nconst maxArrSize = 500;\r\nexport class LocalArr extends Local {\r\n    private readonly index: number[];\r\n    constructor(name: string) {\r\n        super(name);\r\n        let index = __ls.getItem(this.name);\r\n        this.index = index === null? [] : index.split('\\n').map(v => Number(v));\r\n    }\r\n    private saveIndex() {\r\n        __ls.setItem(this.name, this.index.join('\\n'));\r\n    }\r\n    protected keyForGet(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i < 0) return undefined;\r\n        return `${this.name}.${key}`;\r\n    }\r\n    protected keyForSet(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i<0) {\r\n            this.index.unshift(key);\r\n            if (this.index.length > maxArrSize) this.index.pop();\r\n        }\r\n        else {\r\n            this.index.splice(i, 1);\r\n            this.index.unshift(key)\r\n        }\r\n        this.saveIndex();\r\n        return `${this.name}.${key}`;\r\n    }\r\n    protected keyForRemove(key:number):string {\r\n        let i = _.indexOf(this.index, key);\r\n        if (i<0) return;\r\n        this.index.splice(i, 1);\r\n        this.saveIndex();\r\n        return `${this.name}.${key}`;\r\n    }\r\n    removeAll():void {\r\n        for (let i of this.index) {\r\n            __ls.removeItem(`${this.name}.${i}`);\r\n        }\r\n        __ls.removeItem(this.name);\r\n        this.index.splice(0);\r\n    }\r\n    item(index:number):LocalCache {\r\n        return this.child(index);\r\n    }\r\n}\r\n\r\nexport class LocalMap extends Local {\r\n    private readonly index: {[key:string]:number};\r\n    private max: number;\r\n    constructor(name: string) {\r\n        super(name);\r\n        this.max = 0;\r\n        this.index = {};\r\n        let index = __ls.getItem(this.name);\r\n        if (index !== null) {\r\n            let ls = index.split('\\n');\r\n            ls.forEach(l => {\r\n                let p = l.indexOf('\\t');\r\n                if (p<0) return;\r\n                let key = l.substr(0, p);\r\n                let i = Number(l.substr(p+1));\r\n                if (isNaN(i) === true) return;\r\n                this.index[key] = i;\r\n                if (i>this.max) this.max = i;\r\n            });\r\n        }\r\n    }\r\n    private saveIndex() {\r\n        let ls:string[] = [];\r\n        for (let k in this.index) {\r\n            let v = this.index[k];\r\n            if (v === undefined) continue;\r\n            ls.push(`${k}\\t${v}`);\r\n        }\r\n        __ls.setItem(this.name, ls.join('\\n'));\r\n    }\r\n    protected keyForGet(key:number):string {\r\n        let i = this.index[key];\r\n        if (i === undefined) return undefined;\r\n        return `${this.name}.${i}`;\r\n    }\r\n    protected keyForSet(key:number):string {\r\n        let i = this.index[key];\r\n        if (i === undefined) {\r\n            ++this.max;\r\n            i = this.max;\r\n            this.index[key] = i;\r\n            this.saveIndex();\r\n        }\r\n        return `${this.name}.${i}`;\r\n    }\r\n    protected keyForRemove(key:string|number):string {\r\n        let i = this.index[key];\r\n        if (i===undefined) return;\r\n        this.index[key] = undefined;\r\n        this.saveIndex();\r\n        return `${this.name}.${i}`;\r\n    }\r\n    removeAll():void {\r\n        for (let i in this.index) {\r\n            __ls.removeItem(`${this.name}.${this.index[i]}`);\r\n            this.index[i] = undefined;\r\n        }\r\n        __ls.removeItem(this.name);\r\n        this.max = 0;\r\n    }\r\n    item(key:string):LocalCache {\r\n        return this.child(key);\r\n    }\r\n}\r\n","import _ from 'lodash';\r\nimport { Page, PageHeaderProps, PageWebNav } from '../components';\r\nimport { nav } from '../nav';\r\nimport { resOptions, t } from '../res';\r\nimport { User, env } from 'tonva-core';\r\nimport { VPage } from './vpage';\r\nimport { View } from './view';\r\nimport { messageHub } from 'tonva-core';\r\n\r\nexport interface ConfirmOptions {\r\n    caption?: string;\r\n    message: string | JSX.Element;\r\n    classNames?: string;\r\n    ok?: string;\r\n    yes?: string;\r\n    no?: string;\r\n}\r\n\r\nexport interface WebNav<C extends Controller> {\r\n\tVNavHeader?: new (controller: C) => View<C>;\r\n\tVNavRawHeader?: new (controller: C) => View<C>;\r\n\tVNavFooter?: new (controller: C) => View<C>;\r\n\tVNavRawFooter?: new (controller: C) => View<C>;\r\n\trenderPageHeader?: (props: PageHeaderProps) => JSX.Element;\r\n}\r\n\r\nexport abstract class Controller {\r\n\tprotected res: any = {};\r\n\tt = (str: string): string|JSX.Element => this.internalT(str) || str;\r\n    icon: string|JSX.Element;\r\n    label:string|JSX.Element;\r\n\treadonly isDev:boolean = env.isDevelopment;\r\n\tpageWebNav: PageWebNav;\r\n    get user():User {return nav.user}\r\n    get isLogined():boolean {\r\n        let {user} = nav;\r\n        if (!user) return false;\r\n        return user.id > 0;\r\n    }\r\n\r\n\tprotected beforeInit() {}\r\n\tprotected afterInit() {}\r\n\r\n    internalInit(...param: any[]) {\r\n\t\tthis.beforeInit();\r\n        this.init(...param);\r\n\t\tthis.pageWebNav = this.getPageWebNav();        \r\n\t\tthis.afterInit();\r\n    }\r\n\r\n\tinit(...param: any[]) {\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\treturn this.res?.[str] ?? t(str);\r\n\t}\r\n\r\n\tget webNav(): WebNav<any> {return undefined;}\r\n\r\n\tgetWebNav(): WebNav<any> {return this.webNav;}\r\n\r\n\tgetPageWebNav(): PageWebNav {return undefined;}\r\n\r\n\tget isWebNav(): boolean {return nav.isWebNav}\r\n\tnavigate(url:string) {\r\n\t\tnav.navigate(url);\r\n\t}\r\n\t\r\n\tsetRes(res: any) {\r\n\t\tif (res === undefined) return;\r\n\t\tlet {$lang, $district} = resOptions;\r\n\t\t_.merge(this.res, res);\r\n\t\tif ($lang !== undefined) {\r\n\t\t\tlet l = res[$lang];\r\n\t\t\tif (l !== undefined) {\r\n\t\t\t\t_.merge(this.res, l);\r\n\t\t\t\tlet d = l[$district];\r\n\t\t\t\tif (d !== undefined) {\r\n\t\t\t\t\t_.merge(this.res, d);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\t\t\r\n\t}\r\n\tgetRes():any {return this.res;}\r\n\r\n    private receiveHandlerId:number;\r\n    //private disposer:()=>void;\r\n\r\n    protected dispose = () => {\r\n        // message listener的清理\r\n\t\t//nav.unregisterReceiveHandler(this.receiveHandlerId);\r\n\t\tmessageHub.unregisterReceiveHandler(this.receiveHandlerId);\r\n        this.onDispose();\r\n    }\r\n\r\n    protected onDispose() {\r\n\t}\r\n\t\r\n\tisMe(id:any):boolean {\r\n\t\tif (id === null) return false;\r\n\t\tlet {user} = this;\r\n\t\tlet userId = user.id;\r\n\t\tswitch (typeof id) {\r\n\t\t\tdefault: return false;\r\n\t\t\tcase 'string': return Number(id) === userId;\r\n\t\t\tcase 'number': return id === userId;\r\n\t\t\tcase 'object': return id.id === userId;\r\n\t\t}\r\n\t}\r\n\r\n    protected async openVPage<C extends Controller, P extends VPage<C>>(vp: new (controller: C)=>P, param?:any, afterBack?:(ret:any)=>void):Promise<P> {\r\n\t\tlet ret = new vp((this as any) as C);\r\n\t\tawait ret.open(param, afterBack);\r\n\t\treturn ret;\r\n    }\r\n\r\n    protected async replaceVPage<C extends Controller, P extends VPage<C>>(vp: new (controller: C)=>P, param?:any, afterBack?:(ret:any)=>void):Promise<P> {\r\n\t\tlet ret = new vp((this as any) as C);\r\n\t\tawait ret.replaceOpen(param, afterBack);\r\n\t\treturn ret;\r\n    }\r\n\r\n    protected renderView<C extends Controller, V extends View<C>>(view: new (controller: C)=>V, param?:any):JSX.Element {\r\n\t\tlet v = new view((this as any) as C);\r\n\t\treturn v.render(param);\r\n    }\r\n\r\n    async event(type:string, value:any) {\r\n        await this.onEvent(type, value);\r\n    }\r\n\r\n    protected async onEvent(type:string, value:any) {\r\n    }\r\n\r\n    protected msg(text:string) {\r\n        alert(text);\r\n    }\r\n    protected errorPage(header:string, err:any) {\r\n        this.openPage(<Page header=\"App error!\">\r\n            <pre>\r\n                {typeof err === 'string'? err : err.message}\r\n            </pre>\r\n        </Page>);\r\n    }\r\n\r\n    protected onMessage(message:any):Promise<void> {\r\n        return;\r\n    }\r\n\r\n    private onMessageReceive = async (message:any):Promise<void> => {\r\n        await this.onMessage(message);\r\n    }\r\n\r\n    protected async beforeStart():Promise<boolean> {\r\n        return true;\r\n\t}\r\n\tprotected async afterStart():Promise<void> {\r\n\t}\r\n    protected registerReceiveHandler() {\r\n        this.receiveHandlerId = messageHub.registerReceiveHandler(this.onMessageReceive);\r\n    }\r\n\r\n    protected abstract internalStart(param?:any, ...params:any[]):Promise<void>;\r\n    async start(param?:any, ...params:any[]):Promise<void> {\r\n\t\tthis.registerReceiveHandler();\r\n        let ret = await this.beforeStart();\r\n        if (ret === false) return;\r\n\t\tawait this.internalStart(param, ...params);\r\n\t\tawait this.afterStart();\r\n    }\r\n\r\n    get isCalling():boolean {return this._resolve_$ !== undefined}\r\n\r\n    private _resolve_$:((value:any) => void)[];\r\n    async call<T>(param?:any, ...params:any[]):Promise<T> {\r\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\r\n        return new Promise<T> (async (resolve, reject) => {\r\n            this._resolve_$.push(resolve);\r\n            await this.start(param, ...params);\r\n        });\r\n    }\r\n\r\n    async vCall<C extends Controller>(vp: new (controller: C)=>VPage<C>, param?:any):Promise<any> {\r\n        if (this._resolve_$ === undefined) this._resolve_$ = [];\r\n        return new Promise<any> (async (resolve, reject) => {\r\n            this._resolve_$.push(resolve);\r\n            await (new vp(this as any)).open(param);\r\n        });\r\n    }\r\n\r\n    returnCall(value:any) {\r\n        if (this._resolve_$ === undefined) return;\r\n        let resolve = this._resolve_$.pop();\r\n        if (resolve === undefined) {\r\n            alert('the Controller call already returned, or not called');\r\n            return;\r\n        }\r\n        resolve(value);\r\n    }\r\n\r\n    openPage(page:JSX.Element, onClosePage?: (ret:any)=>void) {\r\n\t\tlet disposer: ()=>void;\r\n\t\tif (onClosePage !== undefined) {\r\n\t\t\tdisposer = () => {\r\n\t\t\t\t//if (this.disposer) this.disposer();\r\n\t\t\t\tonClosePage(undefined);\r\n\t\t\t}\r\n\t\t}\r\n\r\n        nav.push(page, disposer);\r\n        //this.disposer = undefined;\r\n    }\r\n\r\n    replacePage(page:JSX.Element, onClosePage?: ()=>void) {\r\n        nav.replace(page, onClosePage);\r\n        //this.disposer = undefined;\r\n    }\r\n\r\n    backPage() {\r\n        nav.back();\r\n    }\r\n\r\n    closePage(level?:number) {\r\n        nav.pop(level);\r\n    }\r\n\r\n    ceasePage(level?:number) {\r\n        nav.ceaseTop(level);\r\n\t}\r\n\t\r\n\tgo(showPage:()=>void, url:string, absolute?:boolean) {\r\n\t\tnav.go(showPage, url, absolute);\r\n\t}\r\n\r\n    removeCeased() {\r\n        nav.removeCeased();\r\n    }\r\n\r\n    regConfirmClose(confirmClose: ()=>Promise<boolean>) {\r\n        nav.regConfirmClose(confirmClose);\r\n\t}\r\n\r\n\tprivate topPageKey:any;\r\n\tprotected startAction() {\r\n\t\tthis.topPageKey = nav.topKey();\r\n    }\r\n    get TopKey() {\r\n        return this.topPageKey;\r\n    }\r\n    SetTopKey(key:any) {\r\n        this.topPageKey = key;\r\n    }\r\n\tpublic popToTopPage() {\r\n\t\tnav.popTo(this.topPageKey);\r\n\t}\r\n\r\n    async confirm(options: ConfirmOptions): Promise<'ok'|'yes'|'no'|undefined> {\r\n        return new Promise<'ok'|'yes'|'no'|undefined> (async (resolve, reject) => {\r\n            let {caption, message, ok, yes, no, classNames} = options;\r\n            let close = (res:'ok'|'yes'|'no'|undefined) => {\r\n                this.closePage();\r\n                resolve(res);\r\n            }\r\n            let buttons:any[] = [];\r\n            if (ok !== undefined) {\r\n                buttons.push(<button key=\"ok\" className=\"btn btn-primary me-3\" onClick={()=>close('ok')}>{ok}</button>);\r\n            }\r\n            if (yes !== undefined) {\r\n                buttons.push(<button key=\"yes\" className=\"btn btn-success me-3\" onClick={()=>close('yes')}>{yes}</button>);\r\n            }\r\n            if (no !== undefined) {\r\n                buttons.push(<button key=\"no\" className=\"btn btn-outline-danger me-3\" onClick={()=>close('no')}>{no}</button>);\r\n            }\r\n            this.openPage(<Page header={caption || '请确认'} back=\"close\">\r\n                <div className={classNames || \"rounded bg-white m-5 p-3 border\"}>\r\n                    <div className=\"d-flex align-items-center justify-content-center\">\r\n                        {message}\r\n                    </div>\r\n                    <div className=\"mt-3 d-flex align-items-center justify-content-center\">\r\n                        {buttons}\r\n                    </div>\r\n                </div>\r\n            </Page>);\r\n            nav.regConfirmClose(async ():Promise<boolean> => {\r\n                resolve(undefined);\r\n                return true;\r\n            });\r\n        });\r\n    }\r\n}\r\n","import { from62 } from './62';\r\nimport { LocalMap } from './localDb';\r\n\r\nexport const env = (function () {\r\n\tlet {unit, testing, buildingUq, params, lang, district, timeZone, isMobile} = initEnv();\r\n    return {\r\n\t\tunit,\r\n\t\ttesting,\r\n\t\tbuildingUq, \r\n\t\tparams,\r\n\t\tlang, \r\n\t\tdistrict,\r\n\t\ttimeZone,\r\n\t\tbrowser: detectBrowser(), \r\n        isDevelopment: process.env.NODE_ENV === 'development',\r\n\t\tisMobile,\r\n        localDb: new LocalMap(testing===true? '$$':'$'),\r\n        setTimeout: (tag:string, callback: (...args: any[]) => void, ms: number, ...args: any[]):NodeJS.Timer => {\r\n            return global.setTimeout(callback, ms, ...args);\r\n        },\r\n        clearTimeout: (handle:NodeJS.Timer):void => {\r\n            global.clearTimeout(handle);\r\n        },\r\n        setInterval: (callback: (...args: any[]) => void, ms: number, ...args: any[]): NodeJS.Timer => {\r\n            return global.setInterval(callback, ms, ...args);\r\n        },\r\n        clearInterval: (handle:NodeJS.Timer):void => {\r\n            global.clearInterval(handle);\r\n        }\r\n    }\r\n}());\r\n\r\nfunction initEnv(): {\r\n\tunit: number; \r\n\ttesting: boolean; \r\n\tbuildingUq: boolean;\r\n\tparams: {[key:string]: string}; \r\n\tlang: string; \r\n\tdistrict: string;\r\n\ttimeZone: number;\r\n\tisMobile: boolean;\r\n}\r\n{\r\n\tlet pl     = /\\+/g,  // Regex for replacing addition symbol with a space\r\n        search = /([^&=]+)=?([^&]*)/g,\r\n        decode = function (s:any) { return decodeURIComponent(s.replace(pl, \" \")); },\r\n        query  = window.location.search.substring(1);\r\n    let params:{[key:string]:string} = {};\r\n    for (;;) {\r\n\t   let match = search.exec(query);\r\n\t   if (!match) break;\r\n       params[decode(match[1])] = decode(match[2]);\t\r\n\t}\r\n\r\n\tlet testing:boolean; // = isTesting();\r\n\tlet unit:number;\r\n\r\n\tlet sUnit = params['u'] || params['unit'];\r\n\tif (sUnit) {\r\n\t\tlet p = sUnit.indexOf('-');\t\t\r\n\t\tif (p>=0) {\r\n\t\t\tlet tc = sUnit.charCodeAt(p+1);\r\n\t\t\tconst tt = 'tT';\r\n\t\t\ttesting = tc === tt.charCodeAt(0) || tc === tt.charCodeAt(1);\r\n\t\t\tsUnit = sUnit.substr(0, p);\r\n\t\t}\r\n\t\telse {\r\n\t\t\ttesting = false;\r\n\t\t}\r\n\t\tif (sUnit[0] === '0') {\r\n\t\t\tunit = Number(sUnit);\r\n\t\t}\r\n\t\telse {\r\n\t\t\tunit = from62(sUnit);\r\n\t\t}\r\n\t\tif (isNaN(unit) === true) unit = undefined;\r\n\t}\r\n\telse {\r\n\t\t// 下面都是为了兼容以前的操作。\r\n\t\t// 整个url上，只要有test作为独立的字符串出现，就是testing\r\n\t\ttesting = /(\\btest\\b)/i.test(document.location.href);\r\n\t\tlet unitName:string;\r\n\t\tlet el = document.getElementById('unit');\r\n\t\tif (el) {\r\n\t\t\tunitName = el.innerText;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tel = document.getElementById('unit.json');\r\n\t\t\tif (el) {\r\n\t\t\t\tlet json = el.innerHTML;\r\n\t\t\t\tif (json) {\r\n\t\t\t\t\tlet res = JSON.parse(json);\r\n\t\t\t\t\tunitName = res?.unit;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!unitName) {\r\n\t\t\tunitName = process.env.REACT_APP_UNIT;\r\n\t\t}\r\n\r\n\t\tif (unitName) {\r\n\t\t\tunit = Number.parseInt(unitName);\r\n\t\t\tif (Number.isInteger(unit) === false) {\r\n\t\t\t\tif (unitName === '百灵威') {\r\n\t\t\t\t\tunit = 24;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (!unit) unit = 0;\r\n\t}\r\n    let lang: string, district: string;\r\n    let language = (navigator.languages && navigator.languages[0])  // Chrome / Firefox\r\n        || navigator.language; // ||   // All browsers\r\n    //navigator.userLanguage; // IE <= 10\r\n    if (!language) {\r\n        lang = 'zh';\r\n        district = 'CN';\r\n    }\r\n    else {\r\n        let parts = language.split('-');\r\n        lang = parts[0];\r\n        if (parts.length > 1) district = parts[1].toUpperCase();\r\n    }\r\n\tlet timeZone = -new Date().getTimezoneOffset() / 60;\r\n\tconst regEx = new RegExp('Android|webOS|iPhone|iPad|' +\r\n    'BlackBerry|Windows Phone|'  +\r\n    'Opera Mini|IEMobile|Mobile' , \r\n    'i');\r\n\tconst isMobile = regEx.test(navigator.userAgent);\r\n\treturn {unit, testing, buildingUq:false, params, lang, district, timeZone, isMobile};\r\n}\r\n\r\nfunction detectBrowser() { \r\n    if((navigator.userAgent.indexOf(\"Opera\") || navigator.userAgent.indexOf('OPR')) >= 0 )\r\n        return 'Opera';\r\n\tif(navigator.userAgent.indexOf(\"Chrome\") >= 0 )\r\n        return 'Chrome';\r\n\tif(navigator.userAgent.indexOf(\"Safari\") >= 0)\r\n        return 'Safari';\r\n\tif(navigator.userAgent.indexOf(\"Firefox\") >= 0 )\r\n        return 'Firefox';\r\n\tif((navigator.userAgent.indexOf(\"MSIE\") >= 0 ) || (!!(document as any).documentMode === true ))\r\n        return 'IE'; //crap\r\n    return 'Unknown';\r\n}\r\n","import { User } from 'tonva-core';\r\n\r\nexport interface Login {\r\n\tshowLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean):void;\r\n\tshowLogout(callback?: ()=>Promise<void>):void\r\n\t//showRegister():void\r\n\t//showForget():void\r\n\tshowChangePassword():void;\r\n\tshowUserQuit():void;\r\n}\r\n\r\nexport async function createLogin():Promise<Login> {\r\n\tlet importCLogin = await import('../auth/CLogin');\r\n\treturn new importCLogin.CLogin();\r\n}\r\n\r\nexport async function showRegister():Promise<void> {\r\n\tlet importCRegister = await import('../auth/register/CRegister');\r\n\tlet c = new importCRegister.CRegister();\r\n\tc.start();\r\n}\r\n\r\nexport async function showForget():Promise<void> {\r\n\tlet importCRegister = await import('../auth/register/CRegister');\r\n\tlet c = new importCRegister.CForget();\r\n\tc.start();\r\n}\r\n","const ALPHABET = '0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\nconst ID_LENGTH = 8;\r\n\r\nexport function uid():string {\r\n    let len = ALPHABET.length;\r\n    let rtn = '';\r\n    for (let i = 0; i < ID_LENGTH; i++) {\r\n        rtn += ALPHABET.charAt(Math.floor(Math.random() * len));\r\n    }\r\n    return rtn;\r\n}\r\n","const digits = '0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz';\r\nconst c0 = digits.charCodeAt(0);\r\nconst c9 = digits.charCodeAt(9);\r\nconst A = digits.charCodeAt(10);\r\nconst Z = digits.charCodeAt(35);\r\nconst a = digits.charCodeAt(36);\r\nconst z = digits.charCodeAt(61);\r\nexport function from62(v:string):number {\r\n\tif (v === null) return null;\r\n\tif (v === undefined) return undefined;\r\n\tif (typeof v !== 'string') return Number.NaN;\r\n\tlet len = v.length;\r\n\tif (len === 0) return Number.NaN;\r\n\tlet ret = 0;\r\n\tfor (let i=0; i<len; i++) {\r\n\t\tlet c = v.charCodeAt(i);\r\n\t\tlet n:number;\r\n\t\tif (c < c0) return Number.NaN;\r\n\t\tif (c <= c9) {\r\n\t\t\tn = c - c0;\r\n\t\t}\r\n\t\telse if (c < A) {\r\n\t\t\treturn Number.NaN;\r\n\t\t} \r\n\t\telse if (c <= Z) {\r\n\t\t\tn = c - A + 10;\r\n\t\t}\r\n\t\telse if (c < a) {\r\n\t\t\treturn Number.NaN;\r\n\t\t}\r\n\t\telse if (c <= z) {\r\n\t\t\tn = c - a + 36;\r\n\t\t}\r\n\t\telse {\r\n\t\t\treturn Number.NaN;\r\n\t\t}\r\n\t\tret *= 62;\r\n\t\tret += n;\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nexport function to62(v:number):string {\r\n\tif (v === null) return null;\r\n\tif (v === undefined) return undefined;\r\n\tif (typeof v !== 'number') return '';\r\n\tif (v < 0) return '';\r\n\tlet ret = '';\r\n\tfor (;;) {\r\n\t\tret = digits[v % 62] + ret;\r\n\t\tv = Math.floor(v / 62);\r\n\t\tif (v === 0) break;\r\n\t}\r\n\treturn ret;\r\n}\r\n","import * as React from 'react';\r\nimport {nav} from '../../nav';\r\n\r\nexport interface PageHeaderProps {\r\n    back?: 'back' | 'close' | 'none';\r\n    center: string | JSX.Element;\r\n    right?: JSX.Element;\r\n    logout?: boolean | (()=>Promise<void>);\r\n    className?: string;\r\n\tafterBack?: () => void;\r\n\tex?: JSX.Element;\r\n}\r\n\r\nexport function renderPageHeader(props: PageHeaderProps, inWebNav?: boolean) {\r\n    let onBack = async () => {\r\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\r\n\t\tlet {afterBack} = props;\r\n\t\tif (afterBack) afterBack();\r\n    }\r\n    let onLogoutClick = () => {\r\n\t\tlet logout = async () => {\r\n\t\t\tlet {logout} = props;\r\n\t\t\tif (typeof logout === 'function') {\r\n\t\t\t\tawait logout(); \r\n\t\t\t}\r\n\t\t\tawait nav.logout(undefined);\r\n\t\t}\r\n\t\tnav.showLogout(logout);\r\n    }\r\n\r\n\tlet b = nav.level > 1 || window.self !== window.top;\r\n\tlet {back, right, center, logout, className, ex} = props;\r\n\tif (inWebNav === true &&  !back && !right && !center) return;\r\n\tlet vBack:any, debugLogout:any;\r\n\tif (logout !== undefined && window.self === window.top) {\r\n\t\tif ((typeof logout === 'boolean' && logout === true)\r\n\t\t\t|| typeof logout === 'function')\r\n\t\t{\r\n\t\t\tlet {user} = nav;\r\n\t\t\tif (user !== undefined) {\r\n\t\t\t\tlet {nick, name} = user;\r\n\t\t\t\tdebugLogout = <div className=\"d-flex align-items-center\">\r\n\t\t\t\t\t<small className=\"text-light\">{nick || name}</small>\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t// eslint-disable-next-line\r\n\t\t\t\t\t\t<div className=\"ms-2 py-2 px-3 cursor-pointer\"\r\n\t\t\t\t\t\t\trole=\"button\"\r\n\t\t\t\t\t\t\tonClick={onLogoutClick}>\r\n\t\t\t\t\t\t\t<i className=\"fa fa-sign-out fa-lg\" />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tif (b) {\r\n\t\tswitch (props.back) {\r\n\t\t\tcase 'none':\r\n\t\t\t\tvBack = undefined;\r\n\t\t\t\tbreak;\r\n\t\t\tdefault:\r\n\t\t\tcase 'back':\r\n\t\t\t\tvBack = <nav onClick={onBack}>{nav.backIcon}</nav>;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 'close':\r\n\t\t\t\tvBack = <nav onClick={onBack}>{nav.closeIcon}</nav>;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n\tif (window.self !== window.top) {\r\n\t\tconsole.log(document.location.href);\r\n\t\t// pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\r\n\t}\r\n\tif (vBack === undefined && typeof center === 'string') {\r\n\t\tcenter = <div className=\"px-3\">{center}</div>;\r\n\t}\r\n\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\r\n\tlet header = <header className={className}>\r\n\t\t<nav>\r\n\t\t\t{vBack}\r\n\t\t\t{/*pop 弹出window暂时停止作用 */}\r\n\t\t\t<div>{center}</div>\r\n\t\t\t{rightView}\r\n\t\t</nav>\r\n\t\t{ex}\r\n\t</header>;\r\n\tif (inWebNav === true) return header;\r\n\treturn <>\r\n\t\t<section className=\"tv-page-header\">{header}</section>\r\n\t\t{header}\r\n\t</>;\r\n}\r\n\r\nexport class PageHeader extends React.Component<PageHeaderProps> {\r\n\trender() {return renderPageHeader(this.props)}\r\n\t/*\r\n    private back = async () => {\r\n        await nav.back(); // 这个才会显示confirm box，在dataForm里面，如果输入了数据的话\r\n\t\tlet {afterBack} = this.props;\r\n\t\tif (afterBack) afterBack();\r\n    }\r\n    openWindow() {\r\n        window.open(document.location.href);\r\n    }\r\n    private logoutClick = () => {\r\n        nav.showLogout(this.logout);\r\n    }\r\n    private logout = async () => {\r\n        let {logout} = this.props;\r\n        if (typeof logout === 'function') {\r\n            await logout(); \r\n        }\r\n        await nav.logout(undefined);\r\n    }\r\n    render() {\r\n        let b = nav.level > 1 || window.self !== window.top;\r\n        let {right, center, logout, className, ex} = this.props;\r\n        let back:any, debugLogout:any;\r\n        if (logout !== undefined && window.self === window.top) {\r\n            if ((typeof logout === 'boolean' && logout === true)\r\n                || typeof logout === 'function')\r\n            {\r\n                let {user} = nav;\r\n                if (user !== undefined) {\r\n                    let {nick, name} = user;\r\n                    debugLogout = <div className=\"d-flex align-items-center\">\r\n                        <small className=\"text-light\">{nick || name}</small>\r\n                        {\r\n                            // eslint-disable-next-line\r\n                            <div className=\"ms-2 py-2 px-3 cursor-pointer\"\r\n                                role=\"button\"\r\n                                onClick={this.logoutClick}>\r\n                                <i className=\"fa fa-sign-out fa-lg\" />\r\n                            </div>\r\n                        }\r\n                    </div>;\r\n                }\r\n            }\r\n        }\r\n        if (b) {\r\n            switch (this.props.back) {\r\n                case 'none':\r\n                    back = undefined;\r\n                    break;\r\n                default:\r\n                case 'back':\r\n                    back = <nav onClick={this.back}><i className=\"fa fa-angle-left\" /></nav>;\r\n                    break;\r\n                case 'close':\r\n                    back = <nav onClick={this.back}><i className=\"fa fa-close\" /></nav>;\r\n                    break;\r\n            }\r\n        }\r\n        if (window.self !== window.top) {\r\n            console.log(document.location.href);\r\n            // pop = <header onClick={this.openWindow} className=\"mx-1\"><FA name=\"external-link\" /></header>;\r\n        }\r\n        if (back === undefined && typeof center === 'string') {\r\n            center = <div className=\"px-3\">{center}</div>;\r\n        }\r\n\t\tlet rightView = (right || debugLogout) && <aside>{right} {debugLogout}</aside>;\r\n\t\tlet header = <header className={className}>\r\n\t\t\t<nav>\r\n\t\t\t\t{back}\r\n\t\t\t\t<div>{center}</div>\r\n\t\t\t\t{rightView}\r\n\t\t\t</nav>\r\n\t\t\t{ex}\r\n\t\t</header>;\r\n        return <>\r\n\t\t\t<section className=\"tv-page-header\">{header}</section>\r\n\t\t\t{header}\r\n\t\t</>;\r\n\t}\r\n\t*/\r\n}\r\n","import * as React from 'react';\r\nimport { makeObservable, observable, runInAction } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\nimport classNames from 'classnames';\r\nimport { IVPage } from './page';\r\nimport { IObservableValue } from 'mobx';\r\nimport '../../css/va-tab.css';\r\nimport { ScrollView } from './scrollView';\r\n\r\nexport type TabCaption = (selected:boolean) => JSX.Element;\r\n\r\nexport interface TabProp {\r\n    name: string;\r\n    caption: TabCaption;\r\n\tcontent?: () => JSX.Element;\r\n\tpage?: IVPage;\r\n    notify?: IObservableValue<number> | number;\r\n    load?: () => Promise<void>;\r\n\tonShown?: () => Promise<void>;\r\n\tisSelected?: boolean;\r\n\tonScroll?: () => void;\r\n\tonScrollTop?: () => Promise<boolean>;\r\n\tonScrollBottom?: () => Promise<void>;\r\n\tclassName?: string;\r\n}\r\n\r\nexport interface TabsProps {\r\n    tabs: TabProp[];\r\n    tabPosition?: 'top' | 'bottom';\r\n    size?: 'sm' | 'lg' | 'md';\r\n    tabBg?: string;\r\n    contentBg?: string;\r\n    sep?: string;\r\n    selected?: string;\r\n    borderColor?: string;\r\n    borderWidth?: string;\r\n}\r\n\r\nclass Tab {\r\n\tloaded: boolean = false;\r\n\tselected: boolean = false;\r\n\t\r\n    name: string;\r\n    caption: TabCaption;\r\n\tcontentBuilder: ()=>JSX.Element;\r\n\tpage: IVPage;\r\n    notify: IObservableValue<number> | number;\r\n    load?: () => Promise<void>;\r\n\tonShown?: () => Promise<void>;\r\n\tonScroll?: () => void;\r\n\tonScrollTop?: () => Promise<boolean>;\r\n\tonScrollBottom?: () => Promise<void>;\r\n\tclassName?: string;\r\n\r\n\tprivate _content: JSX.Element;\r\n\t\r\n\tconstructor() {\r\n\t\tmakeObservable(this, {\r\n\t\t\tloaded: observable, \r\n\t\t\tselected: observable, \r\n\t\t});\r\n\t}\r\n    \r\n    get content(): JSX.Element {\r\n\t\tif (this.load && this.loaded === false) return null;\r\n\t\tif (this.selected === false) return this._content;\r\n\t\tif (!this._content) {\r\n\t\t\tif (this.contentBuilder !== undefined) {\r\n\t\t\t\tthis._content = this.contentBuilder();\r\n\t\t\t}\r\n\t\t\telse if (this.page !== undefined) {\r\n\t\t\t\tthis._content = this.page.content();\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tthis._content = <div className=\"p-5\">tab 应该定义content或者page</div>;\r\n\t\t\t}\r\n\t\t}\r\n\t\treturn this._content;\r\n    }\r\n\r\n    async shown() {\r\n        if (this.onShown !== undefined) {\r\n            await this.onShown();\r\n        }\r\n        if (this.load !== undefined) {\r\n\t\t\tif (this.loaded === false) {\r\n\t\t\t\tawait this.load();\r\n\t\t\t\trunInAction(() => {\r\n\t\t\t\t\tthis.loaded = true;\r\n\t\t\t\t});\r\n\t\t\t}\r\n        }\r\n    }\r\n}\r\n\r\nexport const TabCaptionComponent = (label:string|JSX.Element, icon:string, color:string) => <div \r\n    className={'d-flex justify-content-center align-items-center flex-column cursor-pointer ' + color}>\r\n    <div><i className={'fa fa-lg fa-' + icon} /></div>\r\n    <small>{label}</small>\r\n</div>;\r\n\r\n//export const TabCaption = TabCaptionComponent;\r\n\r\nexport class TabsView {\r\n\tprivate props: TabsProps;\r\n    private size: string;\r\n    private tabBg: string;\r\n    private sep: string;\r\n    selectedTab: Tab;\r\n    tabArr: Tab[];\r\n\r\n    constructor(props: TabsProps) {\r\n\t\tthis.props = props;\r\n\t\tlet {size, tabs, tabBg: tabBack, sep, selected} = props;\r\n\t\tthis.size = size || 'md';\r\n        this.tabArr = tabs.map(v => {\r\n            let tab = new Tab();\r\n            let {name, caption, content, page, notify, load, onShown, isSelected, onScroll, onScrollTop, onScrollBottom, className} = v;\r\n\t\t\ttab.name = name;\r\n\t\t\tif (isSelected === true || name === selected) {\r\n\t\t\t\tthis.selectedTab = tab;\r\n\t\t\t}\r\n\t\t\ttab.selected = false;\r\n\t\t\ttab.caption = caption;\r\n\t\t\tif (content !== undefined) {\r\n\t\t\t\ttab.contentBuilder = content;\r\n\t\t\t}\r\n\t\t\telse if (page !== undefined) {\r\n\t\t\t\ttab.page = page;\r\n\t\t\t\t//contentBuilder = () => {return page.content()};\r\n\t\t\t}\r\n            tab.notify = notify;\r\n            tab.load = load;\r\n\t\t\ttab.onShown = onShown;\r\n\t\t\ttab.onScroll = onScroll;\r\n\t\t\ttab.onScrollTop = onScrollTop;\r\n\t\t\ttab.onScrollBottom = onScrollBottom;\r\n\t\t\ttab.className = className;\r\n            return tab;\r\n        });\r\n        this.tabBg = tabBack;\r\n        //this.contentBg = contentBack;\r\n        this.sep = sep;\r\n        if (this.selectedTab === undefined) {\r\n\t\t\tthis.selectedTab = this.tabArr[0];\r\n\t\t}\r\n        this.selectedTab.selected = true;\r\n\t\tmakeObservable(this, {\r\n\t\t\tselectedTab: observable, \r\n\t\t\ttabArr: observable,\r\n\t\t});\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabClick(this.selectedTab);\r\n\t\t}, 100);\t\t\r\n    }\r\n\r\n    tabClick = async (tab:Tab) => {\r\n\t\tif (!tab) {\r\n\t\t\ttab = this.selectedTab;\r\n\t\t\tif (tab === undefined) {\r\n\t\t\t\tif (this.tabArr === undefined) return;\r\n\t\t\t\tif (this.tabArr.length === 0) return;\r\n\t\t\t\ttab = this.tabArr[0];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\trunInAction(() => {\r\n\t\t\tthis.selectedTab.selected = false;\r\n\t\t\ttab.selected = true;\r\n\t\t\tthis.selectedTab = tab;\r\n\t\t});\r\n\t\t\r\n\t\tawait tab.shown();\r\n    }\r\n\r\n\tprivate tabs = observer(() => {\r\n        let {tabPosition, borderColor} = this.props;\r\n        let bsCur:React.CSSProperties, bsTab:React.CSSProperties\r\n        if (borderColor) {\r\n            bsCur = {\r\n                borderColor: borderColor,\r\n                borderStyle: 'solid',\r\n                borderTopWidth: 1,\r\n                borderLeftWidth: 1,\r\n                borderRightWidth: 1,\r\n                borderBottomWidth: 1,\r\n            }\r\n            bsTab = {\r\n                borderColor: borderColor,\r\n                borderStyle: 'solid',\r\n                borderTopWidth: 1,\r\n                borderBottomWidth: 1,\r\n                borderLeftWidth: 0,\r\n                borderRightWidth: 0,\r\n\t\t\t\tcursor: 'pointer',\r\n            }\r\n            if (tabPosition === 'top') {\r\n                bsCur.borderBottomWidth = 0;\r\n                bsCur.borderTopLeftRadius = 10;\r\n                bsCur.borderTopRightRadius = 10;\r\n                bsTab.borderTopWidth = 0;\r\n            }\r\n            else {\r\n                bsCur.borderTopWidth = 0;\r\n                bsCur.borderBottomLeftRadius = 10;\r\n                bsCur.borderBottomRightRadius = 10;\r\n                bsTab.borderBottomWidth = 0;\r\n            }\r\n        }\r\n\t\tlet cn = classNames('tv-tabs', this.tabBg, this.sep, 'tv-tabs-' + this.size);\r\n\t\tlet tabs = <div className={cn}>\r\n            {this.tabArr.map((v,index) => {\r\n                let {selected, caption, notify} = v;\r\n                let notifyCircle:any;\r\n                if (notify !== undefined) {\r\n                    let num = typeof notify === 'number'? notify : notify.get();\r\n                    if (num !== undefined) {\r\n                        if (num > 0) notifyCircle = <u>{num>99?'99+':num}</u>;\r\n                        else if (num < 0) notifyCircle = <u className=\"dot\" />;\r\n                    }\r\n                }\r\n                return <div key={index} onClick={()=>this.tabClick(v)} \r\n\t\t\t\t\tstyle={selected===true? bsCur:bsTab}>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t{notifyCircle}\r\n\t\t\t\t\t{caption(selected)}\r\n\t\t\t\t\t</div>\r\n                </div>\r\n            })}\r\n\t\t</div>;\r\n\t\treturn tabs;\r\n\t});\r\n\r\n\tcontent = observer(() => {\r\n\t\tlet displayNone:React.CSSProperties = {visibility: 'hidden'};\r\n\t\treturn <>\r\n\t\t\t{this.tabArr.map((v,index) => {\r\n\t\t\t\tlet {tabPosition} = this.props;\r\n\t\t\t\tlet {content, page, onScroll, onScrollTop, onScrollBottom, className} = v;\r\n\t\t\t\tlet tabs = React.createElement(this.tabs);\r\n\t\t\t\tlet pageHeader:any, pageFooter:any;\r\n\t\t\t\tif (page !== undefined) {\r\n\t\t\t\t\tpageHeader = page.header();\r\n\t\t\t\t\tpageFooter = page.footer();\r\n\t\t\t\t}\r\n\t\t\t\tlet header:any, footer:any;\r\n\t\t\t\tlet visibility:React.CSSProperties = {visibility:'hidden'};\r\n\t\t\t\tif (tabPosition === 'top') {\r\n\t\t\t\t\theader = <>\r\n\t\t\t\t\t\t<section className=\"tv-page-header\">\r\n\t\t\t\t\t\t\t<header>{tabs}{pageHeader}</header>\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t<header style={visibility}>{tabs}{pageHeader}</header>\r\n\t\t\t\t\t</>;\r\n\t\t\t\t\tif (pageFooter !== undefined) {\r\n\t\t\t\t\t\tfooter = <>\r\n\t\t\t\t\t\t\t<footer style={visibility}>{pageFooter}</footer>\r\n\t\t\t\t\t\t\t<section className=\"tv-page-footer\">\r\n\t\t\t\t\t\t\t\t<footer>{pageFooter}</footer>\r\n\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tif (pageHeader !== undefined) {\r\n\t\t\t\t\t\theader = <>\r\n\t\t\t\t\t\t\t<section className='tv-page-header'>\r\n\t\t\t\t\t\t\t\t<header>{pageHeader}</header>\r\n\t\t\t\t\t\t\t</section>\r\n\t\t\t\t\t\t\t<header style={visibility}>{pageHeader}</header>\r\n\t\t\t\t\t\t</>;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tfooter = <>\r\n\t\t\t\t\t\t<footer style={visibility}>{pageFooter}{tabs}</footer>\r\n\t\t\t\t\t\t<section className='tv-page-footer'>\r\n\t\t\t\t\t\t\t<footer>{pageFooter}{tabs}</footer>\r\n\t\t\t\t\t\t</section>\r\n\t\t\t\t\t</>;\r\n\t\t\t\t}\r\n\r\n\t\t\t\tlet style:React.CSSProperties;\r\n\t\t\t\tif (v.selected===false) style = displayNone;\r\n\t\t\t\treturn <ScrollView key={index} className={className}\r\n\t\t\t\t\tstyle={style}\r\n\t\t\t\t\tonScroll={onScroll} onScrollTop={onScrollTop} onScrollBottom={onScrollBottom}>\r\n\t\t\t\t\t{header}\r\n\t\t\t\t\t{content}\r\n\t\t\t\t\t{footer}\r\n\t\t\t\t</ScrollView>;\r\n\t\t\t})}\r\n\t\t</>;\r\n\t});\r\n\r\n    render() {\r\n\t\tlet {tabPosition} = this.props;\r\n\t\tlet tabs = React.createElement(this.tabs);\r\n\t\tlet header:any, footer:any;\r\n\t\tlet visibility:React.CSSProperties = {display:'none'};\r\n\t\tif (tabPosition === 'top') {\r\n\t\t\theader = <header>{tabs}</header>;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfooter = <footer>{tabs}</footer>;\r\n\t\t}\r\n\t\treturn <>\r\n\t\t\t{header}\r\n\t\t\t{this.tabArr.map((v,index) => {\r\n\t\t\t\tlet style:React.CSSProperties;\r\n\t\t\t\tif (v.selected===false) style = visibility;\r\n\t\t\t\treturn <div key={index} className={classNames(v.className)} style={style}>\r\n\t\t\t\t\t{v.content}\r\n\t\t\t\t</div>;\r\n\t\t\t})}\r\n\t\t\t{footer}\r\n\t\t</>;\r\n    }\r\n};\r\n\r\n@observer export class Tabs extends React.Component<TabsProps> {\r\n\tprivate readonly tabsView: TabsView;\r\n    constructor(props: TabsProps) {\r\n\t\tsuper(props);\r\n\t\tthis.tabsView = new TabsView(props);\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabsView.tabClick(undefined);\r\n\t\t}, 100);\r\n\t\t*/\r\n    }\r\n\r\n    render() {\r\n\t\treturn this.tabsView.render();\r\n    }\r\n};\r\n\r\n@observer export class RootTabs extends React.Component<TabsProps> {\r\n\tprivate readonly tabsView: TabsView;\r\n    constructor(props: TabsProps) {\r\n\t\tsuper(props);\r\n\t\tthis.tabsView = new TabsView(props);\r\n\t\t/*\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.tabsView.tabClick(undefined);\r\n\t\t}, 100);\r\n\t\t*/\r\n    }\r\n\r\n    render() {\r\n\t\treturn React.createElement(this.tabsView.content);\r\n    }\r\n};\r\n","//import _ from 'lodash';\r\nimport { KeyValueRes, Res } from './res';\r\n\r\nexport interface InputRes extends KeyValueRes {\r\n    required: string;\r\n    number: string;\r\n    integer: string;\r\n    min: string;\r\n    max: string;\r\n}\r\n\r\n/*eslint no-template-curly-in-string: 0*/\r\nexport const inputRes:Res<InputRes> = {\r\n    _: {\r\n        required: 'required',\r\n        number: 'not valid number',\r\n        integer: 'not valid integer',\r\n        min: 'min value is ${min}',\r\n        max: 'max value is ${max}',\r\n    },\r\n    zh: {\r\n        _: {\r\n            required: '必须填',\r\n            number: '需要数字',\r\n            integer: '需要整数',\r\n            min: '不能小于${min}',\r\n            max: '不能大于${max}',\r\n        }\r\n    },\r\n}\r\n","import { capitalCase } from \"../tool\";\r\nimport { FieldItem, FieldUIType } from \"../ui\";\r\n\r\nexport function buildFieldItem(field:any, isKey:boolean):FieldItem {\r\n\tlet $FieldItemType: string, fieldItemType: string, widget:FieldUIType;\r\n\tlet {name, type} = field;\r\n\tswitch (type) {\r\n\t\tcase 'id':\r\n\t\t\t$FieldItemType = 'FieldItemId';\r\n\t\t\tfieldItemType = 'id';\r\n\t\t\tbreak;\r\n\t\tcase 'char':\r\n\t\t\t$FieldItemType = 'FieldItemString';\r\n\t\t\tfieldItemType = 'string';\r\n\t\t\twidget = 'string';\r\n\t\t\tbreak;\r\n\t\tcase 'smallint':\r\n\t\tcase 'int':\r\n\t\tcase 'bigint':\r\n\t\t\t$FieldItemType = 'FieldItemInt';\r\n\t\t\tfieldItemType = 'integer';\r\n\t\t\twidget = 'updown';\r\n\t\t\tbreak;\r\n\t\tcase 'dec':\r\n\t\tcase 'float':\r\n\t\tcase 'double':\r\n\t\t\t$FieldItemType = 'FieldItemNum';\r\n\t\t\tfieldItemType = 'number';\r\n\t\t\twidget = 'number';\r\n\t\t\tbreak;\r\n\t}\r\n\treturn {\r\n\t\tname,\r\n\t\ttype: fieldItemType,\r\n\t\tisKey,\r\n\t\twidget,\r\n\t\tlabel: capitalCase(name),\r\n\t\t$FieldItemType,\r\n\t} as FieldItem;\r\n}\r\n","import React from 'react';\r\nimport { nav } from '../components';\r\nimport { VPage } from '../vm';\r\nimport { CLogin } from './CLogin';\r\n\r\nexport class VLogout extends VPage<CLogin> {\r\n\tprivate onLogout: ()=>void;\r\n\r\n\tinit(param: any) {\r\n\t\tthis.onLogout = param;\r\n\t}\r\n\theader() {return this.isWebNav === true? false : '安全退出';}\r\n\tfooter() {\r\n\t\treturn <div className=\"mt-5 text-center justify-content-center\">\r\n\t\t\t<button className=\"btn btn-outline-warning\" onClick={nav.resetAll}>升级软件</button>\r\n\t\t</div>;\r\n\t}\r\n\tprotected get back(): 'close' | 'back' | 'none' {return 'close'}\r\n\tcontent() {\r\n\t\treturn <div className=\"m-5 border border-info bg-white rounded-3 p-5 text-center\">\r\n\t\t\t<div>退出当前账号不会删除任何历史数据，下次登录依然可以使用本账号</div>\r\n\t\t\t<div className=\"mt-5 text-center\">\r\n\t\t\t\t<button className=\"btn btn-danger\" onClick={this.onLogout}>安全退出</button>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import {Form, Schema, UiSchema, UiTextItem, UiPasswordItem, Context, UiButton, StringSchema, Ax, nav} from '../components';\r\nimport { tonvaTop, getSender } from './tools';\r\nimport { CLogin } from './CLogin';\r\nimport { VPage } from '../vm';\r\n\r\nconst schema: Schema = [\r\n    {name: 'username', type: 'string', required: true, maxLength: 100} as StringSchema,\r\n    {name: 'password', type: 'string', required: true, maxLength: 100} as StringSchema,\r\n    {name: 'login', type: 'submit'},\r\n];\r\n\r\nexport class VLogin extends VPage<CLogin> {\r\n    private onLogin: (un:string, pwd:string) => Promise<boolean>;\r\n    private withBack: boolean;\r\n\r\n\tinit({onLogin, withBack}:{onLogin: (un:string, pwd:string) => Promise<boolean>; withBack: boolean;}) {\r\n\t\tthis.onLogin = onLogin;\r\n\t\tthis.withBack = withBack;\r\n\t}\r\n\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            username: {placeholder: '手机/邮箱/用户名', label: '登录账号'} as UiTextItem,\r\n            password: {widget: 'password', placeholder: '密码', label: '密码'} as UiPasswordItem,\r\n            login: {widget: 'button', className: 'btn btn-primary btn-block mt-3', label: '登录'} as UiButton,\r\n        }\r\n    }\r\n\r\n    private onSubmit = async (name:string, context:Context):Promise<string> => {\r\n        let values = context.form.data;\r\n        let un = values['username'];\r\n        let pwd = values['password'];\r\n        if (pwd === undefined) {\r\n            return 'something wrong, pwd is undefined';\r\n\t\t}\r\n\t\tlet ret = await this.onLogin(un, pwd);\r\n\t\tif (ret === true) return;\r\n\r\n\t\tlet sender = getSender(un);\r\n\t\tlet type:string = sender !== undefined? sender.caption : '用户名';\r\n\t\treturn type + '或密码错！';\r\n    }\r\n    private onEnter = async (name:string, context:Context):Promise<string> => {\r\n        if (name === 'password') {\r\n            return await this.onSubmit('login', context);\r\n        }\r\n\t}\r\n\r\n\theader() {\r\n        if (this.withBack === true) {\r\n            return '登录';\r\n\t\t}\r\n\t\treturn false;\r\n\t}\r\n\r\n\tcontent() {\r\n        return <div className=\"d-flex p-5 flex-column justify-content-center align-items-center\">\r\n\t\t\t<div className=\"flex-fill\" />\r\n\t\t\t<div className=\"w-20c\">\r\n\t\t\t\t{tonvaTop()}\r\n\t\t\t\t<div className=\"h-2c\" />\r\n\t\t\t\t<Form schema={schema} uiSchema={this.uiSchema} \r\n\t\t\t\t\tonButtonClick={this.onSubmit} \r\n\t\t\t\t\tonEnter={this.onEnter}\r\n\t\t\t\t\trequiredFlag={false} />\r\n\t\t\t\t<div className=\"text-center\">\r\n\t\t\t\t\t<Ax className=\"btn btn-link\" href=\"/forget\">\r\n\t\t\t\t\t\t忘记密码\r\n\t\t\t\t\t</Ax>\r\n\t\t\t\t\t<Ax href=\"/register\" className=\"btn btn-link\">\r\n\t\t\t\t\t\t注册账号\r\n\t\t\t\t\t</Ax>\r\n\t\t\t\t</div>\r\n\t\t\t\t{nav.privacyEntry()}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"flex-fill\" />\r\n\t\t\t<div className=\"flex-fill\" />\r\n\t\t</div>;\r\n    }\r\n}\r\n","import * as React from 'react';\r\nimport { VPage } from '../vm';\r\nimport { Page, Form, ItemSchema, UiSchema, StringSchema, UiPasswordItem, Context, ButtonSchema, UiButton, nav } from '../components';\r\n//import { CenterAppApi } from '../net';\r\nimport { CLogin } from './CLogin';\r\n\r\nexport class VChangePassword extends VPage<CLogin> {\r\n    private schema: ItemSchema[] = [\r\n        {name:'orgPassword', type: 'string', maxLength: 60, required: true} as StringSchema,\r\n        {name:'newPassword', type: 'string', maxLength: 60, required: true} as StringSchema,\r\n        {name:'newPassword1', type: 'string', maxLength: 60, required: true} as StringSchema,\r\n        {name:'submit', type: 'submit'} as ButtonSchema\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            orgPassword: {\r\n                widget: 'password',\r\n                label: '原密码',\r\n                placeholder: '输入原来的密码'\r\n            } as UiPasswordItem,\r\n            newPassword: {\r\n                widget: 'password',\r\n                label: '新密码',\r\n                placeholder: '输入新设的密码'\r\n            } as UiPasswordItem,\r\n            newPassword1: {\r\n                widget: 'password',\r\n                label: '确认密码', \r\n                placeholder: '再次输入新设密码'\r\n            } as UiPasswordItem,\r\n            submit: {\r\n                widget: 'button',\r\n                label: '提交',\r\n                className: 'btn btn-primary'\r\n            } as UiButton,\r\n        }\r\n\t};\r\n\t\r\n\tprivate onChange: (orgPassword:string, newPassword:string) => Promise<boolean>\r\n\tinit(onChange: (orgPassword:string, newPassword:string) => Promise<boolean>) {\r\n\t\tthis.onChange = onChange;\r\n\t}\r\n\r\n    private onSubmit = async (name:string, context: Context):Promise<any> => {\r\n        let {orgPassword, newPassword, newPassword1} = context.data;\r\n        if (newPassword !== newPassword1) {\r\n            context.setError('newPassword1', '新密码错误，请重新输入');\r\n            return;\r\n        }\r\n        //let centerAppApi = new CenterAppApi('tv/', undefined);\r\n\t\t//let ret = await centerAppApi.changePassword({orgPassword, newPassword});\r\n\t\tlet ret = await this.onChange(orgPassword, newPassword);\r\n        if (ret === false) {\r\n            context.setError('orgPassword', '原密码错误');\r\n            return;\r\n        }\r\n        nav.replace(<Page header=\"修改密码\" back=\"close\">\r\n            <div className=\"m-3  text-success\">\r\n                密码修改成功！\r\n            </div>\r\n        </Page>);\r\n        return;\r\n    }\r\n\r\n\theader() {return '修改密码'}\r\n\r\n    content() {\r\n        return <Form\r\n\t\t\tclassName=\"m-3\" \r\n\t\t\tschema={this.schema}\r\n\t\t\tuiSchema={this.uiSchema}\r\n\t\t\tonButtonClick={this.onSubmit}\r\n\t\t\tfieldLabelSize={2} />\r\n    }\r\n}\r\n","import { CLogin } from \"./CLogin\";\r\nimport { VPage } from \"../vm\";\r\nimport { nav } from \"../components\";\r\nimport { CenterAppApi } from \"tonva-core\";\r\n\r\nconst waitingTime = '一小时';\r\n\r\nabstract class VUserQuitBase extends VPage<CLogin> {\r\n    protected abstract get note(): any;\r\n    protected get button1Caption(): string {return;}\r\n    protected get button2Caption(): string {return;}\r\n    protected renderButton1():JSX.Element {\r\n        let caption = this.button1Caption;\r\n        if (caption === null) return null;\r\n        return <button className=\"btn btn-primary\" onClick={() => this.onClickButton1()}>\r\n            {caption??'不注销'}\r\n        </button>;\r\n    }\r\n    protected renderButton2():JSX.Element {\r\n        let caption = this.button2Caption;\r\n        if (caption === null) return null;\r\n        return <button className=\"btn btn-outline-info ms-3\" onClick={() => this.onClickButton2()}>\r\n            {caption??'确认注销'}\r\n        </button>;\r\n    }\r\n    header() {return '注销账号'}\r\n    content() {\r\n        return <div className=\"border border-danger rounded mx-auto m-3 w-max-30c bg-white \">\r\n            <div className=\"p-4 border-bottom\">{this.note}</div>\r\n            <div className=\"p-3 text-center\">\r\n                {this.renderButton1()}\r\n                {this.renderButton2()}\r\n            </div>\r\n        </div>\r\n    }\r\n\r\n    protected onClickButton1() {\r\n        this.closePage();\r\n    }\r\n\r\n    protected onClickButton2() {\r\n    }\r\n}\r\n\r\nexport class VUserQuit extends VUserQuitBase {\r\n    protected get note(): any {\r\n        return <>\r\n        注意：账号注销后，账号绑定手机、邮件等相关信息将被释放。账号无法将登录。<br/>\r\n        请确认！\r\n        </>;\r\n    }\r\n    protected get button2Caption(): string {return '我已了解，仍然注销';}\r\n\r\n    protected onClickButton2() {\r\n        this.openVPage(VQuitConfirm);\r\n    }\r\n}\r\n\r\nclass VQuitConfirm extends VUserQuitBase {\r\n    protected get note(): any {\r\n        return <>\r\n        账号注销后，如果在{waitingTime}内容重新登录账号，账号自动恢复。\r\n        {waitingTime}之后，账号绑定手机、邮件等相关信息将被释放。账号无法将登录。<br/>\r\n        请再次确认！\r\n        </>;\r\n    }\r\n    protected get button2Caption(): string {return '确认注销';}\r\n\r\n    protected onClickButton1() {\r\n        this.closePage(2);\r\n    }\r\n\r\n    protected async onClickButton2() {\r\n        let centerAppApi = new CenterAppApi('tv/', undefined);\r\n        await centerAppApi.userQuit();\r\n        this.openVPage(VQuitDone);\r\n    }\r\n}\r\n\r\nclass VQuitDone extends VUserQuitBase {\r\n    header() {return '注销已账号'}\r\n    protected get back(): 'close' | 'back' | 'none' {return 'none'}\r\n    protected get note(): any {\r\n        return <>\r\n        账号将在{waitingTime}后彻底注销。<br/>\r\n        如果在{waitingTime}内容重新登录账号，注销操作自动取消。\r\n        {waitingTime}之后，账号绑定手机、邮件等相关信息将被释放。账号无法将登录。\r\n        </>;\r\n    }\r\n    protected get button1Caption(): string {return '退出';}\r\n    protected get button2Caption(): string {return null;}\r\n    protected onClickButton1() {\r\n        nav.logout();\r\n    }\r\n}\r\n","import { User } from 'tonva-core';\r\nimport { nav, Login } from '../components';\r\nimport { Controller, VPage } from \"../vm\";\r\nimport { VLogout } from './VLogout';\r\nimport { VLogin } from './VLogin';\r\nimport { CenterAppApi, userApi } from 'tonva-core';\r\nimport { VChangePassword } from './VChangePassword';\r\nimport { VUserQuit } from './VUserQuit';\r\n\r\nexport class CLogin extends Controller implements Login {\r\n\tprotected async internalStart() {\r\n\t}\r\n\r\n\tasync showLogin(callback?: (user:User)=>Promise<void>, withBack?:boolean):Promise<void> {\r\n\t\tlet onLogin = async (un:string, pwd:string):Promise<boolean> => {\r\n\t\t\tlet user = await userApi.login({\r\n\t\t\t\tuser: un,\r\n\t\t\t\tpwd: pwd,\r\n\t\t\t\tguest: nav.guest,\r\n\t\t\t});\r\n\t\r\n\t\t\tif (user === undefined) return false;\r\n\t\t\tconsole.log(\"onLoginSubmit: user=%s pwd:%s\", user.name, user.token);\r\n\t\t\tawait nav.userLogined(user, callback);\r\n\t\t\treturn true;\r\n\t\t}\r\n\t\tthis.openVPage(VLogin, {onLogin, withBack});\r\n    }\r\n\r\n    async showLogout(callback?: ()=>Promise<void>) {\r\n\t\tthis.openVPage(VLogout, () => {\r\n\t\t\tnav.logout(callback);\r\n\t\t});\r\n\t}\r\n\t/*\r\n\tasync showRegister() {\r\n\t\tlet cRegister = new (await import('./register')).CRegister(this.res);\r\n\t\tawait cRegister.start();\r\n\t}\r\n\r\n\tasync showForget() {\r\n\t\tlet cForget = new (await import('./register')).CForget(this.res);\r\n\t\tawait cForget.start();\r\n\t}\r\n\t*/\r\n\r\n\tprotected getVChangePassword():new (cLogin:CLogin) => VPage<CLogin> {\r\n\t\treturn VChangePassword;\r\n\t}\r\n\tasync showChangePassword() {\r\n\t\tlet vPage = this.getVChangePassword();\r\n\t\tthis.openVPage(vPage, async (orgPassword:string, newPassword:string):Promise<boolean> => {\r\n\t\t\tlet centerAppApi = new CenterAppApi('tv/', undefined);\r\n\t\t\tlet ret = await centerAppApi.changePassword({orgPassword, newPassword});\r\n\t\t\treturn ret;\r\n\t\t});\r\n    }\r\n\r\n\tasync showUserQuit():Promise<void> {\r\n\t\tthis.openVPage(VUserQuit);\r\n\t}\r\n}\r\n","export default __webpack_public_path__ + \"static/media/logo.2d27ead7.svg\";","import { mobileRegex, emailRegex } from 'tonva-core';\r\nimport { nav } from '../components';\r\nimport logo from '../img/logo.svg';\r\n\r\nexport function tonvaTop() {\r\n    return nav.loginTop(<div className=\"d-flex align-items-center position-relative\">\r\n        <img className=\"App-logo h-3c position-absolute\" src={logo} alt=\"img\" />\r\n        <div className=\"h3 flex-fill text-center\"><span className=\"text-primary me-3\">同</span>\r\n            <span className=\"text-danger\">花</span>\r\n        </div>\r\n    </div>);\r\n}\r\n\r\ninterface Sender {\r\n    type: string;\r\n    caption: string;\r\n    regex: RegExp;\r\n}\r\n\r\nconst senders:Sender[] = [\r\n    {type:'mobile', caption:'手机号', regex: mobileRegex},\r\n    {type:'email', caption:'邮箱', regex: emailRegex}\r\n];\r\n\r\nexport function getSender(un: string):Sender {\r\n    let sender = senders.find(v => v.regex.test(un) === true);\r\n    return sender;\r\n}","import fs from \"fs\";\r\nimport { capitalCase } from \"../tool\";\r\nimport { FieldItem } from \"../ui\";\r\nimport { Entity, ID, IDX, IX, UqMan } from \"../uqCore\";\r\nimport { buildUQ } from \"./buildUQ\";\r\nimport { buildFieldItem } from \"./fieldItem\";\r\nimport { buildTsHeader, overrideTsFile, saveTsFileIfNotExists } from \"./tools\";\r\n\r\nexport function buildTsUqFolder(uq: UqMan, uqsFolder:string, uqAlias:string) {\r\n\tlet uqFolder = uqsFolder + '/' + uqAlias;\r\n\tif (fs.existsSync(uqFolder) === false) {\r\n\t\tfs.mkdirSync(uqFolder);\r\n\t}\r\n\tlet tsUq = buildTsHeader();\r\n\ttsUq += buildUQ(uq, uqAlias);\r\n\toverrideTsFile(`${uqFolder}/${uqAlias}.ts`, tsUq);\r\n\tsaveTuidAndIDTsIndexAndRender(uqFolder, uq, uqAlias);\r\n}\r\n\r\nfunction saveTuidAndIDTsIndexAndRender(uqFolder:string, uq: UqMan, uqAlias:string) {\r\n\tlet imports = '', sets = '';\r\n\tlet {idArr, idxArr, ixArr, tuidArr} = uq;\r\n\tlet coll:{[name:string]: Entity} = {};\r\n\r\n\tfor (let i of tuidArr) {\r\n\t\tlet {sName} = i;\r\n\t\tcoll[sName.toLowerCase()] = i;\r\n\t\tlet cName = capitalCase(sName);\t\t\r\n\t\tif (cName[0] === '$') continue;\r\n\t\timports += `\\nimport * as ${cName} from './${cName}.ui';`;\r\n\t\tsets += `\\n\tassign(uq, '${cName}', ${cName});`;\r\n\r\n\t\tlet tsUI = `// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { Res, setRes, TFunc } from 'tonva-react';\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { FieldItem, FieldItemNum, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\r\nimport { Tuid${cName} } from \"./${uqAlias}\";\r\n\r\nconst resRaw: Res<any> = {\r\n\t$zh: {\r\n\t},\r\n\t$en: {\r\n\t}\r\n};\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: Tuid${cName}):JSX.Element {\r\n\treturn <>{uqStringify(item)}</>;\r\n};\r\n`;\r\n\r\n\t\tlet path = `${uqFolder}/${cName}.ui.tsx`;\r\n\t\tsaveTsFileIfNotExists(path, tsUI);\r\n\t}\r\n\r\n\tfor (let i of [...idArr, ...idxArr, ...ixArr]) {\r\n\t\tlet {sName} = i;\r\n\t\t//coll[sName.toLowerCase()] = i;\r\n\t\tlet cName = capitalCase(sName);\r\n\t\tif (cName[0] === '$') continue;\r\n\t\tcoll[cName.toLocaleLowerCase()] = i;\r\n\t\timports += `\\nimport * as ${cName} from './${cName}.ui';`;\r\n\t\tsets += `\\n\tassign(uq, '${cName}', ${cName});`;\r\n\r\n\t\tlet tsUI = `// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { UI, FieldItem, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\r\nimport { ${cName} } from \"./${uqAlias}\";\r\n\r\n/*--fields--*/\r\nconst fields = {\r\n};\r\n/*==fields==*/\r\n\r\nconst fieldArr: FieldItem[] = [\r\n];\r\n\r\nexport const ui: UI = {\r\n\tlabel: \"${cName}\",\r\n\tfieldArr,\r\n\tfields,\r\n};\r\n\r\nconst resRaw: Res<any> = {\r\n\t$zh: {\r\n\t},\r\n\t$en: {\r\n\t}\r\n};\r\nconst res: any = {};\r\nsetRes(res, resRaw);\r\n\r\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\r\n\treturn res[str as string] ?? str;\r\n}\r\n\r\nexport function render(item: ${cName}):JSX.Element {\r\n\treturn <>{uqStringify(item)}</>;\r\n};\r\n`;\r\n\r\n\t\tlet path = `${uqFolder}/${cName}.ui.tsx`;\r\n\t\tsaveTsFileIfNotExists(path, tsUI);\r\n\r\n\t\tlet fields = buildFields(i);\r\n\t\tlet tsFieldArr:string = buildFieldArr(i);\r\n\r\n\t\treplaceTsFileFields(path, fields);\r\n\t\tlet tsImportFieldItemsBegin = 'import { FieldItem, ';\r\n\t\tlet tsImportFieldItemsEnd = ' } from \"tonva-react\";';\r\n\t\tlet tsImportFieldItems = 'FieldItemInt, FieldItemNum, FieldItemString, FieldItemId';\r\n\t\treplaceTsFileString(path, \r\n\t\t\t{\r\n\t\t\t\tbegin: tsImportFieldItemsBegin, \r\n\t\t\t\tend: tsImportFieldItemsEnd, \r\n\t\t\t\tcontent: tsImportFieldItemsBegin + tsImportFieldItems + tsImportFieldItemsEnd,\r\n\t\t\t}\r\n\t\t);\r\n\t\treplaceTsFileString(path, \r\n\t\t\t{begin:'\\nconst fieldArr: FieldItem[] = [\\n', end: '\\n];\\n', content:tsFieldArr}\r\n\t\t);\r\n\t}\r\n\r\n\tlet tsIndex = `import { UqExt as Uq, assign } from './${uqAlias}';${imports}\r\n\t\r\nexport function setUI(uq: Uq) {${sets}\r\n}\r\nexport * from './${uqAlias}';\r\n`;\r\n\toverrideTsFile(`${uqFolder}/index.ts`, tsIndex);\r\n\r\n\tlet files = fs.readdirSync(uqFolder);\r\n\tconst suffix = '.ui.tsx';\r\n\tfor (let file of files) {\r\n\t\tif (file.endsWith(suffix) === false) continue;\r\n\t\tlet from = file.length - suffix.length;\r\n\t\tlet fileEntityName = file.substring(0, from);\r\n\t\tlet entity = coll[fileEntityName.toLocaleLowerCase()];\r\n\t\tif (entity === undefined || fileEntityName[0] === '$') {\r\n\t\t\tlet unFile = `${uqFolder}/${file}`;\r\n\t\t\tfs.unlinkSync(unFile);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nfunction buildFields(i:ID|IDX|IX):{[name:string]:FieldItem} {\r\n\tswitch (i.typeName) {\r\n\t\tcase 'id': return buildIDFields(i as ID);\r\n\t\tcase 'idx': return buildIDXFields(i);\r\n\t\tcase 'ix': return buildIXFields(i);\r\n\t}\r\n};\r\n\r\nfunction buildIDFields(ID:ID):{[name:string]:FieldItem} {\r\n\tlet ret:{[name:string]:FieldItem} = {};\r\n\tlet {schema} = ID;\r\n\tlet {keys, fields} = schema;\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tlet isKey = (keys as any[])?.findIndex(v => v.name === name) >= 0;\r\n\t\tret[name] = buildFieldItem(f, isKey);\r\n\t}\r\n\treturn ret;\r\n}\r\nfunction buildIDXFields(IDX:IDX):{[name:string]:FieldItem} {\r\n\tlet ret:{[name:string]:FieldItem} = {};\r\n\tlet {schema} = IDX;\r\n\tlet {keys, fields} = schema;\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tlet isKey = (keys as any[])?.findIndex(v => v.name === name) >= 0;\r\n\t\tret[name] = buildFieldItem(f, isKey);\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\nfunction buildIXFields(IX:IX):{[name:string]:FieldItem} {\r\n\tlet ret:{[name:string]:FieldItem} = {};\r\n\tlet {schema} = IX;\r\n\tlet {keys, fields} = schema;\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tlet isKey = (keys as any[])?.findIndex(v => v.name === name) >= 0;\r\n\t\tret[name] = buildFieldItem(f, isKey);\r\n\t}\r\n\treturn ret;\r\n};\r\n\r\nfunction buildFieldArr(i:ID|IDX|IX):string {\r\n\tlet ts = '\\nconst fieldArr: FieldItem[] = [\\n\\t';\r\n\tswitch (i.typeName) {\r\n\t\tcase 'id': ts += buildIDFieldArr(i as ID); break;\r\n\t\tcase 'idx': ts += buildIDXFieldArr(i); break;\r\n\t\tcase 'ix': ts += buildIXFieldArr(i); break;\r\n\t}\r\n\treturn ts += '\\n];\\n';\r\n}\r\nfunction buildIDFieldArr(i:ID):string {\r\n\tlet {schema} = i;\r\n\tlet ts = '';\r\n\tfor (let f of schema.fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'id') continue;\r\n\t\tts += `fields.${name}, `;\r\n\t}\r\n\treturn ts;\r\n}\r\nfunction buildIDXFieldArr(i:IDX):string {\r\n\tlet {schema} = i;\r\n\tlet ts = '';\r\n\tfor (let f of schema.fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'id') continue;\r\n\t\tts += `fields.${name}, `;\r\n\t}\r\n\treturn ts;\r\n}\r\nfunction buildIXFieldArr(i:IX):string {\r\n\tlet {schema} = i;\r\n\tlet ts = '';\r\n\tfor (let f of schema.fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'ix') continue;\r\n\t\tif (name === 'id') continue;\r\n\t\tts += `fields.${name}, `;\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nfunction replaceTsFileFields(path: string, fields:{[name:string]:FieldItem}) {\r\n\tlet text = fs.readFileSync(path).toString();\r\n\tlet startStr = '\\n/*--fields--*/';\r\n\tlet endStr = '\\n/*==fields==*/\\n';\r\n\tlet start = text.indexOf(startStr);\r\n\tif (start > 0) {\r\n\t\tlet end = text.indexOf(endStr, start + startStr.length);\r\n\t\tif (end > 0) {\r\n\t\t\tlet lBrace = text.indexOf('{', start + startStr.length);\r\n\t\t\tlet rBrace = text.lastIndexOf('}', end);\r\n\t\t\tlet oldText = text.substring(lBrace, rBrace+1);\r\n\t\t\tlet fieldsText = buildFieldsFromOldText(fields, oldText);\r\n\t\t\ttext = text.substring(0, start)\r\n\t\t\t\t+ startStr + '\\nconst fields = {'\r\n\t\t\t\t+ fieldsText\r\n\t\t\t\t+ '\\n};'\r\n\t\t\t\t+ text.substring(end);\r\n\t\t\tfs.writeFileSync(path, text);\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst fieldItemReplaceProps = ['label', 'placeholder', 'widget', 'type'];\r\nfunction buildFieldsFromOldText(fields:{[name:string]:FieldItem}, oldText:string):string {\r\n\tlet ret = '';\r\n\tfor (let i in fields) {\r\n\t\tlet field = fields[i];\r\n\t\tsetFieldOldProp(field, oldText);\r\n\t\tret += buildFieldText(field);\r\n\t}\r\n\treturn ret;\r\n}\r\n\r\nfunction setFieldOldProp(field:FieldItem, text:string) {\r\n\tlet fieldStart = field.name + ':';\r\n\tlet start = text.indexOf('\\t' + fieldStart);\r\n\tif (start < 0) start = text.indexOf('\\n' + fieldStart);\r\n\tif (start < 0) start = text.indexOf(' ' + fieldStart);\r\n\tif (start < 0) return;\r\n\t++start;\r\n\tlet end = text.indexOf('}', start + fieldStart.length);\r\n\tif (end < 0) return;\r\n\tlet fieldText = text.substring(start + fieldStart.length, end + 1);\r\n\t/* eslint no-eval: 0 */\r\n\tlet obj = eval('(' + fieldText + ')');\r\n\tfieldItemReplaceProps.forEach(v => {\r\n\t\tlet prop = obj[v];\r\n\t\tif (!prop) return;\r\n\t\tif (v === 'type') return; // 这个是由新的schema决定的\r\n\t\t(field as any)[v] = prop;\r\n\t});\r\n}\r\n\r\nfunction buildFieldText(field:FieldItem):string {\r\n\tlet {$FieldItemType} = field as any;\r\n\tdelete (field as any).$FieldItemType;\r\n\tlet ret = '\\n\\t' + field.name + ': ';\r\n\tlet json = JSON.stringify(field, null, '\\t\\t');\r\n\tjson = json.replace('}', '\\t}');\r\n\tret += json;\r\n\treturn ret + ' as ' + $FieldItemType + ',';\r\n}\r\n\r\ninterface ReplaceSection {\r\n\tbegin: string;\r\n\tend: string;\r\n\tcontent: string;\r\n};\r\nfunction replaceTsFileString(path:string, sec:ReplaceSection) {\r\n\tlet text = fs.readFileSync(path).toString();\r\n\tlet {begin, end, content} = sec;\r\n\tlet b = text.indexOf(begin);\r\n\tif (b < 0) return;\r\n\tlet e = text.indexOf(end, b + begin.length - 1);\r\n\tif (e < 0) return;\r\n\ttext = text.substring(0, b) + content + text.substr(e + end.length);\r\n\tfs.writeFileSync(path, text);\r\n}\r\n","import { camelCase, capitalCase } from \"../tool\";\r\nimport { UqMan, Action, Book, Query, Sheet\r\n\t, Tuid, UqEnum, Map, History, Pending\r\n\t, Entity, ID, IX, IDX, ArrFields, Field } from '../uqCore';\r\nimport { entityName } from \"./tools\";\r\n\r\nexport function buildUQ(uq:UqMan, uqAlias:string) {\r\n\tlet tsImport = `\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { IDXValue, Uq`;\r\n\tlet ts:string = `\\n\\n`;\r\n\tts += '\\n//===============================';\r\n\tts += `\\n//======= UQ ${uq.name} ========`;\r\n\tts += '\\n//===============================';\r\n\tts += '\\n';\r\n\t\r\n\tuq.enumArr.forEach(v => ts += uqEntityInterface<UqEnum>(v, buildEnumInterface));\r\n\r\n\tuq.tuidArr.forEach(v => ts += uqEntityInterface<Tuid>(v, buildTuidInterface));\r\n    uq.actionArr.forEach(v => ts += uqEntityInterface<Action>(v, buildActionInterface));\r\n    uq.sheetArr.forEach(v => ts += uqEntityInterface<Sheet>(v, buildSheetInterface));\r\n    uq.queryArr.forEach(v => ts += uqEntityInterface<Query>(v, buildQueryInterface));\r\n    uq.bookArr.forEach(v => ts += uqEntityInterface<Book>(v, buildBookInterface));\r\n    uq.mapArr.forEach(v => ts += uqEntityInterface<Map>(v, buildMapInterface));\r\n    uq.historyArr.forEach(v => ts += uqEntityInterface<History>(v, buildHistoryInterface));\r\n    uq.pendingArr.forEach(v => ts += uqEntityInterface<Pending>(v, buildPendingInterface));\r\n\tuq.idArr.forEach(v => ts += uqEntityInterface<ID>(v, buildIDInterface));\r\n\tuq.idxArr.forEach(v => ts += uqEntityInterface<IDX>(v, buildIDXInterface));\r\n\tuq.idxArr.forEach(v => ts += uqEntityInterface<IDX>(v, buildIDXActParamInterface));\t\r\n\tuq.ixArr.forEach(v => ts += uqEntityInterface<IX>(v, buildIXInterface));\r\n\r\n\tts += buildActsInterface(uq);\r\n\r\n\tts += `\r\n\\nexport interface UqExt extends Uq {\r\n\tActs(param:ParamActs): Promise<any>;\r\n`;\r\n\tfunction appendArr<T extends Entity>(arr:T[], type:string, tsBuild: (v:T) => string) {\r\n\t\tif (arr.length === 0) return;\r\n\t\tlet tsLen = ts.length;\r\n\t\tarr.forEach(v => ts += tsBuild(v));\r\n\t\tif (ts.length - tsLen > 0) {\r\n\t\t\ttsImport += ', Uq' + type;\r\n\t\t}\r\n\t}\r\n\tappendArr<Tuid>(uq.tuidArr, 'Tuid', v => uqBlock<Tuid>(v, buildTuid));\r\n\tappendArr<Action>(uq.actionArr, 'Action', v => uqBlock<Action>(v, buildAction));\r\n\tappendArr<Sheet>(uq.sheetArr, 'Sheet', v => uqBlock<Sheet>(v, buildSheet));\r\n\tappendArr<Book>(uq.bookArr, 'Book', v => uqBlock<Book>(v, buildBook));\r\n\tappendArr<Query>(uq.queryArr, 'Query', v => uqBlock<Query>(v, buildQuery));\r\n\tappendArr<Map>(uq.mapArr, 'Map', v => uqBlock<Map>(v, buildMap));\r\n\tappendArr<History>(uq.historyArr, 'History', v => uqBlock<History>(v, buildHistory));\r\n\tappendArr<Pending>(uq.pendingArr, 'Pending', v => uqBlock<Pending>(v, buildPending));\r\n\tappendArr<ID>(uq.idArr, 'ID', v => uqBlock<ID>(v, buildID));\r\n\tappendArr<IDX>(uq.idxArr, 'IDX', v => uqBlock<IDX>(v, buildIDX));\r\n\tappendArr<IX>(uq.ixArr, 'IX', v => uqBlock<IX>(v, buildIX));\r\n\tts += '\\n}\\n';\r\n\tts += `\r\nexport function assign(uq: any, to:string, from:any): void {\r\n\tlet hasEntity = uq.$.hasEntity(to);\r\n\tif (hasEntity === false) {\r\n\t\treturn;\r\n\t}\r\n\tObject.assign((uq as any)[to], from);\r\n}\r\n`;\r\n\t\r\n\ttsImport += ' } from \"tonva-core\";';\r\n\treturn tsImport + ts;\r\n}\r\n\r\nfunction uqEntityInterface<T extends Entity>(entity: T, buildInterface: (entity: T)=>string) {\r\n\tlet {name} = entity;\r\n\tif (name.indexOf('$') > 0) return '';\r\n\tlet entityCode = buildInterface(entity);\r\n\tif (!entityCode) return '';\r\n\treturn '\\n' + entityCode + '\\n';\r\n}\r\n\r\nfunction uqBlock<T extends Entity>(entity: T, build: (entity: T)=>string) {\r\n\tlet {name} = entity;\r\n\tif (name.indexOf('$') > 0) return '';\r\n\tlet entityCode = build(entity);\r\n\tif (!entityCode) return '';\r\n\treturn '\\n' + entityCode;\r\n}\r\n\r\n\r\nfunction buildFields(fields: Field[], isInID:boolean = false, indent:number = 1) {\r\n\tif (!fields) return '';\r\n\tlet ts = '';\r\n\tfor (let f of fields) {\r\n\t\tts += buildField(f, isInID, indent);\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nconst fieldTypeMap:{[type:string]:string} = {\r\n\t\"char\": \"string\",\r\n\t\"text\": \"string\",\r\n\t\"id\": \"number\",\r\n\t\"textid\": \"string\",\r\n\t\"int\": \"number\",\r\n\t\"bigint\": \"number\",\r\n\t\"smallint\": \"number\",\r\n\t\"tinyint\": \"number\",\r\n\t\"dec\": \"number\",\r\n\t\"float\": \"number\",\r\n\t\"double\": \"number\",\r\n};\r\nconst sysFields = ['id', 'main', 'row', 'no', '$create', '$update', '$owner'];\r\nfunction buildField(field: Field, isInID:boolean, indent:number = 1) {\r\n\tlet {name, type} = field;\r\n\tlet s = fieldTypeMap[type];\r\n\tif (!s) s = 'any';\r\n\tlet q:string = (isInID === true && sysFields.indexOf(name) >= 0)? '?' : '';\r\n\treturn `\\n${'\\t'.repeat(indent)}${name}${q}: ${s};`;\r\n}\r\n\r\nfunction buildArrs(arrFields: ArrFields[]):string {\r\n\tif (!arrFields) return '';\r\n\tlet ts = '\\n';\r\n\tfor (let af of arrFields) {\r\n\t\tts += `\\t${camelCase(af.name)}: {`;\r\n\t\tts += buildFields(af.fields, false, 2);\r\n\t\tts += '\\n\\t}[];\\n';\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\n/*\r\nconst typeMap:{[type:string]:string} = {\r\n\taction: 'Action',\r\n\tquery: 'Query',\r\n}\r\n*/\r\nfunction buildReturns(entity:Entity, returns:ArrFields[]):string {\r\n\tif (!returns) return;\r\n\t//let {typeName} = entity;\r\n\t//let type = typeMap[typeName] || typeName;\r\n\tlet {sName} = entity;\r\n\tsName = capitalCase(sName);\r\n\tlet ts = '';\r\n\tfor (let ret of returns) {\r\n\t\tlet retName = capitalCase(ret.name);\r\n\t\tts += `export interface Return${sName}${retName} {`;\r\n\t\tts += buildFields(ret.fields);\r\n\t\tts += '\\n}\\n';\r\n\t}\r\n\r\n\tts += `export interface Result${sName} {\\n`;\r\n\tfor (let ret of returns) {\r\n\t\tlet retName = capitalCase(ret.name);\r\n\t\tts += `\\t${ret.name}: Return${sName}${retName}[];\\n`;\r\n\t}\r\n\tts += '}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildTuid(tuid: Tuid) {\r\n\tlet ts = `\\t${entityName(tuid.sName)}: UqTuid<Tuid${capitalCase(tuid.sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildTuidInterface(tuid: Tuid) {\r\n\tlet ts = `export interface Tuid${capitalCase(tuid.sName)} {`;\r\n\tts += `\\n\\tid?: number;`;\r\n\tts += buildFields(tuid.fields);\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildAction(action: Action) {\r\n\tlet ts = `\\t${entityName(action.sName)}: UqAction<Param${capitalCase(action.sName)}, Result${capitalCase(action.sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildActionInterface(action: Action) {\r\n\tlet ts = `export interface Param${capitalCase(action.sName)} {`;\r\n\tts += buildFields(action.fields);\r\n\tts += buildArrs(action.arrFields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(action, action.returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildEnumInterface(enm: UqEnum) {\r\n\tlet {schema} = enm;\r\n\tif (!schema) return;\r\n\tlet {values} = schema;\r\n\tlet ts = `export enum ${capitalCase(enm.sName)} {`;\r\n\tlet first:boolean = true;\r\n\tfor (let i in values) {\r\n\t\tif (first === false) {\r\n\t\t\tts += ',';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tfirst = false;\r\n\t\t}\r\n\t\tlet v = values[i];\r\n\t\tts += '\\n\\t' + i + ' = ';\r\n\t\tif (typeof v === 'string') {\r\n\t\t\tts += '\"' + v + '\"';\r\n\t\t}\r\n\t\telse {\r\n\t\t\tts += v;\r\n\t\t}\r\n\t}\r\n\treturn ts += '\\n}'\r\n}\r\n\r\nfunction buildQuery(query: Query) {\r\n\tlet {sName} = query;\r\n\tlet ts = `\\t${entityName(sName)}: UqQuery<Param${capitalCase(sName)}, Result${capitalCase(sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildQueryInterface(query: Query) {\r\n\tlet ts = `export interface Param${capitalCase(query.sName)} {`;\r\n\tts += buildFields(query.fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(query, query.returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildSheet(sheet: Sheet) {\r\n\tlet {sName, verify} = sheet;\r\n\tlet cName = capitalCase(sName);\r\n\tlet v = verify? `Verify${cName}` : 'any';\r\n\tlet ts = `\\t${entityName(sName)}: UqSheet<Sheet${cName}, ${v}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildSheetInterface(sheet: Sheet) {\r\n\tlet {sName, fields, arrFields, verify} = sheet;\r\n\tlet ts = `export interface Sheet${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += buildArrs(arrFields);\r\n\tts += '}';\r\n\r\n\tif (verify) {\r\n\t\tlet {returns} = verify;\r\n\t\tts += `\\nexport interface Verify${capitalCase(sName)} {`;\r\n\t\tfor (let item of returns) {\r\n\t\t\tlet {name:arrName, fields} = item;\r\n\t\t\tts += '\\n\\t' + arrName + ': {';\r\n\t\t\tts += buildFields(fields, false, 2);\r\n\t\t\tts += '\\n\\t}[];';\r\n\t\t}\r\n\t\tts += '\\n}';\r\n\t}\r\n\treturn ts;\r\n}\r\n\r\nfunction buildBook(book: Book):string {\r\n\tlet {sName} = book;\r\n\tlet ts = `\\t${entityName(sName)}: UqBook<Param${capitalCase(sName)}, Result${capitalCase(sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildBookInterface(book: Book):string {\r\n\tlet {sName, fields, returns} = book;\r\n\tlet ts = `export interface Param${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(book, returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildMap(map: Map):string {\r\n\tlet {sName} = map;\r\n\tlet ts = `\\t${entityName(sName)}: UqMap;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildMapInterface(map: Map):string {\r\n\t/*\r\n\tlet {sName, fields, returns} = map;\r\n\tlet ts = `export interface Param${capitalCaseString(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(map, returns);\r\n\treturn ts;\r\n\t*/\r\n\treturn '';\r\n}\r\n\r\nfunction buildHistory(history: History):string {\r\n\tlet {sName} = history;\r\n\tlet ts = `\\t${entityName(sName)}: UqHistory<Param${capitalCase(sName)}, Result${capitalCase(sName)}>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildHistoryInterface(history: History):string {\r\n\tlet {sName, fields, returns} = history;\r\n\tlet ts = `export interface Param${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(history, returns);\r\n\treturn ts;\r\n}\r\n\r\nfunction buildPending(pending: Pending):string {\r\n\tlet {sName} = pending;\r\n\tlet ts = `\\t${entityName(sName)}: UqPending<any, any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildPendingInterface(pending: Pending):string {\r\n\t/*\r\n\tlet {sName, fields, returns} = pending;\r\n\tlet ts = `export interface Param${capitalCaseString(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}\\n';\r\n\tts += buildReturns(pending, returns);\r\n\treturn ts;\r\n\t*/\r\n\treturn '';\r\n}\r\n\r\nfunction buildID(id: ID):string {\r\n\tlet {sName} = id;\r\n\tlet ts = `\\t${entityName(sName)}: UqID<any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIDX(idx: IDX):string {\r\n\tlet {sName} = idx;\r\n\tlet ts = `\\t${entityName(sName)}: UqIDX<any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIX(ix: IX):string {\r\n\tlet {sName} = ix;\r\n\tlet ts = `\\t${entityName(sName)}: UqIX<any>;`;\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIDInterface(idEntity: ID):string {\r\n\tlet {sName, fields, schema} = idEntity;\r\n\tlet {keys:schemaKeys} = schema;\r\n\tlet keys:Field[] = [], others:Field[] = [];\r\n\tfor (let f of fields) {\r\n\t\tlet {name} = f;\r\n\t\tif (name === 'id') continue;\r\n\t\tif ((schemaKeys as any[]).find(v => v.name === name)) keys.push(f);\r\n\t\telse others.push(f);\r\n\t}\r\n\tlet ts = `export interface ${capitalCase(sName)} {`;\r\n\tts += `\\n\\tid?: number;`;\r\n\tts += buildFields(keys, true);\r\n\tts += buildFields(others, true);\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIDXInterface(idx: IDX):string {\r\n\tlet {sName, fields, schema} = idx;\r\n\tlet {exFields} = schema;\r\n\tlet ts = `export interface ${capitalCase(sName)} {`;\r\n\tlet indent = 1;\r\n\tfor (let field of fields) {\r\n\t\tlet {name, type} = field;\r\n\t\tlet s = fieldTypeMap[type];\r\n\t\tif (!s) s = 'any';\r\n\t\tts += `\\n${'\\t'.repeat(indent)}${name}`;\r\n\t\tif (name !== 'id') ts += '?';\r\n\t\tts += `: ${s};`;\r\n\t}\r\n\r\n\tts += `\\n\\t$act?: number;`;\r\n\r\n\tlet hasTrack:boolean = false;\r\n\tlet hasMemo:boolean = false;\r\n\tif (exFields) {\r\n\t\tfor (let exField of exFields) {\r\n\t\t\tlet {track, memo} = exField;\r\n\t\t\tif (track === true) hasTrack = true;\r\n\t\t\tif (memo === true) hasMemo = true;\r\n\t\t}\r\n\t}\r\n\tif (hasTrack === true) {\r\n\t\tts += `\\n\\t$track?: number;`;\r\n\t}\r\n\tif (hasMemo === true) {\r\n\t\tts += `\\n\\t$memo?: string;`;\r\n\t}\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIDXActParamInterface(idx: IDX):string {\r\n\tlet {sName, fields, schema} = idx;\r\n\tlet {exFields} = schema;\r\n\tlet ts = `export interface ActParam${capitalCase(sName)} {`;\r\n\tlet indent = 1;\r\n\tfor (let field of fields) {\r\n\t\tlet {name, type} = field;\r\n\t\tlet s = fieldTypeMap[type];\r\n\t\tif (!s) s = 'any';\r\n\t\tts += `\\n${'\\t'.repeat(indent)}${name}`;\r\n\t\tif (name !== 'id') ts += '?';\r\n\t\tts += `: ${s}|IDXValue;`;\r\n\t}\r\n\r\n\tts += `\\n\\t$act?: number;`;\r\n\r\n\tlet hasTrack:boolean = false;\r\n\tlet hasMemo:boolean = false;\r\n\tif (exFields) {\r\n\t\tfor (let exField of exFields) {\r\n\t\t\tlet {track, memo} = exField;\r\n\t\t\tif (track === true) hasTrack = true;\r\n\t\t\tif (memo === true) hasMemo = true;\r\n\t\t}\r\n\t}\r\n\tif (hasTrack === true) {\r\n\t\tts += `\\n\\t$track?: number;`;\r\n\t}\r\n\tif (hasMemo === true) {\r\n\t\tts += `\\n\\t$memo?: string;`;\r\n\t}\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildIXInterface(ix: IX):string {\r\n\tlet {sName, fields} = ix;\r\n\tlet ts = `export interface ${capitalCase(sName)} {`;\r\n\tts += buildFields(fields);\r\n\tts += '\\n}';\r\n\treturn ts;\r\n}\r\n\r\nfunction buildActsInterface(uq: UqMan) {\r\n\tlet ts = `\\nexport interface ParamActs {`;\r\n\tuq.idArr.forEach(v => {\r\n\t\tlet {sName} = v;\r\n\t\tts += `\\n\\t${camelCase(sName)}?: ${capitalCase(sName)}[];`;\r\n\t});\r\n\tuq.idxArr.forEach(v => {\r\n\t\tlet {sName} = v;\r\n\t\tts += `\\n\\t${camelCase(sName)}?: ActParam${capitalCase(sName)}[];`;\r\n\t});\r\n\tuq.ixArr.forEach(v => {\r\n\t\tlet {sName} = v;\r\n\t\tts += `\\n\\t${camelCase(sName)}?: ${capitalCase(sName)}[];`;\r\n\t});\r\n\tts += '\\n}\\n';\r\n\treturn ts;\r\n}\r\n","import * as React from 'react';\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { Page, ItemSchema, UiSchema, StringSchema, UiTextItem, Edit, ImageSchema, nav, UiImageItem } from '../components';\r\nimport { userApi } from 'tonva-core';\r\n\r\nexport class EditMeInfo extends React.Component {\r\n    private schema:ItemSchema[] = [\r\n        {name:'nick', type:'string'} as StringSchema,\r\n        {name:'icon', type:'image'} as ImageSchema\r\n    ];\r\n    private uiSchema:UiSchema = {\r\n        items: {\r\n            nick: {widget:'text', label:'别名', placeholder:'好的别名更方便记忆'} as UiTextItem,\r\n            icon: {widget:'image', label:'头像'} as UiImageItem,\r\n        }\r\n    }\r\n    data:any;\r\n\r\n    constructor(props:any) {\r\n        super(props);\r\n\t\tmakeObservable(this, {\r\n\t\t\tdata: observable,\r\n\t\t})\r\n        let {nick, icon} = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        }\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema:ItemSchema, newValue:any, preValue:any) => {\r\n        let {name} = itemSchema;        \r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        let user:any = nav.user;\r\n        user[name] = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n    render() {\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={this.schema} uiSchema={this.uiSchema}\r\n                data={this.data}\r\n                onItemChanged={this.onItemChanged} />\r\n        </Page>;\r\n    }\r\n}\r\n","//import * as React from 'react';\r\nimport { Page, nav, LMR } from \"../components\";\r\nimport { VPage } from '../vm';\r\n//import { appInFrame } from '../net';\r\nimport { CAppBase } from \"./CAppBase\";\r\n//import { UQsMan } from '../uq';\r\n\r\n/*\r\nexport class VAppMain extends VPage<CMainBase> {\r\n    async open(param?:any) {\r\n        this.openPage(this.appPage);\r\n    }\r\n\r\n    render(param?:any) {\r\n        return this.appContent();\r\n    }\r\n\r\n    protected appPage = () => {\r\n        let {caption} = this.controller;\r\n        return <Page header={caption} logout={async()=>{appInFrame.unit = undefined}}>\r\n            {this.appContent()}\r\n        </Page>;\r\n    }\r\n\r\n    protected appContent = () => {\r\n        let {cUqArr} = this.controller;\r\n        let content:any;\r\n        if (cUqArr.length === 0) {\r\n            content = <div className=\"text-danger\">\r\n                <FA name=\"\" /> 此APP没有绑定任何的UQ\r\n            </div>;\r\n        }\r\n        else {\r\n            content = cUqArr.map((v,i) => <div key={i}>{v.render()}</div>);\r\n        }\r\n        return <>{content}</>;\r\n    };\r\n}\r\n*/\r\nexport class VUnsupportedUnit extends VPage<CAppBase<any>> {\r\n\tprivate params: {predefinedUnit:number, uqsLoadErrors:string[]};\r\n    async open(params: {predefinedUnit:number, uqsLoadErrors:string[]}) {\r\n\t\tthis.params = params;\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet {predefinedUnit, uqsLoadErrors} = this.params;\r\n        let {user} = nav;\r\n\t\tlet userName:string = user? user.name : '[未登录]';\r\n\t\t//let {appOwner, appName} = UQsMan.value;\r\n        return <Page header=\"APP无法运行\" logout={true}>\r\n            <div className=\"m-3 text-danger container\">\r\n                <div className=\"mb-3 row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">登录用户</div>\r\n                    <div className=\"col-sm text-body\">{userName}</div>\r\n                </div>\r\n                <div className=\"mb-3 row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">预设小号</div>\r\n                    <div className=\"col-sm text-body\">{predefinedUnit || <small className=\"\">[无预设小号]</small>}</div>\r\n                </div>\r\n\t\t\t\t{\r\n\t\t\t\t\tuqsLoadErrors && uqsLoadErrors.map(v => {\r\n\t\t\t\t\t\treturn <div className=\"mb-3 row\">\r\n\t\t\t\t\t\t\t<div className=\"col-sm-3 font-weight-bold\">App</div>\r\n\t\t\t\t\t\t\t<div className=\"col-sm text-body\">{v}</div>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n                <div className=\"mb-3 row\">\r\n                    <div className=\"col-sm-3 font-weight-bold\">小号{predefinedUnit}</div>\r\n                    <div className=\"col-sm text-body\">\r\n                        预设小号定义在 public/unit.json 文件中。\r\n                        定义了这个文件的程序，只能由url直接启动。\r\n                        用户第一次访问app之后，会缓存在localStorage里。<br/>\r\n                        如果要删去缓存的预定义Unit，logout然后再login。\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\t\t</Page>;\t\t\r\n\t}\r\n\t/*\r\n\t<div className=\"mb-3 row\">\r\n\t\t<div className=\"col-sm-3 font-weight-bold\">\r\n\t\t\t可能原因<FA name=\"exclamation-triangle\" />\r\n\t\t</div>\r\n\t\t<div className=\"col-sm text-body\">\r\n\t\t\t<ul className=\"p-0\">\r\n\t\t\t\t<li>没有小号运行 {appName}</li>\r\n\t\t\t\t<li>用户 <b>{userName}</b> 没有加入任何一个运行{appName}的小号</li>\r\n\t\t\t\t{\r\n\t\t\t\t\tpredefinedUnit && \r\n\t\t\t\t\t<li>预设小号 <b>{predefinedUnit}</b> 没有运行App {appName}</li>\r\n\t\t\t\t}\r\n\t\t\t</ul>\r\n\t\t</div>\r\n\t</div>\r\n\t*/\r\n}\r\n\r\nexport class VUnitSelect extends VPage<CAppBase<any>> {\r\n    async open() {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private renderRow = (item: any, index: number):JSX.Element => {\r\n        let {id, nick, name} = item;\r\n        return <LMR className=\"px-3 py-2\" right={'id: ' + id}>\r\n            <div>{nick || name}</div>\r\n        </LMR>;\r\n    }\r\n    private onRowClick = async (appUnit: any) => {\r\n\t\t//appInFrame.unit = appUnit.id; // 25;\r\n\t\t//this.controller.setAppUnit(appUnit);\r\n        await this.controller.start();\r\n    }\r\n\r\n    private page = () => {\r\n        return <Page header=\"选择小号\" logout={true}>\r\n\t\t\t<div>this.controller.appUnits appUnits removed</div>\r\n        </Page>\r\n        // <List items={this.controller.appUnits} item={{render: this.renderRow, onClick: this.onRowClick}}/>\r\n\t}\r\n}\r\n\r\nexport class VErrorsPage extends VPage<CAppBase<any>> {\r\n    async open(errors:string[]) {\r\n        this.openPage(this.page, {errors:errors});\r\n    }\r\n\r\n    private page = (errors:{errors:string[]}) => {\r\n        return <Page header=\"ERROR\">\r\n            <div className=\"m-3\">\r\n\t\t\t\t<div className=\"p-3 d-flex justify-content-center align-items-center\">\r\n\t\t\t\t\t<button className=\"btn btn-danger\" onClick={nav.resetAll}>重启网页</button>\r\n\t\t\t\t</div>\r\n\r\n                <div>Load Uqs 发生错误：</div>\r\n                {errors.errors.map((r, i) => <div key={i}>{r}</div>)}\r\n            </div>\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport class VStartError extends VPage<CAppBase<any>> {\r\n    async open(error:any) {\r\n        this.openPage(this.page, {error});\r\n    }\r\n\r\n    private page = ({error}:{error:any}) => {\r\n        return <Page header=\"App start error!\">\r\n            <pre>\r\n                {typeof error === 'string'? error : error.message}\r\n            </pre>\r\n        </Page>;\r\n    }\r\n}","import { centerApi, logoutApis, AppConfig as AppConfigCore, Web } from \"tonva-core\";\r\nimport { User, UqsConfig as UqsConfigCore } from 'tonva-core';\r\nimport { RouteFunc, Hooks, Navigo, NamedRoute } from \"tonva-core\";\r\nimport { nav, Nav } from '../nav';\r\nimport { t, setGlobalRes } from '../res';\r\nimport { Controller } from '../vm';\r\nimport { UQsLoader, UQsMan, TVs } from \"tonva-core\";\r\nimport { VErrorsPage, VStartError } from \"./vMain\";\r\nimport { WebReact } from \"tonva-react\";\r\n\r\nexport interface IConstructor<T> {\r\n    new (...args: any[]): T;\r\n}\r\n/*\r\nexport interface DevConfig {\r\n\tname: string;\r\n\talias?: string;\r\n\tmemo?: string;\r\n}\r\n\r\nexport interface UqConfig {\r\n\tdev: DevConfig;\r\n\tname: string;\r\n\talias?: string;\t\r\n\tversion?: string;\r\n\tmemo?: string;\r\n}\r\n\r\nexport interface UqsConfig {\r\n\tapp?: {\r\n\t\tdev: DevConfig;\r\n\t\tname: string;\r\n\t\tversion?: string;\r\n\t};\r\n\tuqs?: UqConfig[];\r\n}\r\n*/\r\nexport type UqsConfig = UqsConfigCore;\r\nexport interface AppConfig extends AppConfigCore /*UqsConfig*/ {\r\n\t/*\r\n\tapp?: {\r\n\t\tname: string;\r\n\t\tversion: string;\r\n\t\townerMap?: {[key:string]: string};\r\n\t};\r\n\t*/\r\n    //appName: string;        // 格式: owner/appName\r\n    version: string;        // 版本变化，缓存的uqs才会重载\r\n    tvs?: TVs;\r\n    //uqNameMap?: {[uqName:string]: string};      // uqName='owner/uq' 映射到内存简单名字：uq, 可以注明映射，也可以自动。有可能重\r\n    loginTop?: JSX.Element;\r\n    oem?: string;               // 用户注册发送验证码的oem厂家，默认同花\r\n\tprivacy?: string;\r\n\tnoUnit?: boolean;\t\t\t// app的运行，不跟unit绑定\r\n\thtmlTitle?: string;\r\n}\r\n\r\nexport interface Elements {\r\n\t[id:string]: (element: HTMLElement)=>void,\r\n}\r\n\r\nexport abstract class CAppBase<U> extends Controller {\r\n\tprivate appConfig: AppConfig;\r\n\tprivate uqsMan: UQsMan;\r\n    protected _uqs: U;\r\n\treadonly web: Web;\r\n\treadonly nav: Nav;\r\n\ttimezone: number;\r\n\tunitTimezone: number;\r\n\r\n    constructor(config?: AppConfig) {\r\n\t\tsuper();\r\n\t\tthis.web = new WebReact();\r\n\t\tthis.nav = nav;\r\n\t\tthis.appConfig = config || (nav.navSettings as AppConfig);\r\n\t\tif (this.appConfig) {\r\n\t\t\tlet {app, uqs} = this.appConfig;\r\n\t\t\tif (app === undefined && uqs === undefined) {\r\n\t\t\t\tthrow new Error('app or uqs must be defined in AppConfig');\r\n\t\t\t}\r\n\t\t}\r\n    }\r\n\r\n    get uqs(): U {return this._uqs;}\r\n\r\n\tinternalT(str:string):any {\r\n\t\treturn t(str);\r\n\t}\r\n\t\r\n\tsetRes(res:any) {\r\n\t\tsetGlobalRes(res);\r\n\t}\r\n\tprotected afterBuiltUQs(uqs: any) {}\r\n\r\n\tprivate uqsUser: any = '';\r\n\tprotected async initUQs():Promise<any> {\r\n\t\tif (!this.appConfig) return;\r\n\t\tlet {user} = nav;\r\n\t\tif (user === this.uqsUser) return;\r\n\t\tthis.uqsUser = user;\r\n\t\tlogoutApis();\r\n\t\tlet uqsLoader = new UQsLoader(this.web, this.appConfig);\r\n\t\tlet retErrors = await uqsLoader.build();\r\n\t\tthis.uqsMan = uqsLoader.uqsMan;\r\n\t\tthis._uqs = this.uqsMan.proxy;\r\n\t\tthis.afterBuiltUQs(this._uqs);\r\n\t\treturn retErrors;\r\n\t}\r\n\r\n    protected async beforeStart():Promise<boolean> {\r\n        try {\r\n\t\t\tthis.onNavRoutes();\r\n\t\t\tlet retErrors = await this.initUQs();\r\n            if (retErrors !== undefined) {\r\n                this.openVPage(VErrorsPage, retErrors);\r\n                return false;\r\n            }\r\n            return true;\r\n        }\r\n        catch (err) {\r\n            this.openVPage(VStartError, err);\r\n            return false;\r\n        }\r\n    }\r\n\tprotected async afterStart():Promise<void> {\r\n\t\tnav.resolveRoute();\r\n\t\tnav.onChangeLogin = (user:User) => this.onChangeLogin(user);\r\n\t\tthis.onChangeLogin(this.user);\r\n\t}\r\n\r\n    async userFromId(userId:number):Promise<any> {\r\n        return await centerApi.userFromId(userId);\r\n    }\r\n\r\n\tprotected on(routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(url:string, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(regex:RegExp, routeFunc:RouteFunc, hooks?:Hooks):Navigo;\r\n\tprotected on(options: {[url:string]: RouteFunc|NamedRoute}):Navigo;\r\n\tprotected on(...args:any[]):Navigo {\r\n\t\treturn nav.on(args[0], args[1], args[2]);\r\n\t}\r\n\r\n\tprotected onNavRoutes() {return;}\r\n\r\n\tasync getUqRoles(uqName:string):Promise<string[]> {\r\n\t\tlet {user} = nav;\r\n\t\tif (!user) return null;\r\n\t\tlet {roles:userRoles} = nav.user;\r\n\t\tlet uq = uqName.toLowerCase();\r\n\t\tlet roles:string[];\r\n\t\tif (userRoles) {\r\n\t\t\troles = userRoles[uq];\r\n\t\t}\r\n\t\tif (roles) return roles;\r\n\r\n\t\troles = await this.uqsMan.getUqUserRoles(uq);\r\n\t\tif (!roles) roles = null;\r\n\t\tnav.setUqRoles(uq, roles);\r\n\t\treturn roles;\r\n\t}\r\n\r\n\tisAdmin(roles:string[]):boolean {\r\n\t\treturn this.isRole(roles, '$');\r\n\t}\r\n\r\n\tisRole(roles:string[], role:string):boolean {\r\n\t\tif (!roles) return false;\r\n\t\trole = role.toLowerCase();\r\n\t\treturn roles.indexOf(role) >= 0;\r\n\t}\r\n\r\n\tprotected onChangeLogin(user: User):Promise<void> {\r\n\t\treturn;\r\n\t}\r\n}\r\n","import { AppConfig, CAppBase } from './CAppBase';\r\n\r\nexport async function start(CApp: new (config: AppConfig) => CAppBase<any>, appConfig: AppConfig, isUserLogin?:boolean) {\r\n\tif (appConfig) {\r\n\t\tlet {htmlTitle} = appConfig;\r\n\t\tif (htmlTitle) {\r\n\t\t\tdocument.title = htmlTitle;\r\n\t\t}\r\n\t\tlet html = document.getElementsByTagName('html');\r\n\t\tlet html0 = html[0];\r\n\t\tif (html0) {\r\n\t\t\tlet version = html0?.getAttribute('data-version');\r\n\t\t\tif (version) {\r\n\t\t\t\t//appConfig.version = version;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tlet cApp = new CApp(appConfig);\r\n    await cApp.start(isUserLogin);\r\n}\r\n","import _ from 'lodash';\r\nimport { Web } from 'tonva-core';\r\nimport { Nav } from 'tonva-react';\r\nimport { Controller, WebNav } from \"../vm\";\r\nimport { CAppBase, IConstructor } from \"./CAppBase\";\r\n\r\nexport abstract class CBase<A extends CAppBase<U>, U> extends Controller {\r\n    constructor(cApp: A) {\r\n        super();\r\n        this.cApp = cApp;\r\n\t\tif (cApp) {\r\n\t\t\tlet {uqs, web, nav} = cApp;\r\n\t\t\tthis.uqs = uqs;\r\n\t\t\tthis.web = web;\r\n\t\t\tthis.nav = nav;\r\n\t\t}\r\n\t}\r\n\r\n    readonly cApp: A;\r\n    readonly uqs: U;\r\n\treadonly web: Web;\r\n\treadonly nav: Nav;\r\n    //get uqs(): U {return this._uqs}\r\n\t//get cApp(): A {return this._cApp}\r\n\tget timezone():number {return this.cApp.timezone;}\r\n\tget unitTimezone():number {return this.cApp.unitTimezone;}\r\n\tasync getUqRoles(uqName:string):Promise<string[]> {\r\n\t\treturn this.cApp?.getUqRoles(uqName);\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\tlet r = super.internalT(str);\r\n\t\tif (r!==undefined) return r;\r\n\t\treturn this.cApp.internalT(str);\r\n\t}\r\n\r\n    protected newC<T extends CBase<A,U>>(type: IConstructor<T>, ...param:any[]):T {\r\n\t\tlet c = new type(this.cApp);\r\n\t\tc.internalInit(...param);\r\n\t\treturn c;\r\n    }\r\n\r\n    newSub<O extends CBase<A,U>, T extends CSub<A,U,O>>(type: IConstructor<T>, ...param:any[]):T {\r\n\t\tlet s = new type(this);\r\n\t\ts.internalInit(...param);\r\n\t\treturn s;\r\n\t}\r\n\t\r\n\tgetWebNav(): WebNav<any> {\r\n\t\tlet wn = this.cApp?.getWebNav();\r\n\t\tif (wn === undefined) return;\r\n\t\tlet ret = _.clone(wn);\r\n\t\t_.merge(ret, this.webNav);\r\n\t\treturn ret;\r\n\t}\r\n}\r\n\r\nexport abstract class CSub<A extends CAppBase<U>, U, T extends CBase<A, U>> extends CBase<A,U> {\r\n    protected _owner: T;\r\n\r\n    constructor(owner: T) {\r\n        super(owner.cApp);\r\n        this._owner = owner;\r\n\t}\r\n\r\n\tinternalT(str:string):any {\r\n\t\tlet r = super.internalT(str);\r\n\t\tif (r!==undefined) return r;\r\n\t\treturn this._owner.internalT(str);\r\n\t}\r\n\r\n    protected get owner(): T {return this._owner}\r\n\t\r\n\tgetWebNav(): WebNav<any> {\r\n\t\tlet wn = this.cApp?.getWebNav();\r\n\t\tif (wn === undefined) return;\r\n\t\tlet ownerWNs:WebNav<any>[] = [];\r\n\t\tfor (let p = this.owner; p!==undefined; p = (p as any)?.owner) {\r\n\t\t\townerWNs.push(p.webNav);\r\n\t\t}\r\n\t\tlet ret = _.clone(wn);\r\n\t\tfor (;;) {\r\n\t\t\tlet own = ownerWNs.pop();\r\n\t\t\tif (own === undefined) break;\r\n\t\t\t_.merge(ret, own);\r\n\t\t}\r\n\t\t_.merge(ret, this.webNav);\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { Web } from \"tonva-core\";\r\nimport { nav } from './nav';\r\n\r\nexport class WebReact extends Web {\r\n    async navInit(): Promise<void> {\r\n        await nav.init();\r\n    }\r\n}\r\n","import React from 'react';\r\nimport _ from 'lodash';\r\nimport { FA, Page } from './components';\r\nimport { Controller } from \"./vm/controller\";\r\nimport { makeObservable, observable } from 'mobx';\r\nimport { observer } from 'mobx-react';\r\n\r\nexport interface CStringEditProps {\r\n\tlabel?: string;\r\n\tplaceholder?: string;\r\n\tmaxLength?: number;\r\n\tonValueChange?: (value: string) => Promise<void>;\r\n}\r\n\r\nexport class CStringEdit extends Controller {\r\n\tprivate props: CStringEditProps = {\r\n\t\tlabel: '编辑'\r\n\t}\r\n\tvalue: string = null;\r\n\tnewValue: string = null;\r\n\tisChanged: boolean = null;\r\n\terror: string = null;\r\n\r\n\tconstructor() {\r\n\t\tsuper();\r\n\t\tmakeObservable(this, {\r\n\t\t\tvalue: observable,\r\n\t\t\tnewValue: observable,\r\n\t\t\tisChanged: observable,\r\n\t\t\terror: observable,\r\n\t\t});\r\n\t}\r\n\r\n\tprotected async internalStart() {}\r\n\trender(value:string, props?:CStringEditProps) {\r\n\t\tthis.value = value;\r\n\t\tif (props) _.merge(this.props, props);\r\n\t\treturn React.createElement(observer(()=><>{this.renderValue()}{this.renderPencil()}</>))\r\n\t}\r\n\r\n\tprotected renderValue() {return <>{this.value}</>}\r\n\tprotected renderPencil() {\r\n\t\treturn <span onClick={this.onEdit} className=\"cursor-pointer\">\r\n\t\t\t&nbsp; <FA className=\"text-info\" name=\"pencil-square-o\" /> &nbsp;\r\n\t\t</span>;\r\n\t}\r\n\r\n    private onChange = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.newValue = evt.target.value;\r\n        let preValue = this.value;\r\n        this.isChanged = (this.newValue !== preValue);\r\n    }\r\n\r\n    private onBlur = (evt: React.ChangeEvent<HTMLInputElement>) => {\r\n        this.verifyValue();\r\n\t}\r\n\t\r\n\tprotected verifyValue() {}\r\n\r\n    private onFocus = () => {\r\n        this.error = undefined;\r\n\t}\r\n\t\r\n\tprivate onEdit = () => {\r\n\t\tlet {label, maxLength, placeholder, onValueChange} = this.props;\r\n\t\tlet onSave = () => {\r\n\t\t\tthis.verifyValue();\r\n\t\t\tif (this.error === undefined) {\r\n\t\t\t\tthis.value = this.newValue;\r\n\t\t\t\tthis.closePage();\r\n\t\t\t\tif (onValueChange) onValueChange(this.value);\r\n\t\t\t}\r\n\t\t}\r\n        let right = React.createElement(observer(() => <button\r\n            className=\"btn btn-sm btn-success align-self-center me-2\"\r\n            disabled={!this.isChanged}\r\n            onClick={onSave}>保存</button>));\r\n\t\tlet onKeyDown = (evt: React.KeyboardEvent<HTMLInputElement>) => {\r\n\t\t\tif (evt.keyCode === 13) onSave();\r\n\t\t}\r\n\t\tthis.openPage(<Page header={label} right={right}>\r\n            <div className=\"m-3\">\r\n\t\t\t\t<input type=\"text\"\r\n\t\t\t\t\tonChange={this.onChange}\r\n\t\t\t\t\tonKeyDown={onKeyDown}\r\n                    onBlur={this.onBlur}\r\n                    onFocus={this.onFocus}\r\n\t\t\t\t\tclassName=\"form-control\"\r\n\t\t\t\t\tdefaultValue={this.value}\r\n\t\t\t\t\tmaxLength={maxLength} />\r\n                {\r\n\t\t\t\t\tReact.createElement(observer(()=> placeholder && <div className=\"small muted m-2\">{placeholder}</div>))                    \r\n                }\r\n                {this.error && <div className=\"text-danger\">{this.error}</div>}\r\n            </div>\r\n\t\t</Page>);\r\n\t}\r\n}\r\n","export function uqStringify(values: any): string {\r\n    let s = '{';\r\n    if (values === undefined) return 'undefined';\r\n    for (let i in values) {\r\n        let v = values[i];\r\n        s += i + ': ';\r\n        if (v === undefined) {\r\n            s += 'undefined';\r\n        }\r\n        else if (v === null) {\r\n            s += 'null';\r\n        }\r\n        else {\r\n            switch (typeof v) {\r\n                default:\r\n                    s += v;\r\n                    break;\r\n                case 'function':\r\n                    s += 'function';\r\n                    break;\r\n                case 'object':\r\n                    s += '{obj}';\r\n                    break;\r\n            }\r\n        }\r\n        s += ', ';\r\n    }\r\n    return s + '}';\r\n}\r\n","//=== UqApp builder created on Fri Nov 12 2021 10:09:31 GMT-0500 (北美东部标准时间) ===//\nimport { CSub, CBase, CAppBase, IConstructor } from 'tonva-react';\nimport { UQs } from './uqs';\nimport { CApp } from './CApp';\n\nexport abstract class CUqBase extends CBase<CApp, UQs> {\n\tprotected async internalStart(param?:any, ...params:any[]):Promise<void> {}\n}\n\nexport abstract class CUqSub<A extends CAppBase<U>, U, T extends CBase<A,U>> extends CSub<A, U, T> {\n}\n\nexport abstract class CUqApp extends CAppBase<UQs> {\n\tprotected newC<T extends CUqBase>(type: IConstructor<T>, ...param:any[]): T {\n\t\tlet c = new type(this);\n\t\tc.internalInit(...param);\n\t\treturn c;\n\t}\n}\n","import { VPage } from \"tonva-react\";\r\nimport { CHome } from \"./CHome\";\r\nimport '../App.css';\r\n\r\nexport class VHome extends VPage<CHome> {\r\n\theader() {return '首页'}\r\n\tcontent() {\r\n\t\tlet {cApp, cAccount} = this.controller;\r\n\t\treturn <div>\r\n\t\t\t<div className=\"d-flex flex-wrap p-2\">\r\n\t\t\t\t{cAccount?.renderAccounts()}\r\n\t\t\t</div>\r\n\t\t\t{cApp.renderVPortal()}\r\n\t\t</div>\r\n\t}\r\n}\r\n","import { CAccount } from \"./CAccount\";\r\nimport { View } from \"tonva-react\";\r\nimport { observer } from \"mobx-react\";\r\nimport { EnumAccount, Post } from \"uq-app/uqs/JkMe\";\r\n\r\nexport class VAccount extends View<CAccount> {\r\n    render() {\r\n\t\tlet VAccounts = observer(() => {\r\n\t\t\tlet {accounts, cApp, onAccountClick} = this.controller;\r\n\t\t\tif (!accounts) return null;\r\n\t\t\tlet {accountTitles, postTitles} = cApp;\r\n\t\t\treturn <>{accounts.map((v, index) => {\r\n\t\t\t\tlet {objectAccount, post, account, balance} = v;\r\n\t\t\t\tlet {title, vice, unit, fixed} = accountTitles[account as EnumAccount];\r\n\t\t\t\tlet postTitle = postTitles[post as Post];\r\n\t\t\t\treturn <div key={index}\r\n\t\t\t\t\tclassName=\"m-2 p-3 border border-info rounded rounded-3 bg-white text-center cursor-pointer\"\r\n\t\t\t\t\tonClick={() => onAccountClick(v)}>\r\n\t\t\t\t\t<div className=\"mb-1 small\">\r\n\t\t\t\t\t\t<span className=\"text-secondary small\">{postTitle?.title}</span>\r\n\t\t\t\t\t\t<span className=\"text-primary\">{title}</span>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<span className=\"fs-5 me-1\">{balance.toFixed(fixed)}</span>\r\n\t\t\t\t\t\t<small className=\"text-muted\">{unit}</small></div>\r\n\t\t\t\t</div>\r\n\t\t\t})}</>;\r\n\t\t});\r\n        return <VAccounts />;\r\n    }\r\n}\r\n","import { CAccount } from 'account';\r\nimport { dateFromHourId } from 'tonva-core';\r\nimport { EasyDate, List, LMR, VPage } from \"tonva-react\";\r\nimport { Item, Post, ReturnGetObjectAccountHistoryRet } from \"uq-app/uqs/JkMe\";\r\n\r\nexport class VObjectAccountHistory extends VPage<CAccount> {\r\n    header() {return '账户明细'}\r\n    content() {\r\n        let {accountHistory} = this.controller;\r\n        return <div>\r\n            <List items={accountHistory} item={{render: this.renderHistory}} />\r\n        </div>\r\n    }\r\n\r\n    private renderHistory = (row:ReturnGetObjectAccountHistoryRet, index:number) => {\r\n        let {accountTitle, cApp} = this.controller;\r\n        let {fixed, unit} = accountTitle;\r\n        let {postTitles, itemTitles} = cApp;\r\n        let {date, value, item, post} = row;\r\n        let right = <div>\r\n            <span className=\"me-1\">{value.toFixed(fixed)}</span>\r\n            <small className=\"text-muted\">{unit}</small>\r\n        </div>;\r\n        return <LMR className=\"px-3 py-2\" right={right}>\r\n            <span className=\"d-inline-block w-min-6c\">{dateString(dateFromHourId(date))}</span>\r\n            <small className=\"text-muted\">\r\n            {postTitles[post as Post].title} &nbsp;\r\n            {itemTitles[item as Item].title}\r\n            </small>\r\n        </LMR>\r\n    } \r\n}\r\n\r\nfunction dateString(date: Date) {\r\n    let y = date.getFullYear();\r\n    let m = date.getMonth() + 1;\r\n    let d = date.getDate();\r\n    if (y === new Date().getFullYear()) {\r\n        return `${m}月${d}日`;\r\n    }\r\n    else {\r\n        return `${y}年${m}月${d}日`;\r\n    }\r\n}\r\n","import { makeObservable, observable, runInAction } from \"mobx\";\r\nimport { CApp, CUqBase } from \"uq-app\";\r\nimport { Title } from \"uq-app/CApp\";\r\nimport { EnumAccount, ReturnGetObjectAccountHistoryRet, ReturnGetUserObjectAccountRet } from \"uq-app/uqs/JkMe\";\r\nimport { VAccount } from \"./VAccount\";\r\nimport { VObjectAccountHistory } from \"./VObjectAccountHistory\";\r\n\r\nexport class CAccount extends CUqBase {\r\n\taccounts: ReturnGetUserObjectAccountRet[] = null;\r\n\taccount: ReturnGetUserObjectAccountRet;\r\n\taccountHistory: ReturnGetObjectAccountHistoryRet[];\r\n\taccountTitle:Title;\r\n\r\n    constructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n\t\tmakeObservable(this, {\r\n\t\t\taccounts: observable\r\n\t\t});\r\n\t}\r\n\r\n    renderAccounts() {\r\n        return this.renderView(VAccount);\r\n    }\r\n\r\n\tasync load(object: number) {\r\n\t\tlet ret = await this.uqs.JkMe.GetUserObjectAccount.query({object});\r\n\t\trunInAction(() => {\r\n\t\t\tthis.accounts = ret.ret;\r\n\t\t});\r\n\t}\r\n\r\n\tonAccountClick = async (account: ReturnGetUserObjectAccountRet) => {\r\n\t\tthis.account = account;\r\n\t\tlet {objectAccount, account:enumAccount} = account;\r\n\t\tlet ret = await this.uqs.JkMe.GetObjectAccountHistory.query({objectAccount});\r\n\t\tthis.accountHistory = ret.ret;\r\n\t\tthis.accountTitle = this.cApp.accountTitles[enumAccount as EnumAccount];\r\n\t\tthis.openVPage(VObjectAccountHistory);\r\n\t}\r\n}\r\n","import { makeObservable, observable, runInAction } from \"mobx\";\r\nimport { CApp, CUqBase } from \"uq-app\";\r\nimport { EnumAccount, ReturnGetObjectAccountHistoryRet, ReturnGetUserObjectAccountRet } from \"uq-app/uqs/JkMe\";\r\nimport { VHome } from \"./VHome\";\r\nimport { VObjectAccountHistory } from \"../account/VObjectAccountHistory\";\r\nimport { CAccount } from \"account\";\r\n\r\nexport interface AccountController {\r\n\tstart(): Promise<void>;\r\n\tloadItem(): Promise<void>;\r\n\trenderItem():JSX.Element;\t\r\n}\r\n\r\nexport class CHome extends CUqBase {\r\n\tcAccount: CAccount;\r\n\r\n\ttab = () => this.renderView(VHome);\r\n\r\n\tload = async () => {\r\n\t\tthis.cAccount = this.newC(CAccount);\r\n\t\tawait Promise.all([this.cApp.cPortal.load(), this.cAccount.load(undefined)]);\r\n\t}\r\n}\r\n","//=== UqApp builder created on Tue Jan 12 2021 23:14:51 GMT-0500 (GMT-05:00) ===//\r\nimport { AppConfig } from \"tonva-react\";\r\nimport { DevConfig } from 'tonva-core';\r\n\r\n/*\r\nconst bz: DevConfig = {\r\n\tname: 'bizdev',\r\n\talias: 'bz',\r\n}\r\n*/\r\nconst jk: DevConfig = {\r\n\tname: '百灵威系统工程部',\r\n\talias: 'jk',\r\n}\r\n\r\nexport const appConfig: AppConfig = {\r\n\tversion: '0.1.0',\r\n\tapp: undefined,\r\n\tuqs: [\r\n\t\t{\r\n\t\t\tdev: jk,\r\n\t\t\tname: 'me',\r\n\t\t\talias: 'Me',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t\t{\r\n\t\t\tdev: jk,\r\n\t\t\tname: 'product',\r\n\t\t\talias: 'Product',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t\t{\r\n\t\t\tdev: jk,\r\n\t\t\tname: '积分商城',\r\n\t\t\talias: 'PointShop',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t\t{\r\n\t\t\tdev: jk,\r\n\t\t\tname: 'hr',\r\n\t\t\talias: 'Hr',\r\n\t\t\tversion: '0.1.0',\r\n\t\t},\r\n\t],\r\n\tnoUnit: true,\r\n    tvs: {},\r\n\toem: undefined,\r\n\thtmlTitle: '我',\r\n};\r\n","import { VPage } from \"tonva-react\";\r\nimport { appConfig } from \"../uq-app/appConfig\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VAbout extends VPage<CMe> {\r\n\theader() {return '关于APP';}\r\n\tcontent() {\r\n\t\treturn <div className=\"py-5 px-3 my-3 w-max-30c mx-auto bg-white\">\r\n\t\t\t<div className=\"text-center mb-5 position-relative\">\r\n\t\t\t\t<small className=\"text-muted position-absolute\"\r\n\t\t\t\t\tstyle={{right:'0', top:'-2.8rem'}}>\r\n\t\t\t\t\t版本: {appConfig.version}\r\n\t\t\t\t</small>\r\n\t\t\t\t<b className=\"text-danger h5 mb-0\">About</b>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n}\r\n","import { observer } from 'mobx-react';\r\nimport { Image, VPage, nav, IconText, PropGrid, LMR, FA, Prop } from 'tonva-react';\r\nimport { CMe } from './CMe';\r\nimport { appConfig } from '../uq-app/appConfig';\r\nimport { VAbout } from './VAbout';\r\n\r\nexport class VMe extends VPage<CMe> {\r\n\theader() {return this.t('me')}\r\n\r\n\tcontent() {\r\n        const { user } = nav;\r\n        let aboutRows: Prop[] = [\r\n            '',\r\n            {\r\n                type: 'component',\r\n                component: <LMR className=\"w-100\" onClick={this.about}\r\n\t\t\t\t\tright={<FA className=\"align-self-center\" name=\"angle-right\" />}>\r\n                    <IconText iconClass=\"text-info me-2\" \r\n\t\t\t\t\t\ticon=\"smile-o\" \r\n\t\t\t\t\t\ttext={<>{this.t('aboutTheApp')} <small>版本 {appConfig.version}</small></>} />                    \r\n                </LMR>,\r\n            },\r\n        ];\r\n\r\n        let rows: Prop[];\r\n        if (user === undefined) {\r\n            rows = aboutRows;\r\n            rows.push(\r\n                {\r\n                    type: 'component',\r\n                    component: <button className=\"btn btn-success w-100 my-2\" onClick={() => nav.logout()}>\r\n                        <FA name=\"sign-out\" size=\"lg\" /> {this.t('pleaseLogin')}\r\n                    </button>\r\n                },\r\n            );\r\n        }\r\n        else {\r\n            let logOutRows: Prop[] = [\r\n            ];\r\n\r\n            rows = [\r\n                '',\r\n                {\r\n                    type: 'component',\r\n                    component: <this.meInfo />\r\n                },\r\n\t\t\t\t'',\r\n            ];\r\n\t\t\trows.push({\r\n                type: 'component',\r\n                component: <this.renderAdmin />,\r\n            });\r\n            rows.push(...aboutRows, ...logOutRows);\r\n        }\r\n        return <>\r\n            <PropGrid rows={[...rows]} values={{}} />\r\n        </>;\r\n    }\r\n\r\n    private renderAdmin = observer(():JSX.Element => {\r\n        let {isAdmin} = this.controller;\r\n        if (isAdmin === false) return null;\r\n        let {admins, user} = this.controller;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n                onClick={this.controller.adminSetting}\r\n                left={<FA name=\"cog\" className=\"text-info mt-1 me-3\" />}\r\n                right={<FA className=\"align-self-center\" name=\"angle-right\" />}\r\n            >\r\n            <div>业务设置</div>\r\n            <div className=\"small text-muted d-flex align-items-center\">\r\n                <small className=\"d-inline\">管理员</small>\r\n                <span className=\"d-inline ms-3 text-danger\">[我]</span>\r\n                {admins.map(v => {\r\n                    return <span className=\"d-inline ms-3\">{this.renderUserText(v.id)}</span>\r\n                })}\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n\tprivate meInfo = observer(() => {\r\n        let { user } = nav;\r\n        if (user === undefined) return null;\r\n        let { id, name, nick, icon } = user;\r\n        return <LMR className=\"py-2 cursor-pointer w-100\"\r\n            left={<Image className=\"w-3c h-3c me-3\" src={icon || '.user-o'} />}\r\n            right={<FA className=\"align-self-end\" name=\"angle-right\" />}\r\n            onClick={this.controller.showEditMe}>\r\n            <div>\r\n                <div>{userSpan(name, nick)}</div>\r\n                <div className=\"small\"><span className=\"text-muted\">ID:</span> {id > 10000 ? id : String(id + 10000).substr(1)}</div>\r\n            </div>\r\n        </LMR>;\r\n    });\r\n\r\n\t/*\r\n\tprivate renderRolesAdmin = observer(() => {\r\n\t\treturn <LMR className=\"py-2 cursor-pointer w-100\" onClick={this.controller.roleAdmin}>\r\n\t\t\t设置用户角色\r\n\t\t</LMR>\r\n\t});\r\n\t*/\r\n\r\n\tprivate about = () => {\r\n\t\tthis.openVPage(VAbout);\r\n\t}\r\n}\r\n\r\nfunction userSpan(name: string, nick: string): JSX.Element {\r\n    return nick ?\r\n        <><b>{nick} &nbsp; <small className=\"muted\">{name}</small></b></>\r\n        : <b>{name}</b>\r\n}\r\n","import { observable } from 'mobx';\r\nimport { userApi } from 'tonva-core';\r\nimport {\r\n    ItemSchema, StringSchema, ImageSchema, UiTextItem, UiImageItem, nav, Page,\r\n    Edit, UiSchema, VPage, Prop, FA, IconText, PropGrid\r\n} from 'tonva-react';\r\nimport { CMe } from './CMe';\r\n\r\nexport class VEditMe extends VPage<CMe>{\r\n\r\n    async open(param: any) {\r\n        this.openPage(this.page);\r\n    }\r\n\r\n    private schema: ItemSchema[] = [\r\n        { name: 'nick', type: 'string' } as StringSchema,\r\n        { name: 'icon', type: 'image' } as ImageSchema,\r\n    ];\r\n    private uiSchema: UiSchema = {\r\n        items: {\r\n            nick: { widget: 'text', label: '别名', placeholder: '好的别名更方便记忆' } as UiTextItem,\r\n            icon: { widget: 'image', label: '头像' } as UiImageItem,\r\n        }\r\n    }\r\n    @observable private data: any;\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        let { nick, icon } = nav.user;\r\n        this.data = {\r\n            nick: nick,\r\n            icon: icon,\r\n        };\r\n    }\r\n\r\n    private onItemChanged = async (itemSchema: ItemSchema, newValue: any, preValue: any) => {\r\n        let { name } = itemSchema;\r\n        await userApi.userSetProp(name, newValue);\r\n        this.data[name] = newValue;\r\n        nav.user.name = newValue;\r\n        nav.saveLocalUser();\r\n    }\r\n\r\n\tprivate onExit = () => {\r\n        nav.showLogout();\r\n    }\r\n\r\n\tprivate changePassword = async () => {\r\n        await nav.changePassword();\r\n    }\r\n\r\n    private userQuit = async () => {\r\n        await nav.userQuit();\r\n    }\r\n\r\n    private page = () => {\r\n\t\tlet { schema, uiSchema, data, onItemChanged } = this;\r\n\t\tlet gridRows: Prop[] = [\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tcomponent: <IconText iconClass=\"text-info me-2\" icon=\"key\" text={this.t('changePassword')} />,\r\n\t\t\t\tonClick: this.changePassword\r\n\t\t\t},\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tcomponent: <IconText iconClass=\"text-danger me-2\" icon=\"ban\" text={this.t('userQuit')} />,\r\n\t\t\t\tonClick: this.userQuit\r\n\t\t\t},\r\n\t\t\t'',\r\n\t\t\t'',\r\n\t\t\t{\r\n\t\t\t\ttype: 'component',\r\n\t\t\t\tbk: '',\r\n\t\t\t\tcomponent: <div className=\"w-100 text-center\">\r\n\t\t\t\t\t<button className=\"btn btn-danger w-100 w-max-20c\" onClick={this.onExit}>\r\n\t\t\t\t\t\t<FA name=\"sign-out\" size=\"lg\" /> {this.t('logout')}\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t},\r\n\t\t];\r\n\r\n\r\n\t\t/*\r\n\t\tlet vAdmin: any;\r\n\t\t\r\n\t\tlet { role } = this.controller;\r\n\t\tif ((role & 2) === 2) {\r\n\t\t\tvAdmin = <div className=\"px-3 py-2 cursor-pointer bg-white border-bottom\" onClick={this.controller.showAdmin}>管理员</div>;\r\n\t\t}\r\n\t\t{vAdmin}\r\n\t\t*/\r\n        return <Page header=\"个人信息\">\r\n            <Edit schema={schema} uiSchema={uiSchema}\r\n                data={data}\r\n                onItemChanged={onItemChanged} />\r\n\t\t\t<PropGrid rows={gridRows} values={{}} />\r\n        </Page>;\r\n    }\r\n}\r\n\r\nexport const webUserSchema: ItemSchema[] = [\r\n    { name: 'firstName', type: 'string', required: true } as StringSchema,\r\n    { name: 'gender', type: 'string' } as StringSchema,\r\n    { name: 'salutation', type: 'string' } as StringSchema,\r\n    { name: 'organizationName', type: 'string', required: true } as StringSchema,\r\n    { name: 'departmentName', type: 'string' } as StringSchema,\r\n];\r\n\r\n","import { VPage } from \"tonva-react\";\r\nimport { CMe } from \"./CMe\";\r\n\r\nexport class VAdminSetting extends VPage<CMe> {\r\n    header() {return '业务设置'}\r\n    content() {\r\n        let {admins} = this.controller;\r\n        return <div>\r\n            <div className=\"small text-muted d-flex align-items-center m-3\">\r\n                <small className=\"d-inline\">管理员</small>\r\n                <span className=\"d-inline ms-3 text-danger\">[我]</span>\r\n                {admins.map(v => {\r\n                    return <span className=\"d-inline ms-3\">{this.renderUserText(v.id)}</span>\r\n                })}\r\n            </div>\r\n        </div>;\r\n    }\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { QueryPager, User } from \"tonva-core\";\r\nimport { CUqBase } from \"uq-app\";\r\nimport { VMe } from \"./VMe\";\r\nimport { VEditMe } from \"./VEditMe\";\r\nimport { VAdminSetting } from \"./VAdminSetting\";\r\n\r\nexport class CMe extends CUqBase {\r\n\tunitOwner: User;\r\n\trootUnits: QueryPager<any>;\r\n\tadmins: {id:number;role:number}[] = null;\r\n\tisAdmin: boolean = false;\r\n\tmap = new Map();\r\n\tconstructor(res:any) {\r\n\t\tsuper(res);\r\n\t\tmakeObservable(this, {\r\n\t\t\tisAdmin: observable,\r\n\t\t\tmap: observable.shallow,\r\n\t\t});\r\n\t}\r\n\r\n\tmapAdd = () => {\r\n\t\tlet v = this.map.get(1);\r\n\t\tif (!v) {\r\n\t\t\tv = 1;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tv = {v};\r\n\t\t}\r\n\t\tthis.map.set(1, v);\r\n\t}\r\n\r\n    protected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => {\r\n\t\treturn this.renderView(VMe);\r\n\t}\r\n\r\n\tshowEditMe = async () => {\r\n\t\tthis.openVPage(VEditMe);\r\n\t}\r\n\r\n\tload = async () => {\r\n\t\tlet admins = await this.uqs.JkMe.getAdmins();\r\n\t\tif (!admins) return;\r\n\t\tlet userId = this.user.id;\r\n\t\tlet p = admins.findIndex(v => v.id === userId);\r\n\t\tif (p >= 0) admins.splice(p, 1);\r\n\t\tthis.admins = admins;\r\n\t\tthis.isAdmin = true;\r\n\t}\r\n\r\n\tbackend = async () => {\r\n\t\t//let cRoles = new CRoles(this.uq, this.res);\r\n\t\t//await cRoles.start();\r\n\t}\r\n\r\n\tadminSetting = async () => {\r\n\t\tthis.openVPage(VAdminSetting);\r\n\t}\r\n\r\n\ttestPointShop = async () => {\r\n\t\t//let ret = await this.uqs.JkPointShop.GetPoints.query({customer: 1});\r\n\t}\r\n}\r\n","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testTimesChange = {\r\n\tname: 'TimesChange', \r\n\tdiscription: 'Test Times Change hours', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet tc = uqs.BzTimesChange;\r\n\t\tlet ret = await tc.IDActs({\r\n\t\t\tstaff: [\r\n\t\t\t\t{id: undefined, no: '101', firstName: 'Song', lastName: 'Sha'}\r\n\t\t\t]\r\n\t\t});\r\n\t\tlog(ret);\r\n\t\tlet id = 13369344;\r\n\t\tlet r1 = await tc.IDActs({\r\n\t\t\thours: [\r\n\t\t\t\t{id, onsite:{value: 3, time: new Date(2021, 0, 1)}}\r\n\t\t\t]\r\n\t\t});\r\n\t\tlog(r1);\r\n\r\n\t\tlet month = await tc.IDLog({\r\n\t\t\tIDX: tc.Hours,\r\n\t\t\tfield: 'onsite',\r\n\t\t\tid,\r\n\t\t\tlog: 'month',\r\n\t\t\tpage: {\r\n\t\t\t\tstart: undefined,\r\n\t\t\t\tend: new Date(2021,0,1).getTime(),\r\n\t\t\t\tsize: 10,\r\n\t\t\t}\r\n\t\t});\r\n\t\tlog(month);\r\n\r\n\t\tlet sum = await tc.IDSum({\r\n\t\t\tIDX: tc.Hours,\r\n\t\t\tfield: ['onsite'],\r\n\t\t\tid: [id],\r\n\t\t\tfar: undefined,\r\n\t\t\tnear: new Date().getTime(),\r\n\t\t});\r\n\t\tlog(sum);\r\n\t\t*/\r\n\t}\r\n}\r\n","import { DebugItem } from \"../CBug\";\r\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\nimport { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\n//BzTest, BzHelloTonva, BzCustomerPayment, \r\n\r\nexport const testItem1:DebugItem = {\r\n\tname: 'HelloTonva.GetProductStock',\r\n\tdiscription: '{product: 1}',\r\n\ttest: async ( log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet a = await uqs.BzTest.ID({\r\n\t\t\tIDX: uqs.BzTest.X1,\r\n\t\t\tid: 7077888,\r\n\t\t});\r\n\t\tfor (let item of a) {\r\n\t\t\tlog(item);\r\n\t\t}\r\n\r\n\t\tlet e = await uqs.BzTest.IDActs({\r\n\t\t\ttag: [\r\n\t\t\t\t{id: undefined, type: 'a', name: 'b'},\r\n\t\t\t\t{id: undefined, type: 'a', name: 'c'},\r\n\t\t\t\t{id: undefined, type: 'd', name: 'c'},\r\n\t\t\t],\r\n\t\t\tx1: [\r\n\t\t\t\t{id: undefined, a1: 1, a2: 3, a3:5, n5: 7},\r\n\t\t\t\t{id: undefined, a1: 1, a2: 7, a3:51, n5: 71},\r\n\t\t\t],\r\n\t\t\tassign1: [\r\n\t\t\t\t{id: 3, id2: 5, val: 3},\r\n\t\t\t\t{id: 3, id2: 6, val: 30},\r\n\t\t\t],\r\n\t\t\tiBook1: [\r\n\t\t\t\t{id: 7, f1: 3.5, f2: 7.2, b: 'bbbb', c: 1},\r\n\t\t\t\t{id: 8, f1: 3.5, f2: 7.2, b: 'bbbbc', c: 2},\r\n\t\t\t],\r\n\t\t});\r\n\t\tlog(e);\r\n\r\n\t\tlet b = await uqs.BzTest.IDDetail<BzTest.OrderMaster, BzTest.OrderDetail>\r\n\t\t({\r\n\t\t\tmaster: {\r\n\t\t\t\tID: uqs.BzTest.OrderMaster,\r\n\t\t\t\tvalue: {customer: 1 },\r\n\t\t\t},\r\n\t\t\tdetail: {\r\n\t\t\t\tID: uqs.BzTest.OrderDetail,\r\n\t\t\t\tvalues: [\r\n\t\t\t\t\t{product:11, price:2.0, quantity:3.0, amount:6.0},\r\n\t\t\t\t\t{product:12, price:2.0, quantity:5.0, amount:10.0},\r\n\t\t\t\t]\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\tlog(b);\r\n\r\n\t\tlet c = await uqs.BzTest.IDDetailGet<BzTest.OrderMaster, BzTest.OrderDetail>({\r\n\t\t\tid: 8716325,\r\n\t\t\tmaster: uqs.BzTest.OrderMaster,\r\n\t\t\tdetail: uqs.BzTest.OrderDetail,\r\n\t\t});\r\n\r\n\t\tfor (let ci of c) {\r\n\t\t\tlog(ci);\r\n\t\t}\r\n\r\n\t\t//let u: BzHelloTonva.Return$pokedRet;\r\n\t\t//u.poke = 1;\r\n\t\t// eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n\t\tlet f = BzCustomerPayment.EnumCustomerAction.confirm;\r\n\r\n\t\tlet ret = await uqs.BzHelloTonva.GetProductStock.query({product: 1});\r\n\t\tlog(ret);\r\n\t\t*/\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t\tlog('test1');\r\n\t}\r\n}","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testItem2 = {\r\n\tname: '第二测试', \r\n\tdiscription: 'second test', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet ret = await uqs.BzHelloTonva.TestArr.submitReturns({rows: [\r\n\t\t\t{a: 1, b: 2}, \r\n\t\t\t{a: 3, b: 4}, \r\n\t\t]});\r\n\t\tlog(ret);\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\t*/\r\n\t}\r\n}\r\n","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testItem3 = {\r\n\tname: '第三测试', \r\n\tdiscription: 'third test', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet a = await uqs.BzTest.IDLog({\r\n\t\t\tIDX: uqs.BzTest.IBook1,\r\n\t\t\tfield: 'f2',\r\n\t\t\tid: 7,\r\n\t\t\tlog: 'each',\r\n\t\t\tpage: {start:undefined, size: 50},\r\n\t\t});\r\n\t\tlog(a);\r\n\r\n\t\tlet b = await uqs.BzTest.KeyID({\r\n\t\t\tID: uqs.BzTest.X1,\r\n\t\t\tkey: {a1: 1, a2: undefined},\r\n\t\t});\r\n\t\tlog(b);\r\n\r\n\t\tlet c = await uqs.BzTest.IX({\r\n\t\t\tIX: uqs.BzTest.Assign1,\r\n\t\t\tid: 3,\r\n\t\t});\r\n\t\tlog(c);\r\n\r\n\t\tlet d = await uqs.BzTest.KeyIX({\r\n\t\t\tID: uqs.BzTest.X1,\r\n\t\t\tkey: {a1: 1, a2: undefined},\r\n\t\t\tIX: uqs.BzTest.Assign1,\r\n\t\t});\r\n\t\tlog(d);\r\n\r\n\t\tlet e = await uqs.BzTest.IDActs({\r\n\t\t\tiBook1: [\r\n\t\t\t\t{id: -7, f1: 3.5, f2: 7.2, b: 'bbbb', c: 1},\r\n\t\t\t]\r\n\t\t});\r\n\t\tlog(e);\r\n\r\n\t\tlet ret = await uqs.BzHelloTonva.TestArr.submitReturns({rows: [\r\n\t\t\t{a: 1, b: 2}, \r\n\t\t\t{a: 3, b: 4}, \r\n\t\t]});\r\n\t\tlog(ret);\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\tlog('test2 - ddd ');\r\n\t\t*/\r\n\t}\r\n}\r\n","import { UQs } from \"uq-app\";\r\nimport { Log } from \"../Logger\";\r\n\r\nexport const testItem4 = {\r\n\tname: 'Tag测试', \r\n\tdiscription: 'Tag Test', \r\n\ttest: async (log: Log, uqs: UQs):Promise<void> => {\r\n\t\t/*\r\n\t\tlet ret = await uqs.BzTest.IX({\r\n\t\t\tIX: uqs.BzTest.CustomerTag,\r\n\t\t\tid: 1,\r\n\t\t\tIDX: [uqs.BzTest.Tag],\r\n\t\t\tpage: undefined,\r\n\t\t});\r\n\t\tlog(ret);\r\n\t\t*/\r\n\t}\r\n}\r\n","import { DebugItem } from \"../CBug\";\r\nimport { testTimesChange } from \"./test-times-change\";\r\nimport { testItem1 } from \"./test1\";\r\nimport { testItem2 } from \"./test2\";\r\nimport { testItem3 } from \"./test3\";\r\nimport { testItem4 } from \"./test4\";\r\n\r\nexport const debugItems: DebugItem[] = [\r\n\ttestItem1,\r\n\ttestItem2,\r\n\ttestItem3,\r\n\ttestItem4,\r\n\ttestTimesChange,\r\n];\r\n","import { FA, LMR, VPage } from \"tonva-react\";\r\nimport { CBug, DebugItem } from \"./CBug\";\r\n\r\nexport class VBug extends VPage<CBug> {\r\n\theader() {\r\n\t\treturn <div className=\"px-3\">\r\n\t\t\tDebug\r\n\t\t\t<small className=\"text-muted\"> - 本页仅调试状态可见</small>\r\n\t\t</div>\r\n\t}\r\n\tcontent() {\r\n        return <div>\r\n\t\t\t<div>\r\n\t\t\t\t{this.controller.debugItems.map(this.renderItem)}\r\n\t\t\t</div>\r\n\t\t\t<div className=\"px-3 py-2\">\r\n\t\t\t\t<button className=\"btn btn-primary\" onClick={this.controller.test}>test</button>\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderItem = (item:DebugItem, index:number):JSX.Element => {\r\n\t\tlet {name, discription} = item;\r\n\t\tlet right = <FA name=\"angle-right\" />;\r\n\t\treturn <LMR key={index} className=\"px-3 py-2 cursor-pointer mt-1 bg-white\"\r\n\t\t\tonClick={() => this.controller.openDebugPage(item)}\r\n\t\t\tright={right}>\r\n\t\t\t<div>{name} <small className=\"text-muted\">{discription}</small></div>\r\n\t\t</LMR>;\r\n\t}\r\n}","import { VPage } from \"tonva-react\";\r\nimport { CBug } from \"./CBug\";\r\n\r\nexport class VConsole extends VPage<CBug> {\r\n\tprivate div: HTMLDivElement;\r\n\tprivate divBottom: HTMLDivElement;\r\n\tinit() {\r\n\t\tthis.startAutoScrollToBottom();\r\n\t}\r\n\theader() {\r\n\t\treturn this.controller.currentItem.name;\r\n\t}\r\n\tcontent() {\r\n\t\tlet {currentItem} = this.controller;\r\n\t\tlet {name, discription} = currentItem;\r\n\t\treturn <div>\r\n\t\t\t<div className=\"p-3\">\r\n\t\t\t<div><b>{name}</b></div>\r\n\t\t\t<div>{discription}</div>\r\n\t\t\t</div>\r\n\t\t\t<div ref={t => this.div = t} className=\"p-3 border-top border-primary bg-light\" />\r\n\t\t\t<div ref={t => this.divBottom = t} />\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate autoScrollEnd:boolean = false;\r\n\tprivate autoScroll = true;\r\n    private lastScrollTop = 0;\r\n    private timeHandler:any;\r\n    private startAutoScrollToBottom() {\r\n\t\tif (this.autoScrollEnd === true) return;\r\n\t\tthis.autoScroll = true;\r\n\t\tif (this.timeHandler !== undefined) return;\r\n        this.timeHandler = setInterval(() => {\r\n\t\t\tif (this.autoScroll === false) return;\r\n            this.divBottom?.scrollIntoView();\r\n        }, 100);\r\n    }\r\n    private endAutoScrollToBottom() {\r\n        setTimeout(() => {\r\n\t\t\tthis.autoScroll = false;\r\n\t\t\tthis.autoScrollEnd = true;\r\n\t\t\tif (this.timeHandler === undefined) return;\r\n\t\t\tclearInterval(this.timeHandler);\r\n\t\t\tthis.timeHandler = undefined;\r\n\t\t}, 300);\r\n\t}\r\n\tprivate pauseAutoScrollToBottom() {\r\n\t\tthis.autoScroll = false;\r\n\t}\r\n\tprotected onPageScroll(e:any) {\r\n        let el = e.target as HTMLBaseElement;\r\n        let {scrollTop, scrollHeight, offsetHeight} = el;\r\n        if (scrollTop <= this.lastScrollTop) {\r\n            this.pauseAutoScrollToBottom();\r\n        }\r\n        else if (scrollTop + offsetHeight > scrollHeight - 30) {\r\n            this.startAutoScrollToBottom();\r\n        }\r\n\r\n        this.lastScrollTop = scrollTop;\r\n\t}\r\n\r\n\tlog = (message?: any):void => {\r\n\t\tconst range = document.createRange();\r\n\t\trange.selectNode(this.div);\r\n\t\tlet html:string;\r\n\t\tif (!message) {\r\n\t\t\thtml = '<div>&nbsp;</div>';\r\n\t\t}\r\n\t\telse if (typeof message === 'object') {\r\n\t\t\thtml = this.objToHtml(message);\r\n\t\t}\r\n\t\telse {\r\n\t\t\thtml = '<div>' + message + '</div>';\r\n\t\t}\r\n\t\tconst child = range.createContextualFragment(html);\r\n\t\tthis.div.appendChild(child);\r\n\t}\r\n\r\n\tprivate objToHtml(obj: any) {\r\n\t\tif (obj === null) return '<div>null</div>';\r\n\t\tif (obj === undefined) return '<div>undefined</div>';\r\n\t\tif (Array.isArray(obj) === true) {\r\n\t\t\treturn this.arrToHtml(0, obj);\r\n\t\t}\r\n\t\tlet ret = '<div>{</div>';\r\n\t\tfor (let i in obj) {\r\n\t\t\tret += this.indent(1) + i + ': ';\r\n\t\t\tlet v = obj[i];\r\n\t\t\tif (Array.isArray(v) === true) {\r\n\t\t\t\tret += this.arrToHtml(1, v);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tret += this.objToString(v);\r\n\t\t\t}\r\n\t\t}\r\n\t\tret += '<div>}</div>';\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate indent(n:number) {\r\n\t\tif (!n) return '';\r\n\t\tlet ret = '';\r\n\t\tn = n*2;\r\n\t\tfor (let i=0; i<n; i++) ret += '&emsp;';\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate objToString(obj: any) {\r\n\t\tif (obj === null) {\r\n\t\t\treturn 'null';\r\n\t\t}\r\n\t\tif (Array.isArray(obj) === true) {\r\n\t\t\treturn 'array[' + obj.length + ']';\r\n\t\t}\r\n\t\tswitch (typeof obj) {\r\n\t\tdefault: return obj.toString();\r\n\t\tcase 'undefined': return 'undefined';\r\n\t\tcase 'object':\r\n\t\t\tif (obj.tuid === undefined) {\r\n\t\t\t\treturn 'obj';\r\n\t\t\t}\r\n\t\t\treturn obj.id;\r\n\t\t}\r\n\t}\r\n\r\n\tprivate objToLine(indent:number, obj:any) {\r\n\t\tlet first = true;\r\n\t\tlet ret = '<div>' + this.indent(indent) + '{ ';\r\n\t\tfor (let i in obj) {\r\n\t\t\tif (first === false) {\r\n\t\t\t\tret += ', ';\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tfirst = false;\r\n\t\t\t}\r\n\t\t\tret += i + ':' + this.objToString(obj[i]);\r\n\t\t}\r\n\t\tret += ' }</div>';\r\n\t\treturn ret;\r\n\t}\r\n\r\n\tprivate indentVal(indent:number, val:any):string {\r\n\t\treturn '<div>' + this.indent(indent) + val + '</div>'\r\n\t}\r\n\tprivate arrToHtml(indent:number, arr:any[]) {\r\n\t\tlet ret = '<div>' + this.indent(indent) + '[</div>';\r\n\t\tfor (let item of arr) {\r\n\t\t\tlet t:string|number;\r\n\t\t\tswitch (typeof item) {\r\n\t\t\t\tdefault: t = this.indentVal(indent+1, item); break;\r\n\t\t\t\tcase 'object': t = this.objToLine(indent+1, item); break;\r\n\t\t\t\tcase 'string': t = this.indentVal(indent+1, `'${item}'`); break;\r\n\t\t\t}\r\n\t\t\tret += t;\r\n\t\t}\r\n\t\tret += '<div>' + this.indent(indent) + ']</div>';\r\n\t\treturn ret;\r\n\t}\r\n}\r\n","import { CUqBase, UQs } from \"uq-app\";\r\nimport { Log } from \"./Logger\";\r\nimport { debugItems } from \"./tester\";\r\nimport { VBug } from \"./VBug\";\r\nimport { VConsole } from \"./VConsole\";\r\n\r\nexport interface DebugItem {\r\n\tname: string;\r\n\tdiscription?: string;\r\n\ttest: (log:Log, uqs: UQs) => Promise<void>;\r\n}\r\n\r\nexport class CBug extends CUqBase {\r\n\tdebugItems = [...debugItems];\r\n\tcurrentItem: DebugItem;\r\n\r\n\tprotected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => this.renderView(VBug);\r\n\r\n\tload = async () => {\r\n\r\n\t}\r\n\r\n\topenDebugPage = async (item:DebugItem) => {\r\n\t\tthis.currentItem = item;\r\n\t\tlet console = await this.openVPage(VConsole);\r\n\t\tlet {test} = item;\r\n\t\tlet start = new Date();\r\n\t\tconsole.log(`=== test start at ${start} ===`);\r\n\t\tconsole.log();\r\n\t\tawait test(console.log, this.uqs);\r\n\t\tlet span = Date.now() - start.getTime();\r\n\t\tlet ms = (1000 + (span % 1000)).toString().substr(1);\r\n\t\tlet s = Math.floor(span / 1000);\r\n\t\tlet m = Math.floor(s / 60);\r\n\t\tlet t = '';\r\n\t\tif (m > 0) t += ms + '\\'';\r\n\t\tt += s + '\"' + ms;\r\n\t\tconsole.log();\r\n\t\tconsole.log(`=== test end: ${t} ===`);\r\n\t}\r\n\r\n\ttest = async () => {\r\n\t\tlet uqName = 'BizDev/hello-tonva';\r\n\t\tlet roles = await this.getUqRoles(uqName);\r\n\t\talert(roles);\r\n\t}\r\n}\r\n","import { zh } from \"./zh\";\r\nimport { en } from \"./en\";\r\n\r\nexport const res = {\r\n\t$zh: zh,\r\n\t$en: en,\r\n}\r\n","export const zh = {\r\n\thome: '首页',\r\n\trelation: '关系',\r\n\tdiscover: '发现',\r\n\tsupervise: '团队',\r\n\ttest: '测试',\r\n\tdebug: 'Debug',\r\n\tme: '我',\r\n\r\n\tchangePassword: '修改密码',\r\n\taboutTheApp: '关于本APP',\r\n\tlogout: '退出登录',\r\n\tpleaseLogin: '登录',\r\n\tuserQuit: '注销用户',\r\n\r\n\tcontent: '内容',\r\n\tbackend: '后台管理',\r\n\r\n\tlist: '列表',\r\n}\r\n","export const en = {\r\n\thome: 'Home',\r\n\trelation: 'Relation',\r\n\tdiscover: 'Discover',\r\n\tsupervise: 'Supervise',\r\n\ttest: 'Test',\r\n\tdebug: 'Debug',\r\n\tme: 'Me',\r\n\r\n\tchangePassword: 'Change password',\r\n\taboutTheApp: 'About the APP',\r\n\tlogout: 'Logout',\r\n\tpleaseLogin: 'Login',\r\n\tuserQuit: 'User quit',\r\n\r\n\tcontent: 'Content',\r\n\tbackend: 'Backend Management',\r\n\r\n\tlist: 'List',\r\n}\r\n","//=== UqApp builder created on Tue Jan 05 2021 18:41:24 GMT-0500 (GMT-05:00) ===//\r\nimport { VPage, TabProp, TabCaptionComponent, t, TabsProps, PageWebNav } from 'tonva-react';\r\nimport { CApp } from './CApp';\r\n\r\nconst color = (selected: boolean) => selected === true ? 'text-primary' : 'text-muted';\r\nfunction caption(label:string|JSX.Element, icon:string) {\r\n\treturn (selected: boolean) => TabCaptionComponent(label, icon, color(selected));\r\n}\r\n\r\nexport class VMain extends VPage<CApp> {\r\n\tprotected get tabsProps(): TabsProps {\r\n\t\tlet { cHome, cMe, cSupervise, ops } = this.controller;\r\n\t\tlet tabs: TabProp[] = [\r\n\t\t\t{name: 'home', caption: caption(t('home'), 'home'), content: cHome.tab},\r\n\t\t]\r\n\t\tif (ops.length > 0) {\r\n\t\t\ttabs.push(\r\n\t\t\t\t{name: 'supervise', caption: caption(t('supervise'), 'bar-chart'), content: cSupervise.tab, load: cSupervise.load},\r\n\t\t\t);\t\r\n\t\t}\r\n\t\ttabs.push(\r\n\t\t\t{name: 'me', caption: caption(t('me'), 'user-o'), content: cMe.tab, load: cMe.load},\r\n\t\t);\r\n\t\t/*\r\n\t\tif (this.isDev === true) {\r\n\t\t\ttabs.push({\r\n\t\t\t\tname: 'UI', caption: caption(t('UI'), 'television'), content: cUI.tab\r\n\t\t\t});\r\n\t\t\ttabs.push({\r\n\t\t\t\tname: 'debug', caption: caption(t('debug'), 'bug'), content: cBug.tab, onShown: cBug.load\r\n\t\t\t});\r\n\t\t}\r\n\t\t*/\r\n\t\treturn {tabs};\r\n\t}\r\n\r\n\tprotected get webNav(): PageWebNav {\r\n\t\treturn {\r\n\t\t\tnavHeader: <div>webNav header</div>, \r\n\t\t\tnavFooter: <div>webNav footer</div>,\r\n\t\t};\r\n\t}\r\n}\r\n","//=== UqApp builder created on Fri Nov 12 2021 10:10:02 GMT-0500 (北美东部标准时间) ===//\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { IDXValue, Uq, UqTuid, UqAction, UqQuery, UqID, UqIDX, UqIX } from \"tonva-core\";\n\n\n//===============================\n//======= UQ 百灵威系统工程部/me ========\n//===============================\n\nexport enum Item {\n\torderDeliver = 1010,\n\torderAmount = 1011,\n\torderProfit = 1012,\n\torderReturn = 1020,\n\torderReceive = 1030,\n\torderReceiveReturn = 1040,\n\tprofitFee = 1110,\n\tcouponFee = 1111,\n\tamountFee = 1120,\n\tcustomerPoint = 2010\n}\n\nexport enum Post {\n\tstaff = 1010,\n\tstaffSales = 1100,\n\tmanager = 2010,\n\tmanagerIT = 2100,\n\tagent = 7010,\n\tagentSales = 7100,\n\tdistributor = 7500,\n\tdistributorSales = 7501,\n\tcustomer = 8010\n}\n\nexport enum OrderReady {\n\tsheet = 1,\n\tcost = 2\n}\n\nexport enum EnumRole {\n\tall = 1,\n\tdev = 2\n}\n\nexport enum EnumRoleOp {\n\ttest = 1\n}\n\nexport enum EnumObjectType {\n\tnone = 0,\n\tuser = 1,\n\tcustomer = 2,\n\tstaff = 3,\n\tagent = 4,\n\tdistributor = 5,\n\tpost = 6\n}\n\nexport enum EnumAccount {\n\tcommission = 10\n}\n\nexport enum EnumBizOpType {\n\torderDeliverDone = 101,\n\torderReceiveDone = 102,\n\torderReturn = 103\n}\n\nexport interface Tuid$sheet {\n\tid?: number;\n\tno: string;\n\tuser: number;\n\tdate: any;\n\tsheet: number;\n\tversion: number;\n\tflow: number;\n\tapp: number;\n\tstate: number;\n\tdiscription: string;\n\tdata: string;\n\tprocessing: number;\n}\n\nexport interface Tuid$user {\n\tid?: number;\n\tname: string;\n\tnick: string;\n\ticon: string;\n\tassigned: string;\n\tpoke: number;\n\ttimezone: number;\n}\n\nexport interface ParamBusTestBoundStaffSales {\n\torderMain: number;\n}\nexport interface ResultBusTestBoundStaffSales {\n}\n\nexport interface ParamBusTestOrderSaleCost {\n\torder: number;\n\tdetail: {\n\t\torderDetail: number;\n\t\tcost: number;\n\t}[];\n\n}\nexport interface ResultBusTestOrderSaleCost {\n}\n\nexport interface ParamCalcMonthSum {\n}\nexport interface ResultCalcMonthSum {\n}\n\nexport interface ParamExecQueueBizOp {\n}\nexport interface ResultExecQueueBizOp {\n}\n\nexport interface ParamExecQueueBizMain {\n}\nexport interface ResultExecQueueBizMain {\n}\n\nexport interface ParamDoneDeliver {\n\tcustomer: number;\n\tcontact: number;\n\twarehouse: number;\n\tdetail: {\n\t\torderDetail: number;\n\t\tquantity: number;\n\t}[];\n\n}\nexport interface ResultDoneDeliver {\n}\n\nexport interface ParamCalcDaySum {\n}\nexport interface ResultCalcDaySum {\n}\n\nexport interface Param$setMyTimezone {\n\t_timezone: number;\n}\nexport interface Result$setMyTimezone {\n}\n\nexport interface Param_BuildLostSalesStaffOrderAmount {\n}\nexport interface Result_BuildLostSalesStaffOrderAmount {\n}\n\nexport interface ParamCalcAccount {\n}\nexport interface ResultCalcAccount {\n}\n\nexport interface Param$poked {\n}\nexport interface Return$pokedRet {\n\tpoke: number;\n}\nexport interface Result$poked {\n\tret: Return$pokedRet[];\n}\n\nexport interface ParamGetPostTitles {\n}\nexport interface ReturnGetPostTitlesRet {\n\tid: number;\n\ttitle: string;\n\tvice: string;\n}\nexport interface ResultGetPostTitles {\n\tret: ReturnGetPostTitlesRet[];\n}\n\nexport interface ParamGetItemTitles {\n}\nexport interface ReturnGetItemTitlesRet {\n\tid: number;\n\ttitle: string;\n\tvice: string;\n\tunit: string;\n\tfixed: number;\n}\nexport interface ResultGetItemTitles {\n\tret: ReturnGetItemTitlesRet[];\n}\n\nexport interface ParamUserObjectPostItem {\n}\nexport interface ReturnUserObjectPostItemRet {\n\tid: number;\n\tobject: number;\n\tpost: any;\n\titem: any;\n}\nexport interface ResultUserObjectPostItem {\n\tret: ReturnUserObjectPostItemRet[];\n}\n\nexport interface ParamGetUserSuperviseItem {\n}\nexport interface ReturnGetUserSuperviseItemRet {\n\titem: any;\n}\nexport interface ResultGetUserSuperviseItem {\n\tret: ReturnGetUserSuperviseItemRet[];\n}\n\nexport interface ParamGetItemSumMonths {\n\titem: any;\n\tdate: any;\n\tmonths: number;\n}\nexport interface ReturnGetItemSumMonthsRet {\n\tdate: any;\n\tvalue: number;\n}\nexport interface ResultGetItemSumMonths {\n\tret: ReturnGetItemSumMonthsRet[];\n}\n\nexport interface ParamGetItemSumDays {\n\titem: any;\n\tdate: any;\n\tdays: number;\n}\nexport interface ReturnGetItemSumDaysRet {\n\tdate: any;\n\tvalue: number;\n}\nexport interface ResultGetItemSumDays {\n\tret: ReturnGetItemSumDaysRet[];\n}\n\nexport interface ParamGetItemHistory {\n\titem: any;\n\tfrom: any;\n\tto: any;\n}\nexport interface ReturnGetItemHistory$page {\n\tid: number;\n\tbiz: number;\n\tbizOp: number;\n\titem: any;\n\tvalue: number;\n\tmemo: string;\n}\nexport interface ResultGetItemHistory {\n\t$page: ReturnGetItemHistory$page[];\n}\n\nexport interface ParamGetProductSumByMonth {\n\titem: any;\n\tmonth: number;\n\tcount: number;\n}\nexport interface ReturnGetProductSumByMonthRet {\n\tid: number;\n\tvalue: number;\n\tamount: number;\n\tprofit: number;\n\treceive: number;\n\treturn: number;\n}\nexport interface ResultGetProductSumByMonth {\n\tret: ReturnGetProductSumByMonthRet[];\n}\n\nexport interface ParamGetMonthSumProduct {\n\titem: any;\n\tid: number;\n}\nexport interface ReturnGetMonthSumProduct$page {\n\tmonth: number;\n\tvalue: number;\n\tamount: number;\n\tprofit: number;\n\treceive: number;\n\treturn: number;\n}\nexport interface ResultGetMonthSumProduct {\n\t$page: ReturnGetMonthSumProduct$page[];\n}\n\nexport interface ParamGetMonthSumCustomer {\n\titem: any;\n\tid: number;\n}\nexport interface ReturnGetMonthSumCustomer$page {\n\tmonth: number;\n\tvalue: number;\n\tamount: number;\n\tprofit: number;\n\treceive: number;\n\treturn: number;\n}\nexport interface ResultGetMonthSumCustomer {\n\t$page: ReturnGetMonthSumCustomer$page[];\n}\n\nexport interface ParamGetCustomerSumByMonth {\n\titem: any;\n\tmonth: number;\n\tcount: number;\n}\nexport interface ReturnGetCustomerSumByMonthRet {\n\tid: number;\n\tvalue: number;\n\tamount: number;\n\tprofit: number;\n\treceive: number;\n\treturn: number;\n}\nexport interface ResultGetCustomerSumByMonth {\n\tret: ReturnGetCustomerSumByMonthRet[];\n}\n\nexport interface ParamGetRoleOps {\n}\nexport interface ReturnGetRoleOpsRet {\n\trole: any;\n\top: any;\n}\nexport interface ResultGetRoleOps {\n\tret: ReturnGetRoleOpsRet[];\n}\n\nexport interface ParamGetObjects {\n}\nexport interface ReturnGetObjectsRet {\n\tid: number;\n\ttype: any;\n}\nexport interface ResultGetObjects {\n\tret: ReturnGetObjectsRet[];\n}\n\nexport interface ParamGetGroupObjects {\n\tgroup: number;\n}\nexport interface ReturnGetGroupObjectsRet {\n\tid: number;\n\ttype: any;\n}\nexport interface ResultGetGroupObjects {\n\tret: ReturnGetGroupObjectsRet[];\n}\n\nexport interface ParamGetGroups {\n}\nexport interface ReturnGetGroupsRet {\n\tid: number;\n\tname: string;\n}\nexport interface ResultGetGroups {\n\tret: ReturnGetGroupsRet[];\n}\n\nexport interface ParamGetPosts {\n}\nexport interface ReturnGetPostsRet {\n\topi: number;\n\tobj: number;\n\tpost: any;\n\titem: any;\n\tamountThisMonth: number;\n\tamountLastMonth: number;\n}\nexport interface ResultGetPosts {\n\tret: ReturnGetPostsRet[];\n}\n\nexport interface ParamGetDistributors {\n}\nexport interface ReturnGetDistributorsRet {\n\tid: number;\n\tdistributor: number;\n}\nexport interface ResultGetDistributors {\n\tret: ReturnGetDistributorsRet[];\n}\n\nexport interface ParamGetStaffs {\n}\nexport interface ReturnGetStaffsRet {\n\topi: number;\n\titem: any;\n\tobj: number;\n\tstaff: number;\n\tvalueToday: number;\n\tvalueThisMonth: number;\n\tvalueLastMonth: number;\n}\nexport interface ResultGetStaffs {\n\tret: ReturnGetStaffsRet[];\n}\n\nexport interface ParamGetAgents {\n}\nexport interface ReturnGetAgentsRet {\n\tid: number;\n\tagent: number;\n}\nexport interface ResultGetAgents {\n\tret: ReturnGetAgentsRet[];\n}\n\nexport interface ParamGetObjectItemPeriodHistory {\n\tobjectPostItem: number;\n\tfrom: any;\n\tto: any;\n\tperiod: number;\n}\nexport interface ReturnGetObjectItemPeriodHistoryRet {\n\tdate: any;\n\tvalue: number;\n}\nexport interface ResultGetObjectItemPeriodHistory {\n\tret: ReturnGetObjectItemPeriodHistoryRet[];\n}\n\nexport interface ParamGetObjectPostItem {\n\tobject: number;\n}\nexport interface ReturnGetObjectPostItemRet {\n\tid: number;\n\tobject: number;\n\tpost: any;\n\titem: any;\n}\nexport interface ResultGetObjectPostItem {\n\tret: ReturnGetObjectPostItemRet[];\n}\n\nexport interface ParamGetObjectItemHistory {\n\tobjectPostItem: number;\n\tfrom: any;\n\tto: any;\n}\nexport interface ReturnGetObjectItemHistoryRet {\n\tminuteId: number;\n\tbiz: number;\n\tbizOp: number;\n\tvalue: number;\n\tmemo: string;\n}\nexport interface ResultGetObjectItemHistory {\n\tret: ReturnGetObjectItemHistoryRet[];\n}\n\nexport interface ParamGetObjectItemPeriodSum {\n\tobject: number;\n\tfrom: any;\n\tto: any;\n}\nexport interface ReturnGetObjectItemPeriodSumRet {\n\tid: number;\n\tobject: number;\n\tpost: any;\n\titem: any;\n\tvalue: number;\n}\nexport interface ResultGetObjectItemPeriodSum {\n\tret: ReturnGetObjectItemPeriodSumRet[];\n}\n\nexport interface ParamGetUserObjectItemPeriodSum {\n\tfrom: any;\n\tto: any;\n}\nexport interface ReturnGetUserObjectItemPeriodSumRet {\n\tid: number;\n\tobject: number;\n\tpost: any;\n\titem: any;\n\tvalue: number;\n}\nexport interface ResultGetUserObjectItemPeriodSum {\n\tret: ReturnGetUserObjectItemPeriodSumRet[];\n}\n\nexport interface ParamGetItemPeriodSum {\n\tdate: any;\n\tdays: number;\n}\nexport interface ReturnGetItemPeriodSumRet {\n\titem: any;\n\tvalue: number;\n}\nexport interface ResultGetItemPeriodSum {\n\tret: ReturnGetItemPeriodSumRet[];\n}\n\nexport interface Param$getMyTimezone {\n}\nexport interface Return$getMyTimezoneRet {\n\ttimezone: number;\n\tunitTimeZone: number;\n}\nexport interface Result$getMyTimezone {\n\tret: Return$getMyTimezoneRet[];\n}\n\nexport interface ParamGetUserObjectAccount {\n\tobject: number;\n}\nexport interface ReturnGetUserObjectAccountRet {\n\tobjectAccount: number;\n\tobject: number;\n\tpost: any;\n\taccount: any;\n\tbalance: number;\n}\nexport interface ResultGetUserObjectAccount {\n\tret: ReturnGetUserObjectAccountRet[];\n}\n\nexport interface ParamGetAccountTitles {\n}\nexport interface ReturnGetAccountTitlesRet {\n\tid: number;\n\ttitle: string;\n\tvice: string;\n\tunit: string;\n\tfixed: number;\n}\nexport interface ResultGetAccountTitles {\n\tret: ReturnGetAccountTitlesRet[];\n}\n\nexport interface ParamGetObjectAccountHistory {\n\tobjectAccount: number;\n}\nexport interface ReturnGetObjectAccountHistoryRet {\n\tdate: number;\n\tvalue: number;\n\tpost: any;\n\titem: any;\n}\nexport interface ResultGetObjectAccountHistory {\n\tret: ReturnGetObjectAccountHistoryRet[];\n}\n\nexport interface ParamGetAccounts {\n}\nexport interface ReturnGetAccountsRet {\n\tid: number;\n\tobject: number;\n\taccount: any;\n\tbalance: number;\n\tobjectType: any;\n\tobjectTo: number;\n}\nexport interface ResultGetAccounts {\n\tret: ReturnGetAccountsRet[];\n}\n\nexport interface Object {\n\tid?: number;\n\ttype: any;\n\tto: number;\n}\n\nexport interface ItemHistory {\n\tid?: number;\n\tbizOp: number;\n\titem: any;\n\tvalue: number;\n\tmemo: number;\n}\n\nexport interface OrderDetail {\n\tid?: number;\n\tmain?: number;\n\titem: number;\n\tproduct: number;\n\tquantity: number;\n\tamount: number;\n\tprice: number;\n}\n\nexport interface OrderMain {\n\tid?: number;\n\tno?: string;\n\twebUser: number;\n\tcustomerAccount: number;\n\tseller: number;\n\tcurrency: number;\n\tsumAmount: number;\n\tstamp: number;\n}\n\nexport interface ItemTitle {\n\tid?: number;\n\ttitle: string;\n\tvice: string;\n\tunit: string;\n\tfixed: number;\n}\n\nexport interface PostTitle {\n\tid?: number;\n\ttitle: string;\n\tvice: string;\n}\n\nexport interface ObjectUser {\n\tid?: number;\n\tuser: number;\n}\n\nexport interface ObjectStaff {\n\tid?: number;\n\tstaff: number;\n}\n\nexport interface ObjectPost {\n\tid?: number;\n\tpost: any;\n}\n\nexport interface ObjectCustomer {\n\tid?: number;\n\tcustomer: number;\n}\n\nexport interface ObjectPostItem {\n\tid?: number;\n\tobject: number;\n\tpost: any;\n\titem: any;\n}\n\nexport interface Group {\n\tid?: number;\n\tname: string;\n}\n\nexport interface ObjectDistributor {\n\tid?: number;\n\tdistributor: number;\n}\n\nexport interface ObjectAgent {\n\tid?: number;\n\tagent: number;\n}\n\nexport interface QueueBizOp {\n\tid?: number;\n\tbizOp: number;\n}\n\nexport interface QueueBizMain {\n\tid?: number;\n\tbizMain: number;\n}\n\nexport interface DeliverDetail {\n\tid?: number;\n\tmain?: number;\n\torderDetail: number;\n\tquantity: number;\n}\n\nexport interface DeliverMain {\n\tid?: number;\n\tno?: string;\n\tcustomer: number;\n\tcontact: number;\n\twarehouse: number;\n\tcutOffMain: number;\n\ttrayNumber: number;\n}\n\nexport interface Role {\n\tid?: number;\n\tname: string;\n\tdiscription: string;\n}\n\nexport interface OPIHistory {\n\tid?: number;\n\topi: number;\n\titemHistory: number;\n\tvalue: number;\n\tbooking: number;\n}\n\nexport interface ObjectAccount {\n\tid?: number;\n\tobject: number;\n\taccount: any;\n\tbalance: number;\n}\n\nexport interface BizMainBound {\n\tid?: number;\n\tbizMain: number;\n\tpost: any;\n\titem: any;\n\tto: number;\n}\n\nexport interface OPIBooking {\n\tid?: number;\n\tbizOpType: any;\n\tpost: any;\n\tpostItem: any;\n\titem: any;\n\tratio: number;\n\tmemo: number;\n}\n\nexport interface AccountTitle {\n\tid?: number;\n\ttitle: string;\n\tvice: string;\n\tunit: string;\n\tfixed: number;\n}\n\nexport interface DxOrderDetail {\n\tid: number;\n\tdeliverDone?: number;\n\treceiveDone?: number;\n\treturn?: number;\n\tcostPrice?: number;\n\t$act?: number;\n}\n\nexport interface DxOrderMain {\n\tid: number;\n\torderReady?: any;\n\t$act?: number;\n}\n\nexport interface DxBizMain {\n\tid: number;\n\tready?: number;\n\t$act?: number;\n}\n\nexport interface DxBizOp {\n\tid: number;\n\ttype?: any;\n\tbiz?: number;\n\tvalue?: number;\n\tdone?: number;\n\tstamp?: number;\n\t$act?: number;\n}\n\nexport interface DxBiz {\n\tid: number;\n\tmain?: number;\n\t$act?: number;\n}\n\nexport interface ActParamDxOrderDetail {\n\tid: number|IDXValue;\n\tdeliverDone?: number|IDXValue;\n\treceiveDone?: number|IDXValue;\n\treturn?: number|IDXValue;\n\tcostPrice?: number|IDXValue;\n\t$act?: number;\n}\n\nexport interface ActParamDxOrderMain {\n\tid: number|IDXValue;\n\torderReady?: any|IDXValue;\n\t$act?: number;\n}\n\nexport interface ActParamDxBizMain {\n\tid: number|IDXValue;\n\tready?: number|IDXValue;\n\t$act?: number;\n}\n\nexport interface ActParamDxBizOp {\n\tid: number|IDXValue;\n\ttype?: any|IDXValue;\n\tbiz?: number|IDXValue;\n\tvalue?: number|IDXValue;\n\tdone?: number|IDXValue;\n\tstamp?: number|IDXValue;\n\t$act?: number;\n}\n\nexport interface ActParamDxBiz {\n\tid: number|IDXValue;\n\tmain?: number|IDXValue;\n\t$act?: number;\n}\n\nexport interface UserObject {\n\tix: number;\n\txi: number;\n\ton: number;\n}\n\nexport interface GroupObject {\n\tix: number;\n\txi: number;\n}\n\nexport interface UserSuperviseItem {\n\tix: number;\n\txi: number;\n}\n\nexport interface MonthSumProduct {\n\tixx: number;\n\tix: number;\n\txi: number;\n\tvalue: number;\n}\n\nexport interface MonthSumCustomer {\n\tixx: number;\n\tix: number;\n\txi: number;\n\tvalue: number;\n}\n\nexport interface IxBizOpBound {\n\tix: number;\n\txi: number;\n\tbound: number;\n}\n\nexport interface UserRole {\n\tix: number;\n\txi: number;\n}\n\nexport interface RoleOps {\n\tix: number;\n\txi: number;\n}\n\nexport interface ObjectAccountHistory {\n\tix: number;\n\txi: number;\n\tvalue: number;\n\topi: number;\n}\n\nexport interface DaySumItem {\n\tix: number;\n\txi: any;\n\tvalue: number;\n}\n\nexport interface AccountBooking {\n\tix: number;\n\txi: number;\n\tradio: number;\n}\n\nexport interface ParamActs {\n\tobject?: Object[];\n\titemHistory?: ItemHistory[];\n\torderDetail?: OrderDetail[];\n\torderMain?: OrderMain[];\n\titemTitle?: ItemTitle[];\n\tpostTitle?: PostTitle[];\n\tobjectUser?: ObjectUser[];\n\tobjectStaff?: ObjectStaff[];\n\tobjectPost?: ObjectPost[];\n\tobjectCustomer?: ObjectCustomer[];\n\tobjectPostItem?: ObjectPostItem[];\n\tgroup?: Group[];\n\tobjectDistributor?: ObjectDistributor[];\n\tobjectAgent?: ObjectAgent[];\n\tqueueBizOp?: QueueBizOp[];\n\tqueueBizMain?: QueueBizMain[];\n\tdeliverDetail?: DeliverDetail[];\n\tdeliverMain?: DeliverMain[];\n\trole?: Role[];\n\toPIHistory?: OPIHistory[];\n\tobjectAccount?: ObjectAccount[];\n\tbizMainBound?: BizMainBound[];\n\toPIBooking?: OPIBooking[];\n\taccountTitle?: AccountTitle[];\n\tdxOrderDetail?: ActParamDxOrderDetail[];\n\tdxOrderMain?: ActParamDxOrderMain[];\n\tdxBizMain?: ActParamDxBizMain[];\n\tdxBizOp?: ActParamDxBizOp[];\n\tdxBiz?: ActParamDxBiz[];\n\tuserObject?: UserObject[];\n\tgroupObject?: GroupObject[];\n\tuserSuperviseItem?: UserSuperviseItem[];\n\tmonthSumProduct?: MonthSumProduct[];\n\tmonthSumCustomer?: MonthSumCustomer[];\n\tixBizOpBound?: IxBizOpBound[];\n\tuserRole?: UserRole[];\n\troleOps?: RoleOps[];\n\tobjectAccountHistory?: ObjectAccountHistory[];\n\tdaySumItem?: DaySumItem[];\n\taccountBooking?: AccountBooking[];\n}\n\n\nexport interface UqExt extends Uq {\n\tActs(param:ParamActs): Promise<any>;\n\n\t$sheet: UqTuid<Tuid$sheet>;\n\t$user: UqTuid<Tuid$user>;\n\tBusTestBoundStaffSales: UqAction<ParamBusTestBoundStaffSales, ResultBusTestBoundStaffSales>;\n\tBusTestOrderSaleCost: UqAction<ParamBusTestOrderSaleCost, ResultBusTestOrderSaleCost>;\n\tCalcMonthSum: UqAction<ParamCalcMonthSum, ResultCalcMonthSum>;\n\tExecQueueBizOp: UqAction<ParamExecQueueBizOp, ResultExecQueueBizOp>;\n\tExecQueueBizMain: UqAction<ParamExecQueueBizMain, ResultExecQueueBizMain>;\n\tDoneDeliver: UqAction<ParamDoneDeliver, ResultDoneDeliver>;\n\tCalcDaySum: UqAction<ParamCalcDaySum, ResultCalcDaySum>;\n\t$setMyTimezone: UqAction<Param$setMyTimezone, Result$setMyTimezone>;\n\t_BuildLostSalesStaffOrderAmount: UqAction<Param_BuildLostSalesStaffOrderAmount, Result_BuildLostSalesStaffOrderAmount>;\n\tCalcAccount: UqAction<ParamCalcAccount, ResultCalcAccount>;\n\t$poked: UqQuery<Param$poked, Result$poked>;\n\tGetPostTitles: UqQuery<ParamGetPostTitles, ResultGetPostTitles>;\n\tGetItemTitles: UqQuery<ParamGetItemTitles, ResultGetItemTitles>;\n\tUserObjectPostItem: UqQuery<ParamUserObjectPostItem, ResultUserObjectPostItem>;\n\tGetUserSuperviseItem: UqQuery<ParamGetUserSuperviseItem, ResultGetUserSuperviseItem>;\n\tGetItemSumMonths: UqQuery<ParamGetItemSumMonths, ResultGetItemSumMonths>;\n\tGetItemSumDays: UqQuery<ParamGetItemSumDays, ResultGetItemSumDays>;\n\tGetItemHistory: UqQuery<ParamGetItemHistory, ResultGetItemHistory>;\n\tGetProductSumByMonth: UqQuery<ParamGetProductSumByMonth, ResultGetProductSumByMonth>;\n\tGetMonthSumProduct: UqQuery<ParamGetMonthSumProduct, ResultGetMonthSumProduct>;\n\tGetMonthSumCustomer: UqQuery<ParamGetMonthSumCustomer, ResultGetMonthSumCustomer>;\n\tGetCustomerSumByMonth: UqQuery<ParamGetCustomerSumByMonth, ResultGetCustomerSumByMonth>;\n\tGetRoleOps: UqQuery<ParamGetRoleOps, ResultGetRoleOps>;\n\tGetObjects: UqQuery<ParamGetObjects, ResultGetObjects>;\n\tGetGroupObjects: UqQuery<ParamGetGroupObjects, ResultGetGroupObjects>;\n\tGetGroups: UqQuery<ParamGetGroups, ResultGetGroups>;\n\tGetPosts: UqQuery<ParamGetPosts, ResultGetPosts>;\n\tGetDistributors: UqQuery<ParamGetDistributors, ResultGetDistributors>;\n\tGetStaffs: UqQuery<ParamGetStaffs, ResultGetStaffs>;\n\tGetAgents: UqQuery<ParamGetAgents, ResultGetAgents>;\n\tGetObjectItemPeriodHistory: UqQuery<ParamGetObjectItemPeriodHistory, ResultGetObjectItemPeriodHistory>;\n\tGetObjectPostItem: UqQuery<ParamGetObjectPostItem, ResultGetObjectPostItem>;\n\tGetObjectItemHistory: UqQuery<ParamGetObjectItemHistory, ResultGetObjectItemHistory>;\n\tGetObjectItemPeriodSum: UqQuery<ParamGetObjectItemPeriodSum, ResultGetObjectItemPeriodSum>;\n\tGetUserObjectItemPeriodSum: UqQuery<ParamGetUserObjectItemPeriodSum, ResultGetUserObjectItemPeriodSum>;\n\tGetItemPeriodSum: UqQuery<ParamGetItemPeriodSum, ResultGetItemPeriodSum>;\n\t$getMyTimezone: UqQuery<Param$getMyTimezone, Result$getMyTimezone>;\n\tGetUserObjectAccount: UqQuery<ParamGetUserObjectAccount, ResultGetUserObjectAccount>;\n\tGetAccountTitles: UqQuery<ParamGetAccountTitles, ResultGetAccountTitles>;\n\tGetObjectAccountHistory: UqQuery<ParamGetObjectAccountHistory, ResultGetObjectAccountHistory>;\n\tGetAccounts: UqQuery<ParamGetAccounts, ResultGetAccounts>;\n\tObject: UqID<any>;\n\tItemHistory: UqID<any>;\n\tOrderDetail: UqID<any>;\n\tOrderMain: UqID<any>;\n\tItemTitle: UqID<any>;\n\tPostTitle: UqID<any>;\n\tObjectUser: UqID<any>;\n\tObjectStaff: UqID<any>;\n\tObjectPost: UqID<any>;\n\tObjectCustomer: UqID<any>;\n\tObjectPostItem: UqID<any>;\n\tGroup: UqID<any>;\n\tObjectDistributor: UqID<any>;\n\tObjectAgent: UqID<any>;\n\tQueueBizOp: UqID<any>;\n\tQueueBizMain: UqID<any>;\n\tDeliverDetail: UqID<any>;\n\tDeliverMain: UqID<any>;\n\tRole: UqID<any>;\n\tOPIHistory: UqID<any>;\n\tObjectAccount: UqID<any>;\n\tBizMainBound: UqID<any>;\n\tOPIBooking: UqID<any>;\n\tAccountTitle: UqID<any>;\n\tDxOrderDetail: UqIDX<any>;\n\tDxOrderMain: UqIDX<any>;\n\tDxBizMain: UqIDX<any>;\n\tDxBizOp: UqIDX<any>;\n\tDxBiz: UqIDX<any>;\n\tUserObject: UqIX<any>;\n\tGroupObject: UqIX<any>;\n\tUserSuperviseItem: UqIX<any>;\n\tMonthSumProduct: UqIX<any>;\n\tMonthSumCustomer: UqIX<any>;\n\tIxBizOpBound: UqIX<any>;\n\tUserRole: UqIX<any>;\n\tRoleOps: UqIX<any>;\n\tObjectAccountHistory: UqIX<any>;\n\tDaySumItem: UqIX<any>;\n\tAccountBooking: UqIX<any>;\n}\n\nexport function assign(uq: any, to:string, from:any): void {\n\tlet hasEntity = uq.$.hasEntity(to);\n\tif (hasEntity === false) {\n\t\treturn;\n\t}\n\tObject.assign((uq as any)[to], from);\n}\n","import { FA, LMR, VPage } from \"tonva-react\";\r\nimport { CTester, UIItem } from \"./CTest\";\r\n\r\nexport class VTester extends VPage<CTester> {\r\n\theader() {\r\n\t\treturn <div className=\"px-3\">\r\n\t\t\tUI\r\n\t\t\t<small className=\"text-muted\"> - 本页仅调试状态可见</small>\r\n\t\t</div>\r\n\t}\r\n\tcontent() {\r\n        return <div>\r\n\t\t\t<div>\r\n\t\t\t\t{this.controller.uiItems.map(this.renderItem)}\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderItem = (item:UIItem, index:number):JSX.Element => {\r\n\t\tlet {name, discription, click} = item;\r\n\t\tlet right = <FA name=\"angle-right\" />;\r\n\t\treturn <LMR key={index} className=\"px-3 py-2 cursor-pointer mt-1 bg-white\"\r\n\t\t\tonClick={click}\r\n\t\t\tright={right}>\r\n\t\t\t<div>{name} <small className=\"text-muted\">{discription}</small></div>\r\n\t\t</LMR>;\r\n\t}\r\n}\r\n","import { CBase/*, Context*/ } from \"tonva-react\";\r\n/*\r\nimport { CID, MidID, CIDX, MidIDX, MidTag, CIDTagList, CTagIDList\r\n\t, SheetUI, MidIDTagList, CSheetNew, MidSheet } from \"tonva-uqui\";\r\n*/\r\nimport { CApp, CUqBase, UQs } from \"uq-app\";\r\n//import { OrderDetail, OrderMaster } from \"uq-app/uqs/BzHelloTonva\";\r\nimport { VTester } from \"./VTest\";\r\n//import { isNumber } from \"lodash\";\r\n\r\nexport interface UIItem {\r\n\tname: string;\r\n\tdiscription?: string;\r\n\tclick: () => Promise<void>;\r\n}\r\n\r\nexport class CTester extends CUqBase {\r\n\treadonly uiItems:UIItem[] = [\r\n\t\t/*\r\n\t\t{\r\n\t\t\tname: 'customer',\r\n\t\t\tdiscription: '客户信息',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet mid = new MidID(uq, {ID:uq.Customer});\r\n\t\t\t\tlet cID = new CID(mid);\r\n\t\t\t\tawait cID.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'tag',\r\n\t\t\tdiscription: '客户标签',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet midTag = new MidTag(uq, uq.Customer, uq.CustomerTag, uq.Tag, 'customer');\r\n\t\t\t\tlet midIDTagList = new MidIDTagList(midTag);\r\n\t\t\t\tlet cIDTagList = new CIDTagList(midIDTagList);\r\n\t\t\t\tawait cIDTagList.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'tagCustomer',\r\n\t\t\tdiscription: '标签客户',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet midTag = new MidTag(uq, uq.Customer, uq.CustomerTag, uq.Tag, 'customer');\r\n\t\t\t\tlet cTagIDList = new CTagIDList(midTag);\r\n\t\t\t\tawait cTagIDList.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'staff',\r\n\t\t\tdiscription: 'TimeChange Staff',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet mid = new MidID(uq, {ID:uq.Staff});\r\n\t\t\t\tlet cStaff = new CID(mid);\r\n\t\t\t\tcStaff.renderItem = (item:any, index:number): JSX.Element => {\r\n\t\t\t\t\treturn <div className=\"\">{uq.Staff.render(item)}</div>\r\n\t\t\t\t};\r\n\t\t\t\tawait cStaff.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'hours',\r\n\t\t\tdiscription: 'TimeChange Hours',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet mid = new MidIDX(uq, uq.Hours, uq.Staff, this.timeZone);\r\n\t\t\t\tlet cHours = new CIDX(mid);\r\n\t\t\t\tawait cHours.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t{\r\n\t\t\tname: 'sheet-order',\r\n\t\t\tdiscription: 'Sheet Order Hello Tonva',\r\n\t\t\tclick: async () => {\r\n\t\t\t\tlet uq = this.uqs.BzHelloTonva;\r\n\t\t\t\tlet onChanged = async (context:Context, value:any, prev:any) => {\r\n\t\t\t\t\tlet quantity = context.getValue('quantity');\r\n\t\t\t\t\tlet price = context.getValue('price');\r\n\t\t\t\t\tif (isNumber(quantity) && isNumber(value)) {\r\n\t\t\t\t\t\tcontext.setValue('amount', (price*quantity).toFixed(2));\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet sheetUI:SheetUI = {\r\n\t\t\t\t\tmaster: {\r\n\t\t\t\t\t\tID: uq.OrderMaster,\r\n\t\t\t\t\t\tfieldCustoms: {\r\n\t\t\t\t\t\t\tcustomer: {ID: uq.Customer},\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tdetail: {\r\n\t\t\t\t\t\tID: uq.OrderDetail,\r\n\t\t\t\t\t\tfieldCustoms: {\r\n\t\t\t\t\t\t\tproduct: { ID: uq.Customer },\r\n\t\t\t\t\t\t\tprice: { onChanged },\r\n\t\t\t\t\t\t\tquantity: { onChanged },\r\n\t\t\t\t\t\t\tamount: { readOnly: true, }\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tlet mid = new MidSheet<OrderMaster, OrderDetail>(uq, sheetUI, this.res);\r\n\t\t\t\tlet cSheetNew = new CSheetNew(mid);\r\n\t\t\t\tawait cSheetNew.start();\r\n\t\t\t}\r\n\t\t},\r\n\t\t*/\r\n\t];\r\n\r\n\tprotected async internalStart() {\r\n\t\tthis.openVPage(VTester);\r\n\t}\r\n\r\n\ttab = () => this.renderView(VTester);\r\n}\r\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { Object } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\ttype: {\n\t\t\"name\": \"type\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Type\"\n\t} as undefined,\n\tto: {\n\t\t\"name\": \"to\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"To\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.type, fields.to, \n];\n\nexport const ui: UI = {\n\tlabel: \"Object\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: Object):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ItemHistory } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tbizOp: {\n\t\t\"name\": \"bizOp\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"BizOp\"\n\t} as FieldItemId,\n\titem: {\n\t\t\"name\": \"item\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Item\"\n\t} as undefined,\n\tvalue: {\n\t\t\"name\": \"value\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Value\"\n\t} as FieldItemNum,\n\tmemo: {\n\t\t\"name\": \"memo\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Memo\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.bizOp, fields.item, fields.value, fields.memo, \n];\n\nexport const ui: UI = {\n\tlabel: \"ItemHistory\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ItemHistory):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { OrderDetail } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tmain: {\n\t\t\"name\": \"main\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Main\"\n\t} as FieldItemId,\n\titem: {\n\t\t\"name\": \"item\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Item\"\n\t} as FieldItemId,\n\tproduct: {\n\t\t\"name\": \"product\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Product\"\n\t} as FieldItemId,\n\tquantity: {\n\t\t\"name\": \"quantity\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Quantity\"\n\t} as FieldItemNum,\n\tamount: {\n\t\t\"name\": \"amount\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Amount\"\n\t} as FieldItemNum,\n\tprice: {\n\t\t\"name\": \"price\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Price\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.main, fields.item, fields.product, fields.quantity, fields.amount, fields.price, \n];\n\nexport const ui: UI = {\n\tlabel: \"OrderDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: OrderDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { OrderMain } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tno: {\n\t\t\"name\": \"no\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": true,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"No\"\n\t} as FieldItemString,\n\twebUser: {\n\t\t\"name\": \"webUser\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"WebUser\"\n\t} as FieldItemId,\n\tcustomerAccount: {\n\t\t\"name\": \"customerAccount\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CustomerAccount\"\n\t} as FieldItemId,\n\tseller: {\n\t\t\"name\": \"seller\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Seller\"\n\t} as FieldItemId,\n\tcurrency: {\n\t\t\"name\": \"currency\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Currency\"\n\t} as FieldItemId,\n\tsumAmount: {\n\t\t\"name\": \"sumAmount\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"SumAmount\"\n\t} as FieldItemNum,\n\tstamp: {\n\t\t\"name\": \"stamp\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Stamp\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.no, fields.webUser, fields.customerAccount, fields.seller, fields.currency, fields.sumAmount, fields.stamp, \n];\n\nexport const ui: UI = {\n\tlabel: \"OrderMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: OrderMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ItemTitle } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\ttitle: {\n\t\t\"name\": \"title\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Title\"\n\t} as FieldItemString,\n\tvice: {\n\t\t\"name\": \"vice\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Vice\"\n\t} as FieldItemString,\n\tunit: {\n\t\t\"name\": \"unit\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Unit\"\n\t} as FieldItemString,\n\tfixed: {\n\t\t\"name\": \"fixed\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Fixed\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.title, fields.vice, fields.unit, fields.fixed, \n];\n\nexport const ui: UI = {\n\tlabel: \"ItemTitle\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ItemTitle):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { PostTitle } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\ttitle: {\n\t\t\"name\": \"title\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Title\"\n\t} as FieldItemString,\n\tvice: {\n\t\t\"name\": \"vice\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Vice\"\n\t} as FieldItemString,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.title, fields.vice, \n];\n\nexport const ui: UI = {\n\tlabel: \"PostTitle\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: PostTitle):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectUser } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tuser: {\n\t\t\"name\": \"user\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"User\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.user, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectUser\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectUser):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectStaff } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tstaff: {\n\t\t\"name\": \"staff\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Staff\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.staff, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectStaff\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectStaff):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectPost } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tpost: {\n\t\t\"name\": \"post\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Post\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.post, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectPost\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectPost):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectCustomer } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tcustomer: {\n\t\t\"name\": \"customer\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Customer\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.customer, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectCustomer\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectCustomer):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectPostItem } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tobject: {\n\t\t\"name\": \"object\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Object\"\n\t} as FieldItemId,\n\tpost: {\n\t\t\"name\": \"post\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Post\"\n\t} as undefined,\n\titem: {\n\t\t\"name\": \"item\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Item\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.object, fields.post, fields.item, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectPostItem\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectPostItem):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { Group } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tname: {\n\t\t\"name\": \"name\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": true,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Name\"\n\t} as FieldItemString,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.name, \n];\n\nexport const ui: UI = {\n\tlabel: \"Group\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: Group):JSX.Element {\n\tlet {name} = item;\n\treturn <>{name}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectDistributor } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tdistributor: {\n\t\t\"name\": \"distributor\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Distributor\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.distributor, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectDistributor\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectDistributor):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectAgent } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tagent: {\n\t\t\"name\": \"agent\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Agent\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.agent, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectAgent\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectAgent):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { QueueBizOp } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tbizOp: {\n\t\t\"name\": \"bizOp\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"BizOp\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.bizOp, \n];\n\nexport const ui: UI = {\n\tlabel: \"QueueBizOp\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: QueueBizOp):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { QueueBizMain } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tbizMain: {\n\t\t\"name\": \"bizMain\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"BizMain\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.bizMain, \n];\n\nexport const ui: UI = {\n\tlabel: \"QueueBizMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: QueueBizMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DeliverDetail } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tmain: {\n\t\t\"name\": \"main\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Main\"\n\t} as FieldItemId,\n\torderDetail: {\n\t\t\"name\": \"orderDetail\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"OrderDetail\"\n\t} as FieldItemId,\n\tquantity: {\n\t\t\"name\": \"quantity\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Quantity\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.main, fields.orderDetail, fields.quantity, \n];\n\nexport const ui: UI = {\n\tlabel: \"DeliverDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DeliverDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DeliverMain } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tno: {\n\t\t\"name\": \"no\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": true,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"No\"\n\t} as FieldItemString,\n\tcustomer: {\n\t\t\"name\": \"customer\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Customer\"\n\t} as FieldItemId,\n\tcontact: {\n\t\t\"name\": \"contact\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Contact\"\n\t} as FieldItemId,\n\twarehouse: {\n\t\t\"name\": \"warehouse\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Warehouse\"\n\t} as FieldItemId,\n\tcutOffMain: {\n\t\t\"name\": \"cutOffMain\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CutOffMain\"\n\t} as FieldItemId,\n\ttrayNumber: {\n\t\t\"name\": \"trayNumber\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"TrayNumber\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.no, fields.customer, fields.contact, fields.warehouse, fields.cutOffMain, fields.trayNumber, \n];\n\nexport const ui: UI = {\n\tlabel: \"DeliverMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DeliverMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { Role } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tname: {\n\t\t\"name\": \"name\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Name\"\n\t} as FieldItemString,\n\tdiscription: {\n\t\t\"name\": \"discription\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Discription\"\n\t} as FieldItemString,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.name, fields.discription, \n];\n\nexport const ui: UI = {\n\tlabel: \"Role\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: Role):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { OPIHistory } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\topi: {\n\t\t\"name\": \"opi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Opi\"\n\t} as FieldItemId,\n\titemHistory: {\n\t\t\"name\": \"itemHistory\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"ItemHistory\"\n\t} as FieldItemId,\n\tvalue: {\n\t\t\"name\": \"value\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Value\"\n\t} as FieldItemNum,\n\tbooking: {\n\t\t\"name\": \"booking\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Booking\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.opi, fields.itemHistory, fields.value, fields.booking, \n];\n\nexport const ui: UI = {\n\tlabel: \"OPIHistory\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: OPIHistory):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectAccount } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tobject: {\n\t\t\"name\": \"object\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Object\"\n\t} as FieldItemId,\n\taccount: {\n\t\t\"name\": \"account\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Account\"\n\t} as undefined,\n\tbalance: {\n\t\t\"name\": \"balance\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Balance\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.object, fields.account, fields.balance, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectAccount\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectAccount):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { BizMainBound } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tbizMain: {\n\t\t\"name\": \"bizMain\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"BizMain\"\n\t} as FieldItemId,\n\tpost: {\n\t\t\"name\": \"post\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Post\"\n\t} as undefined,\n\titem: {\n\t\t\"name\": \"item\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"Item\"\n\t} as undefined,\n\tto: {\n\t\t\"name\": \"to\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": true,\n\t\t\"label\": \"To\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.bizMain, fields.post, fields.item, fields.to, \n];\n\nexport const ui: UI = {\n\tlabel: \"BizMainBound\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: BizMainBound):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { OPIBooking } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tbizOpType: {\n\t\t\"name\": \"bizOpType\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"BizOpType\"\n\t} as undefined,\n\tpost: {\n\t\t\"name\": \"post\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Post\"\n\t} as undefined,\n\tpostItem: {\n\t\t\"name\": \"postItem\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"PostItem\"\n\t} as undefined,\n\titem: {\n\t\t\"name\": \"item\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Item\"\n\t} as undefined,\n\tratio: {\n\t\t\"name\": \"ratio\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Ratio\"\n\t} as FieldItemNum,\n\tmemo: {\n\t\t\"name\": \"memo\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Memo\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.bizOpType, fields.post, fields.postItem, fields.item, fields.ratio, fields.memo, \n];\n\nexport const ui: UI = {\n\tlabel: \"OPIBooking\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: OPIBooking):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { AccountTitle } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\ttitle: {\n\t\t\"name\": \"title\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Title\"\n\t} as FieldItemString,\n\tvice: {\n\t\t\"name\": \"vice\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Vice\"\n\t} as FieldItemString,\n\tunit: {\n\t\t\"name\": \"unit\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"Unit\"\n\t} as FieldItemString,\n\tfixed: {\n\t\t\"name\": \"fixed\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Fixed\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.title, fields.vice, fields.unit, fields.fixed, \n];\n\nexport const ui: UI = {\n\tlabel: \"AccountTitle\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: AccountTitle):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxOrderDetail } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tdeliverDone: {\n\t\t\"name\": \"deliverDone\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"DeliverDone\"\n\t} as FieldItemNum,\n\treceiveDone: {\n\t\t\"name\": \"receiveDone\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"ReceiveDone\"\n\t} as FieldItemNum,\n\treturn: {\n\t\t\"name\": \"return\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Return\"\n\t} as FieldItemNum,\n\tcostPrice: {\n\t\t\"name\": \"costPrice\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"CostPrice\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.deliverDone, fields.receiveDone, fields.return, fields.costPrice, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxOrderDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxOrderDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxOrderMain } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\torderReady: {\n\t\t\"name\": \"orderReady\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"OrderReady\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.orderReady, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxOrderMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxOrderMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxBizMain } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tready: {\n\t\t\"name\": \"ready\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Ready\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.ready, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxBizMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxBizMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxBizOp } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\ttype: {\n\t\t\"name\": \"type\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Type\"\n\t} as undefined,\n\tbiz: {\n\t\t\"name\": \"biz\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Biz\"\n\t} as FieldItemId,\n\tvalue: {\n\t\t\"name\": \"value\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Value\"\n\t} as FieldItemNum,\n\tdone: {\n\t\t\"name\": \"done\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Done\"\n\t} as undefined,\n\tstamp: {\n\t\t\"name\": \"stamp\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Stamp\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.type, fields.biz, fields.value, fields.done, fields.stamp, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxBizOp\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxBizOp):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxBiz } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tmain: {\n\t\t\"name\": \"main\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Main\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.main, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxBiz\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxBiz):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { UserObject } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\ton: {\n\t\t\"name\": \"on\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"On\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.on, \n];\n\nexport const ui: UI = {\n\tlabel: \"UserObject\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: UserObject):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { GroupObject } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, \n];\n\nexport const ui: UI = {\n\tlabel: \"GroupObject\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: GroupObject):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","import { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { UserSuperviseItem } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, \n];\n\nexport const ui: UI = {\n\tlabel: \"UserSuperviseItem\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: UserSuperviseItem):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { MonthSumProduct } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tixx: {\n\t\t\"name\": \"ixx\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ixx\"\n\t} as FieldItemId,\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\tvalue: {\n\t\t\"name\": \"value\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Value\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.ixx, fields.xi, fields.value, \n];\n\nexport const ui: UI = {\n\tlabel: \"MonthSumProduct\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: MonthSumProduct):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { MonthSumCustomer } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tixx: {\n\t\t\"name\": \"ixx\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ixx\"\n\t} as FieldItemId,\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\tvalue: {\n\t\t\"name\": \"value\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Value\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.ixx, fields.xi, fields.value, \n];\n\nexport const ui: UI = {\n\tlabel: \"MonthSumCustomer\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: MonthSumCustomer):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { IxBizOpBound } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\tbound: {\n\t\t\"name\": \"bound\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Bound\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.bound, \n];\n\nexport const ui: UI = {\n\tlabel: \"IxBizOpBound\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: IxBizOpBound):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { UserRole } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, \n];\n\nexport const ui: UI = {\n\tlabel: \"UserRole\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: UserRole):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { RoleOps } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, \n];\n\nexport const ui: UI = {\n\tlabel: \"RoleOps\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: RoleOps):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ObjectAccountHistory } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\tvalue: {\n\t\t\"name\": \"value\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Value\"\n\t} as FieldItemNum,\n\topi: {\n\t\t\"name\": \"opi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Opi\"\n\t} as FieldItemId,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.value, fields.opi, \n];\n\nexport const ui: UI = {\n\tlabel: \"ObjectAccountHistory\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ObjectAccountHistory):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DaySumItem } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as undefined,\n\tvalue: {\n\t\t\"name\": \"value\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Value\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.value, \n];\n\nexport const ui: UI = {\n\tlabel: \"DaySumItem\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DaySumItem):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { AccountBooking } from \"./JkMe\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\tradio: {\n\t\t\"name\": \"radio\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Radio\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.radio, \n];\n\nexport const ui: UI = {\n\tlabel: \"AccountBooking\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: AccountBooking):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","//=== UqApp builder created on Fri Nov 12 2021 10:10:02 GMT-0500 (北美东部标准时间) ===//\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { IDXValue, Uq, UqTuid, UqAction, UqQuery, UqMap, UqHistory } from \"tonva-core\";\n\n\n//===============================\n//======= UQ 百灵威系统工程部/product ========\n//===============================\n\nexport interface Tuid$user {\n\tid?: number;\n\tname: string;\n\tnick: string;\n\ticon: string;\n\tassigned: string;\n\tpoke: number;\n\ttimezone: number;\n}\n\nexport interface Tuid$sheet {\n\tid?: number;\n\tno: string;\n\tuser: number;\n\tdate: any;\n\tsheet: number;\n\tversion: number;\n\tflow: number;\n\tapp: number;\n\tstate: number;\n\tdiscription: string;\n\tdata: string;\n\tprocessing: number;\n}\n\nexport interface TuidChemical {\n\tid?: number;\n\tCAS: string;\n}\n\nexport interface TuidSalesRegion {\n\tid?: number;\n\tname: string;\n\tcurrency: number;\n\tno: string;\n}\n\nexport interface TuidCurrency {\n\tid?: number;\n\tname: string;\n\tsuffix: string;\n}\n\nexport interface TuidPackType {\n\tid?: number;\n\tname: string;\n\tdescription: string;\n}\n\nexport interface TuidLanguage {\n\tid?: number;\n\tno: string;\n\tdescription: string;\n}\n\nexport interface TuidBrand {\n\tid?: number;\n\tname: string;\n\tno: string;\n}\n\nexport interface TuidStuff {\n\tid?: number;\n\tname: string;\n\tpackType: number;\n}\n\nexport interface TuidProductX {\n\tid?: number;\n\tbrand: number;\n\torigin: string;\n\tdescription: string;\n\tdescriptionC: string;\n\timageUrl: string;\n\tno: string;\n\tisValid: number;\n}\n\nexport interface TuidProductCategory {\n\tid?: number;\n\tno: number;\n\tparent: number;\n\tisLeaf: number;\n\torderWithinParent: number;\n}\n\nexport interface TuidLot {\n\tid?: number;\n\tlotnumber: string;\n\tproduct: number;\n}\n\nexport interface TuidPackSalesLevel {\n\tid?: number;\n\tname: string;\n\tno: string;\n}\n\nexport interface ParamCountProductCategoryInclusion {\n}\nexport interface ResultCountProductCategoryInclusion {\n}\n\nexport interface Param$setMyTimezone {\n\t_timezone: number;\n}\nexport interface Result$setMyTimezone {\n}\n\nexport interface ParamGetRootCategory {\n\tsalesRegion: number;\n\tlanguage: number;\n}\nexport interface ReturnGetRootCategoryFirst {\n\tproductCategory: number;\n\tname: string;\n\ttotal: number;\n}\nexport interface ReturnGetRootCategorySecend {\n\tproductCategory: number;\n\tparent: number;\n\tname: string;\n\ttotal: number;\n}\nexport interface ReturnGetRootCategoryThird {\n\tproductCategory: number;\n\tparent: number;\n\tname: string;\n\ttotal: number;\n}\nexport interface ResultGetRootCategory {\n\tfirst: ReturnGetRootCategoryFirst[];\n\tsecend: ReturnGetRootCategorySecend[];\n\tthird: ReturnGetRootCategoryThird[];\n}\n\nexport interface ParamGetChildrenCategory {\n\tparent: number;\n\tsalesRegion: number;\n\tlanguage: number;\n}\nexport interface ReturnGetChildrenCategoryFirst {\n\tproductCategory: number;\n\tparent: number;\n\tname: string;\n\ttotal: number;\n}\nexport interface ReturnGetChildrenCategorySecend {\n\tproductCategory: number;\n\tparent: number;\n\tname: string;\n\ttotal: number;\n}\nexport interface ResultGetChildrenCategory {\n\tfirst: ReturnGetChildrenCategoryFirst[];\n\tsecend: ReturnGetChildrenCategorySecend[];\n}\n\nexport interface ParamSearchProductByCategory {\n\tproductCategory: number;\n\tsalesRegion: number;\n\tlanguage: number;\n}\nexport interface ReturnSearchProductByCategory$page {\n\tseq: number;\n\tid: number;\n\tno: string;\n\tbrand: number;\n\torigin: string;\n\tdescription: string;\n\tdescriptionC: string;\n\timageUrl: string;\n\tchemical: number;\n\tCAS: string;\n\tpurity: string;\n\tmolecularFomula: string;\n\tmolecularWeight: string;\n}\nexport interface ResultSearchProductByCategory {\n\t$page: ReturnSearchProductByCategory$page[];\n}\n\nexport interface ParamGetFutureDeliveryTime {\n\tproduct: number;\n\tsalesRegion: number;\n}\nexport interface ReturnGetFutureDeliveryTimeRet {\n\tminValue: number;\n\tmaxValue: number;\n\tunit: string;\n\tdeliveryTimeDescription: string;\n}\nexport interface ResultGetFutureDeliveryTime {\n\tret: ReturnGetFutureDeliveryTimeRet[];\n}\n\nexport interface ParamSearchProduct {\n\tkeyWord: string;\n\tsalesRegion: number;\n}\nexport interface ReturnSearchProduct$page {\n\tseq: number;\n\tid: number;\n\tno: string;\n\tbrand: number;\n\torigin: string;\n\tdescription: string;\n\tdescriptionC: string;\n\timageUrl: string;\n\tchemical: number;\n\tCAS: string;\n\tpurity: string;\n\tgradeCN: string;\n\tmolecularFomula: string;\n\tmolecularWeight: string;\n}\nexport interface ResultSearchProduct {\n\t$page: ReturnSearchProduct$page[];\n}\n\nexport interface ParamGetRootCategories {\n\tsalesRegion: number;\n\tlanguage: number;\n}\nexport interface ReturnGetRootCategoriesRet {\n\tproductCategory: number;\n\tname: string;\n\ttotal: number;\n}\nexport interface ResultGetRootCategories {\n\tret: ReturnGetRootCategoriesRet[];\n}\n\nexport interface ParamGetPack {\n\tbrandName: string;\n\torigin: string;\n\tradiox: number;\n\tradioy: number;\n\tunit: string;\n}\nexport interface ReturnGetPackRet {\n\tproduct: number;\n\tpack: number;\n\tjkcat: string;\n}\nexport interface ResultGetPack {\n\tret: ReturnGetPackRet[];\n}\n\nexport interface Param$poked {\n}\nexport interface Return$pokedRet {\n\tpoke: number;\n}\nexport interface Result$poked {\n\tret: Return$pokedRet[];\n}\n\nexport interface ParamSearchPointProduct {\n\tkeyWord: string;\n\tsalesRegion: number;\n}\nexport interface ReturnSearchPointProduct$page {\n\tseq: number;\n\tid: number;\n\tproduct: number;\n\torigin: string;\n\tdescription: string;\n\tdescriptionC: string;\n\timageUrl: string;\n\tradiox: number;\n\tradioy: number;\n\tunit: string;\n\tretail: number;\n}\nexport interface ResultSearchPointProduct {\n\t$page: ReturnSearchPointProduct$page[];\n}\n\nexport interface ParamGetProductByOrigin {\n\torigin: string;\n\tsalesRegion: number;\n}\nexport interface ReturnGetProductByOriginRet {\n\tid: number;\n}\nexport interface ResultGetProductByOrigin {\n\tret: ReturnGetProductByOriginRet[];\n}\n\nexport interface ParamGetPointProductMoreBySource {\n\tpack: number;\n\tsalesRegion: number;\n}\nexport interface ReturnGetPointProductMoreBySourceRet {\n\tid: number;\n\tproduct: number;\n\torigin: string;\n\tdescription: string;\n\tdescriptionC: string;\n\timageUrl: string;\n\tradiox: number;\n\tradioy: number;\n\tunit: string;\n\tretail: number;\n}\nexport interface ResultGetPointProductMoreBySource {\n\tret: ReturnGetPointProductMoreBySourceRet[];\n}\n\nexport interface ParamGetLotByLotnumber {\n\tlotnumber: string;\n\torigin: string;\n}\nexport interface ReturnGetLotByLotnumberRet {\n\tid: number;\n\tproduct: number;\n}\nexport interface ResultGetLotByLotnumber {\n\tret: ReturnGetLotByLotnumberRet[];\n}\n\nexport interface ParamGetAvailableProductById {\n\tproduct: number;\n\tsalesRegion: number;\n}\nexport interface ReturnGetAvailableProductByIdRet {\n\tid: number;\n\tbrand: number;\n\torigin: string;\n\tdescription: string;\n\tdescriptionC: string;\n\timageUrl: string;\n\tno: string;\n\tisValid: number;\n}\nexport interface ResultGetAvailableProductById {\n\tret: ReturnGetAvailableProductByIdRet[];\n}\n\nexport interface ParamGetProductPackByOrigin {\n\torigin: string;\n\tsalesRegion: number;\n}\nexport interface ReturnGetProductPackByOriginRet {\n\tproduct: number;\n\tpack: number;\n}\nexport interface ResultGetProductPackByOrigin {\n\tret: ReturnGetProductPackByOriginRet[];\n}\n\nexport interface ParamGetProductPrices {\n\tproduct: number;\n\tsalesRegion: number;\n}\nexport interface ReturnGetProductPricesRet {\n\tproduct: number;\n\tpack: number;\n\tsalesRegion: number;\n\tretail: number;\n\texpireDate: any;\n\tdiscountinued: number;\n\tsalesLevel: number;\n}\nexport interface ResultGetProductPrices {\n\tret: ReturnGetProductPricesRet[];\n}\n\nexport interface ParamGetProductLotNumber {\n\tproduct: number;\n}\nexport interface ReturnGetProductLotNumberRet {\n\tid: number;\n\tproduct: number;\n\tlotnumber: string;\n}\nexport interface ResultGetProductLotNumber {\n\tret: ReturnGetProductLotNumberRet[];\n}\n\nexport interface Param$getMyTimezone {\n}\nexport interface Return$getMyTimezoneRet {\n\ttimezone: number;\n\tunitTimeZone: number;\n}\nexport interface Result$getMyTimezone {\n\tret: Return$getMyTimezoneRet[];\n}\n\nexport interface ParamPriceXquery {\n\tproduct: number;\n\tpack: number;\n\tsalesRegion: number;\n}\nexport interface ReturnPriceXqueryRet {\n\tproduct: number;\n\tpack: number;\n\tsalesRegion: number;\n\texpireDate: any;\n\tdiscountinued: number;\n\tretail: number;\n}\nexport interface ResultPriceXquery {\n\tret: ReturnPriceXqueryRet[];\n}\n\nexport interface ParamProductSearchHistory {\n\twebUser: number;\n\tsalesRegion: number;\n\tkeyword: string;\n}\nexport interface ReturnProductSearchHistory$page {\n\tdate: any;\n\twebUser: number;\n\tsalesRegion: number;\n\tkeyword: string;\n}\nexport interface ResultProductSearchHistory {\n\t$page: ReturnProductSearchHistory$page[];\n}\n\nexport interface ParamActs {\n}\n\n\nexport interface UqExt extends Uq {\n\tActs(param:ParamActs): Promise<any>;\n\n\t$user: UqTuid<Tuid$user>;\n\t$sheet: UqTuid<Tuid$sheet>;\n\tChemical: UqTuid<TuidChemical>;\n\tSalesRegion: UqTuid<TuidSalesRegion>;\n\tCurrency: UqTuid<TuidCurrency>;\n\tPackType: UqTuid<TuidPackType>;\n\tLanguage: UqTuid<TuidLanguage>;\n\tBrand: UqTuid<TuidBrand>;\n\tStuff: UqTuid<TuidStuff>;\n\tProductX: UqTuid<TuidProductX>;\n\tProductCategory: UqTuid<TuidProductCategory>;\n\tLot: UqTuid<TuidLot>;\n\tPackSalesLevel: UqTuid<TuidPackSalesLevel>;\n\tCountProductCategoryInclusion: UqAction<ParamCountProductCategoryInclusion, ResultCountProductCategoryInclusion>;\n\t$setMyTimezone: UqAction<Param$setMyTimezone, Result$setMyTimezone>;\n\tGetRootCategory: UqQuery<ParamGetRootCategory, ResultGetRootCategory>;\n\tGetChildrenCategory: UqQuery<ParamGetChildrenCategory, ResultGetChildrenCategory>;\n\tSearchProductByCategory: UqQuery<ParamSearchProductByCategory, ResultSearchProductByCategory>;\n\tGetFutureDeliveryTime: UqQuery<ParamGetFutureDeliveryTime, ResultGetFutureDeliveryTime>;\n\tSearchProduct: UqQuery<ParamSearchProduct, ResultSearchProduct>;\n\tGetRootCategories: UqQuery<ParamGetRootCategories, ResultGetRootCategories>;\n\tGetPack: UqQuery<ParamGetPack, ResultGetPack>;\n\t$poked: UqQuery<Param$poked, Result$poked>;\n\tSearchPointProduct: UqQuery<ParamSearchPointProduct, ResultSearchPointProduct>;\n\tGetProductByOrigin: UqQuery<ParamGetProductByOrigin, ResultGetProductByOrigin>;\n\tGetPointProductMoreBySource: UqQuery<ParamGetPointProductMoreBySource, ResultGetPointProductMoreBySource>;\n\tGetLotByLotnumber: UqQuery<ParamGetLotByLotnumber, ResultGetLotByLotnumber>;\n\tGetAvailableProductById: UqQuery<ParamGetAvailableProductById, ResultGetAvailableProductById>;\n\tGetProductPackByOrigin: UqQuery<ParamGetProductPackByOrigin, ResultGetProductPackByOrigin>;\n\tGetProductPrices: UqQuery<ParamGetProductPrices, ResultGetProductPrices>;\n\tGetProductLotNumber: UqQuery<ParamGetProductLotNumber, ResultGetProductLotNumber>;\n\t$getMyTimezone: UqQuery<Param$getMyTimezone, Result$getMyTimezone>;\n\tPriceXquery: UqQuery<ParamPriceXquery, ResultPriceXquery>;\n\tAgentPrice: UqMap;\n\tBrandSalesRegion: UqMap;\n\tBrandDeliveryTime: UqMap;\n\tProductStuff: UqMap;\n\tPriceX: UqMap;\n\tProductChemical: UqMap;\n\tProductSalesRegion: UqMap;\n\tProductLegallyProhibited: UqMap;\n\tProductCache: UqMap;\n\tProductProductCategory: UqMap;\n\tProductCategoryInclusion: UqMap;\n\tProductProductCategoryCache: UqMap;\n\tProductMSDSFile: UqMap;\n\tProductSpecFile: UqMap;\n\tProductSalesRank: UqMap;\n\tProductCategoryLeafCache: UqMap;\n\tCOA: UqMap;\n\tProductExtention: UqMap;\n\tProductDeliveryTime: UqMap;\n\tProductEmbargo: UqMap;\n\tProductStandardSample: UqMap;\n\tProductUserManualFile: UqMap;\n\tProductSearchHistory: UqHistory<ParamProductSearchHistory, ResultProductSearchHistory>;\n}\n\nexport function assign(uq: any, to:string, from:any): void {\n\tlet hasEntity = uq.$.hasEntity(to);\n\tif (hasEntity === false) {\n\t\treturn;\n\t}\n\tObject.assign((uq as any)[to], from);\n}\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidChemical } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidChemical):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidSalesRegion } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidSalesRegion):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidCurrency } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidCurrency):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidPackType } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidPackType):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidLanguage } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidLanguage):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidBrand } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidBrand):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidStuff } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidStuff):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidProductX } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidProductX):JSX.Element {\n\tlet {description, descriptionC, imageUrl, no} = item;\n\treturn <div>\n\t\t<div>{no} {descriptionC}</div>\n\t\t{\n\t\t\tdescriptionC === description? \n\t\t\t\tnull :\n\t\t\t\t<div className=\"small text-muted\">{description}</div>\n\t\t}\n\t</div>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidProductCategory } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidProductCategory):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidLot } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidLot):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidPackSalesLevel } from \"./JkProduct\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidPackSalesLevel):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","//=== UqApp builder created on Fri Nov 12 2021 10:10:02 GMT-0500 (北美东部标准时间) ===//\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { IDXValue, Uq, UqTuid, UqAction, UqSheet, UqBook, UqQuery, UqMap, UqHistory, UqPending, UqID, UqIDX, UqIX } from \"tonva-core\";\n\n\n//===============================\n//======= UQ 百灵威系统工程部/积分商城 ========\n//===============================\n\nexport enum EnumPointType {\n\ttotal = 1,\n\tpoint = 2,\n\tused = 3\n}\n\nexport enum EnumPointChangingSource {\n\tordermultiple = 1,\n\tsignIn = 2,\n\texchange = 3,\n\torder = 5,\n\tlottery = 8,\n\treturn = 9\n}\n\nexport enum EnumExchangeState {\n\tdelivering = 12,\n\tdelivered = 13,\n\tcompleted = 14,\n\tcanceled = 15\n}\n\nexport interface Tuid$user {\n\tid?: number;\n\tname: string;\n\tnick: string;\n\ticon: string;\n\tassigned: string;\n\tpoke: number;\n\ttimezone: number;\n}\n\nexport interface TuidProductX {\n\tid?: number;\n\timageUrl: string;\n}\n\nexport interface Tuid$sheet {\n\tid?: number;\n\tno: string;\n\tuser: number;\n\tdate: any;\n\tsheet: number;\n\tversion: number;\n\tflow: number;\n\tapp: number;\n\tstate: number;\n\tdiscription: string;\n\tdata: string;\n\tprocessing: number;\n}\n\nexport interface TuidCustomer {\n\tid?: number;\n}\n\nexport interface TuidWebUser {\n\tid?: number;\n}\n\nexport interface TuidContact {\n\tid?: number;\n}\n\nexport interface TuidCurrency {\n\tid?: number;\n}\n\nexport interface TuidBuyerAccount {\n\tid?: number;\n}\n\nexport interface TuidGenre {\n\tid?: number;\n\tname: string;\n\timageUrl: string;\n}\n\nexport interface TuidPointProductLib {\n\tid?: number;\n\tdescription: string;\n\tdescriptionC: string;\n\tgrade: string;\n\tpoint: number;\n\timageUrl: string;\n\tstartDate: any;\n\tendDate: any;\n\tisValid: number;\n}\n\nexport interface TuidBrand {\n\tid?: number;\n}\n\nexport interface ParamIsCanUseOrder {\n\torderId: string;\n\tcustomer: number;\n}\nexport interface ReturnIsCanUseOrderRet {\n\tresult: number;\n\tid: string;\n}\nexport interface ResultIsCanUseOrder {\n\tret: ReturnIsCanUseOrderRet[];\n}\n\nexport interface ParamAddPlatformOrderPoint {\n\torderId: string;\n\tcouponId: string;\n\tcustomer: number;\n}\nexport interface ReturnAddPlatformOrderPointRet {\n\tresult: number;\n}\nexport interface ResultAddPlatformOrderPoint {\n\tret: ReturnAddPlatformOrderPointRet[];\n}\n\nexport interface ParamGetLastPlatFormOrder {\n\tcustomer: number;\n}\nexport interface ReturnGetLastPlatFormOrderRet {\n\tresult: number;\n\tplatformOrderId: string;\n}\nexport interface ResultGetLastPlatFormOrder {\n\tret: ReturnGetLastPlatFormOrderRet[];\n}\n\nexport interface ParamSignin {\n\twebuser: number;\n\tcustomer: number;\n\tamount: number;\n}\nexport interface ResultSignin {\n}\n\nexport interface ParamSetPointProductVisits {\n\tpointProduct: number;\n}\nexport interface ResultSetPointProductVisits {\n}\n\nexport interface ParamPointProductGenreDelete {\n\tgenre: number;\n}\nexport interface ResultPointProductGenreDelete {\n}\n\nexport interface ParamPointChanged {\n\tcustomer: number;\n\tpoint: number;\n\tpointYear: number;\n\tpointType: number;\n\tpointSource: number;\n\tcomments: string;\n}\nexport interface ResultPointChanged {\n}\n\nexport interface Param$setMyTimezone {\n\t_timezone: number;\n}\nexport interface Result$setMyTimezone {\n}\n\nexport interface SheetPointExchangeSheet {\n\tcustomer: number;\n\twebUser: number;\n\tamount: number;\n\tshippingContact: number;\n\texchangeItems: {\n\t\tproduct: number;\n\t\tpoint: number;\n\t\tquantity: number;\n\t\tsubAmount: number;\n\t}[];\n}\n\nexport interface ParamGetPoints {\n\tcustomer: number;\n}\nexport interface ReturnGetPointsRet {\n\ttotalLeftPoint: number;\n\teffectiveLeftPoint: number;\n\tusedPoint: number;\n\tpointYear: number;\n}\nexport interface ResultGetPoints {\n\tret: ReturnGetPointsRet[];\n}\n\nexport interface ParamGetPointProduct {\n\tstartPoint: number;\n\tendPoint: number;\n}\nexport interface ReturnGetPointProductRet {\n\tproduct: number;\n}\nexport interface ResultGetPointProduct {\n\tret: ReturnGetPointProductRet[];\n}\n\nexport interface ParamGetPlatFormOrder {\n\tplatformOrderId: string;\n}\nexport interface ReturnGetPlatFormOrderRet {\n\tcustomer: number;\n\torderMaker: number;\n\tplatformOrderId: string;\n\tdescription: string;\n\tdescriptionC: string;\n\tradiox: number;\n\tradioy: number;\n\tunit: string;\n\tquantity: number;\n\tprice: number;\n\tsubAmount: number;\n\tamount: number;\n\tcurrency: number;\n\tmark: string;\n}\nexport interface ResultGetPlatFormOrder {\n\tret: ReturnGetPlatFormOrderRet[];\n}\n\nexport interface ParamGetOrderDrawable {\n\tcustomer: number;\n\tstartDate: any;\n}\nexport interface ReturnGetOrderDrawableRet {\n\torderId: string;\n\torderMaker: number;\n\tpoint: number;\n}\nexport interface ResultGetOrderDrawable {\n\tret: ReturnGetOrderDrawableRet[];\n}\n\nexport interface Param$poked {\n}\nexport interface Return$pokedRet {\n\tpoke: number;\n}\nexport interface Result$poked {\n\tret: Return$pokedRet[];\n}\n\nexport interface ParamGetPointHistory {\n\tcustomer: number;\n\tkey: string;\n}\nexport interface ReturnGetPointHistory$page {\n\tid: number;\n\tdate: any;\n\tpoint: number;\n\tpointYear: number;\n\tcomments: string;\n\tpointType: number;\n\tsource: number;\n}\nexport interface ResultGetPointHistory {\n\t$page: ReturnGetPointHistory$page[];\n}\n\nexport interface ParamCheckIsSignin {\n\tcustomer: number;\n}\nexport interface ReturnCheckIsSigninRet {\n\tresult: number;\n}\nexport interface ResultCheckIsSignin {\n\tret: ReturnCheckIsSigninRet[];\n}\n\nexport interface ParamGetPointSigninHistory {\n\tcustomer: number;\n}\nexport interface ReturnGetPointSigninHistory$page {\n\tid: number;\n\tdate: any;\n\tpoint: number;\n\tpointYear: number;\n\tcomments: string;\n\tpointType: number;\n\tsource: number;\n}\nexport interface ResultGetPointSigninHistory {\n\t$page: ReturnGetPointSigninHistory$page[];\n}\n\nexport interface ParamGetNewPointProducts {\n}\nexport interface ReturnGetNewPointProductsRet {\n\tid: number;\n\tpoint: number;\n\tstartDate: any;\n\tendDate: any;\n\timageUrl: string;\n}\nexport interface ResultGetNewPointProducts {\n\tret: ReturnGetNewPointProductsRet[];\n}\n\nexport interface ParamGetHotPointProducts {\n}\nexport interface ReturnGetHotPointProductsRet {\n\tid: number;\n\tpoint: number;\n\tstartDate: any;\n\tendDate: any;\n\timageUrl: string;\n}\nexport interface ResultGetHotPointProducts {\n\tret: ReturnGetHotPointProductsRet[];\n}\n\nexport interface ParamGetPointProductGenre {\n\tpointProduct: number;\n}\nexport interface ReturnGetPointProductGenreRet {\n\tpointProduct: number;\n\tgenre: number;\n}\nexport interface ResultGetPointProductGenre {\n\tret: ReturnGetPointProductGenreRet[];\n}\n\nexport interface ParamGetPointDistribution {\n\tstart: number;\n\tend: number;\n\tgranularity: number;\n}\nexport interface ReturnGetPointDistributionRet {\n\tsubStart: number;\n\tsubEnd: number;\n\tnumbers: number;\n}\nexport interface ResultGetPointDistribution {\n\tret: ReturnGetPointDistributionRet[];\n}\n\nexport interface ParamGetMaxPoints {\n}\nexport interface ReturnGetMaxPointsRet {\n\tmaxPoints: number;\n}\nexport interface ResultGetMaxPoints {\n\tret: ReturnGetMaxPointsRet[];\n}\n\nexport interface ParamGetPointProductBySource {\n\tsourceId: number;\n\ttype: string;\n}\nexport interface ReturnGetPointProductBySourceRet {\n\tpointProduct: number;\n}\nexport interface ResultGetPointProductBySource {\n\tret: ReturnGetPointProductBySourceRet[];\n}\n\nexport interface ParamGetVisitPointProducts {\n}\nexport interface ReturnGetVisitPointProducts$page {\n\tseq: number;\n\tid: number;\n\tpoint: number;\n\tstartDate: any;\n\tendDate: any;\n\timageUrl: string;\n\tvisits: number;\n\texchanges: number;\n}\nexport interface ResultGetVisitPointProducts {\n\t$page: ReturnGetVisitPointProducts$page[];\n}\n\nexport interface ParamGetPointProductByGenre {\n\tgenre: number;\n}\nexport interface ReturnGetPointProductByGenreRet {\n\tpointProduct: number;\n\tgenre: number;\n}\nexport interface ResultGetPointProductByGenre {\n\tret: ReturnGetPointProductByGenreRet[];\n}\n\nexport interface ParamGetPointProductsByPage {\n\tkeyWord: string;\n}\nexport interface ReturnGetPointProductsByPage$page {\n\tseq: number;\n\tid: number;\n\tdescription: string;\n\tdescriptionC: string;\n\tgrade: string;\n\tpoint: number;\n\timageUrl: string;\n}\nexport interface ResultGetPointProductsByPage {\n\t$page: ReturnGetPointProductsByPage$page[];\n}\n\nexport interface ParamGetBrandMinDiscount {\n}\nexport interface ReturnGetBrandMinDiscount$page {\n\tseq: number;\n\tbrand: number;\n\tdiscount: number;\n\tisValid: number;\n}\nexport interface ResultGetBrandMinDiscount {\n\t$page: ReturnGetBrandMinDiscount$page[];\n}\n\nexport interface ParamSearchExchangeOrders {\n\tcustomer: number;\n}\nexport interface ReturnSearchExchangeOrders$page {\n\tseq: number;\n\tid: number;\n\tno: string;\n\tdate: any;\n\tstate: string;\n}\nexport interface ResultSearchExchangeOrders {\n\t$page: ReturnSearchExchangeOrders$page[];\n}\n\nexport interface Param$getMyTimezone {\n}\nexport interface Return$getMyTimezoneRet {\n\ttimezone: number;\n\tunitTimeZone: number;\n}\nexport interface Result$getMyTimezone {\n\tret: Return$getMyTimezoneRet[];\n}\n\nexport interface ParamPointBook {\n\twebUser: number;\n}\nexport interface ReturnPointBook$page {\n\tpointYear: number;\n\tpoint: number;\n\tusedPoint: number;\n\ttotalPoint: number;\n\ttempPoint: number;\n\ttempUsedPoint: number;\n\ttempSignInPoint: number;\n}\nexport interface ResultPointBook {\n\t$page: ReturnPointBook$page[];\n}\n\nexport interface ParamPointBookByCustomer {\n\tcustomer: number;\n}\nexport interface ReturnPointBookByCustomer$page {\n\tpointYear: number;\n\tpoint: number;\n\tusedPoint: number;\n\ttotalPoint: number;\n}\nexport interface ResultPointBookByCustomer {\n\t$page: ReturnPointBookByCustomer$page[];\n}\n\nexport interface ParamPointProductHotStat {\n}\nexport interface ReturnPointProductHotStat$page {\n\tpointProduct: number;\n\tvisits: number;\n\texchanges: number;\n}\nexport interface ResultPointProductHotStat {\n\t$page: ReturnPointProductHotStat$page[];\n}\n\nexport interface ParamPointDistributionBook {\n}\nexport interface ReturnPointDistributionBook$page {\n\tpointStart: number;\n\tnumbers: number;\n}\nexport interface ResultPointDistributionBook {\n\t$page: ReturnPointDistributionBook$page[];\n}\n\nexport interface ParamPointHistory {\n\tpointYear: number;\n\tpoint: number;\n\tpointType: any;\n\tsource: any;\n\tcomments: string;\n\twebUser: number;\n}\nexport interface ReturnPointHistory$page {\n\tdate: any;\n\tpointYear: number;\n\tpoint: number;\n\tpointType: any;\n\tsource: any;\n\tcomments: string;\n\twebUser: number;\n\ttype: number;\n\tsheet: number;\n\trow: number;\n}\nexport interface ResultPointHistory {\n\t$page: ReturnPointHistory$page[];\n}\n\nexport interface ParamPointProductVisitHistory {\n\tpointProduct: number;\n\twebUser: number;\n}\nexport interface ReturnPointProductVisitHistory$page {\n\tdate: any;\n\tpointProduct: number;\n\twebUser: number;\n}\nexport interface ResultPointProductVisitHistory {\n\t$page: ReturnPointProductVisitHistory$page[];\n}\n\nexport interface ParamPointProductLibHistory {\n\tpointProduct: number;\n\tstartDate: any;\n\tendDate: any;\n\treason: string;\n\tcreateTime: any;\n}\nexport interface ReturnPointProductLibHistory$page {\n\tdate: any;\n\tpointProduct: number;\n\tstartDate: any;\n\tendDate: any;\n\treason: string;\n\tcreateTime: any;\n}\nexport interface ResultPointProductLibHistory {\n\t$page: ReturnPointProductLibHistory$page[];\n}\n\nexport interface ParamPointHistoryByCustomer {\n\tpointYear: number;\n\tpoint: number;\n\tpointType: any;\n\tsource: any;\n\tcomments: string;\n\tcustomer: number;\n}\nexport interface ReturnPointHistoryByCustomer$page {\n\tdate: any;\n\tpointYear: number;\n\tpoint: number;\n\tpointType: any;\n\tsource: any;\n\tcomments: string;\n\tcustomer: number;\n\ttype: number;\n\tsheet: number;\n\trow: number;\n}\nexport interface ResultPointHistoryByCustomer {\n\t$page: ReturnPointHistoryByCustomer$page[];\n}\n\nexport interface ParamOrderDetailPointHistory {\n\torderDetailId: number;\n\tpointYear: number;\n\tpoint: number;\n\ttype: number;\n\tcomments: string;\n}\nexport interface ReturnOrderDetailPointHistory$page {\n\tdate: any;\n\torderDetailId: number;\n\tpointYear: number;\n\tpoint: number;\n\ttype: number;\n\tcomments: string;\n}\nexport interface ResultOrderDetailPointHistory {\n\t$page: ReturnOrderDetailPointHistory$page[];\n}\n\nexport interface ParamReOrderDetailPointHistory {\n\torderDetailId: number;\n\tpointYear: number;\n\tpoint: number;\n\ttype: number;\n\tcomments: string;\n}\nexport interface ReturnReOrderDetailPointHistory$page {\n\tdate: any;\n\torderDetailId: number;\n\tpointYear: number;\n\tpoint: number;\n\ttype: number;\n\tcomments: string;\n}\nexport interface ResultReOrderDetailPointHistory {\n\t$page: ReturnReOrderDetailPointHistory$page[];\n}\n\nexport interface OrderMain {\n\tid?: number;\n\tno?: string;\n}\n\nexport interface OrderDetail {\n\tid?: number;\n\tmain?: number;\n\torderMainNo: string;\n\torderDetailNo: string;\n\tendUser: number;\n\tcreateDate: any;\n}\n\nexport interface ExchangeDetail {\n\tid?: number;\n\tmain?: number;\n\titem: number;\n\tquantity: number;\n\tpoint: number;\n\tsubAmount: number;\n}\n\nexport interface ExchangeMain {\n\tid?: number;\n\tno?: string;\n\tcustomer: number;\n\tshippingContact: number;\n\tamount: number;\n\tsheetId: number;\n\tcreateDate: any;\n}\n\nexport interface ReceiveMain {\n\tid?: number;\n\tcreateDate: any;\n}\n\nexport interface ReceiveDetail {\n\tid?: number;\n\tmain?: number;\n\torderDetail: number;\n\tamount: number;\n\tcreateDate: any;\n}\n\nexport interface DxOrderDetail {\n\tid: number;\n\tpoint?: number;\n\ttotalPoint?: number;\n\tmultiple?: number;\n\t$act?: number;\n}\n\nexport interface DxReOrderDetail {\n\tid: number;\n\tpoint?: number;\n\ttotalPoint?: number;\n\t$act?: number;\n}\n\nexport interface DxExchangeDetail {\n\tid: number;\n\tdeliver?: number;\n\tdeliverDone?: number;\n\tdeliverTime?: any;\n\t$act?: number;\n}\n\nexport interface DxExchangeMainState {\n\tid: number;\n\tstate?: any;\n\tcreateDate?: any;\n\t$act?: number;\n}\n\nexport interface ActParamDxOrderDetail {\n\tid: number|IDXValue;\n\tpoint?: number|IDXValue;\n\ttotalPoint?: number|IDXValue;\n\tmultiple?: number|IDXValue;\n\t$act?: number;\n}\n\nexport interface ActParamDxReOrderDetail {\n\tid: number|IDXValue;\n\tpoint?: number|IDXValue;\n\ttotalPoint?: number|IDXValue;\n\t$act?: number;\n}\n\nexport interface ActParamDxExchangeDetail {\n\tid: number|IDXValue;\n\tdeliver?: number|IDXValue;\n\tdeliverDone?: number|IDXValue;\n\tdeliverTime?: any|IDXValue;\n\t$act?: number;\n}\n\nexport interface ActParamDxExchangeMainState {\n\tid: number|IDXValue;\n\tstate?: any|IDXValue;\n\tcreateDate?: any|IDXValue;\n\t$act?: number;\n}\n\nexport interface IxExchangeMainUsedPoint {\n\tix: number;\n\txi: number;\n\tpoint: number;\n}\n\nexport interface ExchangeDetailDeliver {\n\tix: number;\n\txi: number;\n\tdeliverDone: number;\n\tdeliverTime: any;\n}\n\nexport interface IxOrderDetailReceive {\n\tix: number;\n\txi: number;\n\treceiveAmount: number;\n\tcreateDate: any;\n}\n\nexport interface ParamActs {\n\torderMain?: OrderMain[];\n\torderDetail?: OrderDetail[];\n\texchangeDetail?: ExchangeDetail[];\n\texchangeMain?: ExchangeMain[];\n\treceiveMain?: ReceiveMain[];\n\treceiveDetail?: ReceiveDetail[];\n\tdxOrderDetail?: ActParamDxOrderDetail[];\n\tdxReOrderDetail?: ActParamDxReOrderDetail[];\n\tdxExchangeDetail?: ActParamDxExchangeDetail[];\n\tdxExchangeMainState?: ActParamDxExchangeMainState[];\n\tixExchangeMainUsedPoint?: IxExchangeMainUsedPoint[];\n\texchangeDetailDeliver?: ExchangeDetailDeliver[];\n\tixOrderDetailReceive?: IxOrderDetailReceive[];\n}\n\n\nexport interface UqExt extends Uq {\n\tActs(param:ParamActs): Promise<any>;\n\n\t$user: UqTuid<Tuid$user>;\n\tProductX: UqTuid<TuidProductX>;\n\t$sheet: UqTuid<Tuid$sheet>;\n\tCustomer: UqTuid<TuidCustomer>;\n\tWebUser: UqTuid<TuidWebUser>;\n\tContact: UqTuid<TuidContact>;\n\tCurrency: UqTuid<TuidCurrency>;\n\tBuyerAccount: UqTuid<TuidBuyerAccount>;\n\tGenre: UqTuid<TuidGenre>;\n\tPointProductLib: UqTuid<TuidPointProductLib>;\n\tBrand: UqTuid<TuidBrand>;\n\tIsCanUseOrder: UqAction<ParamIsCanUseOrder, ResultIsCanUseOrder>;\n\tAddPlatformOrderPoint: UqAction<ParamAddPlatformOrderPoint, ResultAddPlatformOrderPoint>;\n\tGetLastPlatFormOrder: UqAction<ParamGetLastPlatFormOrder, ResultGetLastPlatFormOrder>;\n\tSignin: UqAction<ParamSignin, ResultSignin>;\n\tSetPointProductVisits: UqAction<ParamSetPointProductVisits, ResultSetPointProductVisits>;\n\tPointProductGenreDelete: UqAction<ParamPointProductGenreDelete, ResultPointProductGenreDelete>;\n\tPointChanged: UqAction<ParamPointChanged, ResultPointChanged>;\n\t$setMyTimezone: UqAction<Param$setMyTimezone, Result$setMyTimezone>;\n\tPointExchangeSheet: UqSheet<SheetPointExchangeSheet, any>;\n\tPointBook: UqBook<ParamPointBook, ResultPointBook>;\n\tPointBookByCustomer: UqBook<ParamPointBookByCustomer, ResultPointBookByCustomer>;\n\tPointProductHotStat: UqBook<ParamPointProductHotStat, ResultPointProductHotStat>;\n\tPointDistributionBook: UqBook<ParamPointDistributionBook, ResultPointDistributionBook>;\n\tGetPoints: UqQuery<ParamGetPoints, ResultGetPoints>;\n\tGetPointProduct: UqQuery<ParamGetPointProduct, ResultGetPointProduct>;\n\tGetPlatFormOrder: UqQuery<ParamGetPlatFormOrder, ResultGetPlatFormOrder>;\n\tGetOrderDrawable: UqQuery<ParamGetOrderDrawable, ResultGetOrderDrawable>;\n\t$poked: UqQuery<Param$poked, Result$poked>;\n\tGetPointHistory: UqQuery<ParamGetPointHistory, ResultGetPointHistory>;\n\tCheckIsSignin: UqQuery<ParamCheckIsSignin, ResultCheckIsSignin>;\n\tGetPointSigninHistory: UqQuery<ParamGetPointSigninHistory, ResultGetPointSigninHistory>;\n\tGetNewPointProducts: UqQuery<ParamGetNewPointProducts, ResultGetNewPointProducts>;\n\tGetHotPointProducts: UqQuery<ParamGetHotPointProducts, ResultGetHotPointProducts>;\n\tGetPointProductGenre: UqQuery<ParamGetPointProductGenre, ResultGetPointProductGenre>;\n\tGetPointDistribution: UqQuery<ParamGetPointDistribution, ResultGetPointDistribution>;\n\tGetMaxPoints: UqQuery<ParamGetMaxPoints, ResultGetMaxPoints>;\n\tGetPointProductBySource: UqQuery<ParamGetPointProductBySource, ResultGetPointProductBySource>;\n\tGetVisitPointProducts: UqQuery<ParamGetVisitPointProducts, ResultGetVisitPointProducts>;\n\tGetPointProductByGenre: UqQuery<ParamGetPointProductByGenre, ResultGetPointProductByGenre>;\n\tGetPointProductsByPage: UqQuery<ParamGetPointProductsByPage, ResultGetPointProductsByPage>;\n\tGetBrandMinDiscount: UqQuery<ParamGetBrandMinDiscount, ResultGetBrandMinDiscount>;\n\tSearchExchangeOrders: UqQuery<ParamSearchExchangeOrders, ResultSearchExchangeOrders>;\n\t$getMyTimezone: UqQuery<Param$getMyTimezone, Result$getMyTimezone>;\n\tPointProduct: UqMap;\n\tPlatformOrder: UqMap;\n\tPlatformOrderUsed: UqMap;\n\tPointShopOrder: UqMap;\n\tPointProductGenre: UqMap;\n\tPointProductSource: UqMap;\n\tPointProductDetail: UqMap;\n\tBrandMinDiscount: UqMap;\n\tOrderBack: UqMap;\n\tPointCustomerBlacklist: UqMap;\n\tPointHistory: UqHistory<ParamPointHistory, ResultPointHistory>;\n\tPointProductVisitHistory: UqHistory<ParamPointProductVisitHistory, ResultPointProductVisitHistory>;\n\tPointProductLibHistory: UqHistory<ParamPointProductLibHistory, ResultPointProductLibHistory>;\n\tPointHistoryByCustomer: UqHistory<ParamPointHistoryByCustomer, ResultPointHistoryByCustomer>;\n\tOrderDetailPointHistory: UqHistory<ParamOrderDetailPointHistory, ResultOrderDetailPointHistory>;\n\tReOrderDetailPointHistory: UqHistory<ParamReOrderDetailPointHistory, ResultReOrderDetailPointHistory>;\n\tPlatformOrderPending: UqPending<any, any>;\n\tSOrderPaymentPending: UqPending<any, any>;\n\tOrderMain: UqID<any>;\n\tOrderDetail: UqID<any>;\n\tExchangeDetail: UqID<any>;\n\tExchangeMain: UqID<any>;\n\tReceiveMain: UqID<any>;\n\tReceiveDetail: UqID<any>;\n\tDxOrderDetail: UqIDX<any>;\n\tDxReOrderDetail: UqIDX<any>;\n\tDxExchangeDetail: UqIDX<any>;\n\tDxExchangeMainState: UqIDX<any>;\n\tIxExchangeMainUsedPoint: UqIX<any>;\n\tExchangeDetailDeliver: UqIX<any>;\n\tIxOrderDetailReceive: UqIX<any>;\n}\n\nexport function assign(uq: any, to:string, from:any): void {\n\tlet hasEntity = uq.$.hasEntity(to);\n\tif (hasEntity === false) {\n\t\treturn;\n\t}\n\tObject.assign((uq as any)[to], from);\n}\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidProductX } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidProductX):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidCustomer } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidCustomer):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidWebUser } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidWebUser):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidContact } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidContact):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidCurrency } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidCurrency):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidBuyerAccount } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidBuyerAccount):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidGenre } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidGenre):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidPointProductLib } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidPointProductLib):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidBrand } from \"./JkPointShop\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidBrand):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { OrderMain } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tno: {\n\t\t\"name\": \"no\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": true,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"No\"\n\t} as FieldItemString,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.no, \n];\n\nexport const ui: UI = {\n\tlabel: \"OrderMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: OrderMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { OrderDetail } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tmain: {\n\t\t\"name\": \"main\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Main\"\n\t} as FieldItemId,\n\torderMainNo: {\n\t\t\"name\": \"orderMainNo\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"OrderMainNo\"\n\t} as FieldItemString,\n\torderDetailNo: {\n\t\t\"name\": \"orderDetailNo\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"OrderDetailNo\"\n\t} as FieldItemString,\n\tendUser: {\n\t\t\"name\": \"endUser\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"EndUser\"\n\t} as FieldItemId,\n\tcreateDate: {\n\t\t\"name\": \"createDate\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CreateDate\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.main, fields.orderMainNo, fields.orderDetailNo, fields.endUser, fields.createDate, \n];\n\nexport const ui: UI = {\n\tlabel: \"OrderDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: OrderDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ExchangeDetail } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tmain: {\n\t\t\"name\": \"main\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Main\"\n\t} as FieldItemId,\n\titem: {\n\t\t\"name\": \"item\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Item\"\n\t} as FieldItemId,\n\tquantity: {\n\t\t\"name\": \"quantity\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Quantity\"\n\t} as FieldItemNum,\n\tpoint: {\n\t\t\"name\": \"point\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Point\"\n\t} as FieldItemNum,\n\tsubAmount: {\n\t\t\"name\": \"subAmount\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"SubAmount\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.main, fields.item, fields.quantity, fields.point, fields.subAmount, \n];\n\nexport const ui: UI = {\n\tlabel: \"ExchangeDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ExchangeDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ExchangeMain } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tno: {\n\t\t\"name\": \"no\",\n\t\t\"type\": \"string\",\n\t\t\"isKey\": true,\n\t\t\"widget\": \"string\",\n\t\t\"label\": \"No\"\n\t} as FieldItemString,\n\tcustomer: {\n\t\t\"name\": \"customer\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Customer\"\n\t} as FieldItemId,\n\tshippingContact: {\n\t\t\"name\": \"shippingContact\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"ShippingContact\"\n\t} as FieldItemId,\n\tamount: {\n\t\t\"name\": \"amount\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Amount\"\n\t} as FieldItemNum,\n\tsheetId: {\n\t\t\"name\": \"sheetId\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"SheetId\"\n\t} as FieldItemId,\n\tcreateDate: {\n\t\t\"name\": \"createDate\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CreateDate\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.no, fields.customer, fields.shippingContact, fields.amount, fields.sheetId, fields.createDate, \n];\n\nexport const ui: UI = {\n\tlabel: \"ExchangeMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ExchangeMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemNumber, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ReceiveMain } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tcreateDate: {\n\t\t\"name\": \"createDate\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CreateDate\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.createDate, \n];\n\nexport const ui: UI = {\n\tlabel: \"ReceiveMain\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ReceiveMain):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ReceiveDetail } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tmain: {\n\t\t\"name\": \"main\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Main\"\n\t} as FieldItemId,\n\torderDetail: {\n\t\t\"name\": \"orderDetail\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"OrderDetail\"\n\t} as FieldItemId,\n\tamount: {\n\t\t\"name\": \"amount\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Amount\"\n\t} as FieldItemNum,\n\tcreateDate: {\n\t\t\"name\": \"createDate\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CreateDate\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.main, fields.orderDetail, fields.amount, fields.createDate, \n];\n\nexport const ui: UI = {\n\tlabel: \"ReceiveDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ReceiveDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxOrderDetail } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tpoint: {\n\t\t\"name\": \"point\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Point\"\n\t} as FieldItemInt,\n\ttotalPoint: {\n\t\t\"name\": \"totalPoint\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"TotalPoint\"\n\t} as FieldItemInt,\n\tmultiple: {\n\t\t\"name\": \"multiple\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Multiple\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.point, fields.totalPoint, fields.multiple, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxOrderDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxOrderDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxReOrderDetail } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tpoint: {\n\t\t\"name\": \"point\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"Point\"\n\t} as FieldItemInt,\n\ttotalPoint: {\n\t\t\"name\": \"totalPoint\",\n\t\t\"type\": \"integer\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"updown\",\n\t\t\"label\": \"TotalPoint\"\n\t} as FieldItemInt,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.point, fields.totalPoint, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxReOrderDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxReOrderDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxExchangeDetail } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tdeliver: {\n\t\t\"name\": \"deliver\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Deliver\"\n\t} as FieldItemNum,\n\tdeliverDone: {\n\t\t\"name\": \"deliverDone\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"DeliverDone\"\n\t} as FieldItemNum,\n\tdeliverTime: {\n\t\t\"name\": \"deliverTime\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"DeliverTime\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.deliver, fields.deliverDone, fields.deliverTime, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxExchangeDetail\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxExchangeDetail):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { DxExchangeMainState } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tid: {\n\t\t\"name\": \"id\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Id\"\n\t} as FieldItemId,\n\tstate: {\n\t\t\"name\": \"state\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"State\"\n\t} as undefined,\n\tcreateDate: {\n\t\t\"name\": \"createDate\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CreateDate\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.state, fields.createDate, \n];\n\nexport const ui: UI = {\n\tlabel: \"DxExchangeMainState\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: DxExchangeMainState):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { IxExchangeMainUsedPoint } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\tpoint: {\n\t\t\"name\": \"point\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"Point\"\n\t} as FieldItemNum,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.point, \n];\n\nexport const ui: UI = {\n\tlabel: \"IxExchangeMainUsedPoint\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: IxExchangeMainUsedPoint):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemInt, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { ExchangeDetailDeliver } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\tdeliverDone: {\n\t\t\"name\": \"deliverDone\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"DeliverDone\"\n\t} as FieldItemNum,\n\tdeliverTime: {\n\t\t\"name\": \"deliverTime\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"DeliverTime\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.deliverDone, fields.deliverTime, \n];\n\nexport const ui: UI = {\n\tlabel: \"ExchangeDetailDeliver\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: ExchangeDetailDeliver):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc, uqStringify } from \"tonva-react\";\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { UI, FieldItem, FieldItemNum, FieldItemString, FieldItemId } from \"tonva-core\";\nimport { IxOrderDetailReceive } from \"./JkPointShop\";\n\n/*--fields--*/\nconst fields = {\n\tix: {\n\t\t\"name\": \"ix\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Ix\"\n\t} as FieldItemId,\n\txi: {\n\t\t\"name\": \"xi\",\n\t\t\"type\": \"id\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"Xi\"\n\t} as FieldItemId,\n\treceiveAmount: {\n\t\t\"name\": \"receiveAmount\",\n\t\t\"type\": \"number\",\n\t\t\"isKey\": false,\n\t\t\"widget\": \"number\",\n\t\t\"label\": \"ReceiveAmount\"\n\t} as FieldItemNum,\n\tcreateDate: {\n\t\t\"name\": \"createDate\",\n\t\t\"isKey\": false,\n\t\t\"label\": \"CreateDate\"\n\t} as undefined,\n};\n/*==fields==*/\n\nconst fieldArr: FieldItem[] = [\n\tfields.xi, fields.receiveAmount, fields.createDate, \n];\n\nexport const ui: UI = {\n\tlabel: \"IxOrderDetailReceive\",\n\tfieldArr,\n\tfields,\n};\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: IxOrderDetailReceive):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","//=== UqApp builder created on Fri Nov 12 2021 10:10:02 GMT-0500 (北美东部标准时间) ===//\n// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { IDXValue, Uq, UqTuid, UqAction, UqQuery, UqMap } from \"tonva-core\";\n\n\n//===============================\n//======= UQ 百灵威系统工程部/hr ========\n//===============================\n\nexport interface Tuid$user {\n\tid?: number;\n\tname: string;\n\tnick: string;\n\ticon: string;\n\tassigned: string;\n\tpoke: number;\n\ttimezone: number;\n}\n\nexport interface Tuid$sheet {\n\tid?: number;\n\tno: string;\n\tuser: number;\n\tdate: any;\n\tsheet: number;\n\tversion: number;\n\tflow: number;\n\tapp: number;\n\tstate: number;\n\tdiscription: string;\n\tdata: string;\n\tprocessing: number;\n}\n\nexport interface TuidEmployee {\n\tid?: number;\n\tname: string;\n\tno: string;\n\tfirstName: string;\n\tlastName: string;\n\ttitle: string;\n\tStatus: string;\n\tCreateTime: any;\n}\n\nexport interface TuidRole {\n\tid?: number;\n\tno: string;\n\tname: string;\n\tnote: string;\n\tIsValid: number;\n\tCreateTime: any;\n}\n\nexport interface TuidCompany {\n\tid?: number;\n\tno: string;\n\tname: string;\n}\n\nexport interface ParamDeleteWebuseEmployee {\n\twebuser: number;\n\temployee: number;\n}\nexport interface ResultDeleteWebuseEmployee {\n}\n\nexport interface ParamAddWebuseEmployee {\n\twebuser: number;\n\temployee: number;\n}\nexport interface ResultAddWebuseEmployee {\n}\n\nexport interface Param$setMyTimezone {\n\t_timezone: number;\n}\nexport interface Result$setMyTimezone {\n}\n\nexport interface ParamSearchEmployee {\n\tkey: string;\n}\nexport interface ReturnSearchEmployee$page {\n\tid: number;\n\tno: string;\n\tname: string;\n\tfirstName: string;\n\tlastName: string;\n\ttitle: string;\n\tStatus: string;\n\tCreateTime: any;\n\twebuser: number;\n\temployee: number;\n}\nexport interface ResultSearchEmployee {\n\t$page: ReturnSearchEmployee$page[];\n}\n\nexport interface ParamSearchTeam {\n\tkey: string;\n}\nexport interface ReturnSearchTeam$page {\n\tid: number;\n\twebuser: number;\n\temployee: number;\n}\nexport interface ResultSearchTeam {\n\t$page: ReturnSearchTeam$page[];\n}\n\nexport interface Param$poked {\n}\nexport interface Return$pokedRet {\n\tpoke: number;\n}\nexport interface Result$poked {\n\tret: Return$pokedRet[];\n}\n\nexport interface ParamGetWebUser {\n\temployee: number;\n}\nexport interface ReturnGetWebUserRet {\n\twebuser: number;\n\temployee: number;\n}\nexport interface ResultGetWebUser {\n\tret: ReturnGetWebUserRet[];\n}\n\nexport interface Param$getMyTimezone {\n}\nexport interface Return$getMyTimezoneRet {\n\ttimezone: number;\n\tunitTimeZone: number;\n}\nexport interface Result$getMyTimezone {\n\tret: Return$getMyTimezoneRet[];\n}\n\nexport interface ParamActs {\n}\n\n\nexport interface UqExt extends Uq {\n\tActs(param:ParamActs): Promise<any>;\n\n\t$user: UqTuid<Tuid$user>;\n\t$sheet: UqTuid<Tuid$sheet>;\n\tEmployee: UqTuid<TuidEmployee>;\n\tRole: UqTuid<TuidRole>;\n\tCompany: UqTuid<TuidCompany>;\n\tDeleteWebuseEmployee: UqAction<ParamDeleteWebuseEmployee, ResultDeleteWebuseEmployee>;\n\tAddWebuseEmployee: UqAction<ParamAddWebuseEmployee, ResultAddWebuseEmployee>;\n\t$setMyTimezone: UqAction<Param$setMyTimezone, Result$setMyTimezone>;\n\tSearchEmployee: UqQuery<ParamSearchEmployee, ResultSearchEmployee>;\n\tSearchTeam: UqQuery<ParamSearchTeam, ResultSearchTeam>;\n\t$poked: UqQuery<Param$poked, Result$poked>;\n\tGetWebUser: UqQuery<ParamGetWebUser, ResultGetWebUser>;\n\t$getMyTimezone: UqQuery<Param$getMyTimezone, Result$getMyTimezone>;\n\tEmployeeRole: UqMap;\n\tWebuserEmployee: UqMap;\n\tEmployeeRelation: UqMap;\n}\n\nexport function assign(uq: any, to:string, from:any): void {\n\tlet hasEntity = uq.$.hasEntity(to);\n\tif (hasEntity === false) {\n\t\treturn;\n\t}\n\tObject.assign((uq as any)[to], from);\n}\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { Res, setRes, TFunc } from 'tonva-react';\nimport { TuidEmployee } from \"./JkHr\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidEmployee):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from \"tonva-react\";\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidRole } from \"./JkHr\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidRole):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","// eslint-disable-next-line @typescript-eslint/no-unused-vars\nimport { Res, setRes, TFunc } from \"tonva-react\";\nimport { FieldItem, FieldItemNumber, FieldItemString, FieldItemId, UI, uqStringify } from \"tonva-core\";\nimport { TuidCompany } from \"./JkHr\";\n\nconst resRaw: Res<any> = {\n\t$zh: {\n\t},\n\t$en: {\n\t}\n};\nconst res: any = {};\nsetRes(res, resRaw);\n\nexport const t:TFunc = (str:string|JSX.Element): string|JSX.Element => {\n\treturn res[str as string] ?? str;\n}\n\nexport function render(item: TuidCompany):JSX.Element {\n\treturn <>{uqStringify(item)}</>;\n};\n","//=== UqApp builder created on Fri Nov 12 2021 10:10:02 GMT-0500 (北美东部标准时间) ===//\nimport * as JkMe from './JkMe';\nimport * as JkProduct from './JkProduct';\nimport * as JkPointShop from './JkPointShop';\nimport * as JkHr from './JkHr';\n\nexport interface UQs {\n\tJkMe: JkMe.UqExt;\n\tJkProduct: JkProduct.UqExt;\n\tJkPointShop: JkPointShop.UqExt;\n\tJkHr: JkHr.UqExt;\n}\n\nexport * as JkMe from './JkMe';\nexport * as JkProduct from './JkProduct';\nexport * as JkPointShop from './JkPointShop';\nexport * as JkHr from './JkHr';\n\nexport function setUI(uqs:UQs) {\n\tJkMe.setUI(uqs.JkMe);\n\tJkProduct.setUI(uqs.JkProduct);\n\tJkPointShop.setUI(uqs.JkPointShop);\n\tJkHr.setUI(uqs.JkHr);\n}\n","import { UqExt as Uq, assign } from './JkMe';\nimport * as Object from './Object.ui';\nimport * as ItemHistory from './ItemHistory.ui';\nimport * as OrderDetail from './OrderDetail.ui';\nimport * as OrderMain from './OrderMain.ui';\nimport * as ItemTitle from './ItemTitle.ui';\nimport * as PostTitle from './PostTitle.ui';\nimport * as ObjectUser from './ObjectUser.ui';\nimport * as ObjectStaff from './ObjectStaff.ui';\nimport * as ObjectPost from './ObjectPost.ui';\nimport * as ObjectCustomer from './ObjectCustomer.ui';\nimport * as ObjectPostItem from './ObjectPostItem.ui';\nimport * as Group from './Group.ui';\nimport * as ObjectDistributor from './ObjectDistributor.ui';\nimport * as ObjectAgent from './ObjectAgent.ui';\nimport * as QueueBizOp from './QueueBizOp.ui';\nimport * as QueueBizMain from './QueueBizMain.ui';\nimport * as DeliverDetail from './DeliverDetail.ui';\nimport * as DeliverMain from './DeliverMain.ui';\nimport * as Role from './Role.ui';\nimport * as OPIHistory from './OPIHistory.ui';\nimport * as ObjectAccount from './ObjectAccount.ui';\nimport * as BizMainBound from './BizMainBound.ui';\nimport * as OPIBooking from './OPIBooking.ui';\nimport * as AccountTitle from './AccountTitle.ui';\nimport * as DxOrderDetail from './DxOrderDetail.ui';\nimport * as DxOrderMain from './DxOrderMain.ui';\nimport * as DxBizMain from './DxBizMain.ui';\nimport * as DxBizOp from './DxBizOp.ui';\nimport * as DxBiz from './DxBiz.ui';\nimport * as UserObject from './UserObject.ui';\nimport * as GroupObject from './GroupObject.ui';\nimport * as UserSuperviseItem from './UserSuperviseItem.ui';\nimport * as MonthSumProduct from './MonthSumProduct.ui';\nimport * as MonthSumCustomer from './MonthSumCustomer.ui';\nimport * as IxBizOpBound from './IxBizOpBound.ui';\nimport * as UserRole from './UserRole.ui';\nimport * as RoleOps from './RoleOps.ui';\nimport * as ObjectAccountHistory from './ObjectAccountHistory.ui';\nimport * as DaySumItem from './DaySumItem.ui';\nimport * as AccountBooking from './AccountBooking.ui';\n\t\nexport function setUI(uq: Uq) {\n\tassign(uq, 'Object', Object);\n\tassign(uq, 'ItemHistory', ItemHistory);\n\tassign(uq, 'OrderDetail', OrderDetail);\n\tassign(uq, 'OrderMain', OrderMain);\n\tassign(uq, 'ItemTitle', ItemTitle);\n\tassign(uq, 'PostTitle', PostTitle);\n\tassign(uq, 'ObjectUser', ObjectUser);\n\tassign(uq, 'ObjectStaff', ObjectStaff);\n\tassign(uq, 'ObjectPost', ObjectPost);\n\tassign(uq, 'ObjectCustomer', ObjectCustomer);\n\tassign(uq, 'ObjectPostItem', ObjectPostItem);\n\tassign(uq, 'Group', Group);\n\tassign(uq, 'ObjectDistributor', ObjectDistributor);\n\tassign(uq, 'ObjectAgent', ObjectAgent);\n\tassign(uq, 'QueueBizOp', QueueBizOp);\n\tassign(uq, 'QueueBizMain', QueueBizMain);\n\tassign(uq, 'DeliverDetail', DeliverDetail);\n\tassign(uq, 'DeliverMain', DeliverMain);\n\tassign(uq, 'Role', Role);\n\tassign(uq, 'OPIHistory', OPIHistory);\n\tassign(uq, 'ObjectAccount', ObjectAccount);\n\tassign(uq, 'BizMainBound', BizMainBound);\n\tassign(uq, 'OPIBooking', OPIBooking);\n\tassign(uq, 'AccountTitle', AccountTitle);\n\tassign(uq, 'DxOrderDetail', DxOrderDetail);\n\tassign(uq, 'DxOrderMain', DxOrderMain);\n\tassign(uq, 'DxBizMain', DxBizMain);\n\tassign(uq, 'DxBizOp', DxBizOp);\n\tassign(uq, 'DxBiz', DxBiz);\n\tassign(uq, 'UserObject', UserObject);\n\tassign(uq, 'GroupObject', GroupObject);\n\tassign(uq, 'UserSuperviseItem', UserSuperviseItem);\n\tassign(uq, 'MonthSumProduct', MonthSumProduct);\n\tassign(uq, 'MonthSumCustomer', MonthSumCustomer);\n\tassign(uq, 'IxBizOpBound', IxBizOpBound);\n\tassign(uq, 'UserRole', UserRole);\n\tassign(uq, 'RoleOps', RoleOps);\n\tassign(uq, 'ObjectAccountHistory', ObjectAccountHistory);\n\tassign(uq, 'DaySumItem', DaySumItem);\n\tassign(uq, 'AccountBooking', AccountBooking);\n}\nexport * from './JkMe';\n","import { UqExt as Uq, assign } from './JkProduct';\nimport * as Chemical from './Chemical.ui';\nimport * as SalesRegion from './SalesRegion.ui';\nimport * as Currency from './Currency.ui';\nimport * as PackType from './PackType.ui';\nimport * as Language from './Language.ui';\nimport * as Brand from './Brand.ui';\nimport * as Stuff from './Stuff.ui';\nimport * as ProductX from './ProductX.ui';\nimport * as ProductCategory from './ProductCategory.ui';\nimport * as Lot from './Lot.ui';\nimport * as PackSalesLevel from './PackSalesLevel.ui';\n\t\nexport function setUI(uq: Uq) {\n\tassign(uq, 'Chemical', Chemical);\n\tassign(uq, 'SalesRegion', SalesRegion);\n\tassign(uq, 'Currency', Currency);\n\tassign(uq, 'PackType', PackType);\n\tassign(uq, 'Language', Language);\n\tassign(uq, 'Brand', Brand);\n\tassign(uq, 'Stuff', Stuff);\n\tassign(uq, 'ProductX', ProductX);\n\tassign(uq, 'ProductCategory', ProductCategory);\n\tassign(uq, 'Lot', Lot);\n\tassign(uq, 'PackSalesLevel', PackSalesLevel);\n}\nexport * from './JkProduct';\n","import { UqExt as Uq, assign } from './JkPointShop';\nimport * as ProductX from './ProductX.ui';\nimport * as Customer from './Customer.ui';\nimport * as WebUser from './WebUser.ui';\nimport * as Contact from './Contact.ui';\nimport * as Currency from './Currency.ui';\nimport * as BuyerAccount from './BuyerAccount.ui';\nimport * as Genre from './Genre.ui';\nimport * as PointProductLib from './PointProductLib.ui';\nimport * as Brand from './Brand.ui';\nimport * as OrderMain from './OrderMain.ui';\nimport * as OrderDetail from './OrderDetail.ui';\nimport * as ExchangeDetail from './ExchangeDetail.ui';\nimport * as ExchangeMain from './ExchangeMain.ui';\nimport * as ReceiveMain from './ReceiveMain.ui';\nimport * as ReceiveDetail from './ReceiveDetail.ui';\nimport * as DxOrderDetail from './DxOrderDetail.ui';\nimport * as DxReOrderDetail from './DxReOrderDetail.ui';\nimport * as DxExchangeDetail from './DxExchangeDetail.ui';\nimport * as DxExchangeMainState from './DxExchangeMainState.ui';\nimport * as IxExchangeMainUsedPoint from './IxExchangeMainUsedPoint.ui';\nimport * as ExchangeDetailDeliver from './ExchangeDetailDeliver.ui';\nimport * as IxOrderDetailReceive from './IxOrderDetailReceive.ui';\n\t\nexport function setUI(uq: Uq) {\n\tassign(uq, 'ProductX', ProductX);\n\tassign(uq, 'Customer', Customer);\n\tassign(uq, 'WebUser', WebUser);\n\tassign(uq, 'Contact', Contact);\n\tassign(uq, 'Currency', Currency);\n\tassign(uq, 'BuyerAccount', BuyerAccount);\n\tassign(uq, 'Genre', Genre);\n\tassign(uq, 'PointProductLib', PointProductLib);\n\tassign(uq, 'Brand', Brand);\n\tassign(uq, 'OrderMain', OrderMain);\n\tassign(uq, 'OrderDetail', OrderDetail);\n\tassign(uq, 'ExchangeDetail', ExchangeDetail);\n\tassign(uq, 'ExchangeMain', ExchangeMain);\n\tassign(uq, 'ReceiveMain', ReceiveMain);\n\tassign(uq, 'ReceiveDetail', ReceiveDetail);\n\tassign(uq, 'DxOrderDetail', DxOrderDetail);\n\tassign(uq, 'DxReOrderDetail', DxReOrderDetail);\n\tassign(uq, 'DxExchangeDetail', DxExchangeDetail);\n\tassign(uq, 'DxExchangeMainState', DxExchangeMainState);\n\tassign(uq, 'IxExchangeMainUsedPoint', IxExchangeMainUsedPoint);\n\tassign(uq, 'ExchangeDetailDeliver', ExchangeDetailDeliver);\n\tassign(uq, 'IxOrderDetailReceive', IxOrderDetailReceive);\n}\nexport * from './JkPointShop';\n","import { UqExt as Uq, assign } from './JkHr';\nimport * as Employee from './Employee.ui';\nimport * as Role from './Role.ui';\nimport * as Company from './Company.ui';\n\t\nexport function setUI(uq: Uq) {\n\tassign(uq, 'Employee', Employee);\n\tassign(uq, 'Role', Role);\n\tassign(uq, 'Company', Company);\n}\nexport * from './JkHr';\n","import { FA, List, LMR, VPage } from \"tonva-react\";\r\nimport { EnumRoleOp\r\n    , ReturnGetUserSuperviseItemRet } from \"uq-app/uqs/JkMe\";\r\nimport { Item  } from \"uq-app/uqs/JkMe/JkMe\";\r\nimport { CSupervise } from \"./CSupervise\";\r\n\r\ninterface VIndexProps {\r\n    icon?:string; \r\n    iconColor?:string;\r\n    caption:string; \r\n    action: ()=>void;\r\n}\r\n\r\nconst VIndex = ({icon, caption, action, iconColor}:VIndexProps) => {\r\n    let fa = <FA name={icon??'chevron-circle-right'} className={'me-3 ' + (iconColor??' text-success ')} />;\r\n    let right = <FA name=\"angle-right\" />\r\n    return <LMR left={fa} right={right}\r\n        className=\"px-3 py-2 mb-1 bg-white cursor-pointer align-items-center\" \r\n        onClick={action}>\r\n        {caption}\r\n    </LMR>\r\n}\r\n\r\nexport class VSupervise extends VPage<CSupervise> {\r\n    private renderOpTest = () => {\r\n        const queryList: {\r\n            caption: string;\r\n            item: Item;\r\n            action: (caption:string, item: Item) => void;\r\n        }[] = [\r\n            {\r\n                caption: '按月商品销售额排序',\r\n                item: Item.orderAmount,\r\n                action: this.controller.showProductSumByMonth,\r\n            },\r\n            {\r\n                caption: '按月商品毛利润排序',\r\n                item: Item.orderProfit,\r\n                action: this.controller.showProductSumByMonth,\r\n            },\r\n            {\r\n                caption: '按月客户销售额排序',\r\n                item: Item.orderAmount,\r\n                action: this.controller.showCustomerSumByMonth,\r\n            },\r\n            {\r\n                caption: '按月客户毛利润排序',\r\n                item: Item.orderProfit,\r\n                action: this.controller.showCustomerSumByMonth,\r\n            },\r\n        ];\r\n        let {superviseItems} = this.controller;\r\n        return <>\r\n            <div className=\"mb-4\">\r\n                <div className=\"my-2 mx-1 border border-info rounded\">\r\n                    <div className=\"p-3 border-bottom border-info bg-white\">\r\n                        <b>公司业务</b>\r\n                    </div>\r\n                    <div>\r\n                        {this.controller.renderVUnitSum()}\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            {this.controller.cObjectsArr.map((v, index) => {\r\n                return <VIndex key={index} \r\n                    action={() => v.loadAndShowList()}\r\n                    caption={v.header()}\r\n                    iconColor=\"text-primary\" />;\r\n                /*\r\n                return <div key={index} className=\"px-3 py-2 mb-1 bg-white cursor-pointer\" \r\n                    onClick={() => v.loadAndShowList()}>\r\n                    {v.header()}\r\n                </div>\r\n                */\r\n            })}\r\n            <VIndex action={this.controller.showAccounts}\r\n                caption=\"账户余额列表\"\r\n                iconColor=\"text-primary\" />\r\n            <div className=\"mb-3\" />\r\n            {\r\n                queryList.map((v, index) => {\r\n                    let {caption, item, action} = v;\r\n                    return <VIndex key={index} iconColor=\"text-danger\"\r\n                        caption={caption} \r\n                        action={()=>action(caption, item)} />;\r\n                    /*\r\n                    return <div key={index} \r\n                        className=\"px-3 py-2 mb-1 bg-white cursor-pointer\" \r\n                        onClick={() => action(caption, item)}>\r\n                        {caption}\r\n                    </div>;\r\n                    */\r\n                })\r\n            }\r\n            <div className=\"mb-3\" />\r\n            <List items={superviseItems} none={null}\r\n                item={{render: this.renderSuperviseItem, onClick: this.onClickSuperviseItem}} />\r\n        </>;\r\n        /*\r\n            <List items={superviseObjects} \r\n            item={{render: this.renderSuperviseObject, onClick: this.onClickSuperviseObject}} />\r\n        <div className=\"mb-3\" />\r\n        */\r\n}\r\n\r\n    private opRenders: {[key in EnumRoleOp]: () => JSX.Element} = {\r\n        [EnumRoleOp.test]: this.renderOpTest,\r\n    }\r\n\r\n    superviseItems: ReturnGetUserSuperviseItemRet[];\r\n\r\n    header() {return '团队'}\r\n    content() {    \r\n        return <div>\r\n            {\r\n                this.controller.cApp.ops.map((v, index) => {\r\n                    let {role, op} = v;\r\n                    return <div key={index} className=\"py-2\">\r\n                        {this.opRenders[op]()}\r\n                    </div>;\r\n                })\r\n            }\r\n        </div>;\r\n    }\r\n\r\n    private renderSuperviseItem = (row: ReturnGetUserSuperviseItemRet, index: number) => {\r\n        let {item} = row;\r\n        let {itemTitles} = this.controller.cApp;\r\n\t\tlet {title, vice} = itemTitles[item as Item];\r\n        return <div className=\"px-3 py-2 align-items-center\">\r\n            全公司{title} <small className=\"text-muted ms-3\">{vice}</small>\r\n        </div>;\r\n    }\r\n    \r\n    private onClickSuperviseItem = (row: ReturnGetUserSuperviseItemRet) => {\r\n        this.controller.showItemSumHistory(row.item);\r\n    }\r\n}\r\n","import { CSupervise } from \"supervise\";\r\nimport { List, LMR, View, VPage } from \"tonva-react\";\r\nimport { ReturnGetItemSumDaysRet, ReturnGetItemSumMonthsRet } from \"uq-app/uqs/JkMe\";\r\n\r\nexport class ViewItemDayHistory extends View<CSupervise> {\r\n    render() {\r\n        return <List items={this.controller.itemSumDays} \r\n            item={{render: this.renderDayItem, onClick: this.onClickDayItem}} />\r\n    }\r\n\r\n    private renderDayItem = (row: ReturnGetItemSumDaysRet, index: number) => {\r\n        let {cApp, item} = this.controller;\r\n        let {itemTitles} = cApp;\r\n        let {unit, fixed} = itemTitles[item];\r\n        let {date, value} = row;\r\n        return <LMR  className=\"px-3 py-2\" \r\n            left={<div>{new Date(date).toLocaleDateString()}</div>} \r\n            right={<div>{(value??0).toFixed(fixed??2)} {unit}</div>} />\r\n    }\r\n\r\n    private onClickDayItem = async (row: ReturnGetItemSumDaysRet) => {\r\n        let {date} = row;\r\n        let from = new Date(date);\r\n        let to = new Date(from);\r\n        to.setDate(to.getDate() + 1);\r\n        await this.controller.showItemHistory(from, to);\r\n    }\r\n}\r\n\r\nexport class VItemDayHistory extends VPage<CSupervise> {\r\n    header() {\r\n        let {cApp, item} = this.controller;\r\n        let {itemTitles} = cApp;\r\n\t\tlet {title, vice} = itemTitles[item];\r\n        return title;\r\n    }\r\n\r\n    content() {\r\n        let v = new ViewItemDayHistory(this.controller);\r\n        return <div className=\"\">\r\n            {v.render()}\r\n        </div>\r\n    }\r\n}\r\n","import { CSupervise } from \"supervise\";\r\nimport { List, LMR, VPage } from \"tonva-react\";\r\nimport { ReturnGetItemSumMonthsRet } from \"uq-app/uqs/JkMe\";\r\nimport { ViewItemDayHistory } from \"./VItemDayHistory\";\r\n\r\nexport class VItemSumHistory extends VPage<CSupervise> {\r\n    header() {\r\n        let {cApp, item} = this.controller;\r\n        let {itemTitles} = cApp;\r\n\t\tlet {title, vice} = itemTitles[item];\r\n        return title;\r\n    }\r\n\r\n    content() {\r\n        let v = new ViewItemDayHistory(this.controller);\r\n        return <div className=\"\">\r\n            <div className=\"px-3 pt-4 pb-2 text-center\">按日汇总 <small className=\"text-muted\">(近30日)</small></div>\r\n            {v.render()}\r\n            <div className=\"px-3 pt-4 pb-2 text-center\">按月汇总 <small className=\"text-muted\">(近12月))</small></div>\r\n            <List items={this.controller.itemSumMonths} \r\n                item={{render: this.renderMonthItem, onClick: this.onClickMonthItem}} />\r\n        </div>\r\n    }\r\n\r\n    private renderMonthItem = (row: ReturnGetItemSumMonthsRet, index: number) => {\r\n        let {cApp, item} = this.controller;\r\n        let {itemTitles} = cApp;\r\n        let {unit, fixed} = itemTitles[item];\r\n        let {date, value} = row;\r\n        let d = new Date(date);\r\n        return <LMR  className=\"px-3 py-2\" \r\n            left={<div>{d.getFullYear()}年{(d.getMonth()+1)}月</div>} \r\n            right={<div>{(value??0).toFixed(fixed??2)} {unit}</div>} />\r\n    }\r\n\r\n    private onClickMonthItem = async (row: ReturnGetItemSumMonthsRet) => {\r\n        let {date} = row;\r\n        let from = new Date(date.getFullYear(), date.getMonth(), 1);\r\n        let to = new Date(from);\r\n        to.setMonth(to.getMonth()+1);\r\n        await this.controller.showItemDayHistory(undefined, from, to);\r\n    }\r\n}\r\n","import { dateFromMinuteId } from 'tonva-core';\r\nimport { List, LMR, VDate, VPage } from \"tonva-react\";\r\nimport { CSupervise } from \"supervise\";\r\nimport { ReturnGetItemHistory$page } from \"uq-app/uqs/JkMe\";\r\n\r\nexport class VItemHistory extends VPage<CSupervise> {\r\n    header() {\r\n        let {cApp, item} = this.controller;\r\n        let {itemTitles} = cApp;\r\n\t\tlet {title, vice} = itemTitles[item];\r\n        return title + '明细';\r\n    }\r\n\r\n    content() {\r\n        return <div className=\"\">\r\n            <List items={this.controller.pageItemHistory} \r\n                item={{render: this.renderItem, onClick: this.onClickItem}} />\r\n        </div>\r\n    }\r\n\r\n    private renderItem = (row: ReturnGetItemHistory$page, index: number) => {\r\n        let {cApp, item} = this.controller;\r\n        let {itemTitles, timezone} = cApp;\r\n        let {unit, fixed} = itemTitles[item];\r\n        let {id, biz, bizOp, value, memo} = row;\r\n        let date = dateFromMinuteId(id, timezone);\r\n        let left = <div className=\"small text-muted w-min-6c\">\r\n            <VDate date={date} hideSameYear={true} />\r\n        </div>; \r\n        return <LMR className=\"px-3 py-2 align-items-center\" \r\n            left={left} \r\n            right={<div>{(value??0).toFixed(fixed??2)} <small className=\"text-muted\">{unit}</small></div>}>\r\n            <b>{bizOp}</b> {memo}\r\n        </LMR>;\r\n    }\r\n\r\n    private onClickItem = (row: ReturnGetItemHistory$page) => {\r\n        alert(JSON.stringify(row));\r\n    }\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { CSupervise } from \"supervise\";\r\nimport { FA, List, LMR, VPage } from \"tonva-react\";\r\nimport { ReturnGetProductSumByMonthRet } from \"uq-app/uqs/JkMe\";\r\n\r\nabstract class VSumByMonth extends VPage<CSupervise> {\r\n    header() { return this.controller.monthSum.vCaption; }\r\n\r\n    content() {\r\n        return <div className=\"\">\r\n            {\r\n                React.createElement(observer(() => <>\r\n                    {this.renderDate()}\r\n                    <List items={this.controller.monthSum.list} \r\n                        item={{render: this.renderItem, onClick: this.onClick}} />\r\n                </>))\r\n            }\r\n        </div>;\r\n    }\r\n    \r\n    protected abstract renderId(id: number): JSX.Element;\r\n\r\n    private renderDate() {\r\n        let {month, hasNext, prev, next} = this.controller.monthSum;\r\n        let left = <div className=\"cursor-pointer px-5 py-3\" onClick={prev}><FA name=\"angle-left\" /></div>;\r\n        let right = <div className={' px-5 py-3 ' + (hasNext? ' cursor-pointer ':' text-light ')} onClick={next}><FA name=\"angle-right\" /></div>\r\n        return <div className=\"d-flex justify-content-center\">\r\n            <div className=\"d-flex mx-auto\">\r\n                {left}\r\n                <div className=\"text-center py-3\">{month.getFullYear()}年{month.getMonth()+1}月</div>\r\n                {right}\r\n            </div>\r\n        </div>;\r\n\t}\r\n\r\n    private renderItem = (row: ReturnGetProductSumByMonthRet, index: number) => {\r\n        let {id, value} = row;\r\n        let {$serial} = row as any;\r\n        return <LMR  className=\"pe-2 pe-sm-3 py-2\" \r\n            left={<div className=\"w-min-2c text-center text-primary me-1 small\">{$serial}</div>} \r\n            right={<div className=\"ms-1\">{(value??0).toFixed(2)}<small className=\"text-muted\">元</small></div>}>\r\n                <div>{this.renderId(id)}</div>\r\n            </LMR>\r\n    }\r\n\r\n    private onClick = async (row: ReturnGetProductSumByMonthRet) => {\r\n        alert(JSON.stringify(row));\r\n    }\r\n}\r\n\r\nexport class VProductSumByMonth extends VSumByMonth {\r\n    protected renderId(id: number) {\r\n        return this.controller.uqs.JkProduct.ProductX.tv(id);\r\n    }\r\n}\r\n\r\nexport class VCustomerSumByMonth extends VSumByMonth {\r\n    protected renderId(id: number) {\r\n        return <>客户{id}</>;\r\n    }\r\n}\r\n","import { CSupervise } from \"../CSupervise\";\r\nimport { CApp, CUqSub, UQs } from \"uq-app\";\r\nimport { computed, makeObservable } from \"mobx\";\r\n\r\nexport abstract class CObjects extends CUqSub<CApp, UQs, CSupervise> {\r\n    abstract get baseList(): any[];\r\n\r\n    constructor(owner: CSupervise) {\r\n        super(owner);\r\n        makeObservable(this, {\r\n            baseList: computed,\r\n        });\r\n    }\r\n\r\n    protected async internalStart() {        \r\n    }\r\n    header() {return this.caption + '销售额列表'}\r\n    protected abstract get caption(): string;\r\n\r\n    protected async loadList(): Promise<void> {\r\n        // if (this.baseList) return;\r\n        await this.internalLoadList();\r\n    }\r\n    protected abstract internalLoadList(): Promise<void>;\r\n    async loadAndShowList(): Promise<void> {\r\n        await this.loadList();\r\n        this.showList();\r\n    }\r\n    protected abstract showList(): Promise<void>;\r\n}\r\n","import { observer } from \"mobx-react\";\r\nimport React from \"react\";\r\nimport { List, VPage } from \"tonva-react\";\r\nimport { CObjects } from \"./CObjects\";\r\n\r\nexport abstract class VObjects<T extends CObjects> extends VPage<T> {\r\n    header() {return this.controller.header()}\r\n    content() {\r\n        return React.createElement(observer(() => {\r\n            return <div className=\"\">\r\n                {this.renderListHeader()}\r\n                <List items={this.controller.baseList}\r\n                    item={{render: this.renderRow, onClick: this.onClickRow}} />\r\n                {this.renderListFooter()}\r\n            </div>\r\n        }));\r\n    }\r\n\r\n    private renderRow = (v:any, index:number): JSX.Element => {\r\n        return this.renderItem(v, index);\r\n    }\r\n\r\n    private onClickRow = (v:any) => {\r\n        this.onClickItem(v);\r\n    }\r\n\r\n    protected renderListHeader(): JSX.Element {\r\n        return <></>;\r\n    }\r\n\r\n    protected renderListFooter(): JSX.Element {\r\n        return <></>;\r\n    }\r\n\r\n    protected renderItem(v:any, index:number): JSX.Element {\r\n        return <div className=\"px-3 py-2\">\r\n            {v.id}\r\n        </div>;\r\n    }\r\n\r\n    protected onClickItem(v:any) {\r\n        alert(v.id);\r\n    }\r\n}\r\n","import { CAgents } from \"./CAgents\";\r\nimport { VObjects } from \"./VObjects\";\r\n\r\nexport class VAgents extends VObjects<CAgents> {\r\n}\r\n","import { CObjects } from \"./CObjects\";\r\nimport { VAgents } from \"./VAgents\";\r\n\r\nexport class CAgents extends CObjects {\r\n    protected list: any[];\r\n\r\n    get baseList(): any[] {return this.list}\r\n\r\n    protected get caption(): string {return '轻代理';}\r\n\r\n    protected async internalLoadList(): Promise<void> {\r\n        let ret = await this.uqs.JkMe.GetAgents.query({});\r\n        this.list = ret.ret;\r\n    }\r\n\r\n    protected async showList(): Promise<void> {\r\n        this.openVPage(VAgents);\r\n    }\r\n}\r\n\r\n","import { CDistributors } from \"./CDistributors\";\r\nimport { VObjects } from \"./VObjects\";\r\n\r\nexport class VDistributors extends VObjects<CDistributors> {\r\n}\r\n","import { VDistributors } from \"./VDistributors\";\r\nimport { CObjects } from \"./CObjects\";\r\n\r\nexport class CDistributors extends CObjects {\r\n    protected list: any[];\r\n\r\n    get baseList(): any[] {return this.list}\r\n\r\n    protected get caption(): string {return '经销商'}\r\n\r\n    protected async internalLoadList(): Promise<void> {\r\n        let ret = await this.uqs.JkMe.GetDistributors.query({});\r\n        this.list = ret.ret;\r\n    }\r\n\r\n    protected async showList(): Promise<void> {\r\n        this.openVPage(VDistributors);\r\n    }\r\n}\r\n\r\n","import { CGroups } from \"./CGroups\";\r\nimport { VObjects } from \"./VObjects\";\r\n\r\nexport class VGroups extends VObjects<CGroups> {\r\n}\r\n","import { CObjects } from \"./CObjects\";\r\nimport { VGroups } from \"./VGroups\";\r\n\r\nexport class CGroups extends CObjects {\r\n    protected list: any[];\r\n\r\n    get baseList(): any[] {return this.list}\r\n\r\n    protected get caption(): string {return '部门';}\r\n\r\n    protected async internalLoadList(): Promise<void> {\r\n        let ret = await this.uqs.JkMe.GetGroups.query({});\r\n        this.list = ret.ret;\r\n    }\r\n\r\n    protected async showList(): Promise<void> {\r\n        this.openVPage(VGroups);\r\n    }\r\n}\r\n","export const cnAmount = ' w-min-6c text-end ms-2';\r\n\r\n","import { LMR } from \"tonva-react\";\r\nimport { cnAmount } from \"tools\";\r\nimport { Item, Post } from \"uq-app/uqs/JkMe\";\r\nimport { CPosts } from \"./CPosts\";\r\nimport { VObjects } from \"./VObjects\";\r\n\r\nexport class VPosts extends VObjects<CPosts> {\r\n    protected renderItem(v:any, index:number): JSX.Element {\r\n\t\tlet {postTitles, itemTitles} = this.controller.cApp;\r\n        let {id, post, item, amountThisMonth, amountLastMonth} = v;\r\n\t\tlet {title:postTitle} = postTitles[post as Post];\r\n\t\tlet {title:itemTitle} = itemTitles[item as Item];\r\n        let right = <div className=\"d-flex align-items-center\">\r\n            {this.vAmount(amountThisMonth, item)}\r\n            {this.vAmount(amountLastMonth, item)}\r\n        </div>;\r\n        return <LMR className=\"px-3 py-2\" right={right}>\r\n            {postTitle} {itemTitle}\r\n        </LMR>;\r\n    }\r\n\r\n    protected renderListHeader(): JSX.Element {\r\n        return <div>\r\n            <div className=\"d-flex px-3 py-3 border-bottom border-primary\">\r\n                <div className=\"flex-fill\"></div>\r\n                <div className={cnAmount}>本月</div>\r\n                <div className={cnAmount}>上月</div>\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private vAmount(amount:number, item:Item):JSX.Element {\r\n\t\tlet {itemTitles} = this.controller.cApp;\r\n\t\tlet {fixed, unit} = itemTitles[item];\r\n        return <div className={cnAmount}>\r\n            {((amount??0) as number).toFixed(fixed)} \r\n            <small className=\"text-muted\">{unit}</small>\r\n        </div>;\r\n    }\r\n\r\n    /*\r\n    protected onClickItem(v:any) {\r\n        this.controller.showPostItemHistory(v);\r\n    }\r\n    */\r\n}\r\n","import { CObjects } from \"./CObjects\";\r\nimport { VPosts } from \"./VPosts\";\r\n\r\nexport class CPosts extends CObjects {\r\n    protected list: any[];\r\n\r\n    get baseList(): any[] {return this.list}\r\n\r\n    protected get caption(): string {return '岗位'}\r\n    header() {return this.caption + '绩效列表'}\r\n\r\n    protected async internalLoadList(): Promise<void> {\r\n        let ret = await this.uqs.JkMe.GetPosts.query({\r\n        });\r\n        this.list = ret.ret;\r\n    }\r\n\r\n    protected async showList(): Promise<void> {\r\n        this.openVPage(VPosts);\r\n    }\r\n}\r\n","import { LMR } from \"tonva-react\";\r\nimport { cnAmount } from \"tools\";\r\nimport { Item } from \"uq-app/uqs/JkMe\";\r\nimport { CStaffs, StaffRow } from \"./CStaffs\";\r\nimport { VObjects } from \"./VObjects\";\r\n\r\nexport class VStaffs extends VObjects<CStaffs> {\r\n    protected renderItem(v:StaffRow, index:number): JSX.Element {\r\n        let {staff, monthValuesArr} = v;\r\n        let right = <div className=\"d-block\">\r\n            {monthValuesArr.map((v, index) => {\r\n                let {item, dThis, mThis, mLast} = v;\r\n                if (mThis === undefined && mLast === undefined) return null;\r\n                let {itemTitles} = this.controller.cApp;\r\n                let {title} = itemTitles[item];\r\n                return <div key={index} className=\"d-flex\">\r\n                    <div className=\"flex-fill text-sm-end small text-muted\">{title}</div>\r\n                    <div className=\"d-sm-flex\">\r\n                        <div className=\"d-flex d-sm-block\">\r\n                            <div className=\"flex-fill small text-muted d-sm-none\">今日</div>\r\n                            <div>{this.vValue(dThis)}</div>\r\n                        </div>\r\n                        <div className=\"d-flex d-sm-block\">\r\n                            <div className=\"flex-fill small text-muted d-sm-none\">本月</div>\r\n                            <div>{this.vValue(mThis)}</div>\r\n                        </div>\r\n                        <div className=\"d-flex d-sm-block\">\r\n                            <div className=\"flex-fill small text-muted d-sm-none\">上月</div>\r\n                            <div>{this.vValue(mLast)}</div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            })}\r\n        </div>;\r\n        return <div className=\"px-3 py-2 d-block d-sm-flex\">\r\n            <div className=\"flex-fill\">\r\n                {this.controller.uqs.JkHr.Employee.tv(staff, renderEmployee)}\r\n            </div>\r\n            {right}\r\n        </div>;\r\n    }\r\n\r\n    protected renderListHeader(): JSX.Element {\r\n        return <div>\r\n            <div className=\"d-flex px-3 py-3 border-bottom border-primary\">\r\n                <div className=\"flex-fill\">员工</div>\r\n                <div className=\"d-none d-sm-flex\">\r\n                    <div className={cnAmount}>今天</div>\r\n                    <div className={cnAmount}>本月</div>\r\n                    <div className={cnAmount}>上月</div>\r\n                </div>\r\n            </div>\r\n            {this.renderListFooter()}\r\n        </div>;\r\n    }\r\n\r\n    protected renderListFooter(): JSX.Element {\r\n        let {sum} = this.controller;\r\n        return <div className=\"px-3 py-3 d-block d-sm-flex\">\r\n            <div className=\"flex-fill fw-bold text-sm-end small text-muted me-3\">合计</div>\r\n            <div>\r\n                {sum.map((v, index) => {\r\n                    let {item, dThis, mThis, mLast} = v;\r\n                    if ((mThis === 0 || mThis === undefined) \r\n                        && (mLast === 0 || mLast === undefined)) return null;\r\n                    let {itemTitles} = this.controller.cApp;\r\n                    let {title} = itemTitles[item];\r\n                    return <div key={index} className=\"d-flex\">\r\n                        <div className=\"flex-fill text-sm-end small text-muted\">{title}</div>\r\n                        <div className=\"d-sm-flex\">\r\n                            <div className=\"d-flex d-sm-block\">\r\n                                <div className=\"flex-fill small text-muted d-sm-none\">今日</div>\r\n                                <div>{this.vValue(dThis)}</div>\r\n                            </div>\r\n                            <div className=\"d-flex d-sm-block\">\r\n                                <div className=\"flex-fill small text-muted d-sm-none\">本月</div>\r\n                                <div>{this.vValue(mThis)}</div>\r\n                            </div>\r\n                            <div className=\"d-flex d-sm-block\">\r\n                                <div className=\"flex-fill small text-muted d-sm-none\">上月</div>\r\n                                <div>{this.vValue(mLast)}</div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                })}\r\n            </div>\r\n        </div>;\r\n    }\r\n\r\n    private vValue(amount:number):JSX.Element {\r\n\t\tlet {itemTitles} = this.controller.cApp;\r\n\t\tlet {fixed, unit} = itemTitles[Item.orderAmount];\r\n        return <div className={cnAmount}>\r\n            {((amount??0) as number).toFixed(fixed)} \r\n            <small className=\"text-muted\">{unit}</small>\r\n        </div>;\r\n    }\r\n\r\n    protected onClickItem(v:any) {\r\n        let {obj, staff} = v;\r\n        let pageTop = <div className=\"px-3 py-4\">\r\n            <div>职员 <b>{this.controller.uqs.JkHr.Employee.tv(staff, renderEmployee)}</b></div>\r\n        </div>;\r\n        this.controller.showObjectPortal(obj, pageTop);\r\n    }\r\n}\r\n\r\nfunction renderEmployee(employee: any):JSX.Element {\r\n    let {name} = employee;\r\n    return <>{name}</>;\r\n}\r\n","import { makeObservable, observable } from \"mobx\";\r\nimport { CSupervise } from \"supervise\";\r\nimport { Item } from \"uq-app/uqs/JkMe\";\r\nimport { CObjects } from \"./CObjects\";\r\nimport { VStaffs } from \"./VStaffs\";\r\n\r\nexport interface MonthValues {\r\n\topi: number;\r\n    item: Item;\r\n    dThis: number;\r\n    mThis: number;\r\n    mLast: number;\r\n}\r\n\r\nexport interface ItemMonthValues {\r\n    [Item.orderAmount]?: MonthValues;\r\n    [Item.couponFee]?: MonthValues;\r\n    [Item.profitFee]?: MonthValues;\r\n}\r\n\r\nexport interface StaffRow {\r\n\tobj: number;\r\n\tstaff: number;\r\n    monthValuesArr: MonthValues[];\r\n}\r\n\r\nexport class CStaffs extends CObjects {\r\n    list: StaffRow[];\r\n    sum: {item: Item; dThis: number; mThis: number; mLast: number; }[] = [];\r\n\r\n    get baseList(): any[] {return this.list}\r\n\r\n    constructor(owner: CSupervise) {\r\n        super(owner);\r\n        makeObservable(this, {\r\n            list: observable.shallow,\r\n        });\r\n    }\r\n\r\n    protected get caption(): string {return '员工'}\r\n\r\n    protected async internalLoadList(): Promise<void> {\r\n        let ret = await this.uqs.JkMe.GetStaffs.query({\r\n        });\r\n        let list = ret.ret;\r\n        let coll:{[staff:number]: StaffRow} = {};\r\n        let arr: StaffRow[] = [];\r\n        let sum: {[key in Item]?: {item: Item; dThis: number; mThis: number; mLast: number; }} = {};\r\n        for (let r of list) {\r\n            let {opi, item, obj, staff, valueToday, valueThisMonth, valueLastMonth} = r;\r\n            let staffRow = coll[staff];\r\n            if (staffRow === undefined) {\r\n                coll[staff] = staffRow = {\r\n                    obj,\r\n                    staff,\r\n                    monthValuesArr: [],\r\n                };\r\n                arr.push(staffRow);\r\n            }\r\n            let {monthValuesArr} = staffRow;\r\n            monthValuesArr.push({\r\n                opi,\r\n                item,\r\n                dThis: valueToday,\r\n                mThis: valueThisMonth,\r\n                mLast: valueLastMonth,\r\n            });\r\n            let sumItem = sum[item as Item];\r\n            if (sumItem === undefined) {\r\n                sumItem = {\r\n                    item,\r\n                    dThis: 0,\r\n                    mThis: 0,\r\n                    mLast: 0,\r\n                };\r\n                sum[item as Item] = sumItem;\r\n            }\r\n            sumItem.dThis += (valueToday ?? 0);\r\n            sumItem.mThis += (valueThisMonth ?? 0);\r\n            sumItem.mLast += (valueLastMonth ?? 0);\r\n        }\r\n        this.sum.splice(0, this.sum.length);\r\n        for (let i in sum) this.sum.push(sum[Number(i) as Item]);\r\n        this.list = arr;\r\n    }\r\n\r\n    protected async showList(): Promise<void> {\r\n        this.openVPage(VStaffs);\r\n    }\r\n\r\n    async showObjectPortal(object: number, pageTop: JSX.Element) {\r\n        let cObjectPortal = this.cApp.newCObjectPortal(object, pageTop);\r\n        cObjectPortal.showObjectPortal();\r\n    }\r\n}\r\n","import { CSupervise } from \"../CSupervise\";\r\nimport { CAgents } from \"./CAgents\";\r\nimport { CDistributors } from \"./CDistributors\";\r\nimport { CGroups } from \"./CGroups\";\r\nimport { CObjects } from \"./CObjects\";\r\nimport { CPosts } from \"./CPosts\";\r\nimport { CStaffs } from \"./CStaffs\";\r\n\r\nexport function initCObjects(cSupervise: CSupervise): CObjects[] {\r\n    return [\r\n        new CGroups(cSupervise),\r\n        new CDistributors(cSupervise),\r\n        new CAgents(cSupervise),\r\n        new CPosts(cSupervise),\r\n        new CStaffs(cSupervise),\r\n    ];\r\n}\r\n","import { List, LMR, VPage } from \"tonva-react\";\r\nimport { EnumAccount, EnumObjectType, Post, ReturnGetAccountsRet } from \"uq-app/uqs/JkMe\";\r\nimport { CSupervise } from \"./CSupervise\";\r\n\r\nexport class VAccounts extends VPage<CSupervise> {\r\n    header() {return '账户余额列表'}\r\n    content() {\r\n        return <List items={this.controller.accounts}\r\n            item={{render: this.renderAccount, onClick: this.controller.showAccountHistory}} />\r\n    }\r\n\r\n    private renderAccount = (row: ReturnGetAccountsRet, index:number) => {\r\n        let {cApp, uqs} = this.controller;\r\n        let {accountTitles} = cApp;\r\n        let {id, object, account, balance, objectType, objectTo} = row;\r\n        let {title:accountTitle, unit, fixed} = accountTitles[account as EnumAccount];\r\n        let right = <div>\r\n            <span>{balance.toFixed(fixed??2)}</span>\r\n            <small className=\"ms-1 text-muted\">{unit}</small>\r\n        </div>;\r\n        let {Employee} = uqs.JkHr;\r\n        const renderObject = () => {\r\n            switch (Number(objectType) as EnumObjectType) {\r\n                default: return <>{objectType} {objectTo}</>;\r\n                case EnumObjectType.post:\r\n                    let {postTitles} = cApp;\r\n                    return <>{postTitles[objectTo as Post].title}</>;\r\n                case EnumObjectType.staff:\r\n                    return Employee.tv(objectTo, renderEmployee);\r\n            }\r\n        }\r\n        return <LMR className=\"px-3 py-2\" right={right}>\r\n            {renderObject()} {accountTitle}\r\n        </LMR>\r\n    }\r\n}\r\n\r\nfunction renderEmployee(employee: any):JSX.Element {\r\n    let {name} = employee;\r\n    return <>{name}</>;\r\n}\r\n","import { CUqBase, UQs } from \"uq-app\";\r\nimport { ReturnGetObjectsRet\r\n\t, ReturnGetGroupsRet\r\n\t, ReturnGetDistributorsRet\r\n\t, ReturnGetAgentsRet\r\n\t, ReturnGetStaffsRet\r\n\t, ReturnGetPostsRet\r\n\t, ReturnGetUserSuperviseItemRet\r\n\t, ReturnGetCustomerSumByMonthRet, ReturnGetItemHistory$page\r\n\t, ReturnGetItemSumDaysRet, ReturnGetItemSumMonthsRet\r\n\t, ReturnGetProductSumByMonthRet\r\n\t, ReturnGetAccountsRet\r\n} from \"uq-app/uqs/JkMe\";\r\nimport { Item } from \"uq-app/uqs/JkMe/JkMe\";\r\nimport { VSupervise } from \"./VSupervise\";\r\nimport { VItemSumHistory } from \"./VItemSumHistory\";\r\nimport { env, PageItems } from \"tonva-core\";\r\nimport { VItemHistory } from \"./VItemHistory\";\r\nimport { VItemDayHistory } from \"./VItemDayHistory\";\r\nimport { VCustomerSumByMonth, VProductSumByMonth } from \"./VSumByMonth\";\r\nimport { action, computed, makeObservable, observable, runInAction } from \"mobx\";\r\nimport { CObjects } from \"./objects/CObjects\";\r\nimport { initCObjects } from \"./objects\";\r\nimport { VAccounts } from \"./VAccounts\";\r\n\r\nexport class CSupervise extends CUqBase {\r\n\titem: Item;\r\n\titemSumDays: ReturnGetItemSumDaysRet[];\r\n\titemSumMonths: ReturnGetItemSumMonthsRet[];\r\n\tpageItemHistory: PageItemHistory;\r\n\tmonthSum: MonthSum<any>;\r\n\tsuperviseItems: ReturnGetUserSuperviseItemRet[];\r\n\tobjects: ReturnGetObjectsRet[];\r\n\tgroups: ReturnGetGroupsRet[];\r\n\tdistributors: ReturnGetDistributorsRet[];\r\n\tagents: ReturnGetAgentsRet[];\r\n\tstaffs: ReturnGetStaffsRet[];\r\n\tposts: ReturnGetPostsRet[];\r\n\tcObjectsArr: CObjects[];\r\n\taccounts: ReturnGetAccountsRet[];\r\n\r\n\tprotected async internalStart() {\r\n\t}\r\n\r\n\ttab = () => this.renderView(VSupervise);\r\n\r\n\tload = async() => {\r\n\t\tthis.cObjectsArr = initCObjects(this);\r\n\t\tlet {JkMe} = this.uqs;\r\n\t\tlet [superviseItems] = await Promise.all([\r\n\t\t\tJkMe.GetUserSuperviseItem.query({}),\r\n\t\t]);\r\n\t\tthis.superviseItems = superviseItems.ret;\r\n\t}\r\n\r\n\tasync showItemSumHistory(item: Item) {\r\n\t\tif (item) this.item = item;\r\n\t\telse item = this.item;\r\n\t\tlet date = new Date();\r\n\t\tdate.setDate(date.getDate() + 1);\r\n\t\tlet [itemSumDays, itemSumMonths] = await Promise.all([\r\n\t\t\tthis.uqs.JkMe.GetItemSumDays.query({\r\n\t\t\t\titem, \r\n\t\t\t\tdate, \r\n\t\t\t\tdays: 30,\r\n\t\t\t}),\r\n\t\t\tthis.uqs.JkMe.GetItemSumMonths.query({\r\n\t\t\t\titem, \r\n\t\t\t\tdate, \r\n\t\t\t\tmonths: 12,\r\n\t\t\t}),\r\n\t\t]);\r\n\t\tthis.itemSumDays = itemSumDays.ret;\r\n\t\tthis.itemSumMonths = itemSumMonths.ret;\r\n\t\tthis.openVPage(VItemSumHistory);\r\n\t}\r\n\r\n\tasync showItemDayHistory(item: Item, from:Date, to:Date) {\r\n\t\tif (item) this.item = item;\r\n\t\telse item = this.item;\r\n\t\tlet days = Math.floor((to.getTime() - from.getTime())/ (1000*3600*24));\r\n\t\tlet [itemSumDays] = await Promise.all([\r\n\t\t\tthis.uqs.JkMe.GetItemSumDays.query({\r\n\t\t\t\titem, \r\n\t\t\t\tdate: to, \r\n\t\t\t\tdays,\r\n\t\t\t})\r\n\t\t]);\r\n\t\tthis.itemSumDays = itemSumDays.ret;\r\n\t\tthis.openVPage(VItemDayHistory);\r\n\t}\r\n\r\n\tasync showItemHistory(from:Date, to:Date) {\r\n\t\tthis.pageItemHistory = new PageItemHistory(this.uqs);\r\n\t\tawait this.pageItemHistory.first({\r\n\t\t\titem:this.item, \r\n\t\t\tfrom, \r\n\t\t\tto,\r\n\t\t});\r\n\t\tthis.openVPage(VItemHistory);\r\n\t}\r\n\r\n\tshowProductSumByMonth = async (caption: string, item: Item) => {\r\n\t\tthis.monthSum = new MonthSumProduct(this, caption, item);\r\n\t\tawait this.monthSum.load();\r\n\t\tthis.openVPage(VProductSumByMonth);\r\n\t}\r\n\r\n\tshowCustomerSumByMonth = async (caption: string, item: Item) => {\r\n\t\tthis.monthSum = new MonthSumCustomer(this, caption, item);\r\n\t\tawait this.monthSum.load();\r\n\t\tthis.openVPage(VCustomerSumByMonth);\r\n\t}\r\n\r\n\trenderVUnitSum() {\r\n\t\treturn this.cApp.renderVUnitSum();\r\n\t}\r\n\r\n\tshowAccounts = async () => {\r\n\t\tlet ret = await this.uqs.JkMe.GetAccounts.query({});\r\n\t\tthis.accounts = ret.ret;\r\n\t\tthis.openVPage(VAccounts);\r\n\t}\r\n\r\n\tshowAccountHistory = async () => {\r\n\t\talert('显示账户明细 正在设计中...');\r\n\t}\r\n}\r\n\r\nclass PageItemHistory extends PageItems<ReturnGetItemHistory$page> {\r\n\tprivate uqs: UQs;\r\n\tconstructor(uqs: UQs) {\r\n\t\tsuper();\r\n\t\tthis.uqs = uqs;\r\n\t}\r\n\tprotected async loadResults(param: any, pageStart: any, pageSize: number): Promise<{\r\n        [name: string]: any[];\r\n    }> {\r\n\t\tlet ret = await this.uqs.JkMe.GetItemHistory.page(param, pageStart, pageSize);\r\n\t\treturn ret as any;\r\n\t}\r\n}\r\n\r\nabstract class MonthSum<T> {\r\n\tprotected controller: CSupervise;\r\n\tvCaption: string;\r\n\titem: Item;\r\n\tmonth: Date;\r\n\tlist: T[];\r\n\tconstructor(controller: CSupervise, caption: string, item: Item) {\r\n\t\tthis.controller = controller;\r\n\t\tthis.month = new Date();\r\n\t\tthis.month.setDate(1);\r\n\t\tthis.month.setHours(0, 0, 0, 0);\r\n\t\tthis.vCaption = caption;\r\n\t\tthis.item = item;\r\n\t\tmakeObservable(this, {\r\n\t\t\tmonth: observable,\r\n\t\t\thasNext: computed,\r\n\t\t\tprev: action,\r\n\t\t\tnext: action,\r\n\t\t\tlist: observable.shallow,\r\n\t\t});\r\n\t}\r\n\r\n\tprev = async () => {\r\n\t\tlet m = new Date(this.month);\r\n\t\tm.setMonth(m.getMonth() - 1);\r\n\t\tthis.month = m;\r\n\t\tawait this.load();\r\n\t}\r\n\r\n\tnext = async () => {\r\n\t\tif (this.hasNext === true) {\r\n\t\t\tlet m = new Date(this.month);\r\n\t\t\tm.setMonth(m.getMonth() + 1);\r\n\t\t\tthis.month = m;\r\n\t\t\tawait this.load();\r\n\t\t}\r\n\t}\r\n\r\n\tget hasNext():boolean {\r\n\t\tlet d = new Date();\r\n\t\td.setDate(0);\r\n\t\td.setHours(0, 0, 0, 0);\r\n\t\treturn this.month < d;\r\n\t}\r\n\r\n\tabstract load(): Promise<void>;\r\n}\r\n\r\nclass MonthSumProduct extends MonthSum<ReturnGetProductSumByMonthRet> {\r\n\tasync load(): Promise<void> {\r\n\t\tlet m = this.month.getFullYear() * 100 + (this.month.getMonth() + 1);\r\n\t\tlet param = {\r\n\t\t\titem: this.item, \r\n\t\t\tmonth: m,\r\n\t\t\tcount: 200,\r\n\t\t};\r\n\t\tlet ret = await this.controller.uqs.JkMe.GetProductSumByMonth.query(param);\r\n\t\tlet list = ret.ret;\r\n\t\tlet len = list.length;\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t(list[i] as any).$serial = i+1;\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tthis.list = list;\r\n\t\t});\r\n\t}\r\n}\r\n\r\nclass MonthSumCustomer extends MonthSum<ReturnGetCustomerSumByMonthRet> {\r\n\tasync load(): Promise<void> {\r\n\t\tlet m = this.month.getFullYear() * 100 + (this.month.getMonth() + 1);\r\n\t\tlet param = {\r\n\t\t\titem: this.item, \r\n\t\t\tmonth: m,\r\n\t\t\tcount: 200,\r\n\t\t};\r\n\t\tlet ret = await this.controller.uqs.JkMe.GetCustomerSumByMonth.query(param);\r\n\t\tlet list = ret.ret;\r\n\t\tlet len = list.length;\r\n\t\tfor (let i=0; i<len; i++) {\r\n\t\t\t(list[i] as any).$serial = i+1;\r\n\t\t}\r\n\t\trunInAction(() => {\r\n\t\t\tthis.list = list;\r\n\t\t});\r\n\t}\r\n}","import { action, computed, makeObservable, observable } from \"mobx\";\r\nimport { env } from \"tonva-core\";\r\nimport { Item, Post, ReturnGetObjectItemPeriodSumRet } from \"uq-app/uqs/JkMe\";\r\n\r\nexport enum EnumPeriod {day = 0, month = 1, week = 2, year = 3}\r\n\r\nexport interface ItemPeriodSum extends ReturnGetObjectItemPeriodSumRet {\r\n\tid: number;\r\n\tobject: number;\r\n\tpost: Post;\r\n\titem: Item;\r\n\tvalue: number;\r\n}\r\n\r\nexport interface PostPeriodSum {\r\n    post: Post;\r\n    itemColl: {[item in keyof typeof Item]: ItemPeriodSum};\r\n    itemList: ItemPeriodSum[];\r\n}\r\n\r\nexport abstract class Period {\r\n    private timezone: number;\r\n    constructor(timezone: number) {\r\n        this.timezone = timezone;\r\n        this.to = this.newDate();\r\n        this.from = new Date(this.to);\r\n        this.init();\r\n        this.initObservable();\r\n    }\r\n    private newDate():Date {\r\n        let ret = new Date();\r\n        ret.setHours(ret.getHours() - env.timeZone + this.timezone)\r\n        ret.setHours(0, 0, 0, 0);\r\n        return ret;\r\n    }\r\n    protected initObservable() {\r\n        makeObservable(this, {\r\n            from: observable,\r\n            to: observable,\r\n            prev: action,\r\n            next: action,\r\n            hasNext: computed,\r\n        });\r\n    }\r\n    type: EnumPeriod;\r\n\tfrom: Date;\r\n\tto: Date;\r\n    abstract init(): void;\r\n    abstract prev(): void;\r\n    abstract next(): void;\r\n    get hasNext(): boolean {\r\n        let date = this.newDate();\r\n        return this.to <= date;\r\n    }\r\n    abstract render(): string;\r\n}\r\n\r\nconst weekday = '日一二三四五六';\r\nclass DayPeriod extends Period {\r\n    init(): void {\r\n        this.type = EnumPeriod.day;\r\n        this.to.setDate(this.from.getDate()+1);\r\n    }\r\n    prev(): void {\r\n        this.to = new Date(this.to.setDate(this.to.getDate()-1));\r\n        this.from = new Date(this.from.setDate(this.from.getDate()-1));\r\n    }\r\n    next(): void {\r\n        this.to = new Date(this.to.setDate(this.to.getDate()+1));\r\n        this.from = new Date(this.from.setDate(this.from.getDate()+1));\r\n    }\r\n    render(): string {\r\n        let year = new Date().getFullYear();\r\n        let y = this.from.getFullYear();\r\n        let m = this.from.getMonth();\r\n        let d = this.from.getDate();\r\n        let dw = this.from.getDay();\r\n        return (y === year? '': `${y}年`) + `${m+1}月${d}日 星期${weekday[dw]}`;\r\n    }\r\n}\r\n\r\nclass WeekPeriod extends Period {\r\n    init(): void {\r\n        this.type = EnumPeriod.week;\r\n        let day = this.to.getDay();\r\n        let diff = this.to.getDate() - day + (day === 0 ? -6:1); // adjust when day is sunday\r\n        this.from = new Date(this.to.setDate(diff));\r\n        this.to.setDate(this.to.getDate() + 7);\r\n    }\r\n    prev(): void {\r\n        this.from = new Date(this.from.setDate(this.from.getDate() - 7));\r\n        this.to = new Date(this.to.setDate(this.to.getDate() - 7));\r\n    }\r\n    next(): void {\r\n        this.from = new Date(this.from.setDate(this.from.getDate() + 7));\r\n        this.to = new Date(this.to.setDate(this.to.getDate() + 7));\r\n    }\r\n    render(): string {\r\n        let year = new Date().getFullYear();\r\n        let yf = this.from.getFullYear();\r\n        let mf = this.from.getMonth();\r\n        let df = this.from.getDate();\r\n        let mt = this.to.getMonth();\r\n        let dt = this.to.getDate();\r\n        return (yf === year? '': `${yf}年`) + `${mf+1}月${df}日 - `\r\n            + (mt === mf? '': `${mt}月`) + `${dt}日`;\r\n    }\r\n}\r\n\r\nclass MonthPeriod extends Period {\r\n    init(): void {\r\n        this.type = EnumPeriod.month;\r\n        this.from = new Date(this.to.getFullYear(), this.to.getMonth(), 1);\r\n        this.to = new Date(this.to.getFullYear(), this.to.getMonth() + 1, 1);\r\n    }\r\n    prev(): void {\r\n        this.from = new Date(this.from.setMonth(this.from.getMonth() - 1));\r\n        this.to = new Date(this.to.setMonth(this.to.getMonth() - 1));\r\n    }\r\n    next(): void {\r\n        this.from = new Date(this.from.setMonth(this.from.getMonth() + 1));\r\n        this.to = new Date(this.to.setMonth(this.to.getMonth() + 1));\r\n    }\r\n    render(): string {\r\n        let year = new Date().getFullYear();\r\n        let yf = this.from.getFullYear();\r\n        return `${year===yf? '': year+'年'}${this.from.getMonth()+1}月`;\r\n    }\r\n}\r\n\r\nclass YearPeriod extends Period {\r\n    init(): void {\r\n        this.type = EnumPeriod.year;\r\n        this.from = new Date(this.to.getFullYear(), 0, 1);\r\n        this.to = new Date(this.to.getFullYear() + 1, 0, 1);\r\n    }\r\n    prev(): void {\r\n        this.from = new Date(this.from.setFullYear(this.from.getFullYear() - 1));\r\n        this.to = new Date(this.to.setFullYear(this.to.getFullYear() - 1));\r\n    }\r\n    next(): void {\r\n        this.from = new Date(this.from.setFullYear(this.from.getFullYear() + 1));\r\n        this.to = new Date(this.to.setFullYear(this.to.getFullYear() + 1));\r\n    }\r\n    render(): string {return `${this.from.getFullYear()}年`}\r\n}\r\n\r\nexport function createPeriod(periodType: EnumPeriod, timezone:number): Period {\r\n    let period: Period;\r\n    switch (periodType) {\r\n        case EnumPeriod.day: period = new DayPeriod(timezone); break;\r\n        case EnumPeriod.week: period = new WeekPeriod(timezone); break;\r\n        case EnumPeriod.month: period = new MonthPeriod(timezone); break;\r\n        case EnumPeriod.year: period = new YearPeriod(timezone); break;\r\n    }\r\n    return period;\r\n}","import { UQs } from \"uq-app\";\r\nimport { ReturnGetObjectItemHistoryRet } from \"uq-app/uqs/JkMe\";\r\n\r\nexport class BizOpDetail {\r\n    private uqs: UQs;\r\n    item: ReturnGetObjectItemHistoryRet;\r\n\r\n    constructor(uqs: UQs, item: ReturnGetObjectItemHistoryRet) {\r\n        this.uqs = uqs;\r\n        this.item = item;\r\n    }\r\n}","import { dateFromMinuteId } from 'tonva-core';\r\nimport { EasyTime, FA, VPage } from \"tonva-react\";\r\nimport { CPortal } from \"./CPortal\";\r\n\r\nexport class VBizOpDetail extends VPage<CPortal> {\r\n    header() {return '业务详情'}\r\n    content() {\r\n        let {bizOpDetail} = this.controller;\r\n        let {minuteId, bizOp, memo, value} = bizOpDetail.item;\r\n        let {itemTitles, timezone} = this.controller.cApp;\r\n        let {item} = this.controller.itemPeriodSum;\r\n        let {unit, fixed} = itemTitles[item];\r\n        let d = dateFromMinuteId(minuteId, timezone);\r\n        return <div className=\"p-3\">\r\n            <div>业务编号：{bizOp}</div>\r\n            <div>发生时间：<EasyTime date={d} timeZone={-5} /></div>\r\n            <div>{memo} {(value??0).toFixed(fixed??2)} {unit}</div>\r\n            <div className=\"my-3\">\r\n                <FA className=\"text-danger me-3\" name=\"smile-o\" size=\"lg\" />\r\n                <span className=\"text-muted\">业务详情显示正在开发中</span>\r\n            </div>\r\n        </div>\r\n    }\r\n}\r\n","import { dateFromMinuteId } from 'tonva-core';\r\nimport { List, LMR, VDate, VPage } from \"tonva-react\";\r\nimport { ReturnGetObjectItemHistoryRet } from \"uq-app/uqs/JkMe\";\r\nimport { CPortal } from \"./CPortal\";\r\n\r\nexport class VPostItemHistory extends VPage<CPortal> {\r\n\theader() {\r\n        let {itemTitles, postTitles} = this.controller.cApp;\r\n        let {itemPeriodSum} = this.controller;\r\n        let {post, item} = itemPeriodSum;\r\n        return `${postTitles[post].title} - ${itemTitles[item].title}`;\r\n    }\r\n\tcontent() {\r\n        let {history} = this.controller;\r\n\t\treturn <div className=\"\">\r\n            <List items={history} \r\n                item={{render: this.renderItem, onClick: this.onClickItem}} />\r\n        </div>;\r\n    }\r\n\r\n    private renderItem = (history: ReturnGetObjectItemHistoryRet, index: number) => {\r\n        let {itemTitles, timezone} = this.controller.cApp;\r\n        let {minuteId, value, biz, bizOp, memo} = history;\r\n        let {item} = this.controller.itemPeriodSum;\r\n        let {unit, fixed} = itemTitles[item];\r\n        let d = dateFromMinuteId(minuteId, timezone);\r\n        let left = <div className=\"text-muted small w-min-4c me-2\">\r\n            <VDate date={d} hideSameYear={true} />\r\n        </div>;\r\n        let right = <div className=\"ms-2\">{(value??0).toFixed(fixed??2)} {unit}</div>;\r\n        return <LMR className=\"px-3 py-2 align-items-center\" left={left} right={right}>\r\n            <small>{bizOp}{memo? ': ' + memo : ''}</small>\r\n        </LMR>;\r\n    }\r\n\r\n    private onClickItem = (item: ReturnGetObjectItemHistoryRet) => {\r\n        this.controller.showBizOpDetail(item);\r\n    }\r\n}","import { List, LMR, VPage } from \"tonva-react\";\r\nimport { ReturnGetObjectItemPeriodHistoryRet } from \"uq-app/uqs/JkMe\";\r\nimport { CPortal } from \"./CPortal\";\r\n\r\nabstract class VPeriodPostItemHistory extends VPage<CPortal> {\r\n\theader() {\r\n        let {itemTitles, postTitles} = this.controller.cApp;\r\n        let {itemPeriodSum} = this.controller;\r\n        let {post, item} = itemPeriodSum;\r\n        return `${postTitles[post].title} - ${itemTitles[item].title}`;\r\n    }\r\n\tcontent() {\r\n        let {periodHistory} = this.controller;\r\n\t\treturn <div className=\"\">\r\n            <List items={periodHistory} \r\n                item={{render: this.renderItem, onClick: this.onClickItem}} />\r\n        </div>;\r\n    }\r\n\r\n    private renderItem = (history: ReturnGetObjectItemPeriodHistoryRet, index: number) => {\r\n        let {itemTitles} = this.controller.cApp;\r\n        let {date, value} = history;\r\n        let {item} = this.controller.itemPeriodSum;\r\n        let {unit, fixed} = itemTitles[item];\r\n        let d = new Date(date);\r\n        let left = <div className=\"text-muted small\">{this.renderDate(d)}</div>;\r\n        let right = <div>{(value??0).toFixed(fixed??2)} {unit}</div>;\r\n        return <LMR className=\"px-3 py-2\" left={left} right={right}></LMR>;\r\n    }\r\n\r\n    private onClickItem = async (item: ReturnGetObjectItemPeriodHistoryRet) => {\r\n        await this.clickItem(item);\r\n    }\r\n\r\n    protected abstract renderDate(date: Date): JSX.Element;\r\n    protected abstract clickItem(item: ReturnGetObjectItemPeriodHistoryRet): Promise<void>;\r\n}\r\n\r\nexport class VDayPostItemHistory extends VPeriodPostItemHistory {\r\n    protected renderDate(d: Date): JSX.Element {\r\n        return <>{d.getMonth()+1}月{String(100+d.getDate()).substr(1)}日</>;\r\n    }\r\n\r\n    protected async clickItem(item: ReturnGetObjectItemPeriodHistoryRet): Promise<void> {\r\n        let from: Date = item.date;\r\n        let to: Date = new Date(from);\r\n        to.setDate(to.getDate()+1);\r\n        await this.controller.showPostItemHistory(undefined, from, to);\r\n    }\r\n}\r\n\r\nexport class VMonthPostItemHistory extends VPeriodPostItemHistory {\r\n    protected renderDate(d: Date): JSX.Element {\r\n        return <>{d.getMonth()+1}月</>;\r\n    }\r\n\r\n    protected async clickItem(item: ReturnGetObjectItemPeriodHistoryRet): Promise<void> {\r\n        let from: Date = item.date;\r\n        let to: Date = new Date(from);\r\n        to.setMonth(to.getMonth()+1);\r\n        await this.controller.showDayPostItemHistory(undefined, from, to);\r\n    }\r\n}\r\n","import React from \"react\";\r\nimport { observer } from \"mobx-react\";\r\nimport { EasyTime, FA, List, LMR, VPage } from \"tonva-react\";\r\nimport { CPortal } from \"./CPortal\";\r\nimport { View } from \"tonva-react\";\r\nimport { EnumPeriod, PostPeriodSum, ItemPeriodSum } from \"./period\";\r\nimport { ReturnGetObjectItemPeriodSumRet } from \"uq-app/uqs/JkMe\";\r\n\r\nconst cnColPeriod = \"col text-center\";\r\nconst cnPeriod = \" py-2 px-3 \";\r\nconst cnTabCur = ' border-2 border-bottom border-primary fw-bold bg-light ';\r\nconst cnTab = ' border-bottom border-muted cursor-pointer text-muted ';\r\n\r\nexport class VPeriodSum<T extends CPortal = CPortal> extends View<T> {\r\n    render(): JSX.Element {\r\n\t\treturn React.createElement(observer(() => {\r\n\t\t\tlet periodList:[EnumPeriod, string, string][] = [\r\n\t\t\t\t[EnumPeriod.day, '日', undefined],\r\n\t\t\t\t[EnumPeriod.week, '周', undefined],\r\n\t\t\t\t[EnumPeriod.month, '月', undefined],\r\n\t\t\t\t[EnumPeriod.year, '年', undefined],\r\n\t\t\t];\r\n\t\t\tlet {period} = this.controller;\r\n\t\t\tlet {type} = period;\r\n\t\t\tfor (let p of periodList) {\r\n\t\t\t\tlet [ep] = p;\r\n\t\t\t\tp[2] = cnPeriod + (ep === type? cnTabCur : cnTab);\r\n\t\t\t}\r\n\t\t\tlet VRefreshTime = observer(() => <EasyTime date={this.controller.cApp.refreshTime}/>);\r\n\t\t\treturn <div className=\"\">\r\n\t\t\t\t<div className=\"row g-0\">\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tperiodList.map(v => {\r\n\t\t\t\t\t\t\tlet [ep, title, cn] = v;\r\n\t\t\t\t\t\t\treturn <div key={title} className={cnColPeriod} \r\n\t\t\t\t\t\t\t\tonClick={() => this.controller.setPeriod(ep)}>\r\n\t\t\t\t\t\t\t\t<div className={cn}>{title}</div>\r\n\t\t\t\t\t\t\t</div>;\r\n\t\t\t\t\t\t})\r\n\t\t\t\t\t}\r\n\t\t\t\t</div>\r\n\t\t\t\t{this.renderDate()}\r\n\t\t\t\t<div className=\"\">\r\n\t\t\t\t\t<List items={this.controller.list} \r\n\t\t\t\t\t\titem={{render: this.renderItem, onClick: undefined/*this.onClickItem*/}} />\r\n\t\t\t\t</div>\r\n\t\t\t\t<div className=\"d-flex py-2 px-3\">\r\n\t\t\t\t\t<div className=\"flex-fill\"></div>\r\n\t\t\t\t\t<div className=\"small text-muted cursor-pointer\"\r\n\t\t\t\t\t\tonClick={this.controller.cApp.refresh}>\r\n\t\t\t\t\t\t<FA name=\"refresh\" /> <VRefreshTime />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</div>;\r\n\t\t}));\r\n    }\r\n\r\n\tprivate renderDate() {\r\n\t\tlet {period, prev, next} = this.controller;\r\n\t\tlet {hasNext} = period;\r\n\t\tlet left = <div className=\"cursor-pointer p-3\" onClick={prev}><FA name=\"angle-left\" /></div>;\r\n\t\tlet right = <div className={' p-3 ' + (hasNext? ' cursor-pointer ':' text-light ')} onClick={next}><FA name=\"angle-right\" /></div>\r\n\t\treturn <div className=\"d-flex\">\r\n\t\t\t{left}\r\n\t\t\t<div className=\"text-center flex-fill py-3\">{period.render()}</div>\r\n\t\t\t{right}\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate onClickItem = (item: ReturnGetObjectItemPeriodSumRet) => {\r\n\t\t//this.controller.showItemHistory(item.id, EnumSumPeriod.day);\r\n\t}\r\n\r\n\tprotected renderItem = (postPeriodSum: PostPeriodSum, index: number) => {\r\n\t\tlet {postTitles} = this.controller.cApp;\r\n\t\tlet {post, itemList} = postPeriodSum;\r\n\t\tlet {title, vice} = postTitles[post];\r\n\t\treturn <div className=\"d-block mx-3 my-3 border border-success\">\r\n\t\t\t<div className=\"px-3 py-2\">\r\n\t\t\t\t<b className=\"text-primary\">{title}</b>\r\n\t\t\t\t<small className=\"text-muted ms-3\">{vice}</small>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<List items={itemList} \r\n\t\t\t\t\titem={{render: this.renderItemPeriodSum, onClick: this.onClickItemPeriodSum}} />\r\n\t\t\t</div>\r\n\t\t</div>;\r\n\t}\r\n\r\n\tprivate renderItemPeriodSum = (ips: ItemPeriodSum, index: number) => {\r\n\t\tlet {itemTitles} = this.controller.cApp;\r\n\t\tlet {item, value} = ips;\r\n\t\tlet {title, vice, fixed} = itemTitles[item];\r\n\t\treturn <LMR className=\"px-3 py-2 w-100\" right={<div>{(value??0).toFixed(fixed)}</div>}>\r\n\t\t\t{title} <small className=\"text-muted ms-3\">{vice}</small>\r\n\t\t</LMR>;\r\n\t}\r\n\t\r\n\tprivate onClickItemPeriodSum = (ips: ItemPeriodSum) => {\r\n\t\tswitch (this.controller.period.type) {\r\n\t\t\tcase EnumPeriod.day:\r\n\t\t\t\tthis.controller.showPostItemHistory(ips, undefined, undefined);\r\n\t\t\t\tbreak;\r\n\t\t\tcase EnumPeriod.month:\r\n\t\t\tcase EnumPeriod.week:\r\n\t\t\t\tthis.controller.showDayPostItemHistory(ips, undefined, undefined);\r\n\t\t\t\tbreak;\r\n\t\t\tcase EnumPeriod.year:\r\n\t\t\t\tthis.controller.showMonthPostItemHistory(ips, undefined, undefined);\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t}\r\n}\r\n","import { action, makeObservable, observable, runInAction } from \"mobx\";\r\nimport { CApp, CUqBase } from \"uq-app\";\r\nimport { Item, ObjectPostItem, ReturnGetObjectItemHistoryRet, ReturnGetObjectItemPeriodHistoryRet\r\n    , ReturnGetObjectItemPeriodSumRet } from \"uq-app/uqs/JkMe\";\r\nimport { BizOpDetail } from \"./bizOpDetail\";\r\nimport { PostPeriodSum, Period, ItemPeriodSum, EnumPeriod, createPeriod } from \"./period\";\r\nimport { VBizOpDetail } from \"./VBizOpDetail\";\r\nimport { VPostItemHistory } from \"./VPostItemHistory\";\r\nimport { VDayPostItemHistory, VMonthPostItemHistory } from \"./VPeriodPostItemHistory\";\r\nimport { VPeriodSum } from \"./VPortal\";\r\n\r\nexport class CPortal extends  CUqBase {\r\n\tbizOpDetail: BizOpDetail;\r\n\r\n    period: Period;\r\n    list: any[];\r\n    objectPostItem: ObjectPostItem;\r\n    itemPeriodSum: ItemPeriodSum;\r\n    history: ReturnGetObjectItemHistoryRet[];\r\n    periodHistory: ReturnGetObjectItemPeriodHistoryRet[];\r\n\r\n    constructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n        makeObservable(this, {\r\n            period: observable,\r\n            history: observable.shallow,\r\n            periodHistory: observable.shallow,\r\n            //postPeriodSumColl: observable.ref,\r\n            //postPeriodSumList: observable.shallow,\r\n            list: observable.shallow,\r\n            internalSetPeriod: action,\r\n        });\r\n        this.internalSetPeriod(EnumPeriod.day);\r\n    }\r\n\r\n    protected async internalStart() {\r\n    }\r\n\r\n    internalSetPeriod(periodType: EnumPeriod) {\r\n        this.period = createPeriod(periodType, this.cApp.timezone);\r\n    }\r\n\r\n    async setPeriod(periodType: EnumPeriod) {\r\n        this.internalSetPeriod(periodType);\r\n        await this.load();\r\n    }\r\n\r\n    protected async GetPeriodSum(from: Date, to: Date):Promise<{ret:any[]}> {\r\n        let ret = await this.uqs.JkMe.GetUserObjectItemPeriodSum.query({\r\n            from,\r\n            to,\r\n        });\r\n        return ret;\r\n    }\r\n\r\n    async load() {\r\n        let {from, to} = this.period;\r\n        let ret = await this.GetPeriodSum(from, to);\r\n        let arr: ReturnGetObjectItemPeriodSumRet[] = ret.ret;\r\n        let postPeriodSumColl = {} as any;\r\n        let postPeriodSumList:PostPeriodSum[] = [];\r\n        for (let n of arr) {\r\n            let post = Number(n.post);\r\n            let item = Number(n.item);\r\n            let ips:ItemPeriodSum = {...n, post, item};\r\n            let postPeriodSum = postPeriodSumColl[post];\r\n            if (postPeriodSum === undefined) {\r\n                let itemColl: {[item in keyof typeof Item]: ItemPeriodSum} = {} as any;\r\n                postPeriodSumColl[post] = postPeriodSum = {\r\n                    post: post,\r\n                    itemColl,\r\n                    itemList: [],\r\n                }\r\n                postPeriodSumList.push(postPeriodSum);\r\n            }\r\n            postPeriodSum.itemColl[item] = ips;\r\n            postPeriodSum.itemList.push(ips);\r\n        }\r\n        runInAction(() => {\r\n            //this.postPeriodSumColl = postPeriodSumColl;\r\n            //this.postPeriodSumList = postPeriodSumList;\r\n            this.list = postPeriodSumList;\r\n        });\r\n    }\r\n\r\n    private async loadPostItemHistory(ips: ItemPeriodSum, fromDate: Date, toDate: Date) {\r\n        if (!ips) {\r\n            ips = this.itemPeriodSum;\r\n        }\r\n        else {\r\n            this.itemPeriodSum = ips;\r\n        }\r\n        let {id: objectPostItem} = ips;\r\n      \r\n        let {from, to} = this.period;\r\n        if (fromDate) from = fromDate;\r\n        if (toDate) to = toDate;\r\n\t\tlet ret = await this.uqs.JkMe.GetObjectItemHistory.query({\r\n\t\t\tobjectPostItem, \r\n\t\t\tfrom,\r\n\t\t\tto,\r\n\t\t});\r\n        runInAction(() => {\r\n            this.history = ret.ret;\r\n        });\r\n\t}\r\n\r\n    private async loadPeriodPostItemHistory(ips: ItemPeriodSum, fromDate: Date, toDate: Date, sumPeriod: EnumPeriod) {\r\n        if (ips) {\r\n            this.itemPeriodSum = ips;\r\n        }\r\n        else {\r\n            ips = this.itemPeriodSum;\r\n        }\r\n        let {id: objectPostItem} = ips;\r\n        let {from, to} = this.period;\r\n        if (fromDate) from = fromDate;\r\n        if (toDate) to = toDate;\r\n\t\tlet ret = await this.uqs.JkMe.GetObjectItemPeriodHistory.query({\r\n\t\t\tobjectPostItem, \r\n\t\t\tfrom,\r\n\t\t\tto,\r\n\t\t\tperiod: sumPeriod,\r\n\t\t});\r\n        runInAction(() => {\r\n            this.periodHistory = ret.ret;\r\n        });\r\n\t}\r\n\r\n    prev = async () => {\r\n        this.period.prev();\r\n        await this.load();\r\n    }\r\n\r\n    next = async () => {\r\n        if (this.period.hasNext === false) return;\r\n        this.period.next();\r\n        await this.load();\r\n    }\r\n\r\n\tasync showBizOpDetail(item: ReturnGetObjectItemHistoryRet) {\r\n\t\tthis.bizOpDetail = new BizOpDetail(this.uqs, item);\r\n\t\tthis.openVPage(VBizOpDetail);\r\n\t}\r\n\r\n\tasync showPostItemHistory(ips: ItemPeriodSum, from: Date, to: Date) {\r\n\t\tawait this.loadPostItemHistory(ips, from, to);\r\n\t\tthis.openVPage(VPostItemHistory);\r\n\t}\r\n\r\n\tasync showDayPostItemHistory(ips: ItemPeriodSum, from: Date, to: Date) {\r\n\t\tawait this.loadPeriodPostItemHistory(ips, from, to, EnumPeriod.day);\r\n\t\tthis.openVPage(VDayPostItemHistory);\r\n\t}\r\n\r\n\tasync showMonthPostItemHistory(ips: ItemPeriodSum, from: Date, to: Date) {\r\n\t\tawait this.loadPeriodPostItemHistory(ips, from, to, EnumPeriod.month);\r\n\t\tthis.openVPage(VMonthPostItemHistory);\r\n\t}\r\n\r\n    renderVPortal() {\r\n        return this.renderView(VPeriodSum as any);\r\n    }\r\n}\r\n","import { VPage } from \"tonva-react\";\r\nimport { CObjectPortal } from \"./CObjectPortal\";\r\n\r\nexport class VObjectPortal extends VPage<CObjectPortal> {\r\n    header() { return '详情'; }\r\n    content() {\r\n        return <div>\r\n            <div>{this.controller.pageTop}</div>\r\n            <div className=\"d-flex flex-wrap p-2\">\r\n                {this.controller.cAccount?.renderAccounts()}\r\n            </div>\r\n            <div>{this.controller.renderVPortal()}</div>\r\n        </div>;\r\n    }\r\n}\r\n","import { ResultGetUserObjectItemPeriodSum } from \"uq-app/uqs/JkMe\";\r\nimport { EnumPeriod } from \"../period\";\r\nimport { CPortal } from '../CPortal';\r\nimport { VObjectPortal } from \"./VObjectPortal\";\r\nimport { CAccount } from \"account\";\r\n\r\nexport class CObjectPortal extends CPortal {\r\n\tcAccount: CAccount;\r\n    object: number;\r\n    pageTop: JSX.Element;\r\n\r\n    init(object: number, pageTop: JSX.Element) {\r\n        this.cAccount = this.newC(CAccount);\r\n        this.object = object;\r\n        this.pageTop = pageTop;\r\n    }\r\n\r\n    protected async GetPeriodSum(from: Date, to: Date):Promise<ResultGetUserObjectItemPeriodSum> {\r\n        let ret = await this.uqs.JkMe.GetObjectItemPeriodSum.query({\r\n            object: this.object,\r\n\t\t\tfrom,\r\n\t\t\tto,\r\n\t\t});\r\n        return ret;\r\n    }\r\n\r\n    async showObjectPortal() {\r\n        await Promise.all([\r\n            this.setPeriod(EnumPeriod.month),\r\n            this.cAccount.load(this.object),\r\n        ]);\r\n        this.openVPage(VObjectPortal);\r\n    }\r\n}\r\n","import { VPeriodSum } from \"../VPortal\";\r\nimport { CUnitPortal } from \"./CUnitPortal\";\r\nimport { Item } from \"uq-app/uqs/JkMe\";\r\nimport { FA, LMR } from \"tonva-react\";\r\n\r\nconst nf = new Intl.NumberFormat('en-US', {minimumFractionDigits:2, maximumFractionDigits:2});\r\n\r\nexport class VUnitPortal extends VPeriodSum<CUnitPortal> {\r\n    header() { return '详情'; }\r\n    content() {\r\n        return <div>\r\n            <div>{/*this.controller.pageTop*/}</div>\r\n            <div>{this.controller.renderVPortal()}</div>\r\n        </div>;        \r\n    }\r\n\r\n    protected renderItem = (row: any, index: number) => {\r\n        let {item, value} = row;\r\n        let {itemTitles} = this.controller.cApp;\r\n\t\tlet {title, vice, unit, fixed} = itemTitles[item as Item];\r\n        let left = <div>\r\n            <FA className=\"text-info me-3\" name=\"lightbulb-o\" />\r\n            {title}\r\n        </div>;\r\n        let right = <div>\r\n            {\r\n                value<0?\r\n                <span className=\"text-danger\">({nf.format(-value)})</span>\r\n                :\r\n                <>{nf.format(value??0)}</>\r\n            } \r\n            <small className=\"text-muted ms-1\">{unit}</small>\r\n        </div>;\r\n        return <LMR className=\"py-2 px-3 d-flex align-items-center\"\r\n            left={left} right={right} />;\r\n    }\r\n}\r\n","import { runInAction } from \"mobx\";\r\nimport { EnumPeriod } from \"portal\";\r\nimport { CApp } from \"uq-app\";\r\nimport { ResultGetItemPeriodSum } from \"uq-app/uqs/JkMe\";\r\nimport { CPortal } from '../CPortal';\r\nimport { VUnitPortal } from \"./VUnitPortal\";\r\n\r\nexport class CUnitPortal extends CPortal {\r\n    constructor(cApp: CApp) {\r\n\t\tsuper(cApp);\r\n        this.internalSetPeriod(EnumPeriod.month);\r\n    }\r\n\r\n    protected async GetPeriodSum(from: Date, to: Date):Promise<ResultGetItemPeriodSum> {\r\n        let ret = await this.uqs.JkMe.GetItemPeriodSum.query({\r\n\t\t\tdate: from,\r\n\t\t\tdays: Math.round(Math.abs((to.getTime() - from.getTime()) / (24 * 60 * 60 * 1000))),\r\n\t\t});\r\n        return ret;\r\n    }\r\n    async load() {\r\n        let {from, to} = this.period;\r\n        let ret = await this.GetPeriodSum(from, to);\r\n        runInAction(() => {\r\n            this.list = ret.ret;\r\n        });\r\n    }\r\n\r\n    renderVPortal() {\r\n        return this.renderView(VUnitPortal as any);\r\n    }\r\n}\r\n","import { CHome } from \"../home\";\r\nimport { CMe } from \"../me\";\r\nimport { CBug } from \"./bug\";\r\nimport { CUqApp } from \"./CBase\";\r\nimport { res } from \"./res\";\r\nimport { VMain } from \"./VMain\";\r\nimport { CTester } from \"./test-uqui\";\r\nimport { setUI } from \"./uqs\";\r\nimport { Item, Post, EnumRole, EnumRoleOp, ObjectPostItem, EnumAccount } from \"./uqs/JkMe\";\r\nimport { CSupervise } from \"supervise\";\r\nimport { CPortal, CObjectPortal, CUnitPortal } from \"portal\";\r\nimport { makeObservable, observable } from \"mobx\";\r\nimport { nav, start } from \"tonva-react\";\r\nimport { appConfig } from \"./appConfig\";\r\n\r\nconst gaps = [10, 3,3,3,3,3,5,5,5,5,5,5,5,5,10,10,10,10,15,15,15,30,30,60];\r\n\r\nexport interface Title {\r\n    title: string;\r\n    vice?: string;\r\n    unit?: string;\r\n    fixed?: number;\r\n}\r\n\r\n\r\nexport class CApp extends CUqApp {\r\n\tconstructor() {\r\n\t\tsuper(appConfig);\r\n\t}\r\n\r\n\tcHome: CHome;\r\n\tcSupervise: CSupervise;\r\n\tcBug: CBug;\r\n\tcMe: CMe;\r\n\tcUI: CTester;\r\n\tcPortal: CPortal;\r\n\tcUnitPortal: CUnitPortal;\r\n\r\n\treadonly itemTitles:{[item in Item]: Title} = {} as any;\r\n\treadonly postTitles:{[post in Post]: Title} = {} as any;\r\n\treadonly accountTitles:{[acount in EnumAccount]: Title} = {} as any;\r\n\tops: {role: EnumRole; op: EnumRoleOp}[];\r\n\t\r\n\tprotected async internalStart(isUserLogin: boolean) {\r\n\t\tmakeObservable(this, {\r\n\t\t\trefreshTime: observable\r\n\t\t});\r\n\t\tthis.setRes(res);\r\n\t\tsetUI(this.uqs);\r\n\r\n\t\tawait this.loadBaseData();\r\n\r\n\t\tthis.cHome = this.newC(CHome);\r\n\t\tthis.cSupervise = this.newC(CSupervise);\r\n\t\tthis.cBug = this.newC(CBug);\r\n\t\tthis.cMe = this.newC(CMe);\r\n\t\tthis.cUI = this.newC(CTester);\r\n\t\tthis.cPortal = this.newC(CPortal);\r\n\t\tthis.cHome.load();\r\n\t\tthis.openVPage(VMain, undefined, this.dispose);\r\n\t\t// 加上下面一句，可以实现主动页面刷新\r\n\t\tthis.timer = setInterval(this.callTick, 1000);\r\n\t\t// uq 里面加入这一句，会让相应的$Poked查询返回poke=1：\r\n\t\t// TUID [$User] ID (member) SET poke=1;\r\n\t}\r\n\r\n\tprivate timer:any;\r\n\tprotected onDispose() {\r\n\t\tclearInterval(this.timer);\r\n\t\tthis.timer = undefined;\r\n\t}\r\n\t\r\n\tasync initStart() {\r\n\t\tawait nav.appStart();\r\n\t}\r\n\r\n\trender(loginedOnly: boolean = true):JSX.Element {\r\n\t\tconst onLogined = async (isUserLogin?:boolean) => {\r\n\t\t\tawait start(CApp, appConfig, isUserLogin);\r\n\t\t}\r\n\t\tlet onNotLogined: () => Promise<void>;\r\n\t\tif (loginedOnly === false) onNotLogined = onLogined;\r\n\t\treturn nav.renderNavView(onLogined, onNotLogined);\r\n\t}\r\n\r\n\r\n\tprivate async loadBaseData() {\r\n\t\tlet {JkMe} = this.uqs;\r\n\t\tlet [retItemTitles, retPostTitles, retAccountTitles, roleOps, myTimezone] = await Promise.all([\r\n\t\t\tJkMe.GetItemTitles.query({}),\r\n\t\t\tJkMe.GetPostTitles.query({}),\r\n\t\t\tJkMe.GetAccountTitles.query({}),\r\n\t\t\tJkMe.GetRoleOps.query({}),\r\n\t\t\tJkMe.$getMyTimezone.query({}),\r\n\t\t]);\r\n\t\tfor (let it of retItemTitles.ret) this.itemTitles[it.id as Item] = it;\r\n\t\tfor (let pt of retPostTitles.ret) this.postTitles[pt.id as Post] = pt;\r\n\t\tfor (let at of retAccountTitles.ret) this.accountTitles[at.id as EnumAccount] = at;\r\n\t\tthis.ops = roleOps.ret;\r\n\t\tlet tz = myTimezone.ret[0];\r\n\t\tthis.timezone = tz.timezone;\r\n\t\tthis.unitTimezone = tz.unitTimeZone;\r\n\t}\r\n\t\r\n\trenderVPortal() {\r\n\t\treturn this.cPortal.renderVPortal();\r\n\t}\r\n\r\n\tnewCObjectPortal(object: number, pageTop: JSX.Element): CObjectPortal {\r\n\t\tlet ret = this.newC(CObjectPortal, object, pageTop);\r\n\t\treturn ret;\r\n\t}\r\n\r\n\trenderVUnitSum() {\r\n\t\tif (!this.cUnitPortal) {\r\n\t\t\tthis.cUnitPortal = this.newC(CUnitPortal);\r\n\t\t\tthis.cUnitPortal.load();\r\n\t\t}\r\n\t\treturn this.cUnitPortal.renderVPortal();\r\n\t}\r\n\r\n\t// 数据服务器提醒客户端刷新，下面代码重新调入的数据\r\n\trefresh = async () => {\r\n\t\tlet d = Date.now() / 1000;\r\n\t\tif (d - this.refreshTime < 30) return;\r\n\t\tawait Promise.all([\r\n\t\t\tthis.cHome.load(),\r\n\t\t\tthis.cUnitPortal?.load(),\r\n\t\t]);\r\n\t\tthis.refreshTime = d;\r\n\t}\r\n\r\n\trefreshTime: number = Date.now() / 1000;\r\n\r\n\tprivate tick = 0;\r\n\tprivate gapIndex = 0;\r\n\tprivate callTick = async () => {\r\n\t\ttry {\r\n\t\t\tif (!this.user) return;\r\n\t\t\t++this.tick;\r\n\t\t\tif (this.tick<gaps[this.gapIndex]) return;\r\n\t\t\tthis.tick = 0;\r\n\t\t\tif (this.gapIndex < gaps.length - 1) ++this.gapIndex;\r\n\t\t\tlet ret = await this.uqs.JkMe.$poked.query(undefined, undefined, false);\r\n\t\t\tlet v = ret.ret[0];\r\n\t\t\tif (v === undefined) return;\r\n\t\t\tif (!v.poke) return;\r\n\t\t\tthis.gapIndex = 1;\r\n\t\t\tawait this.refresh();\r\n\t\t}\r\n\t\tcatch {\r\n\t\t}\r\n\t}\r\n}\r\n","import React from 'react';\r\nimport ReactDOM from 'react-dom';\r\nimport { nav, NavView, start } from 'tonva-react';\r\nimport { CApp } from './CApp';\r\nimport { appConfig } from './appConfig';\r\n// import { App } from './App';\r\n\r\nexport async function startApp() {\r\n\tnav.setSettings(appConfig);\r\n\tconst onLogined = async (isUserLogin?:boolean) => {\r\n\t\tawait start(CApp, appConfig, isUserLogin);\r\n\t}\r\n    const notLogined: ()=>Promise<void> = undefined;\r\n    const userPassword: () => Promise<{user:string; password:string}> = undefined;\r\n\tnav.appStart();\r\n    ReactDOM.render(\r\n        <React.StrictMode>\r\n            <NavView ref={navView => nav.set(navView)} \r\n                onLogined={onLogined}\r\n                notLogined={notLogined}\r\n                userPassword={userPassword} />;\r\n        </React.StrictMode>,\r\n        document.getElementById('root')\r\n    );\r\n}\r\n","import { ReportHandler } from 'web-vitals';\r\n\r\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\r\n  if (onPerfEntry && onPerfEntry instanceof Function) {\r\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\r\n      getCLS(onPerfEntry);\r\n      getFID(onPerfEntry);\r\n      getFCP(onPerfEntry);\r\n      getLCP(onPerfEntry);\r\n      getTTFB(onPerfEntry);\r\n    });\r\n  }\r\n};\r\n\r\nexport default reportWebVitals;\r\n","//import React from 'react';\r\n//import ReactDOM from 'react-dom';\r\nimport 'bootstrap/dist/css/bootstrap.css';\r\nimport { startApp } from 'uq-app';\r\nimport './index.css';\r\nimport reportWebVitals from './reportWebVitals';\r\n//import { App } from 'uq-app';\r\n\r\n/*\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n    <App />\r\n  </React.StrictMode>,\r\n  document.getElementById('root')\r\n);\r\n*/\r\n(function() {\r\n  startApp();\r\n})();\r\n\r\n// If you want to start measuring performance in your app, pass a function\r\n// to log results (for example: reportWebVitals(console.log))\r\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\r\nreportWebVitals();\r\n"],"sourceRoot":""}